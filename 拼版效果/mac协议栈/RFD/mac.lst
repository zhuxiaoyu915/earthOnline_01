   1               		.file	"mac.c"
   2               		.arch atmega128
   3               	__SREG__ = 0x3f
   4               	__SP_H__ = 0x3e
   5               	__SP_L__ = 0x3d
   6               	__tmp_reg__ = 0
   7               	__zero_reg__ = 1
   8               		.global __do_copy_data
   9               		.global __do_clear_bss
  11               		.text
  12               	.Ltext0:
 219               	.global	MAC_init
 221               	MAC_init:
   1:mac.c         **** #include "mac.h"
   2:mac.c         **** #include "timer_queue.h"
   3:mac.c         **** #include "project.h"
   4:mac.c         **** #include "router.h"
   5:mac.c         **** 
   6:mac.c         **** 
   7:mac.c         **** 
   8:mac.c         **** //uint8_t  test_variable;
   9:mac.c         **** extern systimer_queue_pointer head_of_systimer_queue;
  10:mac.c         **** 
  11:mac.c         **** 
  12:mac.c         **** //Ò»Ð©Æµ·±Ê¹ÓÃµÄÈ«¾Ö±äÁ¿
  13:mac.c         **** MAC_PIB  mac_pib_data;
  14:mac.c         **** phy_pib  ppib;
  15:mac.c         **** 
  16:mac.c         **** uint8_t  scan_channel_index;
  17:mac.c         **** uint32_t  scan_channel;
  18:mac.c         **** uint16_t  scan_time_period;  
  19:mac.c         **** 
  20:mac.c         **** BYTE     mac_working_state;
  21:mac.c         **** MAC_FRAME_FORMAT   mac_tx_current_frame;
  22:mac.c         **** MAC_FRAME_FORMAT    mac_rx_current_frame;
  23:mac.c         **** BEACON_FRAME_FORMAT  mac_tx_beacon;
  24:mac.c         **** 
  25:mac.c         **** MAC_STATE_TYPE     mac_current_state;
  26:mac.c         **** MAC_STATE_TYPE  mac_current_state_saved;
  27:mac.c         **** bool               Is_mac_associated_successful;
  28:mac.c         **** //PHY_CHANEL_STATE  phy_channel_state;
  29:mac.c         **** 
  30:mac.c         **** 
  31:mac.c         **** //¶¨Ê±Æ÷¶ÓÁÐ£¬Êµ¼ÊÉÏÒ»°ãÖ»ÓÐÒ»¸ö¶ÓÁÐÔªËØ£¬²»¿ÉÄÜÍ¬Ê±ÓÐ¶à¸öÈÎÎñ¡£
  32:mac.c         **** Timer_Queue_pointer  head_of_timer_queue;
  33:mac.c         **** Timer_Queue_pointer  current_timer_elem;	
  34:mac.c         **** 
  35:mac.c         **** //·¢ËÍ¶ÓÁÐ£¬ÀïÃæ´æ·Å×Å´ý·¢ËÍµÄ°ü
  36:mac.c         **** TX_BUFFER  *     head_of_tx_buffer;
  37:mac.c         **** TX_BUFFER  *     tail_of_tx_buffer;
  38:mac.c         **** parameter_tx_task  Parameter_list;
  39:mac.c         **** 
  40:mac.c         **** //½ÓÊÕ¶ÓÁÐ£¬ÀïÃæ´æ·Å×Å½ÓÊÕµÄ°ü
  41:mac.c         **** RX_BUFFER  *     head_of_rx_buffer;
  42:mac.c         **** RX_BUFFER  *     tail_of_rx_buffer;
  43:mac.c         **** 
  44:mac.c         **** //pending¶ÓÁÐ£¬ÀïÃæ´æ·Å×Å¼ä½ÓÍ¨ÐÅµÄ°ü
  45:mac.c         **** INDIRECT_TX_PENDING_QUEUE  * head_of_indirect_pending_buffer;
  46:mac.c         **** INDIRECT_TX_PENDING_QUEUE  * tail_of_indirect_pending_buffer;
  47:mac.c         **** uint8_t                                         current_pending_num;
  48:mac.c         **** 
  49:mac.c         **** bool TRACKBEACON;
  50:mac.c         **** bool IS_MAC_SYNING;
  51:mac.c         **** 
  52:mac.c         **** MLME_SCAN_CONFIRM  scan_result_info;
  53:mac.c         **** MCPS_DATA_INDICATION mcps_data_indication_info;
  54:mac.c         **** MLME_BEACON_NOTIFY_INDICATION  beacon_info;
  55:mac.c         **** MLME_ASSOCIATE_INDICATION   mlme_associate_indication_info;
  56:mac.c         **** 
  57:mac.c         **** SHORT_ADDR  default_short_addr;
  58:mac.c         **** SHORT_ADDR  no_short_addr;
  59:mac.c         **** LONG_ADDR    default_long_addr;
  60:mac.c         **** NODE_INFO      default_node;
  61:mac.c         **** 
  62:mac.c         **** //timing variable used to synchronize
  63:mac.c         **** uint32_t   MAC_SUPERFRAME_PERIOD;
  64:mac.c         **** uint32_t   last_beacon_tx_timestamp;
  65:mac.c         **** uint32_t   last_beacon_rx_timestamp;
  66:mac.c         **** uint32_t   MAC_CAP_PERIOD;
  67:mac.c         **** //Ô¤ÆÚµÄCAP½áÊøtickºÍ³¬Ö¡½áÊøtick
  68:mac.c         **** uint32_t   MAC_OBJECT_CAP_START_TICKS;
  69:mac.c         **** uint32_t   MAC_OBJECT_CAP_END_TICKS;
  70:mac.c         **** uint32_t   MAC_OBJECT_SUPERFRAME_TICKS;
  71:mac.c         **** uint32_t   MAC_CURRENT_TICKS;
  72:mac.c         **** 
  73:mac.c         **** bool         Is_received_beacon;
  74:mac.c         **** uint8_t     loss_sync_number;
  75:mac.c         **** 
  76:mac.c         **** bool         IS_NETWORK_FORMED;
  77:mac.c         **** 
  78:mac.c         **** 
  79:mac.c         **** //MAC³õÊ¼»¯º¯Êý£¬Ö÷ÒªÊÇ¶ÔÒ»Ð©Êý¾Ý½á¹¹µÄ³õÊ¼»¯£¬802.15.4ÖÐÃ»ÓÐ¶¨ÒåÏà¹Øº¯Êý
  80:mac.c         **** void MAC_init(void)
  81:mac.c         **** {
 223               	.LM1:
 224               	/* prologue: frame size=0 */
 225               	/* prologue end (size=0) */
  82:mac.c         **** 	//¶¨Ê±Æ÷¶ÓÁÐµÄ³õÊ¼»¯¡£µ÷ÓÃtimerqueue_initº¯Êý
  83:mac.c         **** 	uint8_t  index;
  84:mac.c         **** 	head_of_timer_queue=NULL;
 227               	.LM2:
 228 0000 1092 0000 		sts (head_of_timer_queue)+1,__zero_reg__
 229 0004 1092 0000 		sts head_of_timer_queue,__zero_reg__
  85:mac.c         **** 	//TRACKBEACONÖÃÎª¼Ù¡£
  86:mac.c         **** 
  87:mac.c         **** 	mac_current_state=MAC_STATE_UNSTARTED;
 231               	.LM3:
 232 0008 1092 0000 		sts mac_current_state,__zero_reg__
  88:mac.c         ****        phy_channel_state=PHY_IDLE;
 234               	.LM4:
 235 000c 1092 0000 		sts phy_channel_state,__zero_reg__
  89:mac.c         **** 	//·¢ËÍ¶ÓÁÐÎª¿Õ
  90:mac.c         **** 	head_of_tx_buffer=NULL;
 237               	.LM5:
 238 0010 1092 0000 		sts (head_of_tx_buffer)+1,__zero_reg__
 239 0014 1092 0000 		sts head_of_tx_buffer,__zero_reg__
  91:mac.c         **** 	tail_of_tx_buffer=NULL;
 241               	.LM6:
 242 0018 1092 0000 		sts (tail_of_tx_buffer)+1,__zero_reg__
 243 001c 1092 0000 		sts tail_of_tx_buffer,__zero_reg__
  92:mac.c         **** 	Parameter_list.top=0;
 245               	.LM7:
 246 0020 1092 0000 		sts Parameter_list+10,__zero_reg__
  93:mac.c         **** 	Parameter_list.tail=0;
 248               	.LM8:
 249 0024 1092 0000 		sts Parameter_list+11,__zero_reg__
  94:mac.c         **** 	//½ÓÊÕ¶ÓÁÐÎª¿Õ
  95:mac.c         **** 	head_of_rx_buffer=NULL;
 251               	.LM9:
 252 0028 1092 0000 		sts (head_of_rx_buffer)+1,__zero_reg__
 253 002c 1092 0000 		sts head_of_rx_buffer,__zero_reg__
  96:mac.c         **** 	tail_of_rx_buffer=NULL;
 255               	.LM10:
 256 0030 1092 0000 		sts (tail_of_rx_buffer)+1,__zero_reg__
 257 0034 1092 0000 		sts tail_of_rx_buffer,__zero_reg__
  97:mac.c         ****        //pending¶ÓÁÐÎª¿Õ
  98:mac.c         **** 	head_of_indirect_pending_buffer=NULL;
 259               	.LM11:
 260 0038 1092 0000 		sts (head_of_indirect_pending_buffer)+1,__zero_reg__
 261 003c 1092 0000 		sts head_of_indirect_pending_buffer,__zero_reg__
  99:mac.c         **** 	tail_of_indirect_pending_buffer=NULL;
 263               	.LM12:
 264 0040 1092 0000 		sts (tail_of_indirect_pending_buffer)+1,__zero_reg__
 265 0044 1092 0000 		sts tail_of_indirect_pending_buffer,__zero_reg__
 100:mac.c         **** 	current_pending_num=0;
 267               	.LM13:
 268 0048 1092 0000 		sts current_pending_num,__zero_reg__
 101:mac.c         ****        //mac_current_state=MAC_STATE_UNSTARTED;
 102:mac.c         **** 	IS_MAC_SYNING=FALSE;
 270               	.LM14:
 271 004c 1092 0000 		sts IS_MAC_SYNING,__zero_reg__
 103:mac.c         ****        default_short_addr.Val=0xffff;
 273               	.LM15:
 274 0050 8FEF      		ldi r24,lo8(-1)
 275 0052 9FEF      		ldi r25,hi8(-1)
 276 0054 9093 0000 		sts (default_short_addr)+1,r25
 277 0058 8093 0000 		sts default_short_addr,r24
 104:mac.c         **** 	default_long_addr.longaddr=0;
 279               	.LM16:
 280 005c 1092 0000 		sts default_long_addr,__zero_reg__
 281 0060 1092 0000 		sts default_long_addr+1,__zero_reg__
 282 0064 1092 0000 		sts default_long_addr+2,__zero_reg__
 283 0068 1092 0000 		sts default_long_addr+3,__zero_reg__
 284 006c 1092 0000 		sts default_long_addr+4,__zero_reg__
 285 0070 1092 0000 		sts default_long_addr+5,__zero_reg__
 286 0074 1092 0000 		sts default_long_addr+6,__zero_reg__
 287 0078 1092 0000 		sts default_long_addr+7,__zero_reg__
 105:mac.c         **** 	no_short_addr.Val=0xfffe;
 289               	.LM17:
 290 007c 8EEF      		ldi r24,lo8(-2)
 291 007e 9FEF      		ldi r25,hi8(-2)
 292 0080 9093 0000 		sts (no_short_addr)+1,r25
 293 0084 8093 0000 		sts no_short_addr,r24
 106:mac.c         **** 	default_node.addrMode=0x00;
 295               	.LM18:
 296 0088 1092 0000 		sts default_node,__zero_reg__
 107:mac.c         **** 	head_of_systimer_queue=NULL;
 298               	.LM19:
 299 008c 1092 0000 		sts (head_of_systimer_queue)+1,__zero_reg__
 300 0090 1092 0000 		sts head_of_systimer_queue,__zero_reg__
 108:mac.c         ****        //---------------------------------------------------------------
 109:mac.c         ****        //------------Ðèµ÷ÓÃÎïÀí²ãº¯ÊýµÃµ½¸ÃµØÖ·----------
 110:mac.c         ****        //-------------------------´ýÌí¼Ó----------------------------
 111:mac.c         **** 	mac_pib_data.macExtAddress.longaddr=0;
 302               	.LM20:
 303 0094 1092 0000 		sts mac_pib_data+34,__zero_reg__
 304 0098 1092 0000 		sts mac_pib_data+35,__zero_reg__
 305 009c 1092 0000 		sts mac_pib_data+36,__zero_reg__
 306 00a0 1092 0000 		sts mac_pib_data+37,__zero_reg__
 307 00a4 1092 0000 		sts mac_pib_data+38,__zero_reg__
 308 00a8 1092 0000 		sts mac_pib_data+39,__zero_reg__
 309 00ac 1092 0000 		sts mac_pib_data+40,__zero_reg__
 310 00b0 1092 0000 		sts mac_pib_data+41,__zero_reg__
 112:mac.c         ****        scan_result_info.resultListSize=0;
 312               	.LM21:
 313 00b4 1092 0000 		sts scan_result_info+6,__zero_reg__
 314 00b8 E0E0      		ldi r30,lo8(scan_result_info+7)
 315 00ba F0E0      		ldi r31,hi8(scan_result_info+7)
 316 00bc 8FE0      		ldi r24,lo8(15)
 317               	.L5:
 113:mac.c         ****        for(index=0;index<MAC_MAX_ED_MEASUREMENT;index++)
 114:mac.c         **** 	   	scan_result_info.pEnergyDetectList[index]=0;
 319               	.LM22:
 320 00be 1192      		st Z+,__zero_reg__
 322               	.LM23:
 323 00c0 8150      		subi r24,lo8(-(-1))
 324 00c2 87FF      		sbrs r24,7
 325 00c4 FCCF      		rjmp .L5
 115:mac.c         **** 
 116:mac.c         **** 	loss_sync_number=0;
 327               	.LM24:
 328 00c6 1092 0000 		sts loss_sync_number,__zero_reg__
 329               	/* epilogue: frame size=0 */
 330 00ca 0895      		ret
 331               	/* epilogue end (size=1) */
 332               	/* function MAC_init size 102 (101) */
 337               	.Lscope0:
 338               		.data
 339               	.LC0:
 340 0000 0A6D 6163 		.string	"\nmacExtaddr is %02x\n"
 340      4578 7461 
 340      6464 7220 
 340      6973 2025 
 340      3032 780A 
 341               		.text
 344               	.global	mlmeResetRequest
 346               	mlmeResetRequest:
 117:mac.c         **** 	//for(index=0;index<MAC_MAX_PAN_DESCRIPTORS;index++)
 118:mac.c         **** 	//	scan_result_info.pPANDescriptorList
 119:mac.c         **** }
 120:mac.c         **** 
 121:mac.c         **** //**************************// 
 122:mac.c         **** MAC_ENUM mlmeResetRequest(bool setDefaultPIB)
 123:mac.c         **** {
 348               	.LM25:
 349               	/* prologue: frame size=16 */
 350 00cc FF92      		push r15
 351 00ce 0F93      		push r16
 352 00d0 1F93      		push r17
 353 00d2 CF93      		push r28
 354 00d4 DF93      		push r29
 355 00d6 CDB7      		in r28,__SP_L__
 356 00d8 DEB7      		in r29,__SP_H__
 357 00da 6097      		sbiw r28,16
 358 00dc 0FB6      		in __tmp_reg__,__SREG__
 359 00de F894      		cli
 360 00e0 DEBF      		out __SP_H__,r29
 361 00e2 0FBE      		out __SREG__,__tmp_reg__
 362 00e4 CDBF      		out __SP_L__,r28
 363               	/* prologue end (size=13) */
 124:mac.c         ****    //·¢ËÍPLME_SET_TRX_STATE.requestÔ­Óï¡£ÖÃÉäÆµÊÕ·¢Æ÷ÎªTRX_OFF
 125:mac.c         ****    
 126:mac.c         ****    //uint8_t state;
 127:mac.c         ****    uint8_t return_state;
 128:mac.c         ****    
 129:mac.c         ****    //È»ºóÔÚresetMAC²ãÀïÃæµÄPIBµÄËùÓÐ½á¹¹Ìå³ÉÔ±ÔªËØÎª³õÊ¼Öµ
 130:mac.c         ****    mac_pib_data.macAckWaitDuration=54;
 365               	.LM26:
 366 00e6 86E3      		ldi r24,lo8(54)
 367 00e8 8093 0000 		sts mac_pib_data,r24
 131:mac.c         ****    //mac_pib_data.macAckWaitDuration=4;
 132:mac.c         ****    if(IS_COORDINATOR||IS_FFD)
 133:mac.c         ****        mac_pib_data.macAssociationPermit=TRUE;
 134:mac.c         ****    else
 135:mac.c         ****        mac_pib_data.macAssociationPermit=FALSE;
 369               	.LM27:
 370 00ec 1092 0000 		sts mac_pib_data+1,__zero_reg__
 136:mac.c         ****    //================================
 137:mac.c         ****    uint8_t buffer_addr[8];
 138:mac.c         ****    LONG_ADDR long_ieee_addr;
 139:mac.c         ****    long_ieee_addr.longaddr=MY_IEEE_ADDR;
 372               	.LM28:
 373 00f0 88E0      		ldi r24,lo8(8)
 374 00f2 8987      		std Y+9,r24
 375 00f4 1A86      		std Y+10,__zero_reg__
 376 00f6 1B86      		std Y+11,__zero_reg__
 377 00f8 1C86      		std Y+12,__zero_reg__
 378 00fa 1D86      		std Y+13,__zero_reg__
 379 00fc 1E86      		std Y+14,__zero_reg__
 380 00fe 8FEF      		ldi r24,lo8(-1)
 381 0100 8F87      		std Y+15,r24
 382 0102 888B      		std Y+16,r24
 383 0104 FE01      		movw r30,r28
 384 0106 3196      		adiw r30,1
 385 0108 97E0      		ldi r25,lo8(7)
 386               	.L14:
 387               	.LBB2:
 140:mac.c         ****    for(uint8_t i=0;i<8;i++)
 141:mac.c         ****    	{
 142:mac.c         ****    	buffer_addr[i]=long_ieee_addr.v[i];
 389               	.LM29:
 390 010a 8085      		ldd r24,Z+8
 391 010c 8193      		st Z+,r24
 393               	.LM30:
 394 010e 9150      		subi r25,lo8(-(-1))
 395 0110 97FF      		sbrs r25,7
 396 0112 FBCF      		rjmp .L14
 397               	.LBE2:
 143:mac.c         **** 	//printf("\n--ieee addr[%d] is %02x--\n",i,buffer_addr[i]);
 144:mac.c         ****    	}
 145:mac.c         ****    cc2420_set_ieee(buffer_addr);
 399               	.LM31:
 400 0114 CE01      		movw r24,r28
 401 0116 0196      		adiw r24,1
 402 0118 0E94 0000 		call cc2420_set_ieee
 146:mac.c         ****    cc2420_get_ieee(mac_pib_data.macExtAddress.v);
 404               	.LM32:
 405 011c 80E0      		ldi r24,lo8(mac_pib_data+34)
 406 011e 90E0      		ldi r25,hi8(mac_pib_data+34)
 407 0120 0E94 0000 		call cc2420_get_ieee
 408 0124 00E0      		ldi r16,lo8(mac_pib_data+34)
 409 0126 10E0      		ldi r17,hi8(mac_pib_data+34)
 410 0128 97E0      		ldi r25,lo8(7)
 411 012a F92E      		mov r15,r25
 412               	.L18:
 413               	.LBB3:
 147:mac.c         ****    for(uint8_t i=0;i<8;i++)
 148:mac.c         ****     printf("\nmacExtaddr is %02x\n",mac_pib_data.macExtAddress.v[i]);
 415               	.LM33:
 416 012c F801      		movw r30,r16
 417 012e 8191      		ld r24,Z+
 418 0130 8F01      		movw r16,r30
 419 0132 9927      		clr r25
 420 0134 9F93      		push r25
 421 0136 8F93      		push r24
 422 0138 80E0      		ldi r24,lo8(.LC0)
 423 013a 90E0      		ldi r25,hi8(.LC0)
 424 013c 9F93      		push r25
 425 013e 8F93      		push r24
 426 0140 0E94 0000 		call printf
 428               	.LM34:
 429 0144 0F90      		pop __tmp_reg__
 430 0146 0F90      		pop __tmp_reg__
 431 0148 0F90      		pop __tmp_reg__
 432 014a 0F90      		pop __tmp_reg__
 433 014c FA94      		dec r15
 434 014e F7FE      		sbrs r15,7
 435 0150 EDCF      		rjmp .L18
 436 0152 88E0      		ldi r24,lo8(8)
 437 0154 F82E      		mov r15,r24
 438               	.LBE3:
 149:mac.c         ****    IS_NETWORK_FORMED=FALSE;
 440               	.LM35:
 441 0156 1092 0000 		sts IS_NETWORK_FORMED,__zero_reg__
 150:mac.c         ****    mac_pib_data.macAutoRequest=FALSE;
 443               	.LM36:
 444 015a 1092 0000 		sts mac_pib_data+2,__zero_reg__
 151:mac.c         ****    mac_pib_data.macBattLifeExt=FALSE;
 446               	.LM37:
 447 015e 1092 0000 		sts mac_pib_data+3,__zero_reg__
 152:mac.c         ****    mac_pib_data.macBattLifeExtPeriods=6;
 449               	.LM38:
 450 0162 86E0      		ldi r24,lo8(6)
 451 0164 8093 0000 		sts mac_pib_data+4,r24
 153:mac.c         ****    mac_pib_data.pMacBeaconPayload=NULL;
 453               	.LM39:
 454 0168 1092 0000 		sts (mac_pib_data+5)+1,__zero_reg__
 455 016c 1092 0000 		sts mac_pib_data+5,__zero_reg__
 154:mac.c         ****    mac_pib_data.macBeaconPayloadLength=0;
 457               	.LM40:
 458 0170 1092 0000 		sts mac_pib_data+7,__zero_reg__
 155:mac.c         ****    mac_pib_data.macBeaconOrder=6;
 460               	.LM41:
 461 0174 8093 0000 		sts mac_pib_data+8,r24
 156:mac.c         ****    mac_pib_data.macBeaconTxTime=0x00000000;
 463               	.LM42:
 464 0178 1092 0000 		sts mac_pib_data+9,__zero_reg__
 465 017c 1092 0000 		sts (mac_pib_data+9)+1,__zero_reg__
 466 0180 1092 0000 		sts (mac_pib_data+9)+2,__zero_reg__
 467 0184 1092 0000 		sts (mac_pib_data+9)+3,__zero_reg__
 157:mac.c         ****    //mac_pib_data.macBSN=0x00;  random value between 0x00-0xff;
 158:mac.c         ****    mac_pib_data.macCoordExtendedAddress=default_long_addr;
 469               	.LM43:
 470 0188 A0E0      		ldi r26,lo8(default_long_addr)
 471 018a B0E0      		ldi r27,hi8(default_long_addr)
 472 018c E0E0      		ldi r30,lo8(mac_pib_data+14)
 473 018e F0E0      		ldi r31,hi8(mac_pib_data+14)
 474 0190 8F2D      		mov r24,r15
 475 0192 0D90      		ld __tmp_reg__,X+
 476 0194 0192      		st Z+,__tmp_reg__
 477 0196 8A95      		dec r24
 478 0198 E1F7      		brne .-8
 159:mac.c         ****    mac_pib_data.macCoordShortAddress=default_short_addr;
 480               	.LM44:
 481 019a 2091 0000 		lds r18,default_short_addr
 482 019e 3091 0000 		lds r19,(default_short_addr)+1
 483 01a2 3093 0000 		sts (mac_pib_data+22)+1,r19
 484 01a6 2093 0000 		sts mac_pib_data+22,r18
 160:mac.c         ****    //mac_pib_data.macDSN=0x00;  random value between 0x00-0xff;
 161:mac.c         ****    mac_pib_data.macGTSPermit=FALSE;
 486               	.LM45:
 487 01aa 1092 0000 		sts mac_pib_data+25,__zero_reg__
 162:mac.c         ****    mac_pib_data.macMaxCsmaBackoffs=2;
 489               	.LM46:
 490 01ae 82E0      		ldi r24,lo8(2)
 491 01b0 8093 0000 		sts mac_pib_data+26,r24
 163:mac.c         ****    mac_pib_data.macMinBE=3;
 493               	.LM47:
 494 01b4 83E0      		ldi r24,lo8(3)
 495 01b6 8093 0000 		sts mac_pib_data+27,r24
 164:mac.c         ****    mac_pib_data.macPANId=default_short_addr;
 165:mac.c         ****    mac_pib_data.macPromiscuousMode=FALSE;
 497               	.LM48:
 498 01ba 1092 0000 		sts mac_pib_data+30,__zero_reg__
 166:mac.c         ****    //===============ÐÞ¸Ä
 167:mac.c         ****    mac_pib_data.macRxOnWhenIdle=TRUE;
 500               	.LM49:
 501 01be 81E0      		ldi r24,lo8(1)
 502 01c0 8093 0000 		sts mac_pib_data+31,r24
 168:mac.c         ****    mac_pib_data.macShortAddress=default_short_addr;
 169:mac.c         ****    mac_pib_data.macSuperframeOrder=5;
 504               	.LM50:
 505 01c4 85E0      		ldi r24,lo8(5)
 506 01c6 8093 0000 		sts mac_pib_data+42,r24
 170:mac.c         ****    mac_pib_data.macTransactionPersistenceTime=0x0005;
 508               	.LM51:
 509 01ca 85E0      		ldi r24,lo8(5)
 510 01cc 90E0      		ldi r25,hi8(5)
 511 01ce 9093 0000 		sts (mac_pib_data+43)+1,r25
 512 01d2 8093 0000 		sts mac_pib_data+43,r24
 171:mac.c         ****    //cc2420_get_ieee(mac_pib_data.macExtAddress.v);
 172:mac.c         ****    if(IS_COORDINATOR)
 173:mac.c         ****    	{
 174:mac.c         ****    	     mac_pib_data.macCoordExtendedAddress=mac_pib_data.macExtAddress;
 175:mac.c         **** 	     mac_pib_data.macCoordShortAddress.Val=COOR_SHORT_ADDRESS;
 176:mac.c         **** 	     mac_pib_data.macShortAddress.Val=COOR_SHORT_ADDRESS;
 177:mac.c         **** 	     mac_pib_data.macPANId.Val=COOR_PAN_ID;
 178:mac.c         ****    	}
 179:mac.c         ****    else 
 180:mac.c         ****    	{
 181:mac.c         ****    	     mac_pib_data.macPANId=default_short_addr;
 514               	.LM52:
 515 01d6 3093 0000 		sts (mac_pib_data+28)+1,r19
 516 01da 2093 0000 		sts mac_pib_data+28,r18
 182:mac.c         ****             mac_pib_data.macShortAddress=default_short_addr;
 518               	.LM53:
 519 01de 3093 0000 		sts (mac_pib_data+32)+1,r19
 520 01e2 2093 0000 		sts mac_pib_data+32,r18
 183:mac.c         ****    	}
 184:mac.c         ****    //mac_pib_data.
 185:mac.c         ****    return_state=PLME_SET_TRX_STATE_request(TRX_OFF);
 522               	.LM54:
 523 01e6 8F2D      		mov r24,r15
 524 01e8 0E94 0000 		call PLME_SET_TRX_STATE_request
 186:mac.c         ****    if(return_state==SUCCESS)
 526               	.LM55:
 527 01ec 8823      		tst r24
 528 01ee 19F4      		brne .L21
 187:mac.c         ****    	return  SUCCESS;
 530               	.LM56:
 531 01f0 80E0      		ldi r24,lo8(0)
 532 01f2 90E0      		ldi r25,hi8(0)
 533 01f4 02C0      		rjmp .L8
 534               	.L21:
 188:mac.c         ****    else return DISABLE_TRX_FAILURE;
 536               	.LM57:
 537 01f6 83EE      		ldi r24,lo8(227)
 538 01f8 90E0      		ldi r25,hi8(227)
 539               	.L8:
 540               	/* epilogue: frame size=16 */
 541 01fa 6096      		adiw r28,16
 542 01fc 0FB6      		in __tmp_reg__,__SREG__
 543 01fe F894      		cli
 544 0200 DEBF      		out __SP_H__,r29
 545 0202 0FBE      		out __SREG__,__tmp_reg__
 546 0204 CDBF      		out __SP_L__,r28
 547 0206 DF91      		pop r29
 548 0208 CF91      		pop r28
 549 020a 1F91      		pop r17
 550 020c 0F91      		pop r16
 551 020e FF90      		pop r15
 552 0210 0895      		ret
 553               	/* epilogue end (size=12) */
 554               	/* function mlmeResetRequest size 163 (138) */
 566               	.Lscope1:
 570               	.global	mlmeSetRequest
 572               	mlmeSetRequest:
 189:mac.c         ****    //ÔÚÊÕµ½PLME_SET_TRX_STATE.confirm²¢ÇÒ½á¹ûÎª³É¹¦ºó£¬½«·¢ËÍMLME_RESET.confirmÔ­Óï²¢ÖÃÎª³É¹¦×´Ì¬
 190:mac.c         ****    //·ñÔòÖÃÎªDISABLE_TRX_FAILURE×´Ì¬£¬ÊµÏÖÉÏconfirmÔ­ÓïÊÇÍ¨¹ý·µ»ØÖµ·µ»ØµÄ¡£
 191:mac.c         ****    
 192:mac.c         **** } 
 193:mac.c         **** 
 194:mac.c         **** //**************************//
 195:mac.c         **** MAC_ENUM mlmeSetRequest(MAC_PIB_ATTR pibAttribute, void *pPibAttributeValue)
 196:mac.c         **** {
 574               	.LM58:
 575               	/* prologue: frame size=0 */
 576               	/* prologue end (size=0) */
 577               	/* epilogue: frame size=0 */
 578 0212 0895      		ret
 579               	/* epilogue end (size=1) */
 580               	/* function mlmeSetRequest size 1 (0) */
 582               	.Lscope2:
 585               	.global	mlmeScanConfirm
 587               	mlmeScanConfirm:
 197:mac.c         **** 	 //¸ù¾Ýº¯Êý´«µÝ¹ýÀ´µÄ²ÎÊýÐÞ¸ÄPIB½á¹¹ÖÐµÄ³ÉÔ±£¬²¢·µ»ØÏàÓ¦µÄ³É¹¦Ê§°Ü½á¹û(¼´confirmÔ­Óï)
 198:mac.c         **** }
 199:mac.c         ****  
 200:mac.c         **** //**************************//
 201:mac.c         **** //ÓÐ±ØÒª¶¨Òåmlmescanconfirmº¯Êý,scan request 
 202:mac.c         **** //×´Ì¬ÓÉscan request·µ»Ø£¬ÆäËûµÄ½á¹ûÓÉÈ«¾Ö½á¹¹MLME_SCAN_CONFIRM·µ»Ø; 
 203:mac.c         **** MAC_ENUM mlmeScanRequest(BYTE scanType, DWORD scanChannels, UINT8 scanDuration)
 204:mac.c         **** {
 205:mac.c         **** 
 206:mac.c         **** 	uint16_t  scantime_on_channel;
 207:mac.c         **** 	uint32_t  object_time;
 208:mac.c         **** 	uint8_t    index;
 209:mac.c         **** 	int8_t    temp_max_energy;
 210:mac.c         **** 	ED_STATE  temp_return_ED;
 211:mac.c         **** 	SET_STATE  temp_return_SET;
 212:mac.c         **** 	scantime_on_channel=((((uint16_t)aBaseSuperframeDuration)<<scanDuration)+((uint16_t)aBaseSuperfram
 213:mac.c         **** 	//printf("=====scan time is %08x",scantime_on_channel);
 214:mac.c         **** 	scan_result_info.resultListSize=0;
 215:mac.c         **** 	switch(scanType)
 216:mac.c         **** 		{
 217:mac.c         **** 		    case ED_SCAN:
 218:mac.c         **** 			   //printf("\n---START TO DO THE ENERGY SCAN----\n");	
 219:mac.c         **** 	                   mac_current_state=MAC_STATE_ENERGY_SCAN;
 220:mac.c         **** 			      phy_channel_state=INACTIVE_PERIOD;
 221:mac.c         **** 	                   for(index=0;index<16;index++)
 222:mac.c         **** 	                   {
 223:mac.c         **** 	                       if(((1<<index)&(scanChannels))!=0)
 224:mac.c         **** 	                       {
 225:mac.c         **** 	                           object_time=systime32()+(((uint32_t)scantime_on_channel)<<1);
 226:mac.c         **** 				    //printf("the object time is %08lx",object_time);			   
 227:mac.c         **** 				      //if(object_time>=0x3fffffff)
 228:mac.c         **** 				      //	  	object_time=object_time-0x3fffffff;
 229:mac.c         **** 				      temp_max_energy=-128;
 230:mac.c         **** 				      temp_return_SET=PLME_SET_request(phyCurrentChanel_id, index);	
 231:mac.c         **** 				      PLME_SET_TRX_STATE_request(RX_ON);  
 232:mac.c         **** 				      if(temp_return_SET.state==PHY_SUCCESS)
 233:mac.c         **** 				      	{
 234:mac.c         **** 			                  while(systime32()!=object_time)
 235:mac.c         **** 	                   	           {    
 236:mac.c         **** 	                   	               temp_return_ED=PLME_ED_request();
 237:mac.c         **** 						 if((temp_return_ED.energylevel>=temp_max_energy)&&(temp_return_ED.state=PHY_SUCCESS))
 238:mac.c         **** 						 	temp_max_energy=temp_return_ED.energylevel;
 239:mac.c         **** 	                   	           }
 240:mac.c         **** 					    scan_result_info.pEnergyDetectList[scan_result_info.resultListSize++]=temp_max_energy;
 241:mac.c         **** 				      	}					  
 242:mac.c         **** 	                       }
 243:mac.c         **** 				  if(scan_result_info.resultListSize>=MAC_MAX_ED_MEASUREMENT)
 244:mac.c         **** 				  	break;
 245:mac.c         **** 	                   }
 246:mac.c         **** 			     mac_current_state=MAC_STATE_ENERGY_SCAN_FINISHED;
 247:mac.c         **** 			     phy_channel_state=INACTIVE_PERIOD;
 248:mac.c         **** 			     PLME_SET_TRX_STATE_request(TRX_OFF);
 249:mac.c         **** 	                   break;         
 250:mac.c         **** 	           case ACTIVE_PASSIVE_SCAN:
 251:mac.c         ****                            scan_channel_index=0;
 252:mac.c         ****                            scan_channel=scanChannels;
 253:mac.c         ****                            scan_time_period=scantime_on_channel;   
 254:mac.c         **** 	                    cc2420_bcn_accept();
 255:mac.c         **** 	                    cc2420_setshortaddress(default_short_addr.Val);
 256:mac.c         ****                            cc2420_setpanid(default_short_addr.Val);
 257:mac.c         **** 	                    mac_current_state=MAC_STATE_ACTIVE_PASSIVE_SCAN;
 258:mac.c         ****                           
 259:mac.c         **** 			    while((scanChannels&((uint32_t)1<<scan_channel_index))==0)
 260:mac.c         **** 			    	{
 261:mac.c         **** 					scan_channel_index++;
 262:mac.c         **** 					if(scan_channel_index==16)
 263:mac.c         **** 						return;
 264:mac.c         **** 			    	}	
 265:mac.c         **** 			    	
 266:mac.c         **** 			    PLME_SET_request(phyCurrentChanel_id, scan_channel_index++); 
 267:mac.c         **** 			    head_of_timer_queue=timer3queue_start(head_of_timer_queue, TIMER_ONE_SHOT, 0, WAIT_SCAN, sca
 268:mac.c         **** 			    PLME_SET_TRX_STATE_request(RX_ON);			  
 269:mac.c         **** 			     phy_channel_state=WAITING_FOR_BEACON;		
 270:mac.c         **** 			   //printf("\nset the %d channel & waitting for beacon\n",scan_channel_index-1);	 
 271:mac.c         **** 	                   break;
 272:mac.c         **** 	          case ORPHAN_SCAN:
 273:mac.c         **** 	//ÈôÎªorphan SCAN£¬
 274:mac.c         **** 	//-----------------------------------***¿ÉÒÔ¿¼ÂÇ°ÑÏÂÃæµÄÊÂÇé×ö³ÉÒ»¸öº¯Êý(»òÈÎÎñ),¶¨Ê±ÖÐ¶Ï·þÎñ³ÌÐòÒ
 275:mac.c         **** 	//º¯ÊýÃûÎª      void orphan_ scan_done(void)
 276:mac.c         **** 	//Ê×ÏÈ¶ÔÓÚµÚÒ»¸öÐÅµÀ£¬µ÷ÓÃPLME_SET_requestÔ­ÓïÉèÖÃÎïÀíÐÅµÀ¡£È»ºó²ÉÓÃCSMA¿ªÊ¼·¢ËÍorphan notificatio
 277:mac.c         **** 	//È»ºóÆô¶¯¶¨Ê±Æ÷¶ÓÁÐ·þÎñ£¬¶¨Ê±Ô­ÒòÎªWAIT_FOR_RESPONSE£¬ÆäÖÐ¶¨Ê±³¤¶ÈÎªaResponseWaitTime¸ösymbol£¬Í¬
 278:mac.c         **** 	//ÍÆ³ö¸ÃÔ­Óï£¬ÆäËûµÄÐÅµÀµÄscanÈÎÎñÓÉ¶¨Ê±Æ÷µÄÖÐ¶Ï·þÎñ³ÌÐòÍê³É
 279:mac.c         **** 	//NOTE1:ÆäÖÐ¸ÃscanµÄconfirmÔ­Óï¿ÉÒÔÓÉmac²ãµÄÖ¡½ÓÊÕ½ø³Ì·¢³ö»òÖÐ¶Ï·þÎñ³ÌÐò·¢³ö¡£
 280:mac.c         **** 	//NOTE2£ºorphan scan²»Í¬ÓÚÇ°ÃæÈýÖÖscan£¬ËüÖ»ÒªÊÕµ½Ò»¸örealgnmentÃüÁîÖ¡ºóÁ¢¼´Í£Ö¹scan¡£
 281:mac.c         ****                            mac_current_state=MAC_STATE_ORPHAN_SCAN;
 282:mac.c         **** 	                    //=====================================================
 283:mac.c         **** 	                    //=========µ÷ÓÃÎïÀí²ãº¯ÊýÉèÖÃÎïÀíÐÅµÀ============
 284:mac.c         **** 	                   orphan_notification_frame_send();
 285:mac.c         **** 			     
 286:mac.c         **** 			     break;
 287:mac.c         **** 	     }
 288:mac.c         **** }
 289:mac.c         **** void mlmeScanConfirm(MLME_SCAN_CONFIRM  scan_result_info)
 290:mac.c         **** {
 589               	.LM59:
 590               	/* prologue: frame size=0 */
 591 0214 CF93      		push r28
 592 0216 DF93      		push r29
 593 0218 CDB7      		in r28,__SP_L__
 594 021a DEB7      		in r29,__SP_H__
 595               	/* prologue end (size=4) */
 291:mac.c         ****        //¸ù¾Ýscan_result_infoÀ´ÐÞ¸Ä¶ÔÓ¦µÄmac²ãºÍPHY²ãµÄpibÐÅÏ¢
 292:mac.c         ****        //±¾À´ÓÐ¸ö¸´ÔÓµÄÑ¡ÔñËã·¨£¬ÕâÀï¼òµ¥´¦ÀíµÚÒ»¸ö
 293:mac.c         ****      //printf("\n-------it is in scan confirm---------\n");
 294:mac.c         **** 	if((scan_result_info.status==SUCCESS)&&(scan_result_info.scanType==ORPHAN_SCAN))
 597               	.LM60:
 598 021c 8D81      		ldd r24,Y+5
 599 021e 8823      		tst r24
 600 0220 09F0      		breq .+2
 601 0222 43C0      		rjmp .L30
 603               	.LM61:
 604 0224 8E81      		ldd r24,Y+6
 605 0226 8330      		cpi r24,lo8(3)
 606 0228 21F4      		brne .L37
 295:mac.c         **** 	{
 296:mac.c         **** 	   //printf("\n----SUCCESSFULL ORPHAN SCAN----\n");
 297:mac.c         **** 	     mac_current_state=MAC_STATE_IDLE;
 608               	.LM62:
 609 022a 80E1      		ldi r24,lo8(16)
 610 022c 8093 0000 		sts mac_current_state,r24
 298:mac.c         **** 	     return;	 
 612               	.LM63:
 613 0230 3EC0      		rjmp .L28
 614               	.L37:
 299:mac.c         **** 	}
 300:mac.c         ****        if((scan_result_info.status==SUCCESS)&&(scan_result_info.scanType==ACTIVE_PASSIVE_SCAN))
 616               	.LM64:
 617 0232 8130      		cpi r24,lo8(1)
 618 0234 D1F5      		brne .L30
 301:mac.c         ****        {//printf("\n-------it is in scan confirm---------\n");
 302:mac.c         ****            mac_current_state=MAC_STATE_ACTIVE_PASSIVE_SCAN_FINISHED;
 620               	.LM65:
 621 0236 8AE0      		ldi r24,lo8(10)
 622 0238 8093 0000 		sts mac_current_state,r24
 303:mac.c         ****            //printf("\n-----the macbeacon is %02x\n",scan_result_info.pPANDescriptorList[0].superfr
 304:mac.c         **** 	    mac_pib_data.macBeaconOrder=((scan_result_info.pPANDescriptorList[0].superframeSpec.SF.bytes.L
 624               	.LM66:
 625 023c 8A8D      		ldd r24,Y+26
 626 023e 982F      		mov r25,r24
 627 0240 9F70      		andi r25,lo8(15)
 628 0242 9093 0000 		sts mac_pib_data+8,r25
 305:mac.c         **** 	    mac_pib_data.macSuperframeOrder=((scan_result_info.pPANDescriptorList[0].superframeSpec.SF.byt
 630               	.LM67:
 631 0246 8295      		swap r24
 632 0248 8F70      		andi r24,0x0f
 633 024a 8093 0000 		sts mac_pib_data+42,r24
 306:mac.c         **** 	    mac_pib_data.macPANId.Val=scan_result_info.pPANDescriptorList[0].coordinator.panID.Val; 		
 635               	.LM68:
 636 024e 888D      		ldd r24,Y+24
 637 0250 998D      		ldd r25,Y+25
 638 0252 9093 0000 		sts (mac_pib_data+28)+1,r25
 639 0256 8093 0000 		sts mac_pib_data+28,r24
 307:mac.c         **** 	    if(scan_result_info.pPANDescriptorList[0].coordinator.addrMode==0x02)	
 641               	.LM69:
 642 025a 8D85      		ldd r24,Y+13
 643 025c 8230      		cpi r24,lo8(2)
 644 025e 39F4      		brne .L31
 308:mac.c         **** 	    	{
 309:mac.c         **** 	           mac_pib_data.macCoordShortAddress.Val=scan_result_info.pPANDescriptorList[0].coordinato
 646               	.LM70:
 647 0260 8E89      		ldd r24,Y+22
 648 0262 9F89      		ldd r25,Y+23
 649 0264 9093 0000 		sts (mac_pib_data+22)+1,r25
 650 0268 8093 0000 		sts mac_pib_data+22,r24
 651 026c 1AC0      		rjmp .L32
 652               	.L31:
 310:mac.c         **** 	    	}
 311:mac.c         **** 	    else if(scan_result_info.pPANDescriptorList[0].coordinator.addrMode==0x03)	
 654               	.LM71:
 655 026e 8330      		cpi r24,lo8(3)
 656 0270 C1F4      		brne .L32
 312:mac.c         **** 	    	{
 313:mac.c         **** 	    	    mac_pib_data.macCoordExtendedAddress.longaddr=scan_result_info.pPANDescriptorList[0].coor
 658               	.LM72:
 659 0272 2E85      		ldd r18,Y+14
 660 0274 3F85      		ldd r19,Y+15
 661 0276 4889      		ldd r20,Y+16
 662 0278 5989      		ldd r21,Y+17
 663 027a 6A89      		ldd r22,Y+18
 664 027c 7B89      		ldd r23,Y+19
 665 027e 8C89      		ldd r24,Y+20
 666 0280 9D89      		ldd r25,Y+21
 667 0282 2093 0000 		sts mac_pib_data+14,r18
 668 0286 3093 0000 		sts mac_pib_data+15,r19
 669 028a 4093 0000 		sts mac_pib_data+16,r20
 670 028e 5093 0000 		sts mac_pib_data+17,r21
 671 0292 6093 0000 		sts mac_pib_data+18,r22
 672 0296 7093 0000 		sts mac_pib_data+19,r23
 673 029a 8093 0000 		sts mac_pib_data+20,r24
 674 029e 9093 0000 		sts mac_pib_data+21,r25
 675               	.L32:
 314:mac.c         **** 	    	}
 315:mac.c         **** 	    ppib.phyCurrentChanel=scan_result_info.pPANDescriptorList[0].logicalChannel;
 677               	.LM73:
 678 02a2 8C85      		ldd r24,Y+12
 679 02a4 8093 0000 		sts ppib,r24
 680 02a8 02C0      		rjmp .L28
 681               	.L30:
 316:mac.c         **** 	    //PLME_SET_request(phyCurrentChanel_id, ppib.phyCurrentChanel);
 317:mac.c         **** 	    //OS_post(synrequest_task);
 318:mac.c         ****        }
 319:mac.c         ****  	else
 320:mac.c         ****  	{
 321:mac.c         ****  	   if(!IS_COORDINATOR)
 322:mac.c         ****  	   	{
 323:mac.c         ****  	   mac_current_state=MAC_STATE_UNSTARTED;
 683               	.LM74:
 684 02aa 1092 0000 		sts mac_current_state,__zero_reg__
 685               	.L28:
 686               	/* epilogue: frame size=0 */
 687 02ae DF91      		pop r29
 688 02b0 CF91      		pop r28
 689 02b2 0895      		ret
 690               	/* epilogue end (size=3) */
 691               	/* function mlmeScanConfirm size 80 (73) */
 693               	.Lscope3:
 695               	.global	mlmeStartConfirm
 697               	mlmeStartConfirm:
 324:mac.c         **** 	 //printf("\n--PASSIVE SCAN FAILURE-----\n");
 325:mac.c         ****  	   	}
 326:mac.c         **** 	   else
 327:mac.c         **** 	   	{
 328:mac.c         **** 	   mac_current_state=MAC_STATE_ACTIVE_PASSIVE_SCAN_FINISHED;
 329:mac.c         **** 	 //printf("\n---doesn't exist any 802.15.4 network ----\n");
 330:mac.c         **** 	 //printf("---I will be the coordinator----");
 331:mac.c         **** 	   	}
 332:mac.c         **** 	   //OS_post(scan_task);	
 333:mac.c         ****  	} 
 334:mac.c         ****        
 335:mac.c         **** }
 336:mac.c         **** 
 337:mac.c         **** void scan_task(void)
 338:mac.c         **** {
 339:mac.c         ****     mlmeScanRequest(ACTIVE_PASSIVE_SCAN, 0x00000008, 6);
 340:mac.c         **** }
 341:mac.c         **** 
 342:mac.c         **** 
 343:mac.c         **** //**************************//
 344:mac.c         **** //¿ªÊ¼×éÖ¯Ò»¸öÐÂµÄÍøÂç,´«ËÍ³¬Ö¡(±ØÐëÊÇFFDÉè±¸²Å¿ÉÒÔµ÷ÓÃ¸ÃÔ­Óïº¯Êý)
 345:mac.c         **** //Èç¹ûÊÇÍøÂçÐ­µ÷Õß£¬½«ºöÂÔ¸Ãº¯ÊýµÄstarttime²ÎÊý
 346:mac.c         **** //NOTE:ÔÚµ÷ÓÃ¸Ãº¯ÊýÇ°£¬¶ÔÓÚÐ­µ÷ÕßÀ´Ëµ£¬Ó¦¸ÃÒÑ¾­ÉèÖÃºÃÁËËùÓÐÍøÂçµÄ²ÎÊý
 347:mac.c         **** //¶ÔÓÚ·ÇÐ­µ÷ÕßµÄFFD(Ïàµ±ÓÚ¶àÌøÍøÂçÖÐµÄ´Ø½Úµã)À´Ëµ£¬Ó¦¸ÃÒÑ¾­Í¬²½µ½Æä¸¸½Úµã(¼´ËüËù¹ØÁªµÄ½Úµã)µÄÐÅ±êÖ¡
 348:mac.c         **** //¶ÔÓÚ·ÇÐ­µ÷ÕßµÄFFD·¢ËÍÐÅ±êÖ¡Ê±ºò£¬Êµ¼ÊÉÏstarttimeÒ²½«×÷ÎªËüÐÅ±êÖ¡¸ºÔØµÄtxoffsetÓòµÄÖµ
 349:mac.c         **** //PIBÀïÃæÓÐ¸ö³ÉÔ±macBeaconTxtime¼ÇÂ¼×ÅÉÏÒ»´Î·¢ËÍÐÅ±êÖ¡µÄ·ûºÅÊýÄ¿ÊÇ¶àÉÙ¡£
 350:mac.c         **** void mlmeStartRequest(SHORT_ADDR panId, uint8_t  logicalChannel, uint8_t beaconOrder, uint8_t super
 351:mac.c         **** {
 352:mac.c         **** 
 353:mac.c         ****    SET_STATE  temp_return_SET;
 354:mac.c         ****    uint8_t return_state;
 355:mac.c         ****    mac_tx_beacon.beacon_payload_length=0;
 356:mac.c         ****    mac_tx_beacon.longpendingadd_length=0;
 357:mac.c         ****    mac_tx_beacon.shortpendingadd_length=0;
 358:mac.c         ****    //printf("\n*******the beacon order is %02x\n",beaconOrder);
 359:mac.c         ****    //printf("\n*******the super order is %02x\n",superframeOrder);
 360:mac.c         ****    mac_tx_beacon.superframe_field.SF.bytes.LSB=((superframeOrder<<4)|beaconOrder);
 361:mac.c         ****    //ÓÉÓÚÎÒÃÇ²»²ÉÓÃGTS´«Êä,ËùÒÔÕâÀïÉèÖÃfinalCAPSlotÎª15.
 362:mac.c         ****    if(panCoordinator)
 363:mac.c         ****    mac_tx_beacon.superframe_field.SF.bytes.MSB=(0x80)|(0x40)|(0x0f);
 364:mac.c         ****    else
 365:mac.c         ****    mac_tx_beacon.superframe_field.SF.bytes.MSB=(0x80)|(0x0f);
 366:mac.c         ****    //printf("\n*******the superframe_field is %02x\n",mac_tx_beacon.superframe_field.SF.bytes.LSB);
 367:mac.c         ****    //printf("\n*******the superframe_field is %02x\n",mac_tx_beacon.superframe_field.SF.bytes.MSB);
 368:mac.c         ****    mac_pib_data.macPANId=panId;
 369:mac.c         ****    mac_pib_data.macBeaconOrder=beaconOrder;
 370:mac.c         ****    mac_pib_data.macSuperframeOrder=superframeOrder;
 371:mac.c         ****    ppib.phyCurrentChanel=logicalChannel;
 372:mac.c         ****    //printf("\n====Base is %d   \n====macBeacon is %d   \n===superframeorder is %d",aBaseSuperframe
 373:mac.c         ****    MAC_SUPERFRAME_PERIOD=(uint32_t)(((uint32_t)aBaseSuperframeDuration)<<(mac_pib_data.macBeaconOrd
 374:mac.c         ****    MAC_CAP_PERIOD=(uint32_t)(((uint32_t)aBaseSuperframeDuration)<<(mac_pib_data.macSuperframeOrder)
 375:mac.c         ****    //printf("\n ---------cap   time is %08lx",MAC_CAP_PERIOD); 	
 376:mac.c         ****    //printf("\n ---------super time is %08lx",MAC_SUPERFRAME_PERIOD);	 
 377:mac.c         ****    temp_return_SET=PLME_SET_request(phyCurrentChanel_id, logicalChannel);
 378:mac.c         ****    /*return_state=PLME_SET_TRX_STATE_request(TX_ON);
 379:mac.c         ****    if(return_state!=PHY_SUCCESS)  
 380:mac.c         ****    	{
 381:mac.c         ****    	   error("\nopen the RF failure\n");
 382:mac.c         **** 	 //printf("%d",return_state);
 383:mac.c         **** 	   return;
 384:mac.c         ****    	}*/
 385:mac.c         ****    if(!coordRealignment)
 386:mac.c         ****    	beacon_frame_send(TRUE);
 387:mac.c         ****    else
 388:mac.c         ****    	coordinator_realignment_frame_send(FALSE, default_node, default_short_addr);
 389:mac.c         **** }
 390:mac.c         **** 
 391:mac.c         **** void mlmeStartConfirm(void)
 392:mac.c         **** {
 699               	.LM75:
 700               	/* prologue: frame size=0 */
 701               	/* prologue end (size=0) */
 702               	/* epilogue: frame size=0 */
 703 02b4 0895      		ret
 704               	/* epilogue end (size=1) */
 705               	/* function mlmeStartConfirm size 1 (0) */
 707               	.Lscope4:
 708               		.data
 709               	.LC1:
 710 0015 0A2D 2D2D 		.string	"\n----the association request frame is no acked-----"
 710      2D74 6865 
 710      2061 7373 
 710      6F63 6961 
 710      7469 6F6E 
 711               	.LC2:
 712 0049 0A2D 2D2D 		.string	"\n---didn't received the association response frame---"
 712      6469 646E 
 712      2774 2072 
 712      6563 6569 
 712      7665 6420 
 713               		.text
 717               	.global	mlmeAssociateConfirm
 719               	mlmeAssociateConfirm:
 393:mac.c         **** 	//Í¨Öª¸ß²ã·¢ËÍÍê±Ï¡£
 394:mac.c         **** 	//¿ÉÒÔÍ¨¹ýpost¸ß²ãÈÎÎñÀ´Íê³É¸ß²ãµÄº¯ÊýÈÎÎñ
 395:mac.c         **** 	//¿Õº¯Êý£¬¸ß²ãÊµÏÖ
 396:mac.c         **** }
 397:mac.c         **** 
 398:mac.c         **** //**************************//
 399:mac.c         **** void mlmeAssociateRequest(UINT8 logicalChannel, BYTE coordAddrMode, SHORT_ADDR coordPANId, ADDRESS 
 400:mac.c         **** {
 401:mac.c         **** 	//ÉèÖÃÏµÍ³µÄMAC×´Ì¬±äÁ¿ÎªMAC_STATE_ASSOC_STARTED
 402:mac.c         **** 	//µ÷ÓÃ·¢ËÍÈÎÎñ·¢ËÍassociate requestÖ¡¡£POST()
 403:mac.c         **** 	NODE_INFO dst;
 404:mac.c         **** 	SET_STATE  temp_return_SET;
 405:mac.c         **** 	dst.addrMode=coordAddrMode;
 406:mac.c         **** 	dst.panID=coordPANId;
 407:mac.c         **** 	if(coordAddrMode==0x03)
 408:mac.c         **** 		dst.longAddr=pCoordAddress.Extended;
 409:mac.c         **** 	else if(coordAddrMode==0x02)
 410:mac.c         **** 		dst.shortAddr=pCoordAddress.Short;
 411:mac.c         **** 	//mac_current_state=MAC_STATE_ASSOC_REQ_SENT;
 412:mac.c         **** 	if(!IS_COORDINATOR)
 413:mac.c         **** 	{  
 414:mac.c         ****           temp_return_SET=PLME_SET_request(phyCurrentChanel_id, logicalChannel);
 415:mac.c         **** 	   //if(phy_channel_state==PHY_IDLE)
 416:mac.c         **** 	   	//{
 417:mac.c         **** 	   	    mac_current_state=MAC_STATE_ASSOC_REQ_SENT;
 418:mac.c         **** 	   	    associate_request_frame_send(coordPANId, dst, capabilityInformation);
 419:mac.c         **** 	   	//}	  
 420:mac.c         **** 	   /*else
 421:mac.c         **** 	   	{
 422:mac.c         **** 	   	    mac_current_state=
 423:mac.c         **** 	   	}*/
 424:mac.c         **** 	} 
 425:mac.c         **** 	//else if(IS_FFD)............
 426:mac.c         **** }
 427:mac.c         **** void mlmeAssociateConfirm(SHORT_ADDR AssocShortAddress, BYTE status)
 428:mac.c         **** {
 721               	.LM76:
 722               	/* prologue: frame size=0 */
 723 02b6 CF93      		push r28
 724 02b8 DF93      		push r29
 725               	/* prologue end (size=2) */
 726 02ba EC01      		movw r28,r24
 429:mac.c         **** 	//printf("\n------success associate------ %d\n",status);
 430:mac.c         **** 	//printf("\nthe allocated short address is %04x\n",AssocShortAddress.Val);
 431:mac.c         **** 	if(status==NO_ACK)
 728               	.LM77:
 729 02bc 693E      		cpi r22,lo8(-23)
 730 02be 19F4      		brne .L40
 432:mac.c         **** 		{
 433:mac.c         **** 		printf("\n----the association request frame is no acked-----\n");
 732               	.LM78:
 733 02c0 80E0      		ldi r24,lo8(.LC1)
 734 02c2 90E0      		ldi r25,hi8(.LC1)
 735 02c4 04C0      		rjmp .L44
 736               	.L40:
 434:mac.c         **** 		//mac_current_state=MAC
 435:mac.c         **** 		}
 436:mac.c         **** 	//Á½ÖÖÇé¿öÎªNO_DATA
 437:mac.c         **** 	if(status==NO_DATA)
 738               	.LM79:
 739 02c6 6B3E      		cpi r22,lo8(-21)
 740 02c8 29F4      		brne .L41
 438:mac.c         **** 		printf("\n---didn't received the association response frame---\n");
 742               	.LM80:
 743 02ca 80E0      		ldi r24,lo8(.LC2)
 744 02cc 90E0      		ldi r25,hi8(.LC2)
 745               	.L44:
 746 02ce 0E94 0000 		call puts
 747 02d2 18C0      		rjmp .L42
 748               	.L41:
 439:mac.c         **** 	if(status==SUCCESS)
 750               	.LM81:
 751 02d4 6623      		tst r22
 752 02d6 B1F4      		brne .L42
 440:mac.c         **** 	{
 441:mac.c         **** 	mac_current_state=MAC_STATE_ASSOC_FINISHED;
 754               	.LM82:
 755 02d8 84E0      		ldi r24,lo8(4)
 756 02da 8093 0000 		sts mac_current_state,r24
 442:mac.c         **** 	//mac_current_state=MAC_STATE_IDLE;
 443:mac.c         **** 	//mac_current_state_saved=MAC_STATE_IDLE;
 444:mac.c         **** 	phy_channel_state=PHY_IDLE;
 758               	.LM83:
 759 02de 6093 0000 		sts phy_channel_state,r22
 445:mac.c         **** 	PLME_SET_TRX_STATE_request(RX_ON);
 761               	.LM84:
 762 02e2 86E0      		ldi r24,lo8(6)
 763 02e4 0E94 0000 		call PLME_SET_TRX_STATE_request
 446:mac.c         **** 	mac_pib_data.macShortAddress=AssocShortAddress;
 765               	.LM85:
 766 02e8 D093 0000 		sts (mac_pib_data+32)+1,r29
 767 02ec C093 0000 		sts mac_pib_data+32,r28
 447:mac.c         **** 	cc2420_setshortaddress((uint16_t)mac_pib_data.macShortAddress.Val);
 769               	.LM86:
 770 02f0 CE01      		movw r24,r28
 771 02f2 0E94 0000 		call cc2420_setshortaddress
 448:mac.c         ****        cc2420_setpanid((uint16_t)mac_pib_data.macPANId.Val);		
 773               	.LM87:
 774 02f6 8091 0000 		lds r24,mac_pib_data+28
 775 02fa 9091 0000 		lds r25,(mac_pib_data+28)+1
 776 02fe 0E94 0000 		call cc2420_setpanid
 777 0302 03C0      		rjmp .L39
 778               	.L42:
 449:mac.c         **** 	}
 450:mac.c         **** 	else 
 451:mac.c         **** 	{
 452:mac.c         **** 	   //Ö÷Òª¹¤×÷ÓÉÍøÂç²ã¾ö¶¨
 453:mac.c         **** 	   mac_current_state=MAC_STATE_ACTIVE_PASSIVE_SCAN_FINISHED;
 780               	.LM88:
 781 0304 8AE0      		ldi r24,lo8(10)
 782 0306 8093 0000 		sts mac_current_state,r24
 783               	.L39:
 784               	/* epilogue: frame size=0 */
 785 030a DF91      		pop r29
 786 030c CF91      		pop r28
 787 030e 0895      		ret
 788               	/* epilogue end (size=3) */
 789               	/* function mlmeAssociateConfirm size 45 (40) */
 791               	.Lscope5:
 797               	.global	mlmeDisassociateIndication
 799               	mlmeDisassociateIndication:
 454:mac.c         **** 	}
 455:mac.c         **** }
 456:mac.c         **** 
 457:mac.c         **** //**************************//
 458:mac.c         **** void mlmeAssociateIndication(MLME_ASSOCIATE_INDICATION   mlme_associate_indication_info)
 459:mac.c         **** {
 460:mac.c         **** 	//Ð­µ÷ÕßÔÚÊÕµ½associate requestÖ¡ºóÍ¨Öª¸ß²ã
 461:mac.c         **** 	//¿ÉÒÔpost¸ß²ãÈÎÎñ
 462:mac.c         **** 	BYTE status;
 463:mac.c         **** 	SHORT_ADDR  shortaddr_alloc;
 464:mac.c         **** 	//Ö÷ÒªÈÎÎñÊÇµ÷ÓÃmlmeassociateresponseÔ­Óï
 465:mac.c         **** 	//------------------------------------------------------
 466:mac.c         **** 	//---------------´ýÌí¼Ó------------------------------
 467:mac.c         **** 	//--------ÍøÂç²ãÊÇ·ñ¾ö¶¨¹ØÁª-------------------
 468:mac.c         **** 	//--------ÐÞ¸Ästatus,·ÖÅäshortaddr--------------------
 469:mac.c         ****      //printf("\n------success received an association request frame--------\n");
 470:mac.c         **** 	//for(uint8_t i=0;i<8;i++)
 471:mac.c         **** 	//	printf("\nthe addr is v[%d]=%d\n",i,mlme_associate_indication_info.Deviceaddr.v[i]);
 472:mac.c         **** 	//shortaddr_alloc.Val=RFD_SHORT_ADDRESS;
 473:mac.c         **** 	shortaddr_alloc=short_address_allocate_req(mlme_associate_indication_info.Deviceaddr);
 474:mac.c         **** 	printf("\n---allocated short addr is %04x---\n",shortaddr_alloc.Val);
 475:mac.c         **** 	status=0x00;
 476:mac.c         **** 	mlmeAssociateResponse(mlme_associate_indication_info.Deviceaddr, shortaddr_alloc,status, FALSE);
 477:mac.c         **** }
 478:mac.c         **** //**************************//
 479:mac.c         **** void mlmeAssociateResponse(LONG_ADDR deviceAddress, SHORT_ADDR assocShortAddress, BYTE status, bool
 480:mac.c         **** {
 481:mac.c         **** 	//Ð­µ÷ÕßµÄ¸ß²ãÔÚÊÕµ½associate indicationÔ­ÓïºóÏìÓ¦MAC²ãµÄÔ­Óï
 482:mac.c         **** 	//MAC²ãµ÷ÓÃ·¢ËÍÈÎÎñ·¢ËÍassociate responseÖ¡
 483:mac.c         **** 	FRAME_CONTROL framectl_field;
 484:mac.c         **** 	NODE_INFO dst; 
 485:mac.c         **** 	NODE_INFO src; 
 486:mac.c         **** 	//ÏÂÃæ²»ÓÃ×ö.
 487:mac.c         **** 	dst.addrMode=0x03;
 488:mac.c         **** 	src.addrMode=0x03;
 489:mac.c         **** 	dst.panID=mac_pib_data.macPANId;
 490:mac.c         **** 	src.panID=mac_pib_data.macPANId;
 491:mac.c         ****        src.longAddr=mac_pib_data.macExtAddress;	
 492:mac.c         **** 	dst.longAddr=deviceAddress;
 493:mac.c         **** 	framectl_field.v[0]=0x23;
 494:mac.c         **** 	framectl_field.v[1]=0xcc;
 495:mac.c         **** 	
 496:mac.c         **** 	//
 497:mac.c         **** 	if((IS_FFD!=0x00)&&(mac_current_state==MAC_STATE_IDLE)&&(current_pending_num<MAX_PENDING_LIST_SIZE
 498:mac.c         **** 		{
 499:mac.c         **** 		    add_pending_queue(0, framectl_field, dst,src,0, NULL, status, TRUE, deviceAddress,assocShortA
 500:mac.c         **** 		}
 501:mac.c         **** 	else if(current_pending_num>=MAX_PENDING_LIST_SIZE)	
 502:mac.c         **** 		{
 503:mac.c         **** 		   //printf("\npending full\n");
 504:mac.c         **** 		     //ÏòÉÏ²ã±¨¸æ
 505:mac.c         **** 		     //mlme_comm_status()
 506:mac.c         **** 		}
 507:mac.c         **** 	//--------------------------------------------------
 508:mac.c         ****        //In order to test the disassociation frame from the coordinator
 509:mac.c         ****        //LONG_ADDR  RFD_LONG_ADDR;
 510:mac.c         **** 
 511:mac.c         **** 	//test the coordinator want the RFD leave the network
 512:mac.c         ****        //mlmeDisassociateRequest(deviceAddress,0x01, FALSE);
 513:mac.c         **** 
 514:mac.c         ****       //---------------------------------------------------
 515:mac.c         **** 	
 516:mac.c         **** 		
 517:mac.c         **** }
 518:mac.c         **** 
 519:mac.c         **** 
 520:mac.c         **** //**************************//
 521:mac.c         **** void mlmeDisassociateRequest(LONG_ADDR pDeviceAddress, BYTE disassociateReason, bool securityEnable
 522:mac.c         **** {
 523:mac.c         **** 	//Ð­µ÷ÕßºÍÒ»°ãÉè±¸¶¼¿É·¢ËÍ¸ÃÇëÇó
 524:mac.c         **** 	//MAC²ãµ÷ÓÃ·¢ËÍÈÎÎñ·¢ËÍdisassociation notificationÖ¡
 525:mac.c         **** 	//Èç¹ûÊÇÐ­µ÷Õß½«²ÉÓÃ¼ä½Ó·¢ËÍ,½øÈëpending¶ÓÁÐ£¬ÆäÖÐÐèÒªÉèÖÃÏµÍ³MAC²ãµÄ×´Ì¬±äÁ¿
 526:mac.c         **** 	FRAME_CONTROL framectl_field;
 527:mac.c         **** 	NODE_INFO dst;
 528:mac.c         **** 	NODE_INFO src;
 529:mac.c         **** 	//ÏÂÃæÎªÖØ¸´ÐÔ¹¤×÷£¬¿ÉÒÔÉ¾³ý
 530:mac.c         **** 	dst.addrMode=0x03;
 531:mac.c         **** 	src.addrMode=0x03;
 532:mac.c         **** 	dst.panID=mac_pib_data.macPANId;
 533:mac.c         **** 	src.panID=mac_pib_data.macPANId;
 534:mac.c         **** 	src.longAddr=mac_pib_data.macExtAddress;
 535:mac.c         **** 	
 536:mac.c         **** 	//
 537:mac.c         **** 	framectl_field.v[0]=0x23;
 538:mac.c         **** 	if(!IS_COORDINATOR)
 539:mac.c         **** 	framectl_field.v[1]=0xc8;
 540:mac.c         **** 	else	
 541:mac.c         **** 	framectl_field.v[1]=0xcc;
 542:mac.c         ****        if((mac_current_state)==MAC_STATE_IDLE)
 543:mac.c         ****        {
 544:mac.c         ****           if((IS_FFD!=0x00)&&(current_pending_num<=MAX_PENDING_LIST_SIZE))
 545:mac.c         ****           	{
 546:mac.c         ****           	    dst.longAddr=pDeviceAddress;
 547:mac.c         **** 		    add_pending_queue(0, framectl_field, dst, src, 0, NULL,disassociateReason,FALSE,pDeviceAddres
 548:mac.c         **** 		
 549:mac.c         ****           	}
 550:mac.c         ****           else
 551:mac.c         ****           	{
 552:mac.c         ****           	    dst.longAddr=mac_pib_data.macCoordExtendedAddress;
 553:mac.c         **** 		    disassociate_notification_frame_send(disassociateReason, mac_pib_data.macCoordExtendedAddress
 554:mac.c         ****           	}	
 555:mac.c         ****        }
 556:mac.c         **** }
 557:mac.c         **** 
 558:mac.c         **** void mlmeDisassociateIndication(LONG_ADDR deviceAddress, BYTE disassociateReason, bool securityUse,
 559:mac.c         **** {
 801               	.LM89:
 802               	/* prologue: frame size=8 */
 803 0310 CF93      		push r28
 804 0312 DF93      		push r29
 805 0314 CDB7      		in r28,__SP_L__
 806 0316 DEB7      		in r29,__SP_H__
 807 0318 2897      		sbiw r28,8
 808 031a 0FB6      		in __tmp_reg__,__SREG__
 809 031c F894      		cli
 810 031e DEBF      		out __SP_H__,r29
 811 0320 0FBE      		out __SREG__,__tmp_reg__
 812 0322 CDBF      		out __SP_L__,r28
 813               	/* prologue end (size=10) */
 560:mac.c         **** 	//Ð­µ÷Õß»òÖÕ¶ËÉè±¸ÔÚÊÕµ½¶Ô·½·¢¹ýÀ´µÄdisassociation notificationÖ¡ºó
 561:mac.c         **** 	//Í¨Öª¸ß²ã¡£post¸ß²ãÈÎÎñ
 562:mac.c         **** 	//¿Õº¯Êý£¬¸ß²ãÊµÏÖ
 563:mac.c         **** 	//------------------------------------------------------
 564:mac.c         **** 	//---------------´ýÌí¼Ó------------------------------
 565:mac.c         **** 	//--------ÍøÂç²ãÉ¾³ý¶ÔÓ¦µÄassociate¼ÇÂ¼--------
 566:mac.c         **** 	//-------------------------------------------------------
 567:mac.c         ****        if(!IS_COORDINATOR)
 568:mac.c         ****        {
 569:mac.c         **** 	 //printf("\n--the RFD received the disassociation indiation----\n");
 570:mac.c         **** 	   mac_current_state=MAC_STATE_IDLE;
 815               	.LM90:
 816 0324 80E1      		ldi r24,lo8(16)
 817 0326 8093 0000 		sts mac_current_state,r24
 818               	/* epilogue: frame size=8 */
 819 032a 2896      		adiw r28,8
 820 032c 0FB6      		in __tmp_reg__,__SREG__
 821 032e F894      		cli
 822 0330 DEBF      		out __SP_H__,r29
 823 0332 0FBE      		out __SREG__,__tmp_reg__
 824 0334 CDBF      		out __SP_L__,r28
 825 0336 DF91      		pop r29
 826 0338 CF91      		pop r28
 827 033a 0895      		ret
 828               	/* epilogue end (size=9) */
 829               	/* function mlmeDisassociateIndication size 22 (3) */
 831               	.Lscope6:
 832               		.data
 833               	.LC3:
 834 007f 0A2D 2D2D 		.string	"\n---success disassociated from the network-----"
 834      7375 6363 
 834      6573 7320 
 834      6469 7361 
 834      7373 6F63 
 835               		.text
 838               	.global	mlmeDisassociateConfirm
 840               	mlmeDisassociateConfirm:
 571:mac.c         ****        }  
 572:mac.c         **** 	else
 573:mac.c         **** 	printf("\n----the coordinator received the disassociation indication----\n");	
 574:mac.c         **** 	
 575:mac.c         **** }
 576:mac.c         **** void mlmeDisassociateConfirm(MAC_ENUM status)
 577:mac.c         **** {
 842               	.LM91:
 843               	/* prologue: frame size=0 */
 844               	/* prologue end (size=0) */
 578:mac.c         **** 	//ÔÚMAC²ã·¢ËÍÍê³É(ÎÞÂÛ³É¹¦ÓëÊ§°Ü)£¬½«µ÷ÓÃ¸ÃÔ­ÓïÍ¨Öª¸ß²ã
 579:mac.c         **** 	//»Ö¸´ÏµÍ³µÄMAC²ãµÄ×´Ì¬±äÁ¿
 580:mac.c         ****   //¿ÉÒÔpostÒ»¸ö¸ß²ãÈÎÎñ
 581:mac.c         ****   //¿Õº¯Êý£¬¸ß²ãÊµÏÖ
 582:mac.c         ****      if(status==SUCCESS)
 846               	.LM92:
 847 033c 8823      		tst r24
 848 033e 21F4      		brne .L48
 583:mac.c         ****      {
 584:mac.c         ****          if(!IS_COORDINATOR)
 585:mac.c         ****              printf("\n---success disassociated from the network-----\n");
 850               	.LM93:
 851 0340 80E0      		ldi r24,lo8(.LC3)
 852 0342 90E0      		ldi r25,hi8(.LC3)
 853 0344 0E94 0000 		call puts
 854               	.L48:
 855 0348 0895      		ret
 856               	/* epilogue: frame size=0 */
 857 034a 0895      		ret
 858               	/* epilogue end (size=1) */
 859               	/* function mlmeDisassociateConfirm size 8 (7) */
 861               	.Lscope7:
 869               	.global	mlmeCommStatusIndication
 871               	mlmeCommStatusIndication:
 586:mac.c         ****          else
 587:mac.c         ****              printf("\n---success disassociated the object RFD from the network------\n");	 	
 588:mac.c         ****      }		 
 589:mac.c         **** }
 590:mac.c         **** 
 591:mac.c         **** void mlmeBeaconNotifyIndication(MLME_BEACON_NOTIFY_INDICATION  beacon_info)
 592:mac.c         **** {
 593:mac.c         ****        bool Is_pending;
 594:mac.c         **** 	uint8_t  i;
 595:mac.c         **** 	Is_pending=FALSE;
 596:mac.c         **** 	//printf("\nmac_current state is %d--\n",mac_current_state);
 597:mac.c         **** 	if(mac_current_state==MAC_STATE_ACTIVE_PASSIVE_SCAN)
 598:mac.c         ****       	{
 599:mac.c         **** 	   scan_result_info.scanType=ACTIVE_PASSIVE_SCAN;
 600:mac.c         **** 	   scan_result_info.status=SUCCESS;
 601:mac.c         **** 	   //scan_result_info.resultListSize++;
 602:mac.c         **** 	   if(scan_result_info.resultListSize>MAC_MAX_PAN_DESCRIPTORS)
 603:mac.c         **** 	   	{
 604:mac.c         **** 	   	   head_of_timer_queue=timer3quere_cancel(head_of_timer_queue, 0,WAIT_SCAN);
 605:mac.c         **** 		   mlmeScanConfirm(scan_result_info);
 606:mac.c         **** 		   mac_current_state=MAC_STATE_ACTIVE_PASSIVE_SCAN_FINISHED;
 607:mac.c         **** 		   PLME_SET_TRX_STATE_request(TRX_OFF);
 608:mac.c         **** 		   phy_channel_state=INACTIVE_PERIOD;
 609:mac.c         ****                //printf("\n$$$$$$$$$$sccessed finish passive scan$$$$$$$$$$$\n");
 610:mac.c         **** 		   
 611:mac.c         **** 	   	}
 612:mac.c         **** 	   else
 613:mac.c         **** 	   	{
 614:mac.c         **** 	   	   scan_result_info.pPANDescriptorList[scan_result_info.resultListSize]=beacon_info.panDescrip
 615:mac.c         **** 		   scan_result_info.resultListSize++;  
 616:mac.c         **** 	   	}
 617:mac.c         ****       	}
 618:mac.c         **** 	/*else if()
 619:mac.c         **** 	{
 620:mac.c         **** 	     
 621:mac.c         **** 	}*/
 622:mac.c         **** 	else  
 623:mac.c         **** 	{     
 624:mac.c         **** 	       for(i=0;i<beacon_info.shortpendingadd_length;i++)
 625:mac.c         **** 	       	{
 626:mac.c         **** 	       	      if(beacon_info.shortaddrpending_list[i].Val==mac_pib_data.macShortAddress.Val)
 627:mac.c         **** 				  	Is_pending=TRUE;
 628:mac.c         **** 	       	}
 629:mac.c         **** 		for(i=0;i<beacon_info.longpendingadd_length;i++)
 630:mac.c         **** 			{
 631:mac.c         **** 			      if(beacon_info.longaddrpending_list[i].longaddr==mac_pib_data.macExtAddress.longaddr)
 632:mac.c         **** 				  	Is_pending=TRUE;
 633:mac.c         **** 			}
 634:mac.c         **** 	       /*if((Is_pending)&&(mac_current_state==MAC_STATE_ASSOC_WAIT_FOR_RESPONSE))
 635:mac.c         **** 		{
 636:mac.c         **** 		     //ÓÐµãÐ¡ÎÊÌâ£¬Èç¹ûÐ­µ÷Õß·¢ËÍÊý¾ÝÖ¡ÔõÃ´°ì?  
 637:mac.c         **** 		     //head_of_timer_queue=timer3quere_cancel(head_of_timer_queue,0, WAIT_FOR_RESPONSE);
 638:mac.c         **** 		}*/
 639:mac.c         **** 		if(Is_pending)
 640:mac.c         **** 			//·¢ËÍdata requestÖ¡
 641:mac.c         **** 			{
 642:mac.c         **** 			      //printf("\nbe told there is association response frame in the coordinator\n");
 643:mac.c         **** 			      data_request_frame_send();	   
 644:mac.c         **** 			}
 645:mac.c         **** 			//data_request_frame_send();
 646:mac.c         ****                 /*#ifdef  I_AM_RFD 			                                                             
 647:mac.c         ****                 else                                                                               
 648:mac.c         ****                 {                                                                                  
 649:mac.c         ****                 		    //test  beacon  received                                                     
 650:mac.c         ****                 		  //printf("\nsuccess received a beacon frame\n");                               
 651:mac.c         ****                 		  //printf("\n the logical channel is %d",beacon_info.panDescriptor.logicalChanne
 652:mac.c         ****                 		  //printf("\n the coord panid is %08x",beacon_info.panDescriptor.coordinator.pan
 653:mac.c         ****                 	         //printf("\n the coord address  is %08x",beacon_info.panDescriptor.coordi
 654:mac.c         ****                 }                                                                                  
 655:mac.c         ****                 #endif   */                                                                        
 656:mac.c         **** 	}       
 657:mac.c         **** }               
 658:mac.c         **** //*************************//
 659:mac.c         **** void mlmeOrphanIndication(LONG_ADDR orphanAddress, bool securityUse, BYTE aclEntry)
 660:mac.c         **** {               
 661:mac.c         **** 	//Ð­µ÷Õß»ò´ØÍ·½ÚµãÔÚÊÕµ½Ò»¸öÉè±¸·¢ËÍ¹ýÀ´µÄorphan nitificationÖ¡Ê±ºòÍ¨Öª¸ß²ãµÄÔ­Óï
 662:mac.c         **** 	//Íê³É¸ß²ãÈÎÎñ£¬¸ÃÈÎÎñÖ÷ÒªÊÇµ÷ÓÃorphan responseÔ­Óï¡£
 663:mac.c         **** 	SHORT_ADDR shortaddress;
 664:mac.c         **** 	//²éÕÒ¶ÔÓ¦orphanAddressµÄshortaddress.
 665:mac.c         **** 	//-------------------------------------------
 666:mac.c         **** 	//-------------------´ýÌí¼Ó--------------
 667:mac.c         **** 	//--------------ÍøÂç²ãµÄ´úÂë----------
 668:mac.c         **** 	//shortaddress.Val=0xfc8b;
 669:mac.c         ****        //shortaddress.Val=RFD_SHORT_ADDRESS;
 670:mac.c         **** 	printf("\nsuccess received a orphan notification frame\n");
 671:mac.c         **** 	shortaddress=short_address_allocate_req(orphanAddress);
 672:mac.c         **** 	mlmeOrphanResponse(orphanAddress, shortaddress, TRUE, FALSE);
 673:mac.c         **** }
 674:mac.c         **** //*************************//
 675:mac.c         **** void mlmeOrphanResponse(LONG_ADDR orphanAddress, SHORT_ADDR shortAddress, bool associatedMember, bo
 676:mac.c         **** {
 677:mac.c         **** 	//Ð­µ÷Õß»ò´ØÍ·½Úµã¸ß²ãÔÚÊÕµ½orphan indicationºó×÷Îª¶ÔMAC²ãµÄÒ»¸öÏìÓ¦
 678:mac.c         **** 	//MAC²ãµ÷ÓÃ·¢ËÍÈÎÎñ·¢ËÍcoordinator realignmentÖ¡
 679:mac.c         **** 	NODE_INFO  dst;
 680:mac.c         **** 	dst.addrMode=0x03;
 681:mac.c         **** 	dst.longAddr.longaddr=orphanAddress.longaddr;
 682:mac.c         **** 	//dst
 683:mac.c         ****        if((IS_FFD)&&(associatedMember)&&(mac_current_state==MAC_STATE_IDLE))
 684:mac.c         **** 	   	coordinator_realignment_frame_send(1, dst,shortAddress);
 685:mac.c         **** 	   	
 686:mac.c         **** 	   	
 687:mac.c         **** }
 688:mac.c         **** 
 689:mac.c         **** 
 690:mac.c         **** void mlmeCommStatusIndication(WORD panId, BYTE srcAddrMode, ADDRESS *pSrcAddr, BYTE dstAddrMode, AD
 691:mac.c         **** {
 873               	.LM94:
 874               	/* prologue: frame size=0 */
 875               	/* prologue end (size=0) */
 876               	/* epilogue: frame size=0 */
 877 034c 0895      		ret
 878               	/* epilogue end (size=1) */
 879               	/* function mlmeCommStatusIndication size 1 (0) */
 881               	.Lscope8:
 886               	.global	mlmeRxEnableRequest
 888               	mlmeRxEnableRequest:
 692:mac.c         **** 	//Í¨Öª¸ß²ãÏÔÊ¾responseÖ¡µÄ´«ÊäÇé¿ö
 693:mac.c         **** 	//¿Õº¯Êý
 694:mac.c         **** }
 695:mac.c         **** 
 696:mac.c         **** 
 697:mac.c         **** void mlmeRxEnableRequest(bool deferPermit, uint32_t rxOnTime, uint32_t rxOnDuration)
 698:mac.c         **** {
 890               	.LM95:
 891               	/* prologue: frame size=0 */
 892               	/* prologue end (size=0) */
 893               	/* epilogue: frame size=0 */
 894 034e 0895      		ret
 895               	/* epilogue end (size=1) */
 896               	/* function mlmeRxEnableRequest size 1 (0) */
 898               	.Lscope9:
 901               	.global	mlmeRxEnableConfirm
 903               	mlmeRxEnableConfirm:
 699:mac.c         **** 	//¿Õº¯Êý
 700:mac.c         **** }
 701:mac.c         **** void mlmeRxEnableConfirm(MAC_ENUM status)
 702:mac.c         **** {
 905               	.LM96:
 906               	/* prologue: frame size=0 */
 907               	/* prologue end (size=0) */
 908               	/* epilogue: frame size=0 */
 909 0350 0895      		ret
 910               	/* epilogue end (size=1) */
 911               	/* function mlmeRxEnableConfirm size 1 (0) */
 913               	.Lscope10:
 917               	.global	mlmeSyncRequest
 919               	mlmeSyncRequest:
 703:mac.c         **** 	//¿Õº¯Êý
 704:mac.c         **** }
 705:mac.c         **** 
 706:mac.c         **** void  synrequest_task(void)
 707:mac.c         **** {
 708:mac.c         ****     mlmeSyncRequest(ppib.phyCurrentChanel,TRUE);
 709:mac.c         **** }
 710:mac.c         **** 
 711:mac.c         **** //*************************//
 712:mac.c         **** //¸ß²ãÔÚÏµÍ³µÄMACÕý³£¹¤×÷×´Ì¬(ÍøÂçÒÑ¾­½¨ºÃ)ÏÂ·¢ËÍsynÍ¬²½ÇëÇó
 713:mac.c         **** void mlmeSyncRequest(UINT8 logicalChannel, bool trackBeacon)
 714:mac.c         **** {
 921               	.LM97:
 922               	/* prologue: frame size=0 */
 923 0352 1F93      		push r17
 924               	/* prologue end (size=1) */
 925 0354 182F      		mov r17,r24
 715:mac.c         **** 
 716:mac.c         ****         mac_current_state=MAC_STATE_SYNING;
 927               	.LM98:
 928 0356 8EE0      		ldi r24,lo8(14)
 929 0358 8093 0000 		sts mac_current_state,r24
 717:mac.c         **** 	 PLME_SET_TRX_STATE_request(RX_ON);	
 931               	.LM99:
 932 035c 86E0      		ldi r24,lo8(6)
 933 035e 0E94 0000 		call PLME_SET_TRX_STATE_request
 718:mac.c         **** 	 PLME_SET_request(phyCurrentChanel_id, logicalChannel);
 935               	.LM100:
 936 0362 612F      		mov r22,r17
 937 0364 80E0      		ldi r24,lo8(0)
 938 0366 0E94 0000 		call PLME_SET_request
 719:mac.c         **** 	  if(!IS_NETWORK_FORMED)
 940               	.LM101:
 941 036a 8091 0000 		lds r24,IS_NETWORK_FORMED
 942 036e 8823      		tst r24
 943 0370 61F4      		brne .L56
 720:mac.c         **** 	  {
 721:mac.c         **** 	     cc2420_setshortaddress((uint16_t)default_short_addr.Val);
 945               	.LM102:
 946 0372 8091 0000 		lds r24,default_short_addr
 947 0376 9091 0000 		lds r25,(default_short_addr)+1
 948 037a 0E94 0000 		call cc2420_setshortaddress
 722:mac.c         **** 	     cc2420_setpanid((uint16_t)mac_pib_data.macPANId.Val);
 950               	.LM103:
 951 037e 8091 0000 		lds r24,mac_pib_data+28
 952 0382 9091 0000 		lds r25,(mac_pib_data+28)+1
 953 0386 0E94 0000 		call cc2420_setpanid
 954               	.L56:
 723:mac.c         **** 	  }	 
 724:mac.c         **** 	 //printf("\n-----the channelID is %d\n",ppib.phyCurrentChanel);
 725:mac.c         **** 	 phy_channel_state=WAITING_FOR_BEACON;
 956               	.LM104:
 957 038a 64E0      		ldi r22,lo8(4)
 958 038c 6093 0000 		sts phy_channel_state,r22
 726:mac.c         **** 	 IS_MAC_SYNING=TRUE;
 960               	.LM105:
 961 0390 81E0      		ldi r24,lo8(1)
 962 0392 8093 0000 		sts IS_MAC_SYNING,r24
 727:mac.c         **** 	 //MAC_SUPERFRAME_PERIOD=aBaseSuperframeDuration*(2<<mac_pib_data.macBeaconOrder);
 728:mac.c         **** 	 //printf("\n&&&&&&&the macbeaconorder is %04x\n",mac_pib_data.macBeaconOrder);
 729:mac.c         **** 	 MAC_SUPERFRAME_PERIOD=(uint32_t)(((uint32_t)aBaseSuperframeDuration)<<(mac_pib_data.macBeaconOrde
 964               	.LM106:
 965 0396 80EA      		ldi r24,lo8(160)
 966 0398 90E0      		ldi r25,hi8(160)
 967 039a A0E0      		ldi r26,hlo8(160)
 968 039c B0E0      		ldi r27,hhi8(160)
 969 039e 9C01      		movw r18,r24
 970 03a0 AD01      		movw r20,r26
 971 03a2 0090 0000 		lds r0,mac_pib_data+8
 972 03a6 04C0      		rjmp 2f
 973 03a8 220F      	1:	lsl r18
 974 03aa 331F      		rol r19
 975 03ac 441F      		rol r20
 976 03ae 551F      		rol r21
 977 03b0 0A94      	2:	dec r0
 978 03b2 D2F7      		brpl 1b
 979 03b4 2093 0000 		sts MAC_SUPERFRAME_PERIOD,r18
 980 03b8 3093 0000 		sts (MAC_SUPERFRAME_PERIOD)+1,r19
 981 03bc 4093 0000 		sts (MAC_SUPERFRAME_PERIOD)+2,r20
 982 03c0 5093 0000 		sts (MAC_SUPERFRAME_PERIOD)+3,r21
 730:mac.c         **** 	 //printf("\n&&&&&&&the MAC_SUPERFRAME PERIOD is %08lx\n",MAC_SUPERFRAME_PERIOD);
 731:mac.c         ****         MAC_CAP_PERIOD=(uint32_t)(((uint32_t)aBaseSuperframeDuration)<<(mac_pib_data.macSuperframeO
 984               	.LM107:
 985 03c4 0090 0000 		lds r0,mac_pib_data+42
 986 03c8 04C0      		rjmp 2f
 987 03ca 880F      	1:	lsl r24
 988 03cc 991F      		rol r25
 989 03ce AA1F      		rol r26
 990 03d0 BB1F      		rol r27
 991 03d2 0A94      	2:	dec r0
 992 03d4 D2F7      		brpl 1b
 993 03d6 8093 0000 		sts MAC_CAP_PERIOD,r24
 994 03da 9093 0000 		sts (MAC_CAP_PERIOD)+1,r25
 995 03de A093 0000 		sts (MAC_CAP_PERIOD)+2,r26
 996 03e2 B093 0000 		sts (MAC_CAP_PERIOD)+3,r27
 732:mac.c         **** 	 //head_of_timer_queue=timer3queue_start(head_of_timer_queue, TIMER_ONE_SHOT, 0, WAIT_FOR_BEACON, 
 733:mac.c         **** 	 head_of_systimer_queue=systimer_start_task(head_of_systimer_queue, SYN_WAITTING_FOR_BEACON, MAC_S
 998               	.LM108:
 999 03e6 8091 0000 		lds r24,head_of_systimer_queue
 1000 03ea 9091 0000 		lds r25,(head_of_systimer_queue)+1
 1001 03ee 0E94 0000 		call systimer_start_task
 1002 03f2 9093 0000 		sts (head_of_systimer_queue)+1,r25
 1003 03f6 8093 0000 		sts head_of_systimer_queue,r24
 734:mac.c         **** 	 Is_received_beacon=FALSE;
 1005               	.LM109:
 1006 03fa 1092 0000 		sts Is_received_beacon,__zero_reg__
 1007               	/* epilogue: frame size=0 */
 1008 03fe 1F91      		pop r17
 1009 0400 0895      		ret
 1010               	/* epilogue end (size=2) */
 1011               	/* function mlmeSyncRequest size 88 (85) */
 1013               	.Lscope11:
 1015               	.global	synrequest_task
 1017               	synrequest_task:
 1019               	.LM110:
 1020               	/* prologue: frame size=0 */
 1021               	/* prologue end (size=0) */
 1023               	.LM111:
 1024 0402 61E0      		ldi r22,lo8(1)
 1025 0404 8091 0000 		lds r24,ppib
 1026 0408 0E94 0000 		call mlmeSyncRequest
 1027               	/* epilogue: frame size=0 */
 1028 040c 0895      		ret
 1029               	/* epilogue end (size=1) */
 1030               	/* function synrequest_task size 6 (5) */
 1032               	.Lscope12:
 1034               	.global	mlmesyn_finished
 1036               	mlmesyn_finished:
 735:mac.c         **** 	 //if()
 736:mac.c         **** 	 
 737:mac.c         **** }
 738:mac.c         **** void mlmesyn_finished(void)
 739:mac.c         **** {
 1038               	.LM112:
 1039               	/* prologue: frame size=0 */
 1040 040e 6F92      		push r6
 1041 0410 7F92      		push r7
 1042 0412 8F92      		push r8
 1043 0414 9F92      		push r9
 1044 0416 AF92      		push r10
 1045 0418 BF92      		push r11
 1046 041a CF92      		push r12
 1047 041c DF92      		push r13
 1048 041e EF92      		push r14
 1049 0420 FF92      		push r15
 1050 0422 0F93      		push r16
 1051 0424 1F93      		push r17
 1052               	/* prologue end (size=12) */
 740:mac.c         ****      uint32_t  deltatime;
 741:mac.c         ****      uint32_t truetime; 
 742:mac.c         ****      uint32_t  margintime;
 743:mac.c         ****      margintime=0;	 
 744:mac.c         ****      //if((mac_current_state==MAC_STATE_SYNING_END)||(mac_current_state==MAC_STATE_IDLE))
 745:mac.c         ****      {
 746:mac.c         ****           truetime=systime32();
 1054               	.LM113:
 1055 0426 0E94 0000 		call systime32
 1056 042a 3B01      		movw r6,r22
 1057 042c 4C01      		movw r8,r24
 747:mac.c         ****           deltatime=(truetime>=last_beacon_rx_timestamp) ? truetime-last_beacon_rx_timestamp:(0x3ff
 1059               	.LM114:
 1060 042e 8091 0000 		lds r24,last_beacon_rx_timestamp
 1061 0432 9091 0000 		lds r25,(last_beacon_rx_timestamp)+1
 1062 0436 A091 0000 		lds r26,(last_beacon_rx_timestamp)+2
 1063 043a B091 0000 		lds r27,(last_beacon_rx_timestamp)+3
 1064 043e 6401      		movw r12,r8
 1065 0440 5301      		movw r10,r6
 1066 0442 A81A      		sub r10,r24
 1067 0444 B90A      		sbc r11,r25
 1068 0446 CA0A      		sbc r12,r26
 1069 0448 DB0A      		sbc r13,r27
 1070 044a 6816      		cp r6,r24
 1071 044c 7906      		cpc r7,r25
 1072 044e 8A06      		cpc r8,r26
 1073 0450 9B06      		cpc r9,r27
 1074 0452 40F4      		brsh .L59
 1076               	.LM115:
 1077 0454 8FEF      		ldi r24,lo8(1073741823)
 1078 0456 9FEF      		ldi r25,hi8(1073741823)
 1079 0458 AFEF      		ldi r26,hlo8(1073741823)
 1080 045a BFE3      		ldi r27,hhi8(1073741823)
 1081 045c A80E      		add r10,r24
 1082 045e B91E      		adc r11,r25
 1083 0460 CA1E      		adc r12,r26
 1084 0462 DB1E      		adc r13,r27
 1085               	.L59:
 748:mac.c         ****           head_of_systimer_queue=systimer_start_task(head_of_systimer_queue, CAP_OVER, (MAC_CAP_PER
 1087               	.LM116:
 1088 0464 8601      		movw r16,r12
 1089 0466 7501      		movw r14,r10
 1090 0468 1695      		lsr r17
 1091 046a 0795      		ror r16
 1092 046c F794      		ror r15
 1093 046e E794      		ror r14
 1094 0470 8091 0000 		lds r24,MAC_CAP_PERIOD
 1095 0474 9091 0000 		lds r25,(MAC_CAP_PERIOD)+1
 1096 0478 A091 0000 		lds r26,(MAC_CAP_PERIOD)+2
 1097 047c B091 0000 		lds r27,(MAC_CAP_PERIOD)+3
 1098 0480 8E19      		sub r24,r14
 1099 0482 9F09      		sbc r25,r15
 1100 0484 A00B      		sbc r26,r16
 1101 0486 B10B      		sbc r27,r17
 1102 0488 9C01      		movw r18,r24
 1103 048a AD01      		movw r20,r26
 1104 048c 62E0      		ldi r22,lo8(2)
 1105 048e 8091 0000 		lds r24,head_of_systimer_queue
 1106 0492 9091 0000 		lds r25,(head_of_systimer_queue)+1
 1107 0496 0E94 0000 		call systimer_start_task
 1108 049a FC01      		movw r30,r24
 1109 049c 9093 0000 		sts (head_of_systimer_queue)+1,r25
 1110 04a0 8093 0000 		sts head_of_systimer_queue,r24
 749:mac.c         ****           head_of_systimer_queue=systimer_start_task(head_of_systimer_queue, RECEIVE_BEACON, (MAC_S
 1112               	.LM117:
 1113 04a4 8091 0000 		lds r24,MAC_SUPERFRAME_PERIOD
 1114 04a8 9091 0000 		lds r25,(MAC_SUPERFRAME_PERIOD)+1
 1115 04ac A091 0000 		lds r26,(MAC_SUPERFRAME_PERIOD)+2
 1116 04b0 B091 0000 		lds r27,(MAC_SUPERFRAME_PERIOD)+3
 1117 04b4 8E19      		sub r24,r14
 1118 04b6 9F09      		sbc r25,r15
 1119 04b8 A00B      		sbc r26,r16
 1120 04ba B10B      		sbc r27,r17
 1121 04bc 9C01      		movw r18,r24
 1122 04be AD01      		movw r20,r26
 1123 04c0 61E0      		ldi r22,lo8(1)
 1124 04c2 CF01      		movw r24,r30
 1125 04c4 0E94 0000 		call systimer_start_task
 1126 04c8 9093 0000 		sts (head_of_systimer_queue)+1,r25
 1127 04cc 8093 0000 		sts head_of_systimer_queue,r24
 750:mac.c         ****           //printf("\n ---------beacon rx time is %08lx\n",last_beacon_rx_timestamp);
 751:mac.c         **** 	   //printf("\n----------true time is  %08lx\n",truetime);	  
 752:mac.c         ****           //printf("\n ---------cap   time is %08lx\n",MAC_CAP_PERIOD); 	
 753:mac.c         ****           //printf("\n ---------super time is %08lx\n",MAC_SUPERFRAME_PERIOD);
 754:mac.c         ****           //Leds_yellowToggle();
 755:mac.c         **** 	   	  
 756:mac.c         ****           MAC_OBJECT_CAP_START_TICKS=last_beacon_rx_timestamp;
 1129               	.LM118:
 1130 04d0 8091 0000 		lds r24,last_beacon_rx_timestamp
 1131 04d4 9091 0000 		lds r25,(last_beacon_rx_timestamp)+1
 1132 04d8 A091 0000 		lds r26,(last_beacon_rx_timestamp)+2
 1133 04dc B091 0000 		lds r27,(last_beacon_rx_timestamp)+3
 1134 04e0 8093 0000 		sts MAC_OBJECT_CAP_START_TICKS,r24
 1135 04e4 9093 0000 		sts (MAC_OBJECT_CAP_START_TICKS)+1,r25
 1136 04e8 A093 0000 		sts (MAC_OBJECT_CAP_START_TICKS)+2,r26
 1137 04ec B093 0000 		sts (MAC_OBJECT_CAP_START_TICKS)+3,r27
 757:mac.c         ****           MAC_OBJECT_CAP_END_TICKS=truetime+((MAC_CAP_PERIOD<<1)-deltatime-margintime);
 1139               	.LM119:
 1140 04f0 8091 0000 		lds r24,MAC_CAP_PERIOD
 1141 04f4 9091 0000 		lds r25,(MAC_CAP_PERIOD)+1
 1142 04f8 A091 0000 		lds r26,(MAC_CAP_PERIOD)+2
 1143 04fc B091 0000 		lds r27,(MAC_CAP_PERIOD)+3
 1144 0500 880F      		lsl r24
 1145 0502 991F      		rol r25
 1146 0504 AA1F      		rol r26
 1147 0506 BB1F      		rol r27
 1148 0508 8A19      		sub r24,r10
 1149 050a 9B09      		sbc r25,r11
 1150 050c AC09      		sbc r26,r12
 1151 050e BD09      		sbc r27,r13
 1152 0510 860D      		add r24,r6
 1153 0512 971D      		adc r25,r7
 1154 0514 A81D      		adc r26,r8
 1155 0516 B91D      		adc r27,r9
 1156 0518 8093 0000 		sts MAC_OBJECT_CAP_END_TICKS,r24
 1157 051c 9093 0000 		sts (MAC_OBJECT_CAP_END_TICKS)+1,r25
 1158 0520 A093 0000 		sts (MAC_OBJECT_CAP_END_TICKS)+2,r26
 1159 0524 B093 0000 		sts (MAC_OBJECT_CAP_END_TICKS)+3,r27
 758:mac.c         ****           MAC_OBJECT_SUPERFRAME_TICKS=truetime+((MAC_SUPERFRAME_PERIOD<<1)-deltatime-margintime);
 1161               	.LM120:
 1162 0528 8091 0000 		lds r24,MAC_SUPERFRAME_PERIOD
 1163 052c 9091 0000 		lds r25,(MAC_SUPERFRAME_PERIOD)+1
 1164 0530 A091 0000 		lds r26,(MAC_SUPERFRAME_PERIOD)+2
 1165 0534 B091 0000 		lds r27,(MAC_SUPERFRAME_PERIOD)+3
 1166 0538 880F      		lsl r24
 1167 053a 991F      		rol r25
 1168 053c AA1F      		rol r26
 1169 053e BB1F      		rol r27
 1170 0540 8A19      		sub r24,r10
 1171 0542 9B09      		sbc r25,r11
 1172 0544 AC09      		sbc r26,r12
 1173 0546 BD09      		sbc r27,r13
 1174 0548 860D      		add r24,r6
 1175 054a 971D      		adc r25,r7
 1176 054c A81D      		adc r26,r8
 1177 054e B91D      		adc r27,r9
 1178 0550 8093 0000 		sts MAC_OBJECT_SUPERFRAME_TICKS,r24
 1179 0554 9093 0000 		sts (MAC_OBJECT_SUPERFRAME_TICKS)+1,r25
 1180 0558 A093 0000 		sts (MAC_OBJECT_SUPERFRAME_TICKS)+2,r26
 1181 055c B093 0000 		sts (MAC_OBJECT_SUPERFRAME_TICKS)+3,r27
 1182               	/* epilogue: frame size=0 */
 1183 0560 1F91      		pop r17
 1184 0562 0F91      		pop r16
 1185 0564 FF90      		pop r15
 1186 0566 EF90      		pop r14
 1187 0568 DF90      		pop r13
 1188 056a CF90      		pop r12
 1189 056c BF90      		pop r11
 1190 056e AF90      		pop r10
 1191 0570 9F90      		pop r9
 1192 0572 8F90      		pop r8
 1193 0574 7F90      		pop r7
 1194 0576 6F90      		pop r6
 1195 0578 0895      		ret
 1196               	/* epilogue end (size=13) */
 1197               	/* function mlmesyn_finished size 182 (157) */
 1203               	.Lscope13:
 1204               		.data
 1205               	.LC4:
 1206 00af 0A2D 2D2D 		.string	"\n----sensor data is sent successfull-----"
 1206      2D73 656E 
 1206      736F 7220 
 1206      6461 7461 
 1206      2069 7320 
 1207               		.text
 1211               	.global	mcpsDataConfirm
 1213               	mcpsDataConfirm:
 759:mac.c         **** 	   //mac_current_state=MAC_STATE_IDLE;
 760:mac.c         ****      }
 761:mac.c         **** }
 762:mac.c         **** 
 763:mac.c         **** void mlmeSyncLossIndication(MAC_ENUM lossReason)
 764:mac.c         **** {
 765:mac.c         **** 	//ÈýÖÖÔ­Òòµ¼ÖÂMAC²ã·¢ËÍ¸ÃÔ­ÓïÍ¨Öª¸ß²ã¡£
 766:mac.c         **** 	//¿ÉÍ¨¹ýpostÒ»¸ö¸ß²ãÈÎÎñ¡£¸ß²ã¶Ô¶ªÊ§Í¬²½¿ÉÄÜÒªÖØÐÂ×ö³ö´¦Àí¡£
 767:mac.c         **** 	//¿Õº¯Êý£¬¸ß²ãÊµÏÖ
 768:mac.c         **** 	NODE_INFO dst;
 769:mac.c         **** 	//printf("\n--- a PAN ID conlict ----\n");
 770:mac.c         **** 	if(IS_COORDINATOR)
 771:mac.c         **** 	{
 772:mac.c         **** 	//¿ÉÄÜÐèÒªÖØÐÂÉèÖÃÒ»ÏÂmac²ãÍøÂç²ÎÊý
 773:mac.c         **** 	coordinator_realignment_frame_send(0, dst, default_short_addr);
 774:mac.c         **** 	mac_current_state=MAC_STATE_IDLE;
 775:mac.c         **** 	}
 776:mac.c         **** 	else
 777:mac.c         **** 	{
 778:mac.c         **** 	   if(lossReason==BEACON_LOSS)
 779:mac.c         **** 	   	//ÍøÂçÖØÆô¶¯
 780:mac.c         **** 	   	mac_current_state=MAC_STATE_UNSTARTED;
 781:mac.c         **** 	      //»òÕß
 782:mac.c         **** 	      //mac_current_state=MAC_STATE_ENERGY_SCAN_FINISHED;
 783:mac.c         **** 	}
 784:mac.c         **** }
 785:mac.c         **** 
 786:mac.c         **** //*************************//
 787:mac.c         **** void mcpsDataRequest(NODE_INFO dst, NODE_INFO src, UINT8 msduLength, BYTE *pMsdu, BYTE msduHandle, 
 788:mac.c         **** {
 789:mac.c         **** 	//MAC²ãÔÚÊÕµ½Ô­Óïºó£¬¸ù¾ÝtxOptionµÄ²ÎÊý
 790:mac.c         **** 	//ÈôÎªÖ±½ÓÍ¨ÐÅ£¬Ôòµ÷ÓÃ·¢ËÍÈÎÎñ·¢ËÍ¸ÃÊý¾ÝÖ¡
 791:mac.c         **** 	//ÈôÎª¼ä½ÓÍ¨ÐÅ,Ôò°ÑËü·Åµ½pending¶ÓÁÐÖÐ,²¢·µ»Ø¡£
 792:mac.c         **** 	FRAME_CONTROL  framectl_field;
 793:mac.c         **** 	if((txOptions&0x04)==0)
 794:mac.c         **** 		//Ö±½ÓÍ¨ÐÅ
 795:mac.c         **** 		{
 796:mac.c         **** 		data_frame_send(pMsdu, msduLength,dst,src,msduHandle);
 797:mac.c         **** 		mac_current_state=MAC_STATE_IDLE;
 798:mac.c         **** 		}
 799:mac.c         **** 	else if((dst.addrMode!=0x00)&&(dst.addrMode!=0x01))
 800:mac.c         **** 	       //¼ä½ÓÍ¨ÐÅ
 801:mac.c         **** 		{
 802:mac.c         **** 		   if((txOptions&0x01)==0)
 803:mac.c         **** 		       framectl_field.v[0]=0x01;
 804:mac.c         **** 		   else
 805:mac.c         **** 		   	framectl_field.v[0]=0x21;
 806:mac.c         **** 		   framectl_field.v[1]=0xcc&(dst.addrMode<<2)&(src.addrMode<<6);	
 807:mac.c         **** 		   if(current_pending_num<=MAX_PENDING_LIST_SIZE)
 808:mac.c         **** 	            {
 809:mac.c         **** 	                add_pending_queue(msduHandle, framectl_field, dst,src, msduLength, pMsdu,0x00,FALS
 810:mac.c         ****                        //¼ÓÈëµ½ÐÅ±êÖ¡µÄpendingÓòÖÐ
 811:mac.c         ****                        /*if(dst.addrMode==0x02)
 812:mac.c         **** 			     mac_tx_beacon.shortaddrpending_list[mac_tx_beacon.shortpendingadd_length++]=dst.shortAddr;
 813:mac.c         **** 			  else 
 814:mac.c         **** 			     mac_tx_beacon.longaddrpending_list[mac_tx_beacon.longpendingadd_length++]=dst.longAddr;
 815:mac.c         **** 			     */
 816:mac.c         **** 		     }
 817:mac.c         ****                  else
 818:mac.c         **** 			   mcpsDataConfirm(TRANSACTION_OVERFLOW, msduHandle);
 819:mac.c         **** 		   }
 820:mac.c         **** 	else   mcpsDataConfirm(INVALID_PARAMETER, msduHandle);
 821:mac.c         **** }
 822:mac.c         **** 
 823:mac.c         **** void mcpsDataConfirm(MAC_ENUM status, BYTE msduHandle)
 824:mac.c         **** {
 1215               	.LM121:
 1216               	/* prologue: frame size=0 */
 1217               	/* prologue end (size=0) */
 825:mac.c         **** 	//×÷ÎªMAC²ã¶ÔmcpsdatarequestµÄÒ»¸öÏìÓ¦£¬Í¨Öª¸ß²ã
 826:mac.c         **** 	//¿Õº¯Êý£¬¸ß²ãÊµÏÖ
 827:mac.c         **** 	printf("\n----sensor data is sent successfull-----\n");
 1219               	.LM122:
 1220 057a 80E0      		ldi r24,lo8(.LC4)
 1221 057c 90E0      		ldi r25,hi8(.LC4)
 1222 057e 0E94 0000 		call puts
 828:mac.c         **** 	mac_current_state=MAC_STATE_START_TO_SLEEP;
 1224               	.LM123:
 1225 0582 82E1      		ldi r24,lo8(18)
 1226 0584 8093 0000 		sts mac_current_state,r24
 1227               	/* epilogue: frame size=0 */
 1228 0588 0895      		ret
 1229               	/* epilogue end (size=1) */
 1230               	/* function mcpsDataConfirm size 8 (7) */
 1232               	.Lscope14:
 1233               		.data
 1234               	.LC5:
 1235 00d9 0A2D 2D2D 		.string	"\n-----success received the sensor data-------"
 1235      2D2D 7375 
 1235      6363 6573 
 1235      7320 7265 
 1235      6365 6976 
 1236               		.text
 1239               	.global	mcpsDataIndication
 1241               	mcpsDataIndication:
 829:mac.c         **** 	
 830:mac.c         **** }
 831:mac.c         **** void mcpsDataIndication(MCPS_DATA_INDICATION mcps_data_indication_info)
 832:mac.c         **** {
 1243               	.LM124:
 1244               	/* prologue: frame size=0 */
 1245 058a CF93      		push r28
 1246 058c DF93      		push r29
 1247 058e CDB7      		in r28,__SP_L__
 1248 0590 DEB7      		in r29,__SP_H__
 1249               	/* prologue end (size=4) */
 833:mac.c         **** 	//MAC½ÓÊÕµ½Ò»¸öÊý¾ÝÖ¡ºó£¬Í¨Öª¸ß²ã£¬¿ÉpostÒ»¸ö¸ß²ãÈÎÎñ
 834:mac.c         **** 	//¿Õº¯Êý£¬¸ß²ãÊµÏÖ
 835:mac.c         **** 	printf("\n-----success received the sensor data-------\n");
 1251               	.LM125:
 1252 0592 80E0      		ldi r24,lo8(.LC5)
 1253 0594 90E0      		ldi r25,hi8(.LC5)
 1254 0596 0E94 0000 		call puts
 1255               	/* epilogue: frame size=0 */
 1256 059a DF91      		pop r29
 1257 059c CF91      		pop r28
 1258 059e 0895      		ret
 1259               	/* epilogue end (size=3) */
 1260               	/* function mcpsDataIndication size 11 (4) */
 1262               	.Lscope15:
 1265               	.global	get_frame_pointer
 1267               	get_frame_pointer:
 836:mac.c         **** 	if(IS_COORDINATOR)
 837:mac.c         **** 	sensor_data_tx_to_pc(mcps_data_indication_info);
 838:mac.c         **** }
 839:mac.c         **** 
 840:mac.c         **** uint8_t  PD_DATA_indication(uint8_t psdulength,uint8_t * psdu,uint8_t ppdulinkquality,uint32_t  tim
 841:mac.c         **** {
 842:mac.c         ****     head_of_rx_buffer=add_to_rx_buffer(psdulength, psdu, ppdulinkquality,timestamp);
 843:mac.c         **** 	//printf("\nfinished add the beacon frame to the buffer\n");
 844:mac.c         ****    //printf("\npsdu->payload is %d\n",psdu[0]);	
 845:mac.c         ****     //printf("\nthe head->payload is %d",*(head_of_rx_buffer->payload));  	
 846:mac.c         ****     OS_post(mac_get_received_frame);
 847:mac.c         ****     //for(uint8_t i=0;i<psdulength;i++)
 848:mac.c         ****     //		printf("\npsdu-> [%d]--is--%02x\n",i,psdu[i]);
 849:mac.c         **** }
 850:mac.c         **** 
 851:mac.c         **** //¸ÃÈÎÎñ¸ºÔðÊÇ´ÓÎïÀí²ãÈ¡Ò»¸öÖ¡²¢½øÐÐ½âÎö
 852:mac.c         **** void  mac_get_received_frame(void)
 853:mac.c         **** {
 854:mac.c         ****       	  RX_BUFFER * current;
 855:mac.c         **** 	  uint8_t      index;
 856:mac.c         **** 	  uint8_t     i;
 857:mac.c         **** 	  index=0;
 858:mac.c         **** 	  current=head_of_rx_buffer;
 859:mac.c         **** 	  //printf("\nthe head->payload is %d",*(head_of_rx_buffer->payload));       
 860:mac.c         ****          if(tail_of_rx_buffer==head_of_rx_buffer)
 861:mac.c         **** 		 	tail_of_rx_buffer=head_of_rx_buffer->next;
 862:mac.c         ****   	  head_of_rx_buffer=head_of_rx_buffer->next;	 
 863:mac.c         ****          //¿ªÊ¼½âÎö½ÓÊÕµ½µÄÖ¡£¬°ÑËüÌîÐ´µ½mac_rx_current_frameÖÐ
 864:mac.c         ****          //È»ºóµ÷ÓÃmac_frame_rcvd½øÐÐ´¦Àí¡£
 865:mac.c         ****          mac_rx_current_frame.frameLength=(current->framelength)-2;
 866:mac.c         ****          mac_rx_current_frame.lqi=current->lqi;
 867:mac.c         ****          mac_rx_current_frame.timestamp=current->timestamp;
 868:mac.c         ****          //index++;
 869:mac.c         ****          //printf("\nthe processing received frame's current->timestamp is %08lx",current->timestam
 870:mac.c         ****          //for(index=0;index<mac_rx_current_frame.frameLength;index++)
 871:mac.c         ****          //    //printf("\nthe current->payload is %02x",*(current->payload+index));               
 872:mac.c         **** 	 //if(current->framelength==current->payload[0])                    
 873:mac.c         **** 	  	//printf("\nreceived a mac bracon frame correctly");      
 874:mac.c         **** 	  printf("\nthe received frame length  is %d\n",mac_rx_current_frame.frameLength);	
 875:mac.c         **** 	  index=1;	
 876:mac.c         **** 	  mac_rx_current_frame.frame_control_field.v[0]=current->payload[index++];
 877:mac.c         **** 	  mac_rx_current_frame.frame_control_field.v[1]=current->payload[index++];
 878:mac.c         **** 	  //printf("\nthe frame_ctl is v[0]=%02x\n",mac_rx_current_frame.frame_control_field.v[0]);
 879:mac.c         **** 	  //printf("\nthe frame_ctl is v[1]=%02x\n",mac_rx_current_frame.frame_control_field.v[1]);
 880:mac.c         **** 	  mac_rx_current_frame.macDSN=current->payload[index++];
 881:mac.c         ****          mac_rx_current_frame.logicalchannel_field=ppib.phyCurrentChanel;
 882:mac.c         **** 	  switch(mac_rx_current_frame.frame_control_field.v[1]&0x0c)
 883:mac.c         **** 	  	{
 884:mac.c         ****    	          case  MAC_DST_LONG_ADDR:
 885:mac.c         **** 			mac_rx_current_frame.dst.addrMode=MAC_DST_LONG_ADDR;
 886:mac.c         **** 		 	//Ç°Á½¸ö×Ö½Ú·ÅÄ¿µÄPANID
 887:mac.c         **** 		 	mac_rx_current_frame.dst.panID.v[0]=current->payload[index++];
 888:mac.c         **** 			mac_rx_current_frame.dst.panID.v[1]=current->payload[index++];
 889:mac.c         **** 			//ºó°Ë¸ö×Ö½Ú·Å³¤Ä¿µÄµØÖ·		 	
 890:mac.c         **** 		 	mac_rx_current_frame.dst.longAddr.v[0]=current->payload[index++];
 891:mac.c         **** 			mac_rx_current_frame.dst.longAddr.v[1]=current->payload[index++];
 892:mac.c         **** 			mac_rx_current_frame.dst.longAddr.v[2]=current->payload[index++];
 893:mac.c         **** 			mac_rx_current_frame.dst.longAddr.v[3]=current->payload[index++];
 894:mac.c         **** 			mac_rx_current_frame.dst.longAddr.v[4]=current->payload[index++];
 895:mac.c         **** 			mac_rx_current_frame.dst.longAddr.v[5]=current->payload[index++];
 896:mac.c         **** 			mac_rx_current_frame.dst.longAddr.v[6]=current->payload[index++];
 897:mac.c         **** 			mac_rx_current_frame.dst.longAddr.v[7]=current->payload[index++];
 898:mac.c         **** 		 	break;
 899:mac.c         **** 	         case  MAC_DST_SHORT_ADDR:
 900:mac.c         **** 			mac_rx_current_frame.dst.addrMode=MAC_DST_SHORT_ADDR;
 901:mac.c         **** 		 	//Ç°Á½¸ö×Ö½Ú·ÅÄ¿µÄPANID
 902:mac.c         **** 		 	mac_rx_current_frame.dst.panID.v[0]=current->payload[index++];
 903:mac.c         **** 			mac_rx_current_frame.dst.panID.v[1]=current->payload[index++];
 904:mac.c         **** 			//ºóÁ½¸ö×Ö½Ú·Å¶ÌÄ¿µÄµØÖ·
 905:mac.c         **** 		 	mac_rx_current_frame.dst.shortAddr.v[0]=current->payload[index++];
 906:mac.c         **** 			mac_rx_current_frame.dst.shortAddr.v[1]=current->payload[index++];
 907:mac.c         **** 		 	break;
 908:mac.c         **** 	        case  MAC_DST_NO_ADDR:
 909:mac.c         ****                      mac_rx_current_frame.dst.addrMode=MAC_DST_NO_ADDR;		
 910:mac.c         ****  		 	break;
 911:mac.c         **** 	        case  MAC_DST_ADDR_RESERVED:
 912:mac.c         **** 		 	error("\nreserved dst address mode is used!\n");
 913:mac.c         **** 		 	break;			
 914:mac.c         **** 	  	}
 915:mac.c         **** 	  switch(mac_rx_current_frame.frame_control_field.v[1]&0xc0)
 916:mac.c         **** 	  	{
 917:mac.c         ****    	          case  MAC_SRC_LONG_ADDR:
 918:mac.c         **** 			mac_rx_current_frame.src.addrMode=MAC_SRC_LONG_ADDR;
 919:mac.c         **** 		 	//Ç°Á½¸ö×Ö½Ú·ÅÄ¿µÄPANID
 920:mac.c         **** 		 	mac_rx_current_frame.src.panID.v[0]=current->payload[index++];
 921:mac.c         **** 			mac_rx_current_frame.src.panID.v[1]=current->payload[index++];
 922:mac.c         **** 			//ºó°Ë¸ö×Ö½Ú·Å³¤Ä¿µÄµØÖ·		 	
 923:mac.c         **** 		 	mac_rx_current_frame.src.longAddr.v[0]=current->payload[index++];
 924:mac.c         **** 			mac_rx_current_frame.src.longAddr.v[1]=current->payload[index++];
 925:mac.c         **** 			mac_rx_current_frame.src.longAddr.v[2]=current->payload[index++];
 926:mac.c         **** 			mac_rx_current_frame.src.longAddr.v[3]=current->payload[index++];
 927:mac.c         **** 			mac_rx_current_frame.src.longAddr.v[4]=current->payload[index++];
 928:mac.c         **** 			mac_rx_current_frame.src.longAddr.v[5]=current->payload[index++];
 929:mac.c         **** 			mac_rx_current_frame.src.longAddr.v[6]=current->payload[index++];
 930:mac.c         **** 			mac_rx_current_frame.src.longAddr.v[7]=current->payload[index++];
 931:mac.c         **** 		 	break;
 932:mac.c         **** 	         case  MAC_SRC_SHORT_ADDR:
 933:mac.c         **** 			mac_rx_current_frame.src.addrMode=MAC_SRC_SHORT_ADDR;
 934:mac.c         **** 		 	//Ç°Á½¸ö×Ö½Ú·ÅÄ¿µÄPANID
 935:mac.c         **** 		 	mac_rx_current_frame.src.panID.v[0]=current->payload[index++];
 936:mac.c         **** 			mac_rx_current_frame.src.panID.v[1]=current->payload[index++];
 937:mac.c         **** 			//ºóÁ½¸ö×Ö½Ú·Å¶ÌÄ¿µÄµØÖ·
 938:mac.c         **** 		 	mac_rx_current_frame.src.shortAddr.v[0]=current->payload[index++];
 939:mac.c         **** 			mac_rx_current_frame.src.shortAddr.v[1]=current->payload[index++];
 940:mac.c         **** 		 	break;
 941:mac.c         **** 	        case  MAC_SRC_NO_ADDR:
 942:mac.c         **** 			mac_rx_current_frame.src.addrMode=MAC_SRC_NO_ADDR;
 943:mac.c         **** 		 	break;
 944:mac.c         **** 	        case  MAC_SRC_ADDR_RESERVED:
 945:mac.c         **** 		 	error("\nreserved dst address mode is used!\n");
 946:mac.c         **** 		 	break;			
 947:mac.c         **** 	  	}	 
 948:mac.c         **** 	  //MHRÒÑ¾­´¦ÀíÍê±Ï
 949:mac.c         **** 	  mac_rx_current_frame.type=mac_rx_current_frame.frame_control_field.v[0]&0x07;
 950:mac.c         **** 	  switch(mac_rx_current_frame.type)
 951:mac.c         **** 	  	{
 952:mac.c         **** 	  	   case MAC_FRAME_BEACON:
 953:mac.c         **** 		   	  mac_rx_current_frame.superframe_field.SF.bytes.LSB=current->payload[index++];
 954:mac.c         **** 			  mac_rx_current_frame.superframe_field.SF.bytes.MSB=current->payload[index++];
 955:mac.c         **** 			  //GTSÓòÎª0x00
 956:mac.c         **** 			  mac_rx_current_frame.gts_char_field.bytes=current->payload[index++];
 957:mac.c         **** 			  //pending address field
 958:mac.c         **** 			  mac_rx_current_frame.pendaddress_field.bytes=current->payload[index++];
 959:mac.c         **** 			  mac_rx_current_frame.shortpendingadd_length=(mac_rx_current_frame.pendaddress_field.bytes&0x07
 960:mac.c         **** 			  mac_rx_current_frame.longpendingadd_length=(((uint8_t)((mac_rx_current_frame.pendaddress_field
 961:mac.c         **** 			  //printf("\nreceived long  pending address bytes is%d\n",mac_rx_current_frame.longpendingadd_l
 962:mac.c         **** 			  for(i=0;i<mac_rx_current_frame.shortpendingadd_length;i++)
 963:mac.c         **** 			  	{
 964:mac.c         **** 		                    mac_rx_current_frame.shortaddrpending_list[i].v[0]=current->payload[index++];
 965:mac.c         **** 				      mac_rx_current_frame.shortaddrpending_list[i].v[1]=current->payload[index++];
 966:mac.c         **** 			  	}
 967:mac.c         **** 			  for(i=0;i<mac_rx_current_frame.longpendingadd_length;i++)
 968:mac.c         **** 			  	{
 969:mac.c         **** 			  	     mac_rx_current_frame.longaddrpending_list[i].v[0]=current->payload[index++];
 970:mac.c         **** 				     mac_rx_current_frame.longaddrpending_list[i].v[1]=current->payload[index++];
 971:mac.c         **** 				     mac_rx_current_frame.longaddrpending_list[i].v[2]=current->payload[index++];
 972:mac.c         **** 				     mac_rx_current_frame.longaddrpending_list[i].v[3]=current->payload[index++];
 973:mac.c         **** 				     mac_rx_current_frame.longaddrpending_list[i].v[4]=current->payload[index++];
 974:mac.c         **** 				     mac_rx_current_frame.longaddrpending_list[i].v[5]=current->payload[index++];
 975:mac.c         **** 				     mac_rx_current_frame.longaddrpending_list[i].v[6]=current->payload[index++];
 976:mac.c         **** 				     mac_rx_current_frame.longaddrpending_list[i].v[7]=current->payload[index++];		 
 977:mac.c         **** 			  	}
 978:mac.c         **** 			  mac_rx_current_frame.beacon_payload_length=current->payload[index++];
 979:mac.c         **** 			  for(i=0;i<mac_rx_current_frame.beacon_payload_length;i++)
 980:mac.c         **** 			   	     mac_rx_current_frame.beacon_payload[i]=current->payload[index++];		 
 981:mac.c         **** 			  break;
 982:mac.c         **** 		   case MAC_FRAME_DATA:
 983:mac.c         **** 	                mac_rx_current_frame.nwk_data_length=current->payload[index++];
 984:mac.c         **** 			  for(i=0;i<mac_rx_current_frame.nwk_data_length;i++)
 985:mac.c         **** 			            mac_rx_current_frame.nwk_data_payload[i]=current->payload[index++];
 986:mac.c         **** 		         break;
 987:mac.c         **** 		   case MAC_FRAME_ACK:
 988:mac.c         **** 		   	  //no payload
 989:mac.c         **** 		   	  
 990:mac.c         **** 		         break;
 991:mac.c         **** 		   case MAC_FRAME_CMD:
 992:mac.c         **** 		   	  mac_rx_current_frame.cmd=current->payload[index++];
 993:mac.c         **** 			  switch(mac_rx_current_frame.cmd)
 994:mac.c         **** 			  	{
 995:mac.c         **** 			  	    case  MAC_CMD_ASSOCIATE_REQ:
 996:mac.c         **** 					   //printf("\nindex is %d\n",index);	
 997:mac.c         **** 					   mac_rx_current_frame.node_capinfo_field.bytes=current->payload[index++];
 998:mac.c         **** 					   break;
 999:mac.c         **** 				    case  MAC_CMD_ASSOCIATE_RPLY:
1000:mac.c         **** 					   mac_rx_current_frame.shortaddralloc.v[0]=current->payload[index++];
1001:mac.c         **** 					   mac_rx_current_frame.shortaddralloc.v[1]=current->payload[index++];
1002:mac.c         **** 					   mac_rx_current_frame.association_status=current->payload[index++];
1003:mac.c         **** 					   //printf("\n----the short alloc addr is %04x---\n",mac_rx_current_frame.shortaddralloc.Val)
1004:mac.c         **** 					   //printf("\nthe associate status is %02x\n",mac_rx_current_frame.association_status);
1005:mac.c         **** 					   break;
1006:mac.c         **** 				    case  MAC_CMD_BEACON_REQ:
1007:mac.c         **** 					   break;
1008:mac.c         **** 				    case  MAC_CMD_COORD_REALIGNMENT:
1009:mac.c         **** 					   mac_rx_current_frame.PAN_ID_field.v[0]=current->payload[index++];
1010:mac.c         **** 					   mac_rx_current_frame.PAN_ID_field.v[1]=current->payload[index++];
1011:mac.c         **** 					   mac_rx_current_frame.coordshortaddr_field.v[0]=current->payload[index++];
1012:mac.c         **** 					   mac_rx_current_frame.coordshortaddr_field.v[1]=current->payload[index++];
1013:mac.c         **** 					   mac_rx_current_frame.logicalchannel_field=current->payload[index++];
1014:mac.c         **** 					   mac_rx_current_frame.shortaddrallocted.v[0]=current->payload[index++];
1015:mac.c         **** 					   mac_rx_current_frame.shortaddrallocted.v[1]=current->payload[index++];
1016:mac.c         **** 					   break;
1017:mac.c         **** 				    case  MAC_CMD_DATA_REQ:
1018:mac.c         **** 					   break;
1019:mac.c         **** 				    case  MAC_CMD_DISASSOCIATE_NOTICE:
1020:mac.c         **** 					   mac_rx_current_frame.disassociation_reason=current->payload[index++];
1021:mac.c         **** 					   break;
1022:mac.c         **** 				    case  MAC_CMD_GTS_REQ:
1023:mac.c         **** 					   break;
1024:mac.c         **** 				    case  MAC_CMD_ORPHAN_NOTICE:
1025:mac.c         **** 					   break;	
1026:mac.c         **** 				    case  MAC_CMD_PAN_ID_CONFLICT:
1027:mac.c         **** 					   break;	
1028:mac.c         **** 			  	}
1029:mac.c         **** 		         break;	
1030:mac.c         **** 	  	}
1031:mac.c         ****         if((index-1)!=mac_rx_current_frame.frameLength)
1032:mac.c         ****    	  {
1033:mac.c         ****    	    //printf("\nthe received frame length  is %d\n",mac_rx_current_frame.frameLength);
1034:mac.c         **** 	    //printf("\nthe index is %d\n",index-1);	  
1035:mac.c         **** 	      error("\n!!!received frame length error\n");	  
1036:mac.c         **** 	      return;
1037:mac.c         ****          }
1038:mac.c         **** 	  remove_from_rx_buffer(current);
1039:mac.c         **** 	  //¿ªÊ¼½øÐÐÖ¡´¦Àí
1040:mac.c         **** 	  mac_frame_rcvd();
1041:mac.c         **** }
1042:mac.c         **** 
1043:mac.c         **** //MAC²ãÔÚÊÕµ½Ò»¸öÖ¡ºóÈçºÎ´¦Àí¸ÃÖ¡º¯Êý
1044:mac.c         **** //ÒÀ¾Ýmac_rx_current_frameÖÐµÄ½á¹¹³ÉÔ±½øÐÐ´¦Àí
1045:mac.c         **** void mac_frame_rcvd(void)
1046:mac.c         **** {
1047:mac.c         ****        //ackÖ¡µÄ·¢ËÍÒÑ¾­°´ÕÕÒªÇóÍê³ÉºóÔÙµ÷ÓÃ¸Ãº¯Êý
1048:mac.c         **** 	//--------------------------------------------------------
1049:mac.c         **** 	//--------------------------------------------------------
1050:mac.c         **** 	//--------------------------------------------------------
1051:mac.c         **** 	TX_BUFFER  * p_frame;
1052:mac.c         **** 	uint8_t  i;
1053:mac.c         ****        switch(mac_rx_current_frame.type)
1054:mac.c         ****        	{
1055:mac.c         ****        	     case MAC_FRAME_ACK:
1056:mac.c         **** 	                 //printf("\ncurrent ack frame dsn is %d\n",mac_rx_current_frame.macDSN);
1057:mac.c         **** 	                 //head_of_timer_queue=timer3quere_cancel(head_of_timer_queue, mac_rx_current_fram
1058:mac.c         **** 			   p_frame=get_frame_pointer(mac_rx_current_frame.macDSN);
1059:mac.c         **** 			   if(p_frame==NULL) 
1060:mac.c         **** 			   	break;
1061:mac.c         **** 	                 switch(p_frame->cmd_type)
1062:mac.c         **** 	                	{
1063:mac.c         **** 	                	       case  MAC_CMD_ASSOCIATE_REQ:
1064:mac.c         **** 	                               printf("\nsuccess receive a association req ack frame\n");
1065:mac.c         **** 					   //printf("---receive ack time is  %08lx---",mac_rx_current_frame.timestamp); 				 
1066:mac.c         ****                                         if(mac_current_state==MAC_STATE_ASSOC_REQ_SENT)
1067:mac.c         ****                                         {
1068:mac.c         **** 		                              mac_current_state=MAC_STATE_ASSOC_WAIT_FOR_RESPONSE;
1069:mac.c         **** 		                              //head_of_timer_queue=timer3queue_start(head_of_timer_queue, TIMER_
1070:mac.c         **** 						  //printf("\ntimer3 is start\n");			  
1071:mac.c         ****                                         }				  
1072:mac.c         **** 					     //ÊÇ·ñÐèÒªÖÃÎïÀíÉäÆµÐÅµÀÎª½ÓÊÕ×´Ì¬??
1073:mac.c         **** 					     break;
1074:mac.c         ****                                    case MAC_CMD_DATA_REQ:
1075:mac.c         **** 	                                 printf("\nsuccess received the data request ack\n");
1076:mac.c         **** 					     if(!IS_NETWORK_FORMED)	 
1077:mac.c         **** 					     	{
1078:mac.c         **** 	                                 head_of_timer_queue=timer3queue_start(head_of_timer_queue, TIMER_
1079:mac.c         **** 				            phy_channel_state=PHY_IDLE;
1080:mac.c         **** 					     mac_current_state=MAC_STATE_ASSOC_WAIT_FOR_RESPONSE;
1081:mac.c         **** 					     PLME_SET_TRX_STATE_request(RX_ON);
1082:mac.c         **** 					     	}
1083:mac.c         **** 						 
1084:mac.c         **** 	                                 break;
1085:mac.c         **** 	      //-----//ÏÂÃæÎåÖÖÇéÐÎÖ»ÐèÅÐ¶ÏÏµÍ³MAC²ã×´Ì¬²»ÎªÉÏÃæµÄ×´Ì¬¼´¿É¡£     
1086:mac.c         **** 	                           case  0x00://²»ÊÇÃüÁîÖ¡
1087:mac.c         **** 	      //Èç¹ûÎªdata frameµÄackÖ¡,ÔÚÍê³ÉÉÏÃæµÄÈÎÎñºó
1088:mac.c         **** 	           //ÏòÉÏ²ã·¢ËÍmcps-data.comfirmÔ­Óï£¬ÏÔÊ¾³É¹¦·¢ËÍÊý¾ÝÖ¡  
1089:mac.c         **** 	                                 mcpsDataConfirm(SUCCESS, p_frame->FrameHandle);
1090:mac.c         **** 	                                 break; 
1091:mac.c         **** 	                           case  MAC_CMD_PAN_ID_CONFLICT:
1092:mac.c         **** 	      //Èç¹ûÎªPANID confilict notificationµÄackÖ¡£¬ÔÚÍê³ÉÉÏÃæµÄÈÎÎñºó
1093:mac.c         **** 	           //È·¶¨Ð­µ÷ÕßÒÑ¾­ÊÕµ½¸ÃÖ¡¡£ÕýÈ··µ»Ø.
1094:mac.c         **** 	                                 //ÎÞÊÂ¿É×ö  
1095:mac.c         **** 	                                 break;
1096:mac.c         **** 	                           case  MAC_CMD_DISASSOCIATE_NOTICE:
1097:mac.c         **** 	      //Èç¹ûÎªdisassociation notificationµÄackÖ¡£¬ÔÚÍê³ÉÉÏÃæµÄÈÎÎñºó
1098:mac.c         **** 	           //ÏòÉÏ²ã·¢ËÍmlme-disassociation.confirmÔ­Óï,·µ»Ø×´Ì¬³É¹¦
1099:mac.c         **** 	                                 mlmeDisassociateConfirm(SUCCESS);
1100:mac.c         **** 	                                 break;
1101:mac.c         **** 	                           case MAC_CMD_ASSOCIATE_RPLY:
1102:mac.c         **** 	      //Èç¹ûÎªassociate responseµÄackÖ¡£¬ÔÚÍê³ÉÉÏÃæµÄÈÎÎñºó
1103:mac.c         **** 	           //ÏòÉÏ²ã·¢ËÍmlme-comm-statusÔ­Óï£¬ÏÔÊ¾ÏìÓ¦Ö¡·¢ËÍ³É¹¦
1104:mac.c         **** 	                                 //mlmeCommStatusIndication(WORD panId, BYTE srcAddrMode, ADDRESS 
1105:mac.c         **** 	                                 //
1106:mac.c         **** 	                                 break;
1107:mac.c         **** 	                           case MAC_CMD_COORD_REALIGNMENT:
1108:mac.c         **** 	      //Èç¹ûÎªcoordinator realignmentµÄackÖ¡(×¢Òâ:Èç¹û·¢ËÍ¸ÃÖ¡Ê±ºò²»ÊÇ¹ã²¥£¬²Å¿ÉÄÜÒªÇóack)£¬ÔÚÍê³É
1109:mac.c         **** 	           //NOTE:¸ÃÖ¡¿Ï¶¨ÊÇÐ­µ÷ÕßÊÕµ½orphanÇëÇóºó·¢³öµÄ¡£(mlme-start.request·¢³öµÄrealignmentÖ¡ÊÇ
1110:mac.c         **** 	           //ÏòÉÏ²ã·¢ËÍmlme-comm-statusÔ­Óï£¬ÏÔÊ¾¸ÃÖ¡·¢ËÍ³É¹¦(pg87)
1111:mac.c         **** 	                                 //mlmeCommStatusIndication(WORD panId, BYTE srcAddrMode, ADDRESS 
1112:mac.c         **** 	                                 break; 
1113:mac.c         **** 	      //ÉÏÊöÇé¿ö´¦ÀíÍê±Ï£¬ÊÍ·Å·¢ËÍÖ¡Õ¼ÓÃµÄ´æ´¢¿Õ¼ä
1114:mac.c         **** 	                	}
1115:mac.c         **** 	                     remove_tx_queue(mac_rx_current_frame.macDSN);
1116:mac.c         **** 	                     break;
1117:mac.c         ****                        case MAC_FRAME_BEACON:
1118:mac.c         **** 	                      if(IS_FFD!=0x00)
1119:mac.c         **** 				      mlmeSyncLossIndication(PAN_ID_CONFLICT);
1120:mac.c         **** 			        else 
1121:mac.c         **** 			        	{   
1122:mac.c         **** 			                   last_beacon_rx_timestamp=mac_rx_current_frame.timestamp;
1123:mac.c         **** 					     if(IS_MAC_SYNING)
1124:mac.c         **** 					     	{
1125:mac.c         **** 						 	//head_of_timer_queue=timer3quere_cancel(head_of_timer_queue,0, WAIT_FOR_BEACON);
1126:mac.c         **** 						 	head_of_systimer_queue=systimer_stop_task(head_of_systimer_queue, SYN_WAITTING_FOR_BEACON);
1127:mac.c         ****                                                  //Í¬²½Íê±Ï
1128:mac.c         ****                                                  mac_current_state=MAC_STATE_SYNING_END;
1129:mac.c         **** 							IS_MAC_SYNING=FALSE;
1130:mac.c         **** 							last_beacon_rx_timestamp=mac_rx_current_frame.timestamp;
1131:mac.c         **** 							mlmesyn_finished();
1132:mac.c         **** 							phy_channel_state=PHY_IDLE;
1133:mac.c         **** 							PLME_SET_TRX_STATE_request(RX_ON);
1134:mac.c         **** 							Is_received_beacon=TRUE;
1135:mac.c         **** 							loss_sync_number=0;
1136:mac.c         **** 							printf("\n------synchronizing success------ \n");
1137:mac.c         **** 							
1138:mac.c         **** 							//mlme
1139:mac.c         **** 			        	       }
1140:mac.c         **** 			        	     else if((mac_rx_current_frame.beacon_payload_length!=0)||(!mac_pib_data.macAutoReq
1141:mac.c         **** 			        	     	{
1142:mac.c         **** 			        	     	    mac_pib_data.macCoordShortAddress=mac_rx_current_frame.src.shortAddr;
1143:mac.c         **** 			        	     	    beacon_info.bsn=mac_rx_current_frame.macDSN;
1144:mac.c         **** 						    beacon_info.sduLength=mac_rx_current_frame.beacon_payload_length;
1145:mac.c         **** 						    beacon_info.pendAddrSpec=mac_rx_current_frame.pendaddress_field.bytes;
1146:mac.c         **** 						    beacon_info.shortpendingadd_length=mac_rx_current_frame.shortpendingadd_length;
1147:mac.c         **** 						    beacon_info.longpendingadd_length=mac_rx_current_frame.longpendingadd_length;
1148:mac.c         **** 						    for(i=0;i<beacon_info.shortpendingadd_length;i++)
1149:mac.c         **** 								beacon_info.shortaddrpending_list[i]=mac_rx_current_frame.shortaddrpending_list[i];
1150:mac.c         **** 						    for(i=0;i<beacon_info.longpendingadd_length;i++)
1151:mac.c         **** 								beacon_info.longaddrpending_list[i]=mac_rx_current_frame.longaddrpending_list[i];
1152:mac.c         **** 						    for(i=0;i<beacon_info.sduLength;i++)
1153:mac.c         **** 								beacon_info.pSdu[i]=mac_rx_current_frame.beacon_payload[i];
1154:mac.c         **** 						    beacon_info.panDescriptor.coordinator=mac_rx_current_frame.src;
1155:mac.c         **** 						    beacon_info.panDescriptor.timeStamp=mac_rx_current_frame.timestamp;
1156:mac.c         **** 						    beacon_info.panDescriptor.linkQuality=mac_rx_current_frame.lqi;
1157:mac.c         **** 						    beacon_info.panDescriptor.superframeSpec=mac_rx_current_frame.superframe_field;
1158:mac.c         **** 					           //printf("\n-----the superframe field is %04x\n",mac_rx_current_frame.superframe_fi
1159:mac.c         **** 						    beacon_info.panDescriptor.logicalChannel=mac_rx_current_frame.logicalchannel_field;
1160:mac.c         **** 						    //ÆäËûÓò±¾°æ±¾²»Ìá¹©Ö§³Ö¡£	
1161:mac.c         **** 						    //Leds_greenToggle();                                 						    
1162:mac.c         **** 						    //printf("\nfinished function mac_frame_rcvd()\n");
1163:mac.c         **** 						    //printf("\nbeacon frame received\n");
1164:mac.c         **** 						    if((mac_current_state_saved==MAC_STATE_ASSOC_WAIT_FOR_RESPONSE)||(mac_current_state_saved
1165:mac.c         **** 						       {mac_current_state=mac_current_state_saved;}
1166:mac.c         **** 						    mlmeBeaconNotifyIndication(beacon_info); 
1167:mac.c         **** 						   if(mac_current_state!=MAC_STATE_ACTIVE_PASSIVE_SCAN)	
1168:mac.c         **** 						    	{
1169:mac.c         **** 						            Is_received_beacon=TRUE;
1170:mac.c         **** 						            mlmesyn_finished();
1171:mac.c         **** 							     //printf("mac_current_state_saved is %d",mac_current_state_saved);		
1172:mac.c         **** 							     //mac_current_state=mac_current_state_saved;
1173:mac.c         **** 						            phy_channel_state=PHY_IDLE;	
1174:mac.c         **** 						            PLME_SET_TRX_STATE_request(RX_ON);	 
1175:mac.c         **** 						            //Is_received_beacon=TRUE;	 
1176:mac.c         **** 							     //-------------------------------------		
1177:mac.c         **** 							     //mac_current_state=MAC_STATE_SYNING_END;		
1178:mac.c         **** 						            //printf("\n------synchronizing success------ \n");	 
1179:mac.c         **** 						    	}
1180:mac.c         **** 						     
1181:mac.c         **** 			        	            }
1182:mac.c         **** 			        	}
1183:mac.c         **** 	                      break;
1184:mac.c         **** 	                case   MAC_FRAME_DATA: 
1185:mac.c         **** 	  //Èç¹ûÊÕµ½µÄÎªdata frame
1186:mac.c         **** 	  	  //È·¶¨ÏµÍ³ÎªÕý³£¹¤×÷×´Ì¬ºó£¬ÊÕÏÂ¸ÃÖ¡£¬²¢Í¨¹ýÔ­ÓïmcpsDataIndicationÏò¸ß²ã±¨¸æ¡£
1187:mac.c         **** 	  	  //²¢²é¿´Êý¾ÝÖ¡ÖÐµÄpendingÓò£¬Èç¹û»¹ÓÐÊý¾ÝÖ¡£¬Ôò¼ÌÐøÆô¶¯·¢ËÍdata request½ø³Ì.
1188:mac.c         ****                                   //printf("\n---received the data frame1----\n");
1189:mac.c         **** 	                           
1190:mac.c         **** 				       if(mac_current_state==MAC_STATE_IDLE)
1191:mac.c         ****                              	{
1192:mac.c         ****                              	  //printf("\n---received the data frame2----\n");
1193:mac.c         ****                              	    mcps_data_indication_info.src=mac_rx_current_frame.src;
1194:mac.c         **** 					    //for(uint8_t i=0;i<8;i++)
1195:mac.c         **** 						//	printf("\nthe src addr[%d] is %x\n",i,mcps_data_indication_info.src.longAddr.v[i]);
1196:mac.c         **** 					    mcps_data_indication_info.dst=mac_rx_current_frame.dst;
1197:mac.c         **** 					    mcps_data_indication_info.mpduLinkQuality=mac_rx_current_frame.lqi;
1198:mac.c         **** 					   mcps_data_indication_info.msduLength=mac_rx_current_frame.nwk_data_length;
1199:mac.c         **** 					    for(i=0;i<mcps_data_indication_info.msduLength;i++)
1200:mac.c         **** 							mcps_data_indication_info.pMsdu[i]=mac_rx_current_frame.nwk_data_payload[i];
1201:mac.c         ****                              	    mcpsDataIndication(mcps_data_indication_info);
1202:mac.c         **** 									
1203:mac.c         ****                              	}
1204:mac.c         **** 	                      break;
1205:mac.c         ****                        case   MAC_FRAME_CMD:
1206:mac.c         **** 			       switch(mac_rx_current_frame.cmd)
1207:mac.c         **** 			       	{
1208:mac.c         **** 			       	        case  MAC_CMD_ASSOCIATE_REQ:
1209:mac.c         **** 	  //Èç¹ûÊÕµ½µÄÎªassociation requestÖ¡(Ö»ÓÐÐ­µ÷ÕßµÄ´úÂë²Å²Î¼Ó±àÒë)
1210:mac.c         **** 	      //È·¶¨ÏµÍ³ÎªÕý³£¹¤×÷×´Ì¬ºó(ÍøÂçÒÑ¾­½¨ºÃ)£¬ÊÕÏÂ¸ÃÖ¡ºó,Í¨¹ýmlmeAssociateIndicationÔ­ÓïÍ¨Öª¸ß²ã
1211:mac.c         ****                                                  //printf("\n----------------sucess received a asso
1212:mac.c         **** 							if((mac_current_state==MAC_STATE_IDLE)&&(IS_FFD!=0x00))
1213:mac.c         **** 	                                         	{
1214:mac.c         **** 	                                         	    //printf("\n----------------sucess received a associ
1215:mac.c         **** 	                                              mlme_associate_indication_info.cap_info=mac_rx_curre
1216:mac.c         **** 	                                              mlme_associate_indication_info.Deviceaddr=mac_rx_cur
1217:mac.c         **** 	                                              mlmeAssociateIndication(mlme_associate_indication_in
1218:mac.c         **** 	                                         	}
1219:mac.c         ****                                                 break;
1220:mac.c         **** 						 case  MAC_CMD_ASSOCIATE_RPLY:
1221:mac.c         **** 	   //Èç¹ûÊÕµ½µÄÎªassociation responseÖ¡
1222:mac.c         **** 	      //È·¶¨ÏµÍ³MAC¹¤×÷×´Ì¬Îªwaittingforresponse×´Ì¬(ÒÑ¾­·¢ËÍdata request²¢ÊÕµ½ack),È¡Ïû¶¨Ê±¶ÓÁÐÖÐ
1223:mac.c         **** 	      //¿ªÊ¼´¦Àí¾ßÌå¹¤×÷¡£±£´æÊÕµ½µÄÐ­µ÷Õß¶ÔÓ¦µÄ²ÎÊý£¬ÉèÖÃ¶ÔÓ¦µÄPIB±äÁ¿
1224:mac.c         **** 	      //Èç¹û³É¹¦¹ØÁª£¬Ôò¸Ä±äÏµÍ³MAC×´Ì¬ÎªÕý³£¹¤×÷×´Ì¬
1225:mac.c         **** 	      //·¢ËÍmlme-associate.confirmÔ­ÓïÏÔÊ¾×´Ì¬
1226:mac.c         **** 	                                         //printf("\n-------success received a association reply f
1227:mac.c         **** 	                                         if((mac_current_state==MAC_STATE_ASSOC_WAIT_FOR_RESPONSE)
1228:mac.c         **** 	                                         	{
1229:mac.c         **** 	                                         	   printf("\n-------success received a association reply
1230:mac.c         **** 	                                         	   head_of_timer_queue=timer3quere_cancel(head_of_timer_
1231:mac.c         **** 							   mac_current_state=MAC_STATE_IDLE;
1232:mac.c         **** 							   mlmeAssociateConfirm(mac_rx_current_frame.shortaddralloc, mac_rx_current_frame.associatio
1233:mac.c         **** 	                                         	}
1234:mac.c         **** 	                                         break;
1235:mac.c         ****                                            case  MAC_CMD_DISASSOCIATE_NOTICE:
1236:mac.c         **** 	   //Èç¹ûÊÕµ½µÄÎªdisassociation notificationÖ¡(Ð­µ÷ÕßºÍenddevice¶¼ÓÐ¿ÉÄÜÊÕµ½¸ÃÖ¡):
1237:mac.c         **** 	      //ÈôÎªÐ­µ÷ÕßÊÕµ½¸ÃÖ¡£¬ÔòÐèÒªÍ¨¹ýmlmeDisassociateIndicationÔ­Óï±¨¸æ¸ø¸ß²ã£¬²¢É¾³ýÏàÓ¦µÄenddev
1238:mac.c         **** 	      //ÈôÎªÖÕ¶ËÉè±¸ÊÕµ½¸ÃÖ¡£¬ÔòÍ¬ÑùÐèÒªÍ¨¹ýmlmeDisassociateIndicationÔ­Óï±¨¸æ¸ø¸ß²ã,²¢É¾³ýÏàÓ¦µÄP
1239:mac.c         **** 	      //ÐÞ¸ÄÏµÍ³µÄMAC²ãµÄ×´Ì¬±äÁ¿ÎªÎ´¹ØÁª×´Ì¬
1240:mac.c         **** 	                                         if((IS_FFD!=0x00))
1241:mac.c         **** 	                                         	{
1242:mac.c         **** 	                                         	    
1243:mac.c         **** 	                                         	    mlmeDisassociateIndication(mac_rx_current_frame.src.
1244:mac.c         **** 	                                         	}
1245:mac.c         **** 						      else
1246:mac.c         **** 						      	{
1247:mac.c         **** 						      	  //printf("\n--received a disassociation notice frame---\n");
1248:mac.c         **** 	                                         	    //if(mac_current_state==MAC_STATE_IDLE)
1249:mac.c         **** 	                                         	    {
1250:mac.c         **** 	                                         	         head_of_timer_queue=timer3quere_cancel(head_of_
1251:mac.c         **** 								  mac_current_state=MAC_STATE_DISASSOCIATED;
1252:mac.c         **** 	                                         	         mlmeDisassociateIndication(mac_rx_current_frame
1253:mac.c         **** 							         
1254:mac.c         **** 	                                         	     };
1255:mac.c         **** 						      	}
1256:mac.c         **** 	                                         break;
1257:mac.c         ****                                            case MAC_CMD_DATA_REQ:
1258:mac.c         **** 	   //Èç¹ûÊÕµ½µÄÎªdata requestÖ¡(Ö»ÓÐÐ­µ÷ÕßµÄ´úÂë²Å²Î¼Ó±àÒë)
1259:mac.c         **** 	      //Æô¶¯Ò»¸öÊý¾Ý·¢ËÍÈÎÎñ:¸ù¾Ýdata requestÖ¡ÖÐµÄÔ´µØÖ·£¬´Ópending¶ÓÁÐÖÐÑ¡ÔñÊý¾Ý½øÐÐ·¢ËÍ,Èç¹ûÃ»Ó
1260:mac.c         **** 	      //½ø³ÌÖ±½Ó·µ»Ø¡£
1261:mac.c         **** 	                                         if(IS_FFD!=0x00)
1262:mac.c         **** 	                                         	{
1263:mac.c         **** 	                                         	   //printf("\ndata request frame received\n");
1264:mac.c         **** 	                                             pending_data_send(mac_rx_current_frame.src);
1265:mac.c         **** 	                                         	}
1266:mac.c         **** 	                                         break;
1267:mac.c         **** 	                                    case MAC_CMD_PAN_ID_CONFLICT:
1268:mac.c         **** 	  //Èç¹ûÊÕµ½µÄÎªPANID confilictÖ¡(Ö»ÓÐÐ­µ÷ÕßµÄ´úÂë²Å²Î¼Ó±àÒë)
1269:mac.c         **** 	      //Ð­µ÷ÕßÕý´¦ÓÚÕý³£µÄ¹¤×÷×´Ì¬(ÍøÂçÒÑ¾­½¨ºÃ)£¬ÔòÐèÒªÍ¨¹ýmlmeSyncLossIndicationÔ­ÓïÍ¨Öª¸ß²ã,ÆäÖ
1270:mac.c         **** 	                                         	{
1271:mac.c         **** 	                                         	    mlmeSyncLossIndication(PAN_ID_CONFLICT);
1272:mac.c         **** 							    
1273:mac.c         **** 							    //mac_current_state=MAC_STATE_ID_CONFLICT;
1274:mac.c         **** 	                                         	}
1275:mac.c         **** 	                                         break;
1276:mac.c         ****                                            case MAC_CMD_ORPHAN_NOTICE:
1277:mac.c         **** 	  //Èç¹ûÊÕµ½µÄÎªOrphan notificationÖ¡(Ö»ÓÐÐ­µ÷ÕßµÄ´úÂë²Å²Î¼Ó±àÒë)
1278:mac.c         **** 	      //Ñ°ÕÒ¶ÔÓ¦ÖÕ¶ËÉè±¸µÄ¹ØÁª¼ÇÂ¼,Èç¹ûÕÒµ½£¬Ôòµ÷ÓÃ·¢ËÍ½ø³Ì£¬·¢ËÍrealignmentÖ¡¸ø¶ÔÓ¦Éè±¸¡£
1279:mac.c         **** 	      //Èç¹ûÃ»ÓÐÕÒµ½¶ÔÓ¦¼ÇÂ¼£¬Ôòdiscard¸ÃÖ¡
1280:mac.c         **** 	                                         if((mac_current_state==MAC_STATE_IDLE)&&(IS_FFD!=0x00))
1281:mac.c         **** 	                                         {
1282:mac.c         **** 	                                         	    mlmeOrphanIndication(mac_rx_current_frame.src.longAd
1283:mac.c         **** 	                                         	    //coordinator_realignment_frame_send();ÓÉmlme-orphan
1284:mac.c         **** 	                                         }
1285:mac.c         **** 	                                         break;
1286:mac.c         ****                                            case MAC_CMD_BEACON_REQ:
1287:mac.c         **** 	  //Èç¹ûÊÕµ½µÄÎªBeacon requestÖ¡(Ö»ÓÐFFDµÄ´úÂë²Å²Î¼Ó±àÒë)
1288:mac.c         **** 	      //ÓÉÓÚÎÒÃÇÊµÏÖµÄÊÇÐÅ±êÊ¹ÄÜÍøÂç£¬ËùÒÔºöÂÔµô¸ÃÖ¡£¬°´ÖÜÆÚ·¢ËÍÐÅ±êÖ¡¾ÍOK¡£
1289:mac.c         **** 	                                        break;
1290:mac.c         ****                                            case MAC_CMD_COORD_REALIGNMENT:
1291:mac.c         **** 	  //Èç¹ûÊÕµ½µÄÎªCoordinator realignmentÖ¡
1292:mac.c         **** 	      //ÈôÏµÍ³MAC²ãÒÑ¾­´¦ÓÚÕý³£¹¤×÷×´Ì¬(ÍøÂçÒÑ¾­½¨ºÃ)£¬Ôòµ÷ÓÃmlmeSyncLossIndicationÍ¨Öª¸ß²ã£¬ÆäÖÐl
1293:mac.c         **** 	      //ÈôÏµÍ³MAC²ãÕý´¦ÓÚORPHAN SCAN×´Ì¬£¬ÔòÈ¡Ïû¶¨Ê±¶ÓÁÐÖÐ¶ÔÓ¦µÄµÈ´ýÈÎÎñ£¬²¢¼ÇÂ¼¸ÃÖ¡ÖÐµÄ²ÎÊý£¬È»ºó
1294:mac.c         **** 	                                        if(!IS_COORDINATOR)
1295:mac.c         **** 	                                        {
1296:mac.c         **** 	                                            if(mac_current_state==MAC_STATE_ORPHAN_SCAN)
1297:mac.c         **** 	                                            {
1298:mac.c         **** 
1299:mac.c         **** 								printf("\n---success received the coordinator realignment frame----\n");					 
1300:mac.c         **** 	                                                 
1301:mac.c         **** 	                                                 //NOTE:×öorphanscanÊ±ºòÉèÖÃµÄÊÇwait_for_response.
1302:mac.c         **** 								head_of_timer_queue=timer3quere_cancel(head_of_timer_queue, 0, WAIT_FOR_RESPONSE);
1303:mac.c         ****                                                         mac_pib_data.macCoordShortAddress=mac_rx_cu
1304:mac.c         **** 							       mac_pib_data.macPANId=mac_rx_current_frame.PAN_ID_field;
1305:mac.c         **** 								//---------------------------------------------
1306:mac.c         **** 								//------------´ýÌí¼Ó-----------------------
1307:mac.c         **** 								//ÉèÖÃÎïÀíÂß¼­ÐÅµÀ--------------------
1308:mac.c         **** 								//---------------------------------------------
1309:mac.c         **** 								mac_pib_data.macShortAddress=mac_rx_current_frame.shortaddrallocted;
1310:mac.c         **** 								mac_pib_data.macCoordExtendedAddress=mac_rx_current_frame.src.longAddr;
1311:mac.c         **** 	                                         	       scan_result_info.status=SUCCESS;
1312:mac.c         **** 	                                         	       scan_result_info.scanType=ORPHAN_SCAN;
1313:mac.c         **** 								mac_current_state=MAC_STATE_IDLE;
1314:mac.c         **** 	                                         	       mlmeScanConfirm(scan_result_info);
1315:mac.c         **** 	                                         	       
1316:mac.c         **** 	                                            }	
1317:mac.c         **** 							  else
1318:mac.c         **** 							  {
1319:mac.c         **** 							       //
1320:mac.c         **** 							     //printf("\n---success received a broadcast realignment frame----\n");
1321:mac.c         ****                                                         /*mac_pib_data.macCoordShortAddress=mac_rx_
1322:mac.c         **** 							       mac_pib_data.macPANId=mac_rx_current_frame.PAN_ID_field;
1323:mac.c         **** 								mac_pib_data.macCoordExtendedAddress=mac_rx_current_frame.src.longAddr;
1324:mac.c         **** 								mac_current_state=MAC_STATE_REALIGNMENT;
1325:mac.c         ****                                                         mlmeSyncLossIndication(REALIGNMENT);
1326:mac.c         ****                                                         */
1327:mac.c         **** 							  }
1328:mac.c         **** 	                                        }
1329:mac.c         ****                                                break;
1330:mac.c         **** 				   }
1331:mac.c         **** 	  //ÆäËûÇéÐÎ£¬discardÊÕµ½µÄÖ¡¡£
1332:mac.c         **** 	                   break;
1333:mac.c         ****        	}
1334:mac.c         **** 	   
1335:mac.c         **** }
1336:mac.c         **** 
1337:mac.c         **** 
1338:mac.c         **** 
1339:mac.c         **** 
1340:mac.c         **** //ÒÔÏÂÎª¸÷Ö¡µÄ·¢ËÍº¯Êý£¬
1341:mac.c         **** //¾ßÌåÍê³É¹¦ÄÜ¾ÍÊÇÌîÐ´mac_tx_current_frameÖÐ¸÷¸öÓò
1342:mac.c         **** void data_request_frame_send(void)
1343:mac.c         **** {
1344:mac.c         ****        mac_tx_current_frame.cmd=MAC_CMD_DATA_REQ;
1345:mac.c         ****        mac_tx_current_frame.type=MAC_FRAME_CMD;
1346:mac.c         **** 	mac_tx_current_frame.macDSN=mac_pib_data.macDSN++;
1347:mac.c         ****        //ÔÝÊ±×÷¼ò»¯´¦Àí
1348:mac.c         **** 	mac_tx_current_frame.src.panID=mac_pib_data.macPANId;
1349:mac.c         **** 	if(mac_current_state==MAC_STATE_ASSOC_WAIT_FOR_RESPONSE)
1350:mac.c         **** 	{
1351:mac.c         **** 	     //Ã»ÓÐÍøÂçºÍÐ­µ÷ÕßµÄÈÎºÎÐÅÏ¢
1352:mac.c         **** 	     //printf("\nno addr mode\n");
1353:mac.c         **** 	      mac_tx_current_frame.dst.addrMode=0x00;
1354:mac.c         **** 	      //mac_tx_current_frame.dst.shortAddr=mac_pib_data.macCoordShortAddress;
1355:mac.c         **** 	      //mac_tx_current_frame.dst.panID=mac_pib_data.macPANId;	 
1356:mac.c         **** 	}
1357:mac.c         **** 	else
1358:mac.c         **** 	{
1359:mac.c         **** 	    //printf("\nlong addr mode\n");
1360:mac.c         **** 	      mac_tx_current_frame.dst.addrMode=0x02;
1361:mac.c         **** 	      mac_tx_current_frame.dst.shortAddr=mac_pib_data.macCoordShortAddress;
1362:mac.c         **** 	      mac_tx_current_frame.dst.panID=mac_pib_data.macPANId;
1363:mac.c         **** 	}
1364:mac.c         **** 	if((mac_pib_data.macShortAddress.Val==default_short_addr.Val)||(mac_pib_data.macShortAddress.Val==
1365:mac.c         **** 	{
1366:mac.c         ****        	mac_tx_current_frame.src.addrMode=0x03;
1367:mac.c         **** 		mac_tx_current_frame.src.longAddr=mac_pib_data.macExtAddress;
1368:mac.c         **** 		
1369:mac.c         **** 	}
1370:mac.c         **** 	else
1371:mac.c         **** 	{
1372:mac.c         **** 	       mac_tx_current_frame.src.addrMode=0x02;
1373:mac.c         **** 		mac_tx_current_frame.src.shortAddr=mac_pib_data.macShortAddress;
1374:mac.c         **** 	}
1375:mac.c         **** 	mac_tx_current_frame.frame_control_field.v[0]=0x23;
1376:mac.c         **** 	mac_tx_current_frame.frame_control_field.v[1]=(mac_tx_current_frame.dst.addrMode<<2)|(mac_tx_curre
1377:mac.c         **** 	mac_frame_send();	 
1378:mac.c         **** }
1379:mac.c         **** 
1380:mac.c         **** void pending_data_send(NODE_INFO dst)
1381:mac.c         **** {
1382:mac.c         ****       INDIRECT_TX_PENDING_QUEUE * p_temp;
1383:mac.c         ****       //NODE_INFO src;
1384:mac.c         ****       p_temp=get_pending_frame(dst);
1385:mac.c         ****       if(Is_data_pending(dst))
1386:mac.c         ****       	{
1387:mac.c         ****       	    while(p_temp!=NULL)
1388:mac.c         ****       	    	{
1389:mac.c         ****       	    	     if((p_temp->dst.panID.Val==dst.panID.Val)&&((p_temp->dst.longAddr.longaddr==dst.lo
1390:mac.c         **** 			 break;		 	
1391:mac.c         ****       	    	}
1392:mac.c         **** 	     if(((p_temp->framectl_field.v[0])&0x07)==MAC_FRAME_DATA)
1393:mac.c         **** 	     	{
1394:mac.c         **** 	     	     data_frame_send(p_temp->high_level_payload,p_temp->frameLength,p_temp->dst,p_temp->src,
1395:mac.c         **** 	     	}
1396:mac.c         ****             else if(p_temp->associate_or_disassociate)
1397:mac.c         ****             	{
1398:mac.c         ****             	     //·¢ËÍassociateÏìÓ¦Ö¡ 
1399:mac.c         ****             	     associate_response_frame_send(mac_pib_data.macCoordShortAddress, p_temp->associat
1400:mac.c         ****             	}
1401:mac.c         **** 	      else
1402:mac.c         **** 	      	{
1403:mac.c         **** 	      	     //·¢ËÍdisassociate notificationÖ¡
1404:mac.c         **** 	      	     disassociate_notification_frame_send(p_temp->disassociation_reason, p_temp->end_device
1405:mac.c         **** 	      	}
1406:mac.c         **** 		remove_pending_queue(p_temp);
1407:mac.c         ****       	} 
1408:mac.c         **** 	else 
1409:mac.c         ****          
1410:mac.c         **** 	 return;
1411:mac.c         **** }
1412:mac.c         **** 
1413:mac.c         **** void  data_frame_send(BYTE * nwkpayload, BYTE nwkpayloadlength, NODE_INFO dst,NODE_INFO src,BYTE fr
1414:mac.c         **** {
1415:mac.c         ****       int i;
1416:mac.c         ****       mac_tx_current_frame.cmd=0x00;
1417:mac.c         ****       mac_tx_current_frame.type=MAC_FRAME_DATA;
1418:mac.c         ****       mac_tx_current_frame.macDSN=mac_pib_data.macDSN++;
1419:mac.c         ****       mac_tx_current_frame.dst=dst;
1420:mac.c         ****       mac_tx_current_frame.src=src;
1421:mac.c         ****       mac_tx_current_frame.nwk_data_length=nwkpayloadlength;
1422:mac.c         ****       mac_tx_current_frame.framehandle=frameHandle;
1423:mac.c         ****       for(i=0;i<nwkpayloadlength;i++)
1424:mac.c         ****           mac_tx_current_frame.nwk_data_payload[i]=*nwkpayload++;
1425:mac.c         ****       if((Is_data_pending(dst))&&(IS_COORDINATOR))
1426:mac.c         ****          mac_tx_current_frame.frame_control_field.v[0]=0x31;
1427:mac.c         ****       else
1428:mac.c         ****          mac_tx_current_frame.frame_control_field.v[0]=0x01;
1429:mac.c         ****       
1430:mac.c         ****       mac_tx_current_frame.frame_control_field.v[1]=(mac_tx_current_frame.dst.addrMode<<2)|(mac_tx_
1431:mac.c         ****       	  
1432:mac.c         ****       mac_frame_send();
1433:mac.c         **** }
1434:mac.c         **** 
1435:mac.c         **** bool  Is_data_pending(NODE_INFO dst)
1436:mac.c         **** {
1437:mac.c         ****        INDIRECT_TX_PENDING_QUEUE * p_temp;
1438:mac.c         **** 	p_temp=head_of_indirect_pending_buffer;
1439:mac.c         **** 	while(p_temp!=NULL)
1440:mac.c         **** 		{
1441:mac.c         **** 		     if((p_temp->dst.longAddr.longaddr==dst.longAddr.longaddr)||(p_temp->dst.shortAddr.Val==dst.s
1442:mac.c         **** 			 return TRUE;
1443:mac.c         **** 		       p_temp=p_temp->next;
1444:mac.c         **** 		}
1445:mac.c         **** 	return FALSE;
1446:mac.c         **** }
1447:mac.c         **** 
1448:mac.c         **** void  associate_request_frame_send(SHORT_ADDR panid,NODE_INFO dst, Node_Capability node_capinfo)
1449:mac.c         **** {
1450:mac.c         ****       mac_tx_current_frame.cmd=MAC_CMD_ASSOCIATE_REQ;
1451:mac.c         ****       mac_tx_current_frame.type=MAC_FRAME_CMD;
1452:mac.c         ****       mac_tx_current_frame.macDSN=mac_pib_data.macDSN++;
1453:mac.c         ****       mac_tx_current_frame.src.addrMode=0x03;
1454:mac.c         ****       mac_tx_current_frame.dst=dst;
1455:mac.c         ****       mac_tx_current_frame.src.panID=default_short_addr;
1456:mac.c         ****       mac_tx_current_frame.src.longAddr=mac_pib_data.macExtAddress;
1457:mac.c         ****       mac_tx_current_frame.node_capinfo_field=node_capinfo;
1458:mac.c         ****       mac_tx_current_frame.frame_control_field.v[0]=0x23;
1459:mac.c         ****       //printf("\nthe dst.addrmode is %02x",mac_tx_current_frame.dst.addrMode);	
1460:mac.c         ****       //printf("\nthe src.addrmode is %02x",mac_tx_current_frame.src.addrMode);	  
1461:mac.c         ****       mac_tx_current_frame.frame_control_field.v[1]=(((uint8_t)mac_tx_current_frame.dst.addrMode)<<
1462:mac.c         ****       //printf("\nthe control field isMSB %02x",mac_tx_current_frame.frame_control_field.v[1]);	  
1463:mac.c         ****       mac_frame_send();	  
1464:mac.c         **** }
1465:mac.c         **** 
1466:mac.c         **** 
1467:mac.c         **** 
1468:mac.c         **** void disassociate_notification_frame_send(BYTE disassociation_reason,LONG_ADDR end_device_addr)
1469:mac.c         **** {    mac_tx_current_frame.cmd=MAC_CMD_DISASSOCIATE_NOTICE;
1470:mac.c         ****     mac_tx_current_frame.type=MAC_FRAME_CMD;  
1471:mac.c         ****     mac_tx_current_frame.macDSN=mac_pib_data.macDSN++;
1472:mac.c         ****     mac_tx_current_frame.src.addrMode=0x03;
1473:mac.c         ****    if(!IS_FFD)	
1474:mac.c         ****     mac_tx_current_frame.dst.addrMode=0x02;
1475:mac.c         ****    else
1476:mac.c         ****     mac_tx_current_frame.dst.addrMode=0x03;	
1477:mac.c         ****     mac_tx_current_frame.src.panID=mac_pib_data.macPANId;
1478:mac.c         ****     mac_tx_current_frame.dst.panID=mac_pib_data.macPANId;	
1479:mac.c         ****     mac_tx_current_frame.src.longAddr=mac_pib_data.macExtAddress;
1480:mac.c         ****     if(IS_FFD!=0x00)
1481:mac.c         ****        mac_tx_current_frame.dst.longAddr=end_device_addr;
1482:mac.c         ****     else
1483:mac.c         ****        mac_tx_current_frame.dst.shortAddr=mac_pib_data.macCoordShortAddress;
1484:mac.c         ****     mac_tx_current_frame.disassociation_reason=disassociation_reason;
1485:mac.c         ****     mac_tx_current_frame.frame_control_field.v[0]=0x23;
1486:mac.c         ****     if(!IS_FFD)	
1487:mac.c         ****     mac_tx_current_frame.frame_control_field.v[1]=0xc8;
1488:mac.c         ****     else
1489:mac.c         ****     mac_tx_current_frame.frame_control_field.v[1]=0xcc;		
1490:mac.c         ****     mac_frame_send();
1491:mac.c         **** } 
1492:mac.c         **** 
1493:mac.c         **** void panid_confilct_frame_send(void)
1494:mac.c         **** {
1495:mac.c         ****      mac_tx_current_frame.cmd=MAC_CMD_PAN_ID_CONFLICT;
1496:mac.c         ****      mac_tx_current_frame.type=MAC_FRAME_CMD;
1497:mac.c         ****      mac_tx_current_frame.macDSN=mac_pib_data.macDSN++;
1498:mac.c         ****      mac_tx_current_frame.src.addrMode=0x03;
1499:mac.c         ****      mac_tx_current_frame.dst.addrMode=0x02;
1500:mac.c         ****      mac_tx_current_frame.src.panID=mac_pib_data.macPANId;
1501:mac.c         ****      mac_tx_current_frame.dst.panID=mac_pib_data.macPANId;
1502:mac.c         ****      mac_tx_current_frame.src.longAddr=mac_pib_data.macExtAddress;
1503:mac.c         ****      //mac_tx_current_frame.dst.longAddr=mac_pib_data.macCoordExtendedAddress;
1504:mac.c         ****      mac_tx_current_frame.dst.shortAddr=mac_pib_data.macCoordShortAddress;
1505:mac.c         ****      mac_tx_current_frame.frame_control_field.v[0]=0x23;
1506:mac.c         ****      mac_tx_current_frame.frame_control_field.v[1]=0xc8;
1507:mac.c         ****      mac_frame_send();	 
1508:mac.c         **** }
1509:mac.c         **** 
1510:mac.c         **** void orphan_notification_frame_send(void)
1511:mac.c         **** {
1512:mac.c         ****       mac_tx_current_frame.cmd=MAC_CMD_ORPHAN_NOTICE;
1513:mac.c         ****       mac_tx_current_frame.type=MAC_FRAME_CMD;
1514:mac.c         ****       mac_tx_current_frame.macDSN=mac_pib_data.macDSN++;
1515:mac.c         ****       mac_tx_current_frame.src.addrMode=0x03;
1516:mac.c         ****       mac_tx_current_frame.dst.addrMode=0x02;
1517:mac.c         ****       mac_tx_current_frame.src.panID=default_short_addr;
1518:mac.c         ****       mac_tx_current_frame.src.longAddr=mac_pib_data.macExtAddress;
1519:mac.c         ****       mac_tx_current_frame.dst.panID=default_short_addr;
1520:mac.c         ****       mac_tx_current_frame.dst.shortAddr=default_short_addr;
1521:mac.c         ****       mac_tx_current_frame.frame_control_field.v[0]=0x03;
1522:mac.c         ****       mac_tx_current_frame.frame_control_field.v[1]=0xc8;
1523:mac.c         ****       mac_frame_send();
1524:mac.c         ****       head_of_timer_queue=timer3queue_start(head_of_timer_queue,TIMER_ONE_SHOT, mac_tx_current_fram
1525:mac.c         **** }
1526:mac.c         **** 
1527:mac.c         **** void beacon_request_frame_send(void)
1528:mac.c         **** {
1529:mac.c         ****        
1530:mac.c         **** }
1531:mac.c         **** 
1532:mac.c         **** 
1533:mac.c         **** //#ifdef I_AM_COORDINATOR
1534:mac.c         **** void coordinator_realignment_frame_send(bool Isunicast,  NODE_INFO  dst, SHORT_ADDR allocated_addr)
1535:mac.c         **** {
1536:mac.c         ****        mac_tx_current_frame.cmd=MAC_CMD_COORD_REALIGNMENT;
1537:mac.c         ****        mac_tx_current_frame.type=MAC_FRAME_CMD;
1538:mac.c         **** 	mac_tx_current_frame.macDSN=mac_pib_data.macDSN++;
1539:mac.c         **** 	mac_tx_current_frame.src.addrMode=0x03;
1540:mac.c         **** 	mac_tx_current_frame.src.longAddr=mac_pib_data.macExtAddress;
1541:mac.c         **** 	mac_tx_current_frame.src.panID=mac_pib_data.macPANId;
1542:mac.c         **** 	mac_tx_current_frame.dst.panID=default_short_addr;
1543:mac.c         ****        //mac_tx_current_frame.dst.addrMode=0x03;
1544:mac.c         **** 	if(Isunicast)
1545:mac.c         **** 		{  
1546:mac.c         **** 		    //µ¥²¥
1547:mac.c         **** 		    mac_tx_current_frame.dst.addrMode=0x03;
1548:mac.c         **** 		    mac_tx_current_frame.dst.longAddr=dst.longAddr;
1549:mac.c         **** 		    mac_tx_current_frame.shortaddrallocted=allocated_addr;
1550:mac.c         **** 	           mac_tx_current_frame.frame_control_field.v[0]=0x23;
1551:mac.c         **** 	           mac_tx_current_frame.frame_control_field.v[1]=0xcc;
1552:mac.c         **** 		}
1553:mac.c         **** 	else 
1554:mac.c         **** 		{  
1555:mac.c         **** 		    //¹ã²¥
1556:mac.c         **** 		    mac_tx_current_frame.dst.addrMode=0x02;
1557:mac.c         **** 	           mac_tx_current_frame.dst.shortAddr=default_short_addr;
1558:mac.c         **** 		    mac_tx_current_frame.shortaddrallocted=default_short_addr;
1559:mac.c         **** 		    mac_tx_current_frame.frame_control_field.v[0]=0x03;
1560:mac.c         ****                   mac_tx_current_frame.frame_control_field.v[1]=0xc8;	
1561:mac.c         **** 		}		
1562:mac.c         **** 	mac_tx_current_frame.PAN_ID_field=mac_pib_data.macPANId;
1563:mac.c         **** 	mac_tx_current_frame.coordshortaddr_field=mac_pib_data.macShortAddress;
1564:mac.c         **** 	mac_tx_current_frame.logicalchannel_field=ppib.phyCurrentChanel;
1565:mac.c         **** 	mac_frame_send();
1566:mac.c         **** 
1567:mac.c         **** }
1568:mac.c         **** void associate_response_frame_send(SHORT_ADDR coor_short_addr, BYTE associate_status,LONG_ADDR asso
1569:mac.c         **** {
1570:mac.c         ****      mac_tx_current_frame.cmd=MAC_CMD_ASSOCIATE_RPLY;
1571:mac.c         ****      mac_tx_current_frame.type=MAC_FRAME_CMD;
1572:mac.c         ****      mac_tx_current_frame.macDSN=mac_pib_data.macDSN++;
1573:mac.c         ****      mac_tx_current_frame.src.addrMode=0x03;
1574:mac.c         ****      mac_tx_current_frame.dst.addrMode=0x03;
1575:mac.c         ****      mac_tx_current_frame.src.panID=mac_pib_data.macPANId;
1576:mac.c         ****      mac_tx_current_frame.dst.panID=mac_pib_data.macPANId;
1577:mac.c         ****      mac_tx_current_frame.src.longAddr=mac_pib_data.macExtAddress;
1578:mac.c         ****      mac_tx_current_frame.dst.longAddr=associate_device_addr;
1579:mac.c         ****      mac_tx_current_frame.shortaddralloc=shortaddralloc;
1580:mac.c         ****      mac_tx_current_frame.association_status=associate_status;
1581:mac.c         ****      mac_tx_current_frame.frame_control_field.v[0]=0x23;
1582:mac.c         ****      mac_tx_current_frame.frame_control_field.v[1]=0xcc;
1583:mac.c         ****      //printf("\nassociate response frame send\n");	 
1584:mac.c         ****      mac_frame_send();
1585:mac.c         **** }
1586:mac.c         **** 
1587:mac.c         **** //´¦ÀíÐÅ±êÖ¡¶¨Ê±ÎÊÌâµÄÈÎÎñ
1588:mac.c         **** void beacon_frame_tx_timing(void)
1589:mac.c         **** {
1590:mac.c         ****      uint32_t  deltatime;
1591:mac.c         ****      uint32_t truetime;
1592:mac.c         ****      truetime=systime32();
1593:mac.c         ****      deltatime=(truetime>=last_beacon_tx_timestamp) ? truetime-last_beacon_tx_timestamp:(0x3fffffff
1594:mac.c         ****      //deltatime=deltatime>>1;
1595:mac.c         ****      head_of_systimer_queue=systimer_start_task(head_of_systimer_queue, CAP_OVER, (MAC_CAP_PERIOD-(
1596:mac.c         ****      head_of_systimer_queue=systimer_start_task(head_of_systimer_queue, BEACON_SEND, (MAC_SUPERFRAM
1597:mac.c         ****      //printf("\n ---------delta time is %08lx\n",deltatime);	 
1598:mac.c         ****      //printf("\n ---------cap   time is %08lx\n",MAC_CAP_PERIOD);
1599:mac.c         ****      //printf("\n ---------super time is %08lx\n",MAC_SUPERFRAME_PERIOD);	
1600:mac.c         ****      MAC_OBJECT_CAP_START_TICKS=last_beacon_tx_timestamp;
1601:mac.c         ****      MAC_OBJECT_CAP_END_TICKS=truetime+((MAC_CAP_PERIOD<<1)-deltatime);
1602:mac.c         ****      MAC_OBJECT_SUPERFRAME_TICKS=truetime+((MAC_SUPERFRAME_PERIOD<<1)-deltatime);    	 
1603:mac.c         **** }
1604:mac.c         **** 
1605:mac.c         **** //·¢ËÍÖ®Ç°Òª°Ñmac_tx_beaconÌîºÃ
1606:mac.c         **** void  beacon_frame_send(bool short_or_long)
1607:mac.c         **** {
1608:mac.c         ****       uint8_t  i;
1609:mac.c         ****       
1610:mac.c         ****         
1611:mac.c         ****       mac_tx_current_frame.type=MAC_FRAME_BEACON;
1612:mac.c         ****       mac_tx_current_frame.macBSN=mac_pib_data.macBSN++;
1613:mac.c         ****       mac_tx_current_frame.dst.addrMode=0x00;
1614:mac.c         ****       mac_tx_current_frame.src.panID=mac_pib_data.macPANId;
1615:mac.c         ****       if(short_or_long)	  
1616:mac.c         ****       {
1617:mac.c         ****           mac_tx_current_frame.src.addrMode=0x02;
1618:mac.c         **** 	   mac_tx_current_frame.src.shortAddr=mac_pib_data.macShortAddress;
1619:mac.c         ****       } 
1620:mac.c         ****       else
1621:mac.c         ****       {
1622:mac.c         ****           mac_tx_current_frame.src.addrMode=0x03;
1623:mac.c         ****           mac_tx_current_frame.src.longAddr=mac_pib_data.macExtAddress;
1624:mac.c         ****       }
1625:mac.c         ****       mac_tx_current_frame.superframe_field=mac_tx_beacon.superframe_field;
1626:mac.c         ****       mac_tx_current_frame.pendaddress_field=mac_tx_beacon.pendaddress_field;
1627:mac.c         ****       mac_tx_current_frame.shortpendingadd_length=mac_tx_beacon.shortpendingadd_length;
1628:mac.c         ****       for(i=0;i<mac_tx_beacon.shortpendingadd_length;i++)
1629:mac.c         **** 	  	mac_tx_current_frame.shortaddrpending_list[i]=mac_tx_beacon.shortaddrpending_list[i];
1630:mac.c         ****       mac_tx_current_frame.longpendingadd_length=mac_tx_beacon.longpendingadd_length;
1631:mac.c         ****       //printf("\nthe longpending addr length is %d\n",mac_tx_beacon.longpendingadd_length);	  
1632:mac.c         ****       for(i=0;i<mac_tx_beacon.longpendingadd_length;i++)
1633:mac.c         ****       	{
1634:mac.c         ****       	      // printf("\nthere is a long address\n");
1635:mac.c         **** 	  	mac_tx_current_frame.longaddrpending_list[i]=mac_tx_beacon.longaddrpending_list[i];
1636:mac.c         ****       	}	
1637:mac.c         ****      mac_tx_current_frame.beacon_payload_length=mac_tx_beacon.beacon_payload_length;
1638:mac.c         ****      for(i=0;i<mac_tx_beacon.beacon_payload_length;i++)
1639:mac.c         **** 	 	mac_tx_current_frame.beacon_payload[i]=mac_tx_beacon.beacon_payload[i];
1640:mac.c         ****      mac_tx_current_frame.frame_control_field.v[0]=0x00;
1641:mac.c         ****      mac_tx_current_frame.frame_control_field.v[1]=0xc0&(mac_tx_current_frame.src.addrMode<<6);
1642:mac.c         ****      //printf("\nframe_ctl field is %02x--\n",mac_tx_current_frame.frame_control_field.v[1]);	 
1643:mac.c         **** 
1644:mac.c         ****      //postÒ»¸öÈÎÎñ´¦Àípending¶ÓÁÐÖÐµÄÔªËØ³¬Ê±ÇéÐÎ
1645:mac.c         ****      OS_post(pending_frame_handle);
1646:mac.c         **** 	 
1647:mac.c         ****      mac_frame_send();        
1648:mac.c         **** }
1649:mac.c         **** 
1650:mac.c         **** void pending_frame_handle(void)
1651:mac.c         **** {
1652:mac.c         ****       INDIRECT_TX_PENDING_QUEUE *p_temp;
1653:mac.c         ****       p_temp=head_of_indirect_pending_buffer;
1654:mac.c         ****       while(p_temp!=NULL)
1655:mac.c         ****       	{
1656:mac.c         ****       	     //printf("\nindirect buffer is not NULL\n");
1657:mac.c         **** 	  	p_temp->MacTranPersistCounter--;
1658:mac.c         **** 		//p_temp=p_temp->next;
1659:mac.c         **** 		if((p_temp->MacTranPersistCounter)==0)
1660:mac.c         **** 		{
1661:mac.c         **** 		     if((p_temp->framectl_field.v[0]&0x07)==0x01)
1662:mac.c         **** 			 mcpsDataConfirm(TRANSACTION_EXPIRED, p_temp->FrameHandle);
1663:mac.c         **** 		     //else   //¶ÔÓÚassociation responseÖ¡µÄ·¢ËÍÇéÐÎ
1664:mac.c         **** 		     //mlmeCommStatusIndication(WORD panId, BYTE srcAddrMode, ADDRESS * pSrcAddr, BYTE dstAddrMod
1665:mac.c         **** 		     remove_pending_queue(p_temp);
1666:mac.c         **** 			 
1667:mac.c         **** 		     	 
1668:mac.c         **** 		}
1669:mac.c         **** 		p_temp=p_temp->next;
1670:mac.c         ****       	}	
1671:mac.c         **** }
1672:mac.c         **** //#endif
1673:mac.c         **** //Ê±¼ä¶ÓÁÐµ÷Õûº¯Êý
1674:mac.c         **** void  timerqueue_adjust(void)
1675:mac.c         **** {
1676:mac.c         ****      current_timer_elem=head_of_timer_queue;
1677:mac.c         ****      current_timer_elem->next=NULL;
1678:mac.c         ****      head_of_timer_queue=head_of_timer_queue->next;
1679:mac.c         ****      //return  current_timer_elem;
1680:mac.c         **** }
1681:mac.c         **** 
1682:mac.c         **** void mac_timer_task(void)
1683:mac.c         **** {
1684:mac.c         **** 	 //Ö÷Òª¸ù¾ÝÊÇÄÄÖÖÀàÐÍµÄ¶¨Ê±ºÍÏµÍ³µÄµ±Ç°×´Ì¬×÷³öÒ»Ð©ÐÐÎª£º¼´post¶ÔÓ¦µÄÈÎÎñ
1685:mac.c         **** 	 //Î¬»¤Ê±¼ä¶ÓÁÐ
1686:mac.c         **** 	TX_BUFFER * p_temp;
1687:mac.c         **** 	//timerqueue_adjust();
1688:mac.c         **** 	 
1689:mac.c         **** 	//--------------------------------------------------------
1690:mac.c         **** 	//--------------------------------------------------------
1691:mac.c         **** 	//--------------------------------------------------------
1692:mac.c         **** 	switch(current_timer_elem->timer_reason)
1693:mac.c         **** 		{
1694:mac.c         **** 		     case  WAIT_FOR_ACK:
1695:mac.c         **** 			 	phy_channel_state=PHY_IDLE;
1696:mac.c         **** 			 	p_temp=get_frame_pointer(current_timer_elem->framedsn);
1697:mac.c         **** 				if(p_temp==NULL)
1698:mac.c         **** 					break;				    
1699:mac.c         **** 	 //Èç¹û¶ÔÓ¦µÄ¶¨Ê±ÈÎÎñÔ­ÒòÎªack³¬Ê±µÄÇéÐÎ
1700:mac.c         **** 	    //Èç¹û¸ÃÖ¡ÖÐµÄFrameRetriesCounterÎª0£¬ÔòÐèÒªÍ¨¹ý¶ÔÓ¦µÄÔ­Óï(Èç£ºconfirm,mlme-comm-status)Ïò¸ß²ã
1701:mac.c         **** 	    //¾ßÌå²Ù×÷ÈçÏÂ£º
1702:mac.c         **** 	                     if(p_temp->FrameRetriesCounter!=0)
1703:mac.c         **** 	                     {
1704:mac.c         **** 	                     	    //ÖØ·¢;
1705:mac.c         **** 	                     	       printf("\n---Retransmit---\n");
1706:mac.c         **** 	                     	       if(Parameter_list.top==((Parameter_list.tail+1)%MAX_TX_BUFFER_SIZE))
1707:mac.c         ****    	                                       error("\ntx buffer is full\n");
1708:mac.c         ****                                           else
1709:mac.c         ****                                             {
1710:mac.c         ****                                                Parameter_list.parameter_tx_task[Parameter_list.tail
1711:mac.c         **** 						     Parameter_list.tail=((Parameter_list.tail+1)%MAX_TX_BUFFER_SIZE);					   
1712:mac.c         ****                                                OS_post(transmit_with_csmaca); 
1713:mac.c         **** 	                     	         } 
1714:mac.c         **** 					      //ACK¶¨Ê±Æ÷µÄÆô¶¯ÊÇÔÚµ×²ã·¢ËÍÍê³ÉÊ±ºòÉèÖÃµÄ.
1715:mac.c         **** 						p_temp->FrameRetriesCounter--;
1716:mac.c         **** 	                     }
1717:mac.c         **** 				else  
1718:mac.c         **** 				{
1719:mac.c         **** 	                     switch(p_temp->cmd_type)
1720:mac.c         **** 	                     	{
1721:mac.c         **** 				          case MAC_CMD_DATA_REQ:
1722:mac.c         **** 	        //ÈôÎªdata requestÖ¡£¬ *************Ð­ÒéÖÐÃ»ÓÐ¿É¿¿ÐÔ±£Ö¤(Ò²²»Ì«¿ÉÄÜ·¢ÉúÏÂÃæÇéÐÎ)**********
1723:mac.c         **** 	              //¶ÔÓÚassociateÖÐµÄdatarequest:¿ÉÒÔÒÔmlme-association.confirm NO_data·µ»Ø¸ø¸ß²ã
1724:mac.c         **** 	                                       if(!IS_NETWORK_FORMED)
1725:mac.c         **** 	                                       mac_current_state=MAC_STATE_ACTIVE_PASSIVE_SCAN_FINISHED;
1726:mac.c         **** 	              //¶ÔÓÚdisassociationÖÐµÄdata request:¿ÉÒÔ²ÉÓÃmlme-disassociation.confirmÔ­Óï£¬×´Ì¬Îª
1727:mac.c         **** 	              //¶ÔÓÚdataµÄdata request:¿ÉÒÔ²ÉÓÃ***********(Ã»ÓÐÕâÑùµÄÔ­Óï£¬ÔòÖ±½Ó·µ»Ø£¬²»´¦Àí)****
1728:mac.c         **** 	                                       
1729:mac.c         **** 	                                       break;
1730:mac.c         ****                                       case MAC_CMD_ASSOCIATE_REQ:
1731:mac.c         **** 						     if(mac_current_state==MAC_STATE_ASSOC_WAIT_FOR_RESPONSE) 
1732:mac.c         **** 							 mlmeAssociateConfirm(default_short_addr, NO_ACK);
1733:mac.c         **** 	        //ÈôÎªassociation requestÖ¡,²ÉÓÃmlme-association.confirm£¬×´Ì¬ÎªNO_ack
1734:mac.c         **** 	                                        break;
1735:mac.c         **** 	                               case 0x00:
1736:mac.c         **** 						     mcpsDataConfirm(NO_ACK, p_temp->FrameHandle);
1737:mac.c         **** 						     break;
1738:mac.c         **** 	        //ÈôÎªdataÖ¡,²ÉÓÃmlme-data.confirm,×´Ì¬ÎªNO_ack
1739:mac.c         **** 	                               case MAC_CMD_DISASSOCIATE_NOTICE:
1740:mac.c         **** 						     mlmeDisassociateConfirm(NO_ACK);
1741:mac.c         **** 						     break;
1742:mac.c         **** 	        //ÈôÎªdisassociation notificationÖ¡,ÔòÍ¨¹ýmlme-disassociate.confirm£¬×´Ì¬ÎªNO_ack
1743:mac.c         **** 	                               case MAC_CMD_PAN_ID_CONFLICT:
1744:mac.c         **** 						     break;
1745:mac.c         **** 	        //ÈôÎªPANID confilict notificationÖ¡,  *************Ð­ÒéÖÐÃ»ÓÐ¿É¿¿ÐÔ±£Ö¤****************
1746:mac.c         **** 	                               case MAC_CMD_ASSOCIATE_RPLY:
1747:mac.c         **** 						     break;
1748:mac.c         **** 	        //ÈôÎªassociate responseÖ¡,²ÉÓÃmlme-comm-statusÔ­Óï£¬×´Ì¬Îªno_ack.
1749:mac.c         **** 	                               case MAC_CMD_COORD_REALIGNMENT:
1750:mac.c         **** 						     break;
1751:mac.c         **** 	        //ÈôÎªcoordinator realignmentÖ¡,²ÉÓÃmlme-comm-statusÔ­Óï£¬×´Ì¬Îªno_ack.
1752:mac.c         **** 
1753:mac.c         **** 	                     	}
1754:mac.c         **** 				 remove_tx_queue(p_temp->FrameSeq);
1755:mac.c         **** 				}
1756:mac.c         **** 				 break;		 
1757:mac.c         **** 	           case  WAIT_FOR_RESPONSE:
1758:mac.c         **** 	 //Èç¹û¶ÔÓ¦µÄ¶¨Ê±ÈÎÎñÔ­ÒòÎªresponse³¬Ê±µÄÇéÐÎ
1759:mac.c         **** 	                     if((mac_current_state==MAC_STATE_ASSOC_WAIT_FOR_RESPONSE)||(mac_current_state
1760:mac.c         **** 						 	mlmeAssociateConfirm(default_short_addr, NO_DATA);
1761:mac.c         **** 	    //Èç¹ûÊÇµÈ´ýassociation responseÖ¡£¬²¢ÇÒtrackbeaconÎªÕæ£¬Ôòµ÷ÓÃMLME-ASSOCIATE.confirmÔ­ÓïÍ¨Öª¸
1762:mac.c         **** 	        //Èç¹ûtrackbeaconÎª¼Ù£¬ÔòÖ±½Óµ÷ÓÃ·¢ËÍÈÎÎñ·¢ËÍdata requestÖ¡¡£
1763:mac.c         **** 	    //Èç¹ûÊÇÔÚ×öorphanscan£¬µÈ´ýcoordinator realignmentÃüÁîÖ¡£¬ÔòÈÏÎª¸ÃÐÅµÀÉÏÃ»ÓÐPAN,¹ØµôÉäÆµ½ÓÊÕ£
1764:mac.c         **** 	                     else if(mac_current_state==MAC_STATE_ORPHAN_SCAN)
1765:mac.c         **** 	                     	{
1766:mac.c         **** 	                     	    //ÇÐ»»µ½ÏÂÒ»¸öÐÅµÀÉÏ½øÐÐscan
1767:mac.c         **** 	                     	    //-------------------------------------------------------
1768:mac.c         **** 	                     	    //---------------´ýÌí¼Ó-------------------------------
1769:mac.c         **** 	                     	    //----------ÉèÖÃÎïÀíÐÅµÀÎªÏÂÒ»¸öÐÅµÀ-------
1770:mac.c         ****                                        //Èç¹ûËùÓÐµÄÐÅµÀ¶¼ÒÑ¾­scan¹ý£¬ÔòÉÏ±¨´íÎóÐÅÏ¢.
1771:mac.c         **** 					    //·¢ËÍorphan_notificationÖ¡
1772:mac.c         **** 	                     	    orphan_notification_frame_send();
1773:mac.c         **** 					    			
1774:mac.c         **** 	                     	}
1775:mac.c         **** 				break;
1776:mac.c         **** 	    //Ä¿Ç°¾ÍÏëµ½ÕâÁ½ÖÖ???????????????
1777:mac.c         **** 	           case WAIT_SCAN:
1778:mac.c         **** 	                    if(mac_current_state==MAC_STATE_ACTIVE_PASSIVE_SCAN)
1779:mac.c         **** 	                    	{
1780:mac.c         **** 			               while((scan_channel&((uint32_t)1<<scan_channel_index))==0)
1781:mac.c         **** 			               	{
1782:mac.c         **** 					              scan_channel_index++;
1783:mac.c         **** 						       if(scan_channel_index>=16)
1784:mac.c         **** 						       	{
1785:mac.c         **** 						       	   //mac_current_state=MAC_STATE_ACTIVE_PASSIVE_SCAN_FINISHED;
1786:mac.c         **** 								   phy_channel_state=INACTIVE_PERIOD;
1787:mac.c         **** 								   PLME_SET_TRX_STATE_request(TRX_OFF);
1788:mac.c         **** 								   mlmeScanConfirm(scan_result_info);
1789:mac.c         **** 							   	   return;
1790:mac.c         **** 						       	}
1791:mac.c         **** 			               	}
1792:mac.c         **** 			               PLME_SET_request(phyCurrentChanel_id, scan_channel_index++);  			  
1793:mac.c         **** 			               PLME_SET_TRX_STATE_request(RX_ON);			  
1794:mac.c         **** 			               phy_channel_state=WAITING_FOR_BEACON;	
1795:mac.c         **** 				        head_of_timer_queue=timer3queue_start(head_of_timer_queue, TIMER_ONE_SHOT, 0, WAIT_SCAN
1796:mac.c         **** 	                     	 printf("\nset the %d channel & waitting for beacon\n",scan_channel_index-1)
1797:mac.c         **** 	                    	}
1798:mac.c         **** 	                    break;
1799:mac.c         **** 	           case WAIT_FOR_DATA:
1800:mac.c         **** 	 //Èç¹û¶ÔÓ¦µÄ¶¨Ê±ÈÎÎñÔ­ÒòÎªÊý¾Ýdata request³¬Ê±µÄÇéÐÎ(¼´·¢ËÍÁËdata request²¢ÊÕµ½ackºóµÈ´ý¶Ô·½Êý¾Ý)
1801:mac.c         **** 	    //Èç¹ûÊÇÊý¾ÝÖ¡µÄdata request,******************Ã»ÓÐ¶ÔÓ¦µÄ´ëÊ©À´±£Ö¤************************Ö±½
1802:mac.c         **** 	    //Èç¹ûÊÇassociate responseÖ¡µÄdata request,Ôò ·¢ËÍmlme-associate-confirm,ÖÃ×´Ì¬ÎªNO-DATA
1803:mac.c         ****                            mlmeAssociateConfirm(default_short_addr, NO_DATA);
1804:mac.c         **** 	                    break;
1805:mac.c         **** 	    //Èç¹ûÊÇdisassociation notification£¬*********************Ã»ÓÐ¶ÔÓ¦µÄ´ëÊ©À´±£Ö¤*************Ö±½
1806:mac.c         **** 	           case WAIT_FOR_BEACON:
1807:mac.c         **** 	 //Èç¹û¶ÔÓ¦µÄ¶¨Ê±ÈÎÎñÔ­ÒòÎªµÈ´ýÐÅ±êÖ¡³¬Ê±µÄÇéÐÎ
1808:mac.c         **** 	    //È·¶¨ÏµÍ³µÄMAC¹¤×÷×´Ì¬ÎªÍ¬²½ing×´Ì¬
1809:mac.c         **** 	                   //NOTE:¼òµ¥Æð¼û£¬Ö»µÈ´ýÒ»´Î.
1810:mac.c         **** 	                   if(IS_MAC_SYNING)
1811:mac.c         **** 				mlmeSyncLossIndication(BEACON_LOSS);
1812:mac.c         **** 			     break;
1813:mac.c         **** 	        //Èç¹ûÎª¼Ù£¬Ôòµ÷ÓÃmlmeSyncLossIndicationÍ¨Öª¸ß²ã£¬ÒÑÊ§È¥Í¬²½
1814:mac.c         **** 	        //Èç¹ûÎªÕæ£¬Ôò°ÑaMaxLostBeaconsµÝ¼õ1,Èç¹ûÒÑ¾­¼õµ½0£¬Ôòµ÷ÓÃmlmeSyncLossIndicationÍ¨Öª¸ß²ã£¬
1815:mac.c         **** 	        //Èç¹ûÃ»ÓÐ¼õµ½Áã£¬ÐèÒªÖØÐÂÆô¶¯¶¨Ê±¶ÓÁÐÈÎÎñ¡£
1816:mac.c         **** 		}
1817:mac.c         ****        //É¾³ý¶¨Ê±ÈÎÎñ
1818:mac.c         **** 	free(current_timer_elem); 
1819:mac.c         ****  
1820:mac.c         **** }
1821:mac.c         **** 
1822:mac.c         **** 
1823:mac.c         **** uint16_t mac_timer3queue_getnextinterval(void)
1824:mac.c         **** {
1825:mac.c         ****      //·µ»Ø¶¨Ê±Æ÷ÏÂÒ»¸ö¶¨Ê±Öµ
1826:mac.c         ****      //Èç¹ûÃ»ÓÐ£¬Ôò·µ»ØÁã
1827:mac.c         ****      Timer_Queue_pointer  temp;
1828:mac.c         ****      temp=head_of_timer_queue->next;
1829:mac.c         ****      if(temp!=NULL) 
1830:mac.c         **** 	 return (temp->ticks);
1831:mac.c         ****      else
1832:mac.c         **** 	 return 0;
1833:mac.c         **** }
1834:mac.c         **** 
1835:mac.c         **** void initial_tx_queue(void)
1836:mac.c         **** {
1837:mac.c         **** 
1838:mac.c         **** }
1839:mac.c         **** 
1840:mac.c         **** TX_BUFFER * add_tx_queue(BYTE framelength, BYTE * payload, BYTE framehandle, bool is_need_ack, BYTE
1841:mac.c         **** {
1842:mac.c         ****        TX_BUFFER  * current;
1843:mac.c         **** 	current=(TX_BUFFER *)malloc(sizeof(TX_BUFFER));
1844:mac.c         **** 	if(current==NULL)
1845:mac.c         **** 	{
1846:mac.c         **** 		error("\nmemory allocated failure\n");
1847:mac.c         **** 		return NULL;
1848:mac.c         **** 	}	
1849:mac.c         **** 	current->payload=payload;
1850:mac.c         **** 	current->FrameHandle=framehandle;
1851:mac.c         **** 	current->FrameRetriesCounter=aMaxFrameRetries;
1852:mac.c         **** 	current->frameLength=framelength;
1853:mac.c         **** 	current->FrameSeq=frameseq;
1854:mac.c         **** 	current->next=NULL;
1855:mac.c         **** 	current->IsNeedAcked=is_need_ack;
1856:mac.c         **** 	current->IsTxed=0;
1857:mac.c         **** 	current->cmd_type=cmd_type;
1858:mac.c         ****        if(tail_of_tx_buffer==NULL)
1859:mac.c         ****         {
1860:mac.c         ****               //printf("\nadd to the head\n");
1861:mac.c         **** 	   	head_of_tx_buffer=current;
1862:mac.c         **** 		tail_of_tx_buffer=current;
1863:mac.c         ****         }
1864:mac.c         **** 	 else
1865:mac.c         **** 	 {
1866:mac.c         **** 	 	tail_of_tx_buffer->next=current;
1867:mac.c         **** 	       tail_of_tx_buffer=current;
1868:mac.c         **** 	 }	   
1869:mac.c         **** 	 return  current;
1870:mac.c         **** }
1871:mac.c         **** void remove_tx_queue(BYTE frameseq)
1872:mac.c         **** {
1873:mac.c         ****        TX_BUFFER  * p_temp1;
1874:mac.c         **** 	TX_BUFFER  * p_temp2;
1875:mac.c         **** 	p_temp1=head_of_tx_buffer;
1876:mac.c         **** 	p_temp2=head_of_tx_buffer;
1877:mac.c         **** 	while((p_temp2->FrameSeq!=frameseq)&&(p_temp2!=NULL))
1878:mac.c         **** 	{
1879:mac.c         **** 		      p_temp1=p_temp2;
1880:mac.c         **** 		      p_temp2=p_temp2->next;
1881:mac.c         **** 	}
1882:mac.c         **** 	if(p_temp2==NULL)
1883:mac.c         **** 		error("\n cannot find the corresponding frame in the tx buffer\n");
1884:mac.c         **** 	else
1885:mac.c         **** 	{
1886:mac.c         **** 	       if(p_temp1==p_temp2)
1887:mac.c         **** 	       	{
1888:mac.c         **** 		   	  head_of_tx_buffer=p_temp1->next;
1889:mac.c         **** 			  tail_of_tx_buffer=p_temp1->next;
1890:mac.c         **** 	       	}
1891:mac.c         **** 		else
1892:mac.c         **** 		{
1893:mac.c         **** 		       p_temp1->next=p_temp2->next;
1894:mac.c         **** 		       p_temp2->next=NULL;
1895:mac.c         **** 		}
1896:mac.c         **** 		//printf("\nsuccess free the tx ram,the frameseq is %d\n",p_temp2->FrameSeq);
1897:mac.c         **** 		free(p_temp2->payload);
1898:mac.c         **** 		free(p_temp2);
1899:mac.c         **** 		
1900:mac.c         **** 	}
1901:mac.c         **** 	 
1902:mac.c         **** }
1903:mac.c         **** TX_BUFFER * get_frame_pointer(BYTE frameseq)
1904:mac.c         **** {
 1269               	.LM126:
 1270               	/* prologue: frame size=0 */
 1271               	/* prologue end (size=0) */
 1272 05a0 982F      		mov r25,r24
1905:mac.c         ****        TX_BUFFER  * temp;
1906:mac.c         **** 	   temp=head_of_tx_buffer;
 1274               	.LM127:
 1275 05a2 E091 0000 		lds r30,head_of_tx_buffer
 1276 05a6 F091 0000 		lds r31,(head_of_tx_buffer)+1
 1277               	.L69:
1907:mac.c         **** 	while(temp->FrameSeq!=frameseq)
1908:mac.c         **** 		temp=temp->next;
 1279               	.LM128:
 1280 05aa 8381      		ldd r24,Z+3
 1281 05ac 8917      		cp r24,r25
 1282 05ae 21F0      		breq .L68
 1283 05b0 0184      		ldd __tmp_reg__,Z+9
 1284 05b2 F285      		ldd r31,Z+10
 1285 05b4 E02D      		mov r30,__tmp_reg__
 1286 05b6 F9CF      		rjmp .L69
 1287               	.L68:
1909:mac.c         **** 	return temp;
1910:mac.c         **** }
 1289               	.LM129:
 1290 05b8 CF01      		movw r24,r30
 1291               	/* epilogue: frame size=0 */
 1292 05ba 0895      		ret
 1293               	/* epilogue end (size=1) */
 1294               	/* function get_frame_pointer size 14 (13) */
 1299               	.Lscope16:
 1300               		.data
 1301               	.LC6:
 1302 0107 0A63 616E 		.string	"\ncannot find a pending frame in the queue\n"
 1302      6E6F 7420 
 1302      6669 6E64 
 1302      2061 2070 
 1302      656E 6469 
 1303               		.text
 1306               	.global	get_pending_frame
 1308               	get_pending_frame:
1911:mac.c         **** 
1912:mac.c         **** RX_BUFFER * add_to_rx_buffer(BYTE framelength, BYTE *payload,BYTE lqi,uint32_t timestamp)
1913:mac.c         **** {
1914:mac.c         ****        RX_BUFFER  * temp;
1915:mac.c         **** 	temp=(RX_BUFFER *)malloc(sizeof(RX_BUFFER));
1916:mac.c         **** 	if(temp==NULL)
1917:mac.c         **** 	{
1918:mac.c         **** 		error("\nmemory allocated failure\n");
1919:mac.c         **** 		return NULL;
1920:mac.c         **** 	}
1921:mac.c         **** 	temp->framelength=framelength;
1922:mac.c         **** 	temp->payload=payload;
1923:mac.c         **** 	temp->lqi=lqi;   
1924:mac.c         **** 	temp->timestamp=timestamp;
1925:mac.c         **** 	temp->next=NULL;
1926:mac.c         **** 	if(tail_of_rx_buffer==NULL)
1927:mac.c         **** 	{
1928:mac.c         **** 	     head_of_rx_buffer=temp;
1929:mac.c         **** 	     tail_of_rx_buffer=temp;
1930:mac.c         **** 	}
1931:mac.c         **** 	else
1932:mac.c         **** 	{
1933:mac.c         **** 	    tail_of_rx_buffer->next=temp;
1934:mac.c         **** 	    tail_of_rx_buffer=temp;
1935:mac.c         **** 	}
1936:mac.c         **** 	return   temp;
1937:mac.c         **** }
1938:mac.c         **** void  remove_from_rx_buffer(RX_BUFFER  * framepointer)
1939:mac.c         **** {
1940:mac.c         ****        /*
1941:mac.c         ****         RX_BUFFER * p_temp1;
1942:mac.c         **** 	RX_BUFFER * p_temp2;
1943:mac.c         **** 	p_temp1=head_of_rx_buffer;
1944:mac.c         **** 	p_temp2=tail_of_rx_buffer;
1945:mac.c         **** 	while((p_temp2!=framepointer)&&(p_temp2!=NULL))
1946:mac.c         **** 	{
1947:mac.c         **** 		    p_temp1=p_temp2;
1948:mac.c         **** 		    p_temp2=p_temp2->next;
1949:mac.c         **** 	}
1950:mac.c         **** 	if(p_temp2==NULL)
1951:mac.c         **** 	{
1952:mac.c         **** 	        error("\nthe frame is not in the rx buffer\n");
1953:mac.c         **** 		 return;
1954:mac.c         **** 	}
1955:mac.c         **** 	else
1956:mac.c         **** 	{
1957:mac.c         **** 	       if(p_temp1==p_temp2)
1958:mac.c         **** 		   	head_of_rx_buffer=p_temp2->next;
1959:mac.c         **** 		else 
1960:mac.c         **** 		{
1961:mac.c         **** 		       p_temp1->next=p_temp2->next;
1962:mac.c         **** 		       p_temp2->next=NULL;
1963:mac.c         **** 		}
1964:mac.c         **** 	}
1965:mac.c         **** 	*/
1966:mac.c         **** 	free(framepointer->payload);
1967:mac.c         ****        free(framepointer);   
1968:mac.c         ****        //printf("\n***************succeed free a physical packet*********************\n");  
1969:mac.c         **** }
1970:mac.c         **** 
1971:mac.c         **** //×é°üº¯Êý£¬¸ù¾Ýµ÷ÓÃÕßÌá¹©µÄ²ÎÊýÐÅÏ¢£¬×é³ÉºÏ·¨µÄMACÖ¡½øÐÐ·¢ËÍ¡£
1972:mac.c         **** //¶ÔÓÚÐÅ±êÖ¡ºÍackÖ¡£¬²»Ðèµ÷ÓÃ¸Ãº¯Êý¡£
1973:mac.c         **** //
1974:mac.c         ****  //¸ù¾ÝÖ¡ÀàÐÍµÈ²ÎÊýÐÅÏ¢×éÖ¯³ÉºÏ·¨µÄMACÖ¡
1975:mac.c         ****    //¼ì²âÎïÀíÐÅµÀÊÇ·ñºÏ·¨
1976:mac.c         ****    //Èç¹ûÐèÒª²ÉÓÃÁ¢¼´·¢ËÍµÄ£¬¼´²ÉÓÃµ÷ÓÃº¯Êýdirect_transmitµÄÐÎÊ½(ÊµÊ±ÐÔ¸ß)
1977:mac.c         ****    //Èç¹ûÐèÒª²ÉÓÃcsma_caËã·¨·¢ËÍµÄ£¬¼´²ÉÓÃpostÒ»¸öÐÂÈÎÎñtransmit_with_csmaca(ÊµÊ±ÐÔµÍ)
1978:mac.c         **** void mac_frame_send(void)
1979:mac.c         **** {
1980:mac.c         ****    TX_BUFFER  * temp;
1981:mac.c         ****    //MAC²ãËùÓÐÓò³¤¶ÈÖ®ºÍ£¬µ«²»°üÀ¨FCSÓò
1982:mac.c         ****    BYTE framelength;
1983:mac.c         ****    BYTE * payload;
1984:mac.c         ****    BYTE framehandle;
1985:mac.c         ****    bool is_need_ack;
1986:mac.c         ****    BYTE frameseq;
1987:mac.c         ****    uint8_t  index;
1988:mac.c         ****    BYTE  cmd_type;
1989:mac.c         ****    uint8_t  i;
1990:mac.c         ****    index=0;
1991:mac.c         ****    uint32_t  return_send_timestamp;
1992:mac.c         ****    //framelength=mac_tx_current_frame.frameLength;
1993:mac.c         ****    payload=(BYTE *)malloc(aMaxMACFrameSize*sizeof(BYTE));
1994:mac.c         ****    payload[index++]=mac_tx_current_frame.frame_control_field.v[0];
1995:mac.c         ****    payload[index++]=mac_tx_current_frame.frame_control_field.v[1];
1996:mac.c         ****    //printf("\nframe_ctl field is %02x--\n",payload[1]);
1997:mac.c         ****    payload[index++]=mac_tx_current_frame.macDSN;
1998:mac.c         ****    frameseq=mac_tx_current_frame.macDSN;
1999:mac.c         ****    is_need_ack=mac_tx_current_frame.frame_control_field.bits.AckReq;
2000:mac.c         ****    cmd_type=0x00;//²»ÊÇÃüÁîÖ¡
2001:mac.c         ****    framehandle=mac_rx_current_frame.framehandle;//¶ÔÊý¾ÝÖ¡ÓÐÓÃµÄÓò
2002:mac.c         ****    //printf("the transmitted beacon frame length is %d", index);
2003:mac.c         ****    
2004:mac.c         ****    switch(mac_tx_current_frame.frame_control_field.v[1]&0x0c)
2005:mac.c         ****    	{
2006:mac.c         ****    	     case  MAC_DST_LONG_ADDR:
2007:mac.c         **** 		 	//Ç°Á½¸ö×Ö½Ú·ÅÄ¿µÄPANID
2008:mac.c         **** 		 	payload[index++]=mac_tx_current_frame.dst.panID.v[0];
2009:mac.c         **** 			payload[index++]=mac_tx_current_frame.dst.panID.v[1];
2010:mac.c         **** 			//ºó°Ë¸ö×Ö½Ú·Å³¤Ä¿µÄµØÖ·		 	
2011:mac.c         **** 		 	payload[index++]=mac_tx_current_frame.dst.longAddr.v[0];
2012:mac.c         **** 			payload[index++]=mac_tx_current_frame.dst.longAddr.v[1];
2013:mac.c         **** 			payload[index++]=mac_tx_current_frame.dst.longAddr.v[2];
2014:mac.c         **** 			payload[index++]=mac_tx_current_frame.dst.longAddr.v[3];
2015:mac.c         **** 			payload[index++]=mac_tx_current_frame.dst.longAddr.v[4];
2016:mac.c         **** 			payload[index++]=mac_tx_current_frame.dst.longAddr.v[5];
2017:mac.c         **** 			payload[index++]=mac_tx_current_frame.dst.longAddr.v[6];
2018:mac.c         **** 			payload[index++]=mac_tx_current_frame.dst.longAddr.v[7];
2019:mac.c         **** 		 	break;
2020:mac.c         **** 	     case  MAC_DST_SHORT_ADDR:
2021:mac.c         **** 		 	//Ç°Á½¸ö×Ö½Ú·ÅÄ¿µÄPANID
2022:mac.c         **** 		 	payload[index++]=mac_tx_current_frame.dst.panID.v[0];
2023:mac.c         **** 			payload[index++]=mac_tx_current_frame.dst.panID.v[1];
2024:mac.c         **** 			//ºóÁ½¸ö×Ö½Ú·Å¶ÌÄ¿µÄµØÖ·
2025:mac.c         **** 		 	payload[index++]=mac_tx_current_frame.dst.shortAddr.v[0];
2026:mac.c         **** 			payload[index++]=mac_tx_current_frame.dst.shortAddr.v[1];
2027:mac.c         **** 		 	break;
2028:mac.c         **** 	     case  MAC_DST_NO_ADDR:
2029:mac.c         **** 		 	break;
2030:mac.c         **** 	     case  MAC_DST_ADDR_RESERVED:
2031:mac.c         **** 		 	error("\nreserved dst address mode is used!\n");
2032:mac.c         **** 		 	break;
2033:mac.c         ****    	}
2034:mac.c         ****    switch(mac_tx_current_frame.frame_control_field.v[1]&0xc0)
2035:mac.c         ****    	{
2036:mac.c         ****    	     case  MAC_SRC_LONG_ADDR:
2037:mac.c         **** 		 	//Ç°Á½¸ö×Ö½Ú·ÅÔ´PANID
2038:mac.c         **** 		 	payload[index++]=mac_tx_current_frame.src.panID.v[0];
2039:mac.c         **** 			payload[index++]=mac_tx_current_frame.src.panID.v[1];
2040:mac.c         **** 			//ºó°Ë¸ö×Ö½Ú·Å³¤Ô´µØÖ·		 	
2041:mac.c         **** 		 	payload[index++]=mac_tx_current_frame.src.longAddr.v[0];
2042:mac.c         **** 			payload[index++]=mac_tx_current_frame.src.longAddr.v[1];
2043:mac.c         **** 			payload[index++]=mac_tx_current_frame.src.longAddr.v[2];
2044:mac.c         **** 			payload[index++]=mac_tx_current_frame.src.longAddr.v[3];
2045:mac.c         **** 			payload[index++]=mac_tx_current_frame.src.longAddr.v[4];
2046:mac.c         **** 			payload[index++]=mac_tx_current_frame.src.longAddr.v[5];
2047:mac.c         **** 			payload[index++]=mac_tx_current_frame.src.longAddr.v[6];
2048:mac.c         **** 			payload[index++]=mac_tx_current_frame.src.longAddr.v[7];
2049:mac.c         **** 		 	break;
2050:mac.c         **** 	     case  MAC_SRC_SHORT_ADDR:
2051:mac.c         **** 		 	//Ç°Á½¸ö×Ö½Ú·ÅÔ´PANID
2052:mac.c         **** 		 	payload[index++]=mac_tx_current_frame.src.panID.v[0];
2053:mac.c         **** 			payload[index++]=mac_tx_current_frame.src.panID.v[1];
2054:mac.c         **** 			//ºóÁ½¸ö×Ö½Ú·Å¶ÌÔ´µØÖ·
2055:mac.c         **** 		 	payload[index++]=mac_tx_current_frame.src.shortAddr.v[0];
2056:mac.c         **** 			payload[index++]=mac_tx_current_frame.src.shortAddr.v[1];
2057:mac.c         **** 		 	break;
2058:mac.c         **** 	     case  MAC_SRC_NO_ADDR:
2059:mac.c         **** 		 	break;
2060:mac.c         **** 	     case  MAC_SRC_ADDR_RESERVED:
2061:mac.c         **** 		 	error("\nreserved src address mode is used!\n");
2062:mac.c         **** 		 	break;   	     
2063:mac.c         ****    	}
2064:mac.c         ****        
2065:mac.c         ****    switch(mac_tx_current_frame.type)
2066:mac.c         ****    	{
2067:mac.c         ****    	     case  MAC_FRAME_BEACON:
2068:mac.c         **** 		 	//³¬Ö¡½á¹¹
2069:mac.c         **** 		 	//printf("the transmitted beacon frame length is %d", index);
2070:mac.c         **** 		 	payload[index++]=mac_tx_current_frame.superframe_field.SF.bytes.LSB;
2071:mac.c         **** 			payload[index++]=mac_tx_current_frame.superframe_field.SF.bytes.MSB;
2072:mac.c         ****                      //GTSÐÅÏ¢±¾°æ±¾Ã»ÓÐÊµÏÖgtsµÄÏà¹ØÐ­Òé
2073:mac.c         **** 			payload[index++]=0x00;
2074:mac.c         **** 			//pendingÐÅÏ¢
2075:mac.c         **** 			payload[index++]=mac_tx_current_frame.pendaddress_field.bytes;
2076:mac.c         **** 			for(i=0;i<mac_tx_current_frame.shortpendingadd_length;i++)
2077:mac.c         **** 			{
2078:mac.c         **** 			     payload[index++]=mac_tx_current_frame.shortaddrpending_list[i].v[0];
2079:mac.c         **** 			     payload[index++]=mac_tx_current_frame.shortaddrpending_list[i].v[1];
2080:mac.c         **** 			}
2081:mac.c         **** 			for(i=0;i<mac_tx_current_frame.longpendingadd_length;i++)
2082:mac.c         **** 			{
2083:mac.c         **** 			     payload[index++]=mac_tx_current_frame.longaddrpending_list[i].v[0];
2084:mac.c         **** 			     payload[index++]=mac_tx_current_frame.longaddrpending_list[i].v[1];
2085:mac.c         **** 			     payload[index++]=mac_tx_current_frame.longaddrpending_list[i].v[2];
2086:mac.c         **** 			     payload[index++]=mac_tx_current_frame.longaddrpending_list[i].v[3];
2087:mac.c         **** 			     payload[index++]=mac_tx_current_frame.longaddrpending_list[i].v[4];
2088:mac.c         **** 			     payload[index++]=mac_tx_current_frame.longaddrpending_list[i].v[5];
2089:mac.c         **** 			     payload[index++]=mac_tx_current_frame.longaddrpending_list[i].v[6];
2090:mac.c         **** 			     payload[index++]=mac_tx_current_frame.longaddrpending_list[i].v[7];
2091:mac.c         **** 			}
2092:mac.c         **** 			//ÐÅ±êÖ¡¸ºÔØ
2093:mac.c         **** 			payload[index++]=mac_tx_current_frame.beacon_payload_length;
2094:mac.c         **** 			for(i=0;i<mac_tx_current_frame.beacon_payload_length;i++)
2095:mac.c         **** 				payload[index++]=mac_tx_current_frame.beacon_payload[i];
2096:mac.c         **** 			//printf("\nthe transmitted beacon frame length is %d", index);
2097:mac.c         **** 			//for(uint8_t i=0;i<index;i++)
2098:mac.c         **** 			//	printf("\nthe beacon frame payload[%d] is %02x\n",i,payload[i]);
2099:mac.c         **** 			last_beacon_tx_timestamp=direct_transmit(index, payload);
2100:mac.c         **** 			//printf("\nthe transmitted beacon frame time is %08lx", last_beacon_tx_timestamp);
2101:mac.c         **** 			//Leds_yellowToggle();
2102:mac.c         **** 			phy_channel_state=PHY_IDLE;
2103:mac.c         **** 			mac_current_state=MAC_STATE_IDLE;
2104:mac.c         **** 			PLME_SET_TRX_STATE_request(RX_ON);
2105:mac.c         **** 			OS_post(beacon_frame_tx_timing);
2106:mac.c         **** 			//for(uint8_t i=0;i<index;i++)
2107:mac.c         **** 			//	printf("\nthe beacon frame payload[%d] is %02x\n",i,payload[i]);
2108:mac.c         **** 			return;
2109:mac.c         **** 		 	break;
2110:mac.c         **** 	     case  MAC_FRAME_DATA:
2111:mac.c         **** 		 	//¿½±´ÍøÂ·²ãÊý¾Ý
2112:mac.c         **** 		 	payload[index++]=mac_tx_current_frame.nwk_data_length;
2113:mac.c         **** 		 	for( i=0;i<mac_tx_current_frame.nwk_data_length;i++)
2114:mac.c         **** 				payload[index++]=mac_tx_current_frame.nwk_data_payload[i];
2115:mac.c         **** 			break;
2116:mac.c         **** 	     case  MAC_FRAME_ACK:
2117:mac.c         **** 		 	//ÒÑ¾­ÓÉµ×²ã·¢ËÍ,ÕâÀï²»½øÐÐ×éÖ¡
2118:mac.c         **** 		 	break;
2119:mac.c         **** 	     case  MAC_FRAME_CMD:
2120:mac.c         **** 		 	{
2121:mac.c         **** 				payload[index++]=mac_tx_current_frame.cmd;
2122:mac.c         **** 				cmd_type=mac_tx_current_frame.cmd;
2123:mac.c         **** 				switch(mac_tx_current_frame.cmd)
2124:mac.c         **** 					{
2125:mac.c         **** 					    case MAC_CMD_ASSOCIATE_REQ:
2126:mac.c         **** 							payload[index++]=mac_tx_current_frame.node_capinfo_field.bytes;
2127:mac.c         **** 							break;
2128:mac.c         **** 					    case MAC_CMD_ASSOCIATE_RPLY:
2129:mac.c         **** 							payload[index++]=mac_tx_current_frame.shortaddralloc.v[0];
2130:mac.c         **** 							payload[index++]=mac_tx_current_frame.shortaddralloc.v[1];
2131:mac.c         **** 							payload[index++]=mac_tx_current_frame.association_status;
2132:mac.c         **** 							//printf("---****index is %d***---\n",index);
2133:mac.c         **** 							//return;
2134:mac.c         **** 							break;
2135:mac.c         **** 				           case MAC_CMD_DISASSOCIATE_NOTICE:
2136:mac.c         **** 						   	payload[index++]=mac_tx_current_frame.disassociation_reason;
2137:mac.c         **** 						   	break;
2138:mac.c         **** 					    case MAC_CMD_DATA_REQ:
2139:mac.c         **** 							break;
2140:mac.c         **** 					    case MAC_CMD_PAN_ID_CONFLICT:
2141:mac.c         **** 							//printf("\n---the panID conflict frame length is %d---\n",index);
2142:mac.c         **** 							break;
2143:mac.c         **** 					    case MAC_CMD_ORPHAN_NOTICE:
2144:mac.c         **** 							break;
2145:mac.c         **** 					    case MAC_CMD_BEACON_REQ:
2146:mac.c         **** 							break;
2147:mac.c         **** 					    case MAC_CMD_COORD_REALIGNMENT:
2148:mac.c         **** 							payload[index++]=mac_tx_current_frame.PAN_ID_field.v[0];
2149:mac.c         **** 							payload[index++]=mac_tx_current_frame.PAN_ID_field.v[1];
2150:mac.c         **** 							payload[index++]=mac_tx_current_frame.coordshortaddr_field.v[0];
2151:mac.c         **** 							payload[index++]=mac_tx_current_frame.coordshortaddr_field.v[1];
2152:mac.c         **** 							payload[index++]=mac_tx_current_frame.logicalchannel_field;
2153:mac.c         **** 							payload[index++]=mac_tx_current_frame.shortaddrallocted.v[0];
2154:mac.c         **** 							payload[index++]=mac_tx_current_frame.shortaddrallocted.v[1];
2155:mac.c         **** 							//printf("--the realignment frame length is %d--",index);
2156:mac.c         **** 							
2157:mac.c         **** 							break;
2158:mac.c         **** 					    case MAC_CMD_GTS_REQ:
2159:mac.c         **** 							//±¾°æ±¾Ã»ÓÐÊµÏÖGTSÏà¹ØÐ­Òé
2160:mac.c         **** 							break;				
2161:mac.c         **** 					}
2162:mac.c         **** 	     	       }
2163:mac.c         **** 		 	break;
2164:mac.c         ****    	}
2165:mac.c         ****    //if(index!=framelength)
2166:mac.c         ****    //	error("\nthe frame length's computing error\n");
2167:mac.c         ****    framelength=index;
2168:mac.c         ****    //printf("the transmitted  frame length is %d", framelength);
2169:mac.c         ****    temp=add_tx_queue(framelength,payload,framehandle,is_need_ack,frameseq,cmd_type);
2170:mac.c         ****    head_of_tx_buffer=temp;
2171:mac.c         ****    //ÖÐ¼ä¿ÕÒ»¸öÔªËØ
2172:mac.c         ****    if(Parameter_list.top==((Parameter_list.tail+1)%MAX_TX_BUFFER_SIZE))
2173:mac.c         ****    	error("\ntx buffer is full\n");
2174:mac.c         ****    else
2175:mac.c         ****    {
2176:mac.c         ****       Parameter_list.parameter_tx_task[Parameter_list.tail]=temp;
2177:mac.c         ****       Parameter_list.tail=((Parameter_list.tail+1)%MAX_TX_BUFFER_SIZE);
2178:mac.c         ****       //printf("the transmitted  frame length is %d", framelength);	  
2179:mac.c         ****       OS_post(transmit_with_csmaca); 
2180:mac.c         ****    }
2181:mac.c         **** }
2182:mac.c         **** 
2183:mac.c         **** 
2184:mac.c         **** uint32_t direct_transmit(uint8_t psdulength,uint8_t * psdu)
2185:mac.c         **** {
2186:mac.c         **** 	//Ö±½Ó·¢ËÍÖ¡£¬²»²ÉÓÃcsma_ca
2187:mac.c         ****   //µ÷ÓÃÎïÀí²ãPD_data_request·¢ËÍ
2188:mac.c         ****   uint32_t  send_timestamp;
2189:mac.c         ****   send_timestamp=PD_DATA_request(psdulength,psdu);
2190:mac.c         ****   free(psdu);
2191:mac.c         ****   //printf("\ntransmit beacon finished");
2192:mac.c         ****   return send_timestamp;
2193:mac.c         **** }
2194:mac.c         **** 
2195:mac.c         **** 
2196:mac.c         **** void initial_pending_queue(void)
2197:mac.c         **** {
2198:mac.c         ****     
2199:mac.c         **** }
2200:mac.c         **** 
2201:mac.c         **** //Ìí¼ÓÒ»¸öÊý¾Ý°üµ½pending¶ÓÁÐÖÐ
2202:mac.c         **** void add_pending_queue(BYTE framehandle, FRAME_CONTROL framectl, NODE_INFO dst, NODE_INFO src, BYTE
2203:mac.c         **** {
2204:mac.c         ****       INDIRECT_TX_PENDING_QUEUE * temp;
2205:mac.c         ****       //bool   is_added_before;	  
2206:mac.c         ****       temp=(INDIRECT_TX_PENDING_QUEUE *)malloc(sizeof(INDIRECT_TX_PENDING_QUEUE));
2207:mac.c         ****       temp->framectl_field=framectl;
2208:mac.c         ****       //¶ÔÓÚ·ÇÊý¾ÝÖ¡µÄÇéÐÎ£¬ÔòÖ±½ÓÖÃframehandleÎª0
2209:mac.c         ****       temp->FrameHandle=framehandle;
2210:mac.c         ****       temp->frameLength=framelength;
2211:mac.c         ****       temp->high_level_payload=payload;
2212:mac.c         ****       temp->MacTranPersistCounter=mac_pib_data.macTransactionPersistenceTime;
2213:mac.c         ****       temp->associate_or_disassociate=associate_or_disassociate;
2214:mac.c         ****       if((temp->framectl_field.v[0]&0x07)!=0x01)
2215:mac.c         ****       	{
2216:mac.c         ****       	     if(associate_or_disassociate)
2217:mac.c         ****       	     	{
2218:mac.c         ****       	     	  
2219:mac.c         **** 	         temp->associate_status=associate_status_or_disassociate_reason;
2220:mac.c         **** 	         temp->associate_device_addr=addr;
2221:mac.c         **** 	         temp->shortaddralloc=shortaddralloc;
2222:mac.c         ****       	     	}	 
2223:mac.c         **** 	      else
2224:mac.c         **** 	      	{
2225:mac.c         **** 		  temp->disassociation_reason=associate_status_or_disassociate_reason;
2226:mac.c         **** 		  temp->end_device_addr=addr;
2227:mac.c         **** 	      	}  
2228:mac.c         ****       	}
2229:mac.c         ****       temp->dst=dst;
2230:mac.c         ****       temp->src=src;
2231:mac.c         ****       temp->IsValid=1;
2232:mac.c         ****       temp->next=NULL;
2233:mac.c         **** 	if(tail_of_indirect_pending_buffer==NULL)
2234:mac.c         **** 	{
2235:mac.c         **** 	     head_of_indirect_pending_buffer=temp;
2236:mac.c         **** 	     tail_of_indirect_pending_buffer=temp;
2237:mac.c         **** 	}
2238:mac.c         **** 	else
2239:mac.c         **** 	{
2240:mac.c         **** 	    tail_of_indirect_pending_buffer->next=temp;
2241:mac.c         **** 	    tail_of_indirect_pending_buffer=temp;
2242:mac.c         **** 	}
2243:mac.c         **** 	if(dst.addrMode==0x02)
2244:mac.c         **** 		{
2245:mac.c         **** 	            /*for(uint8_t i=0;i<mac_tx_beacon.shortpendingadd_length;i++)	
2246:mac.c         **** 	            	{
2247:mac.c         **** 			  if(dst.shortAddr.Val==mac_tx_beacon.shortaddrpending_list[i].Val)
2248:mac.c         **** 			  	
2249:mac.c         **** 	            	}*/ 	
2250:mac.c         **** 	    mac_tx_beacon.shortaddrpending_list[mac_tx_beacon.shortpendingadd_length++]=dst.shortAddr;
2251:mac.c         ****            mac_tx_beacon.pendaddress_field.bytes=(mac_tx_beacon.pendaddress_field.bytes)+1;	
2252:mac.c         **** 		}
2253:mac.c         ****        else 
2254:mac.c         ****        	{
2255:mac.c         **** 	    mac_tx_beacon.longaddrpending_list[mac_tx_beacon.longpendingadd_length++]=dst.longAddr;
2256:mac.c         **** 	    mac_tx_beacon.pendaddress_field.bytes=(mac_tx_beacon.pendaddress_field.bytes)+16;	
2257:mac.c         **** 	    //printf("\nadd the long addr to the pending list\n");	
2258:mac.c         ****        	}
2259:mac.c         **** 	//printf("\nthe longpending addr length is %d\n",mac_tx_beacon.longpendingadd_length);
2260:mac.c         **** 	current_pending_num++;
2261:mac.c         **** }
2262:mac.c         **** 
2263:mac.c         **** //´Ópending¶ÓÁÐÖÐÉ¾³ýÒ»¸öÔªËØ
2264:mac.c         **** void remove_pending_queue(INDIRECT_TX_PENDING_QUEUE  * current)
2265:mac.c         **** {
2266:mac.c         ****        uint8_t  index;
2267:mac.c         ****        INDIRECT_TX_PENDING_QUEUE * p_temp1;
2268:mac.c         **** 	INDIRECT_TX_PENDING_QUEUE * p_temp2;
2269:mac.c         **** 	p_temp1=head_of_indirect_pending_buffer;
2270:mac.c         **** 	p_temp2=head_of_indirect_pending_buffer;
2271:mac.c         **** 	while((p_temp2!=current)&&(p_temp2!=NULL))
2272:mac.c         **** 	{
2273:mac.c         **** 		    p_temp1=p_temp2;
2274:mac.c         **** 		    p_temp2=p_temp2->next;
2275:mac.c         **** 	}
2276:mac.c         **** 	if(p_temp2==NULL)
2277:mac.c         **** 	{
2278:mac.c         **** 	        error("\nthe frame is not in the pending queue\n");
2279:mac.c         **** 		 return;
2280:mac.c         **** 	}
2281:mac.c         **** 	else
2282:mac.c         **** 	{
2283:mac.c         **** 	       if(head_of_indirect_pending_buffer==tail_of_indirect_pending_buffer)
2284:mac.c         **** 	       {
2285:mac.c         **** 		   	head_of_indirect_pending_buffer=NULL;
2286:mac.c         **** 			tail_of_indirect_pending_buffer=NULL;
2287:mac.c         **** 	       }	
2288:mac.c         **** 		else if(p_temp2==head_of_indirect_pending_buffer)
2289:mac.c         **** 			{
2290:mac.c         **** 			     head_of_indirect_pending_buffer=p_temp2->next;
2291:mac.c         **** 			     p_temp2->next==NULL;
2292:mac.c         **** 			}
2293:mac.c         **** 		else
2294:mac.c         **** 		{
2295:mac.c         **** 		       p_temp1->next=p_temp2->next;
2296:mac.c         **** 			if(p_temp2->next!=NULL)   
2297:mac.c         **** 			tail_of_indirect_pending_buffer=p_temp2->next;   
2298:mac.c         **** 			else
2299:mac.c         **** 			tail_of_indirect_pending_buffer=p_temp1;
2300:mac.c         **** 		       p_temp2->next=NULL;
2301:mac.c         **** 			
2302:mac.c         **** 		}
2303:mac.c         **** 	}
2304:mac.c         **** 	//É¾³ýÐÅ±êÖ¡ÖÐµÄ¶ÔÓ¦µØÖ·ÁÐ±í
2305:mac.c         **** 	if(current->dst.addrMode==0x02)
2306:mac.c         **** 	{    
2307:mac.c         **** 	     index=0;
2308:mac.c         **** 	     while((current->dst.shortAddr.Val!=mac_tx_beacon.shortaddrpending_list[index].Val)&&(index<=m
2309:mac.c         **** 	     	     index++;
2310:mac.c         **** 	     if(current->dst.shortAddr.Val==mac_tx_beacon.shortaddrpending_list[index].Val)	 
2311:mac.c         **** 	     	{
2312:mac.c         **** 	     	     //¿ªÊ¼É¾³ýÐÅ±êÖ¡ÖÐµÄpendingµØÖ·
2313:mac.c         **** 	     	     
2314:mac.c         **** 	     	     for(;index<=mac_tx_beacon.shortpendingadd_length-1;index++)
2315:mac.c         **** 			    mac_tx_beacon.shortaddrpending_list[index]=mac_tx_beacon.shortaddrpending_list[index+1];
2316:mac.c         **** 		     mac_tx_beacon.shortpendingadd_length--;
2317:mac.c         **** 		     mac_tx_beacon.pendaddress_field.bytes=mac_tx_beacon.pendaddress_field.bytes-1;
2318:mac.c         **** 	     	}
2319:mac.c         **** 	     else
2320:mac.c         **** 	       error("\nIt is not in the pending queue\n");	 	
2321:mac.c         **** 	}
2322:mac.c         **** 	else if(current->dst.addrMode==0x03)
2323:mac.c         **** 	{
2324:mac.c         **** 	     index=0;
2325:mac.c         **** 	     while((current->dst.longAddr.longaddr!=mac_tx_beacon.longaddrpending_list[index].longaddr)&&(
2326:mac.c         **** 	             index++;
2327:mac.c         **** 	     if(current->dst.longAddr.longaddr==mac_tx_beacon.longaddrpending_list[index].longaddr)
2328:mac.c         **** 	     	{
2329:mac.c         **** 	     	       for(;index<=mac_tx_beacon.longpendingadd_length-1;index++)
2330:mac.c         **** 			     mac_tx_beacon.longaddrpending_list[index]=mac_tx_beacon.longaddrpending_list[index+1];
2331:mac.c         **** 			mac_tx_beacon.longpendingadd_length--;
2332:mac.c         **** 			mac_tx_beacon.pendaddress_field.bytes=mac_tx_beacon.pendaddress_field.bytes-16;
2333:mac.c         **** 	     	}
2334:mac.c         **** 	}
2335:mac.c         **** 	
2336:mac.c         ****        free(current);      
2337:mac.c         **** 	current_pending_num--;
2338:mac.c         **** }
2339:mac.c         **** //¸ù¾ÝÄ¿µÄ½ÚµãµØÖ·ÐÅÏ¢»ñÈ¡pendingÖÐµÄÖ¸Õë
2340:mac.c         **** INDIRECT_TX_PENDING_QUEUE * get_pending_frame(NODE_INFO dst)
2341:mac.c         **** {
 1310               	.LM130:
 1311               	/* prologue: frame size=13 */
 1312 05bc CF92      		push r12
 1313 05be DF92      		push r13
 1314 05c0 EF92      		push r14
 1315 05c2 FF92      		push r15
 1316 05c4 0F93      		push r16
 1317 05c6 1F93      		push r17
 1318 05c8 CF93      		push r28
 1319 05ca DF93      		push r29
 1320 05cc CDB7      		in r28,__SP_L__
 1321 05ce DEB7      		in r29,__SP_H__
 1322 05d0 2D97      		sbiw r28,13
 1323 05d2 0FB6      		in __tmp_reg__,__SREG__
 1324 05d4 F894      		cli
 1325 05d6 DEBF      		out __SP_H__,r29
 1326 05d8 0FBE      		out __SREG__,__tmp_reg__
 1327 05da CDBF      		out __SP_L__,r28
 1328               	/* prologue end (size=16) */
 1329 05dc C982      		std Y+1,r12
 1330 05de DA82      		std Y+2,r13
 1331 05e0 EB82      		std Y+3,r14
 1332 05e2 FC82      		std Y+4,r15
 1333 05e4 0D83      		std Y+5,r16
 1334 05e6 1E83      		std Y+6,r17
 1335 05e8 2F83      		std Y+7,r18
 1336 05ea 3887      		std Y+8,r19
 1337 05ec 4987      		std Y+9,r20
 1338 05ee 5A87      		std Y+10,r21
 1339 05f0 6B87      		std Y+11,r22
 1340 05f2 7C87      		std Y+12,r23
 1341 05f4 8D87      		std Y+13,r24
2342:mac.c         ****      INDIRECT_TX_PENDING_QUEUE  *p_temp;
2343:mac.c         ****      p_temp=head_of_indirect_pending_buffer; 
 1343               	.LM131:
 1344 05f6 0091 0000 		lds r16,head_of_indirect_pending_buffer
 1345 05fa 1091 0000 		lds r17,(head_of_indirect_pending_buffer)+1
 1346 05fe 4C85      		ldd r20,Y+12
 1347 0600 5D85      		ldd r21,Y+13
 1348 0602 2A85      		ldd r18,Y+10
 1349 0604 3B85      		ldd r19,Y+11
 1350 0606 ED2C      		mov r14,r13
 1351 0608 FB80      		ldd r15,Y+3
 1352 060a BC81      		ldd r27,Y+4
 1353 060c AD81      		ldd r26,Y+5
 1354 060e DE80      		ldd r13,Y+6
 1355 0610 CF80      		ldd r12,Y+7
 1356 0612 7885      		ldd r23,Y+8
 1357 0614 6985      		ldd r22,Y+9
2344:mac.c         ****      while((p_temp!=NULL)&&!((p_temp->dst.panID.Val==dst.panID.Val)&&((p_temp->dst.shortAddr.Val==d
 1359               	.LM132:
 1360 0616 03C0      		rjmp .L71
 1361               	.L74:
2345:mac.c         ****      	 p_temp=p_temp->next;     if(p_temp==NULL)
 1363               	.LM133:
 1364 0618 F801      		movw r30,r16
 1365 061a 00A9      		ldd r16,Z+48
 1366 061c 11A9      		ldd r17,Z+49
 1367               	.L71:
 1368 061e 0115      		cp r16,__zero_reg__
 1369 0620 1105      		cpc r17,__zero_reg__
 1370 0622 19F1      		breq .L72
 1371 0624 F801      		movw r30,r16
 1372 0626 868D      		ldd r24,Z+30
 1373 0628 978D      		ldd r25,Z+31
 1374 062a 8417      		cp r24,r20
 1375 062c 9507      		cpc r25,r21
 1376 062e A1F7      		brne .L74
 1377 0630 848D      		ldd r24,Z+28
 1378 0632 958D      		ldd r25,Z+29
 1379 0634 8217      		cp r24,r18
 1380 0636 9307      		cpc r25,r19
 1381 0638 C1F0      		breq .L72
 1382 063a 8489      		ldd r24,Z+20
 1383 063c 8E15      		cp r24,r14
 1384 063e 61F7      		brne .L74
 1385 0640 8589      		ldd r24,Z+21
 1386 0642 8F15      		cp r24,r15
 1387 0644 49F7      		brne .L74
 1388 0646 8689      		ldd r24,Z+22
 1389 0648 8B17      		cp r24,r27
 1390 064a 31F7      		brne .L74
 1391 064c 8789      		ldd r24,Z+23
 1392 064e 8A17      		cp r24,r26
 1393 0650 19F7      		brne .L74
 1394 0652 808D      		ldd r24,Z+24
 1395 0654 8D15      		cp r24,r13
 1396 0656 01F7      		brne .L74
 1397 0658 818D      		ldd r24,Z+25
 1398 065a 8C15      		cp r24,r12
 1399 065c E9F6      		brne .L74
 1400 065e 828D      		ldd r24,Z+26
 1401 0660 8717      		cp r24,r23
 1402 0662 D1F6      		brne .L74
 1403 0664 838D      		ldd r24,Z+27
 1404 0666 8617      		cp r24,r22
 1405 0668 B9F6      		brne .L74
 1406               	.L72:
 1407 066a 0115      		cp r16,__zero_reg__
 1408 066c 1105      		cpc r17,__zero_reg__
 1409 066e 21F4      		brne .L75
2346:mac.c         **** 	 	error("\ncannot find a pending frame in the queue\n");
 1411               	.LM134:
 1412 0670 80E0      		ldi r24,lo8(.LC6)
 1413 0672 90E0      		ldi r25,hi8(.LC6)
 1414 0674 0E94 0000 		call error
 1415               	.L75:
2347:mac.c         ****      return p_temp;
2348:mac.c         **** }
 1417               	.LM135:
 1418 0678 C801      		movw r24,r16
 1419               	/* epilogue: frame size=13 */
 1420 067a 2D96      		adiw r28,13
 1421 067c 0FB6      		in __tmp_reg__,__SREG__
 1422 067e F894      		cli
 1423 0680 DEBF      		out __SP_H__,r29
 1424 0682 0FBE      		out __SREG__,__tmp_reg__
 1425 0684 CDBF      		out __SP_L__,r28
 1426 0686 DF91      		pop r29
 1427 0688 CF91      		pop r28
 1428 068a 1F91      		pop r17
 1429 068c 0F91      		pop r16
 1430 068e FF90      		pop r15
 1431 0690 EF90      		pop r14
 1432 0692 DF90      		pop r13
 1433 0694 CF90      		pop r12
 1434 0696 0895      		ret
 1435               	/* epilogue end (size=15) */
 1436               	/* function get_pending_frame size 110 (79) */
 1441               	.Lscope17:
 1444               	.global	Is_data_pending
 1446               	Is_data_pending:
 1448               	.LM136:
 1449               	/* prologue: frame size=13 */
 1450 0698 CF92      		push r12
 1451 069a DF92      		push r13
 1452 069c EF92      		push r14
 1453 069e FF92      		push r15
 1454 06a0 0F93      		push r16
 1455 06a2 1F93      		push r17
 1456 06a4 CF93      		push r28
 1457 06a6 DF93      		push r29
 1458 06a8 CDB7      		in r28,__SP_L__
 1459 06aa DEB7      		in r29,__SP_H__
 1460 06ac 2D97      		sbiw r28,13
 1461 06ae 0FB6      		in __tmp_reg__,__SREG__
 1462 06b0 F894      		cli
 1463 06b2 DEBF      		out __SP_H__,r29
 1464 06b4 0FBE      		out __SREG__,__tmp_reg__
 1465 06b6 CDBF      		out __SP_L__,r28
 1466               	/* prologue end (size=16) */
 1467 06b8 C982      		std Y+1,r12
 1468 06ba DA82      		std Y+2,r13
 1469 06bc EB82      		std Y+3,r14
 1470 06be FC82      		std Y+4,r15
 1471 06c0 0D83      		std Y+5,r16
 1472 06c2 1E83      		std Y+6,r17
 1473 06c4 2F83      		std Y+7,r18
 1474 06c6 3887      		std Y+8,r19
 1475 06c8 4987      		std Y+9,r20
 1476 06ca 5A87      		std Y+10,r21
 1477 06cc 6B87      		std Y+11,r22
 1478 06ce 7C87      		std Y+12,r23
 1479 06d0 8D87      		std Y+13,r24
 1481               	.LM137:
 1482 06d2 E091 0000 		lds r30,head_of_indirect_pending_buffer
 1483 06d6 F091 0000 		lds r31,(head_of_indirect_pending_buffer)+1
 1485               	.LM138:
 1486 06da 3097      		sbiw r30,0
 1487 06dc 71F1      		breq .L84
 1488 06de 0D2D      		mov r16,r13
 1489 06e0 1E2D      		mov r17,r14
 1490 06e2 BF2D      		mov r27,r15
 1491 06e4 AD81      		ldd r26,Y+5
 1492 06e6 7E81      		ldd r23,Y+6
 1493 06e8 622F      		mov r22,r18
 1494 06ea 532F      		mov r21,r19
 1495 06ec 2A85      		ldd r18,Y+10
 1496 06ee 3B85      		ldd r19,Y+11
 1497               	.L82:
 1499               	.LM139:
 1500 06f0 8489      		ldd r24,Z+20
 1501 06f2 8017      		cp r24,r16
 1502 06f4 A9F4      		brne .L81
 1503 06f6 8589      		ldd r24,Z+21
 1504 06f8 8117      		cp r24,r17
 1505 06fa 91F4      		brne .L81
 1506 06fc 8689      		ldd r24,Z+22
 1507 06fe 8B17      		cp r24,r27
 1508 0700 79F4      		brne .L81
 1509 0702 8789      		ldd r24,Z+23
 1510 0704 8A17      		cp r24,r26
 1511 0706 61F4      		brne .L81
 1512 0708 808D      		ldd r24,Z+24
 1513 070a 8717      		cp r24,r23
 1514 070c 49F4      		brne .L81
 1515 070e 818D      		ldd r24,Z+25
 1516 0710 8617      		cp r24,r22
 1517 0712 31F4      		brne .L81
 1518 0714 828D      		ldd r24,Z+26
 1519 0716 8517      		cp r24,r21
 1520 0718 19F4      		brne .L81
 1521 071a 838D      		ldd r24,Z+27
 1522 071c 8417      		cp r24,r20
 1523 071e 29F0      		breq .L80
 1524               	.L81:
 1525 0720 848D      		ldd r24,Z+28
 1526 0722 958D      		ldd r25,Z+29
 1527 0724 8217      		cp r24,r18
 1528 0726 9307      		cpc r25,r19
 1529 0728 19F4      		brne .L79
 1530               	.L80:
 1532               	.LM140:
 1533 072a 81E0      		ldi r24,lo8(1)
 1534 072c 90E0      		ldi r25,hi8(1)
 1535 072e 07C0      		rjmp .L76
 1536               	.L79:
 1538               	.LM141:
 1539 0730 00A8      		ldd __tmp_reg__,Z+48
 1540 0732 F1A9      		ldd r31,Z+49
 1541 0734 E02D      		mov r30,__tmp_reg__
 1542 0736 3097      		sbiw r30,0
 1543 0738 D9F6      		brne .L82
 1544               	.L84:
 1546               	.LM142:
 1547 073a 80E0      		ldi r24,lo8(0)
 1548 073c 90E0      		ldi r25,hi8(0)
 1549               	.L76:
 1550               	/* epilogue: frame size=13 */
 1551 073e 2D96      		adiw r28,13
 1552 0740 0FB6      		in __tmp_reg__,__SREG__
 1553 0742 F894      		cli
 1554 0744 DEBF      		out __SP_H__,r29
 1555 0746 0FBE      		out __SREG__,__tmp_reg__
 1556 0748 CDBF      		out __SP_L__,r28
 1557 074a DF91      		pop r29
 1558 074c CF91      		pop r28
 1559 074e 1F91      		pop r17
 1560 0750 0F91      		pop r16
 1561 0752 FF90      		pop r15
 1562 0754 EF90      		pop r14
 1563 0756 DF90      		pop r13
 1564 0758 CF90      		pop r12
 1565 075a 0895      		ret
 1566               	/* epilogue end (size=15) */
 1567               	/* function Is_data_pending size 98 (67) */
 1572               	.Lscope18:
 1574               	.global	beacon_request_frame_send
 1576               	beacon_request_frame_send:
 1578               	.LM143:
 1579               	/* prologue: frame size=0 */
 1580               	/* prologue end (size=0) */
 1581               	/* epilogue: frame size=0 */
 1582 075c 0895      		ret
 1583               	/* epilogue end (size=1) */
 1584               	/* function beacon_request_frame_send size 1 (0) */
 1586               	.Lscope19:
 1588               	.global	beacon_frame_tx_timing
 1590               	beacon_frame_tx_timing:
 1592               	.LM144:
 1593               	/* prologue: frame size=0 */
 1594 075e 6F92      		push r6
 1595 0760 7F92      		push r7
 1596 0762 8F92      		push r8
 1597 0764 9F92      		push r9
 1598 0766 AF92      		push r10
 1599 0768 BF92      		push r11
 1600 076a CF92      		push r12
 1601 076c DF92      		push r13
 1602 076e EF92      		push r14
 1603 0770 FF92      		push r15
 1604 0772 0F93      		push r16
 1605 0774 1F93      		push r17
 1606               	/* prologue end (size=12) */
 1608               	.LM145:
 1609 0776 0E94 0000 		call systime32
 1610 077a 3B01      		movw r6,r22
 1611 077c 4C01      		movw r8,r24
 1613               	.LM146:
 1614 077e 8091 0000 		lds r24,last_beacon_tx_timestamp
 1615 0782 9091 0000 		lds r25,(last_beacon_tx_timestamp)+1
 1616 0786 A091 0000 		lds r26,(last_beacon_tx_timestamp)+2
 1617 078a B091 0000 		lds r27,(last_beacon_tx_timestamp)+3
 1618 078e 6401      		movw r12,r8
 1619 0790 5301      		movw r10,r6
 1620 0792 A81A      		sub r10,r24
 1621 0794 B90A      		sbc r11,r25
 1622 0796 CA0A      		sbc r12,r26
 1623 0798 DB0A      		sbc r13,r27
 1624 079a 6816      		cp r6,r24
 1625 079c 7906      		cpc r7,r25
 1626 079e 8A06      		cpc r8,r26
 1627 07a0 9B06      		cpc r9,r27
 1628 07a2 40F4      		brsh .L87
 1630               	.LM147:
 1631 07a4 8FEF      		ldi r24,lo8(1073741823)
 1632 07a6 9FEF      		ldi r25,hi8(1073741823)
 1633 07a8 AFEF      		ldi r26,hlo8(1073741823)
 1634 07aa BFE3      		ldi r27,hhi8(1073741823)
 1635 07ac A80E      		add r10,r24
 1636 07ae B91E      		adc r11,r25
 1637 07b0 CA1E      		adc r12,r26
 1638 07b2 DB1E      		adc r13,r27
 1639               	.L87:
 1641               	.LM148:
 1642 07b4 8601      		movw r16,r12
 1643 07b6 7501      		movw r14,r10
 1644 07b8 1695      		lsr r17
 1645 07ba 0795      		ror r16
 1646 07bc F794      		ror r15
 1647 07be E794      		ror r14
 1648 07c0 8091 0000 		lds r24,MAC_CAP_PERIOD
 1649 07c4 9091 0000 		lds r25,(MAC_CAP_PERIOD)+1
 1650 07c8 A091 0000 		lds r26,(MAC_CAP_PERIOD)+2
 1651 07cc B091 0000 		lds r27,(MAC_CAP_PERIOD)+3
 1652 07d0 8E19      		sub r24,r14
 1653 07d2 9F09      		sbc r25,r15
 1654 07d4 A00B      		sbc r26,r16
 1655 07d6 B10B      		sbc r27,r17
 1656 07d8 9C01      		movw r18,r24
 1657 07da AD01      		movw r20,r26
 1658 07dc 62E0      		ldi r22,lo8(2)
 1659 07de 8091 0000 		lds r24,head_of_systimer_queue
 1660 07e2 9091 0000 		lds r25,(head_of_systimer_queue)+1
 1661 07e6 0E94 0000 		call systimer_start_task
 1662 07ea FC01      		movw r30,r24
 1663 07ec 9093 0000 		sts (head_of_systimer_queue)+1,r25
 1664 07f0 8093 0000 		sts head_of_systimer_queue,r24
 1666               	.LM149:
 1667 07f4 8091 0000 		lds r24,MAC_SUPERFRAME_PERIOD
 1668 07f8 9091 0000 		lds r25,(MAC_SUPERFRAME_PERIOD)+1
 1669 07fc A091 0000 		lds r26,(MAC_SUPERFRAME_PERIOD)+2
 1670 0800 B091 0000 		lds r27,(MAC_SUPERFRAME_PERIOD)+3
 1671 0804 8E19      		sub r24,r14
 1672 0806 9F09      		sbc r25,r15
 1673 0808 A00B      		sbc r26,r16
 1674 080a B10B      		sbc r27,r17
 1675 080c 9C01      		movw r18,r24
 1676 080e AD01      		movw r20,r26
 1677 0810 60E0      		ldi r22,lo8(0)
 1678 0812 CF01      		movw r24,r30
 1679 0814 0E94 0000 		call systimer_start_task
 1680 0818 9093 0000 		sts (head_of_systimer_queue)+1,r25
 1681 081c 8093 0000 		sts head_of_systimer_queue,r24
 1683               	.LM150:
 1684 0820 8091 0000 		lds r24,last_beacon_tx_timestamp
 1685 0824 9091 0000 		lds r25,(last_beacon_tx_timestamp)+1
 1686 0828 A091 0000 		lds r26,(last_beacon_tx_timestamp)+2
 1687 082c B091 0000 		lds r27,(last_beacon_tx_timestamp)+3
 1688 0830 8093 0000 		sts MAC_OBJECT_CAP_START_TICKS,r24
 1689 0834 9093 0000 		sts (MAC_OBJECT_CAP_START_TICKS)+1,r25
 1690 0838 A093 0000 		sts (MAC_OBJECT_CAP_START_TICKS)+2,r26
 1691 083c B093 0000 		sts (MAC_OBJECT_CAP_START_TICKS)+3,r27
 1693               	.LM151:
 1694 0840 8091 0000 		lds r24,MAC_CAP_PERIOD
 1695 0844 9091 0000 		lds r25,(MAC_CAP_PERIOD)+1
 1696 0848 A091 0000 		lds r26,(MAC_CAP_PERIOD)+2
 1697 084c B091 0000 		lds r27,(MAC_CAP_PERIOD)+3
 1698 0850 880F      		lsl r24
 1699 0852 991F      		rol r25
 1700 0854 AA1F      		rol r26
 1701 0856 BB1F      		rol r27
 1702 0858 8A19      		sub r24,r10
 1703 085a 9B09      		sbc r25,r11
 1704 085c AC09      		sbc r26,r12
 1705 085e BD09      		sbc r27,r13
 1706 0860 860D      		add r24,r6
 1707 0862 971D      		adc r25,r7
 1708 0864 A81D      		adc r26,r8
 1709 0866 B91D      		adc r27,r9
 1710 0868 8093 0000 		sts MAC_OBJECT_CAP_END_TICKS,r24
 1711 086c 9093 0000 		sts (MAC_OBJECT_CAP_END_TICKS)+1,r25
 1712 0870 A093 0000 		sts (MAC_OBJECT_CAP_END_TICKS)+2,r26
 1713 0874 B093 0000 		sts (MAC_OBJECT_CAP_END_TICKS)+3,r27
 1715               	.LM152:
 1716 0878 8091 0000 		lds r24,MAC_SUPERFRAME_PERIOD
 1717 087c 9091 0000 		lds r25,(MAC_SUPERFRAME_PERIOD)+1
 1718 0880 A091 0000 		lds r26,(MAC_SUPERFRAME_PERIOD)+2
 1719 0884 B091 0000 		lds r27,(MAC_SUPERFRAME_PERIOD)+3
 1720 0888 880F      		lsl r24
 1721 088a 991F      		rol r25
 1722 088c AA1F      		rol r26
 1723 088e BB1F      		rol r27
 1724 0890 8A19      		sub r24,r10
 1725 0892 9B09      		sbc r25,r11
 1726 0894 AC09      		sbc r26,r12
 1727 0896 BD09      		sbc r27,r13
 1728 0898 860D      		add r24,r6
 1729 089a 971D      		adc r25,r7
 1730 089c A81D      		adc r26,r8
 1731 089e B91D      		adc r27,r9
 1732 08a0 8093 0000 		sts MAC_OBJECT_SUPERFRAME_TICKS,r24
 1733 08a4 9093 0000 		sts (MAC_OBJECT_SUPERFRAME_TICKS)+1,r25
 1734 08a8 A093 0000 		sts (MAC_OBJECT_SUPERFRAME_TICKS)+2,r26
 1735 08ac B093 0000 		sts (MAC_OBJECT_SUPERFRAME_TICKS)+3,r27
 1736               	/* epilogue: frame size=0 */
 1737 08b0 1F91      		pop r17
 1738 08b2 0F91      		pop r16
 1739 08b4 FF90      		pop r15
 1740 08b6 EF90      		pop r14
 1741 08b8 DF90      		pop r13
 1742 08ba CF90      		pop r12
 1743 08bc BF90      		pop r11
 1744 08be AF90      		pop r10
 1745 08c0 9F90      		pop r9
 1746 08c2 8F90      		pop r8
 1747 08c4 7F90      		pop r7
 1748 08c6 6F90      		pop r6
 1749 08c8 0895      		ret
 1750               	/* epilogue end (size=13) */
 1751               	/* function beacon_frame_tx_timing size 182 (157) */
 1757               	.Lscope20:
 1759               	.global	timerqueue_adjust
 1761               	timerqueue_adjust:
 1763               	.LM153:
 1764               	/* prologue: frame size=0 */
 1765               	/* prologue end (size=0) */
 1767               	.LM154:
 1768 08ca E091 0000 		lds r30,head_of_timer_queue
 1769 08ce F091 0000 		lds r31,(head_of_timer_queue)+1
 1770 08d2 F093 0000 		sts (current_timer_elem)+1,r31
 1771 08d6 E093 0000 		sts current_timer_elem,r30
 1773               	.LM155:
 1774 08da 1186      		std Z+9,__zero_reg__
 1775 08dc 1286      		std Z+10,__zero_reg__
 1777               	.LM156:
 1778 08de 1092 0000 		sts (head_of_timer_queue)+1,__zero_reg__
 1779 08e2 1092 0000 		sts head_of_timer_queue,__zero_reg__
 1780               	/* epilogue: frame size=0 */
 1781 08e6 0895      		ret
 1782               	/* epilogue end (size=1) */
 1783               	/* function timerqueue_adjust size 15 (14) */
 1785               	.Lscope21:
 1786               		.data
 1787               	.LC7:
 1788 0132 0A74 6865 		.string	"\nthe frame is not in the pending queue\n"
 1788      2066 7261 
 1788      6D65 2069 
 1788      7320 6E6F 
 1788      7420 696E 
 1789               	.LC8:
 1790 015a 0A49 7420 		.string	"\nIt is not in the pending queue\n"
 1790      6973 206E 
 1790      6F74 2069 
 1790      6E20 7468 
 1790      6520 7065 
 1791               		.text
 1794               	.global	remove_pending_queue
 1796               	remove_pending_queue:
 1798               	.LM157:
 1799               	/* prologue: frame size=0 */
 1800 08e8 CF93      		push r28
 1801 08ea DF93      		push r29
 1802               	/* prologue end (size=2) */
 1803 08ec EC01      		movw r28,r24
 1805               	.LM158:
 1806 08ee 4091 0000 		lds r20,head_of_indirect_pending_buffer
 1807 08f2 5091 0000 		lds r21,(head_of_indirect_pending_buffer)+1
 1808 08f6 9A01      		movw r18,r20
 1810               	.LM159:
 1811 08f8 DA01      		movw r26,r20
 1812 08fa 07C0      		rjmp .L129
 1813               	.L128:
 1815               	.LM160:
 1816 08fc 4115      		cp r20,__zero_reg__
 1817 08fe 5105      		cpc r21,__zero_reg__
 1818 0900 39F0      		breq .L91
 1820               	.LM161:
 1821 0902 DA01      		movw r26,r20
 1823               	.LM162:
 1824 0904 FA01      		movw r30,r20
 1825 0906 40A9      		ldd r20,Z+48
 1826 0908 51A9      		ldd r21,Z+49
 1827               	.L129:
 1828 090a 4C17      		cp r20,r28
 1829 090c 5D07      		cpc r21,r29
 1830 090e B1F7      		brne .L128
 1831               	.L91:
 1833               	.LM163:
 1834 0910 4115      		cp r20,__zero_reg__
 1835 0912 5105      		cpc r21,__zero_reg__
 1836 0914 29F4      		brne .L93
 1838               	.LM164:
 1839 0916 80E0      		ldi r24,lo8(.LC7)
 1840 0918 90E0      		ldi r25,hi8(.LC7)
 1841 091a 0E94 0000 		call error
 1843               	.LM165:
 1844 091e 13C1      		rjmp .L89
 1845               	.L93:
 1847               	.LM166:
 1848 0920 8091 0000 		lds r24,tail_of_indirect_pending_buffer
 1849 0924 9091 0000 		lds r25,(tail_of_indirect_pending_buffer)+1
 1850 0928 2817      		cp r18,r24
 1851 092a 3907      		cpc r19,r25
 1852 092c 49F4      		brne .L95
 1854               	.LM167:
 1855 092e 1092 0000 		sts (head_of_indirect_pending_buffer)+1,__zero_reg__
 1856 0932 1092 0000 		sts head_of_indirect_pending_buffer,__zero_reg__
 1858               	.LM168:
 1859 0936 1092 0000 		sts (tail_of_indirect_pending_buffer)+1,__zero_reg__
 1860 093a 1092 0000 		sts tail_of_indirect_pending_buffer,__zero_reg__
 1861 093e 1FC0      		rjmp .L94
 1862               	.L95:
 1863 0940 FA01      		movw r30,r20
 1864 0942 80A9      		ldd r24,Z+48
 1865 0944 91A9      		ldd r25,Z+49
 1867               	.LM169:
 1868 0946 4217      		cp r20,r18
 1869 0948 5307      		cpc r21,r19
 1870 094a 29F4      		brne .L97
 1872               	.LM170:
 1873 094c 9093 0000 		sts (head_of_indirect_pending_buffer)+1,r25
 1874 0950 8093 0000 		sts head_of_indirect_pending_buffer,r24
 1876               	.LM171:
 1877 0954 14C0      		rjmp .L94
 1878               	.L97:
 1880               	.LM172:
 1881 0956 FD01      		movw r30,r26
 1882 0958 80AB      		std Z+48,r24
 1883 095a 91AB      		std Z+49,r25
 1885               	.LM173:
 1886 095c FA01      		movw r30,r20
 1887 095e 80A9      		ldd r24,Z+48
 1888 0960 91A9      		ldd r25,Z+49
 1889 0962 0097      		sbiw r24,0
 1890 0964 29F0      		breq .L99
 1892               	.LM174:
 1893 0966 9093 0000 		sts (tail_of_indirect_pending_buffer)+1,r25
 1894 096a 8093 0000 		sts tail_of_indirect_pending_buffer,r24
 1895 096e 04C0      		rjmp .L100
 1896               	.L99:
 1898               	.LM175:
 1899 0970 B093 0000 		sts (tail_of_indirect_pending_buffer)+1,r27
 1900 0974 A093 0000 		sts tail_of_indirect_pending_buffer,r26
 1901               	.L100:
 1903               	.LM176:
 1904 0978 FA01      		movw r30,r20
 1905 097a 10AA      		std Z+48,__zero_reg__
 1906 097c 11AA      		std Z+49,__zero_reg__
 1907               	.L94:
 1909               	.LM177:
 1910 097e 8B89      		ldd r24,Y+19
 1911 0980 8230      		cpi r24,lo8(2)
 1912 0982 09F0      		breq .+2
 1913 0984 48C0      		rjmp .L101
 1915               	.LM178:
 1916 0986 70E0      		ldi r23,lo8(0)
 1918               	.LM179:
 1919 0988 4C8D      		ldd r20,Y+28
 1920 098a 5D8D      		ldd r21,Y+29
 1921 098c 8091 0000 		lds r24,mac_tx_beacon+5
 1922 0990 9091 0000 		lds r25,(mac_tx_beacon+5)+1
 1923 0994 4817      		cp r20,r24
 1924 0996 5907      		cpc r21,r25
 1925 0998 81F0      		breq .L103
 1926 099a 2091 0000 		lds r18,mac_tx_beacon+3
 1927               	.L104:
 1928 099e 7F5F      		subi r23,lo8(-(1))
 1929 09a0 E72F      		mov r30,r23
 1930 09a2 FF27      		clr r31
 1931 09a4 EE0F      		add r30,r30
 1932 09a6 FF1F      		adc r31,r31
 1933 09a8 E050      		subi r30,lo8(-(mac_tx_beacon))
 1934 09aa F040      		sbci r31,hi8(-(mac_tx_beacon))
 1935 09ac 8581      		ldd r24,Z+5
 1936 09ae 9681      		ldd r25,Z+6
 1937 09b0 4817      		cp r20,r24
 1938 09b2 5907      		cpc r21,r25
 1939 09b4 11F0      		breq .L103
 1940 09b6 2717      		cp r18,r23
 1941 09b8 90F7      		brsh .L104
 1942               	.L103:
 1944               	.LM180:
 1945 09ba 272F      		mov r18,r23
 1946 09bc 3327      		clr r19
 1947 09be F901      		movw r30,r18
 1948 09c0 E20F      		add r30,r18
 1949 09c2 F31F      		adc r31,r19
 1950 09c4 E050      		subi r30,lo8(-(mac_tx_beacon))
 1951 09c6 F040      		sbci r31,hi8(-(mac_tx_beacon))
 1952 09c8 8581      		ldd r24,Z+5
 1953 09ca 9681      		ldd r25,Z+6
 1954 09cc 4817      		cp r20,r24
 1955 09ce 5907      		cpc r21,r25
 1956 09d0 E9F4      		brne .L105
 1958               	.LM181:
 1959 09d2 6091 0000 		lds r22,mac_tx_beacon+3
 1960 09d6 462F      		mov r20,r22
 1961 09d8 5527      		clr r21
 1962 09da 4150      		subi r20,lo8(-(-1))
 1963 09dc 5040      		sbci r21,hi8(-(-1))
 1964               	.L130:
 1965 09de 4217      		cp r20,r18
 1966 09e0 5307      		cpc r21,r19
 1967 09e2 6CF0      		brlt .L125
 1969               	.LM182:
 1970 09e4 F901      		movw r30,r18
 1971 09e6 E20F      		add r30,r18
 1972 09e8 F31F      		adc r31,r19
 1973 09ea E050      		subi r30,lo8(-(mac_tx_beacon))
 1974 09ec F040      		sbci r31,hi8(-(mac_tx_beacon))
 1975 09ee 8781      		ldd r24,Z+7
 1976 09f0 9085      		ldd r25,Z+8
 1977 09f2 8583      		std Z+5,r24
 1978 09f4 9683      		std Z+6,r25
 1980               	.LM183:
 1981 09f6 7F5F      		subi r23,lo8(-(1))
 1982 09f8 272F      		mov r18,r23
 1983 09fa 3327      		clr r19
 1984 09fc F0CF      		rjmp .L130
 1985               	.L125:
 1987               	.LM184:
 1988 09fe 6150      		subi r22,lo8(-(-1))
 1989 0a00 6093 0000 		sts mac_tx_beacon+3,r22
 1991               	.LM185:
 1992 0a04 8091 0000 		lds r24,mac_tx_beacon+2
 1993 0a08 8150      		subi r24,lo8(-(-1))
 1994 0a0a 93C0      		rjmp .L131
 1995               	.L105:
 1997               	.LM186:
 1998 0a0c 80E0      		ldi r24,lo8(.LC8)
 1999 0a0e 90E0      		ldi r25,hi8(.LC8)
 2000 0a10 0E94 0000 		call error
 2001 0a14 90C0      		rjmp .L111
 2002               	.L101:
 2004               	.LM187:
 2005 0a16 8330      		cpi r24,lo8(3)
 2006 0a18 09F0      		breq .+2
 2007 0a1a 8DC0      		rjmp .L111
 2009               	.LM188:
 2010 0a1c 70E0      		ldi r23,lo8(0)
 2011 0a1e 4C89      		ldd r20,Y+20
 2012 0a20 5091 0000 		lds r21,mac_tx_beacon+4
 2014               	.LM189:
 2015 0a24 01C0      		rjmp .L113
 2016               	.L116:
 2018               	.LM190:
 2019 0a26 7F5F      		subi r23,lo8(-(1))
 2020               	.L113:
 2021 0a28 272F      		mov r18,r23
 2022 0a2a 3327      		clr r19
 2023 0a2c F901      		movw r30,r18
 2024 0a2e 83E0      		ldi r24,3
 2025 0a30 EE0F      	1:	lsl r30
 2026 0a32 FF1F      		rol r31
 2027 0a34 8A95      		dec r24
 2028 0a36 E1F7      		brne 1b
 2029 0a38 E050      		subi r30,lo8(-(mac_tx_beacon))
 2030 0a3a F040      		sbci r31,hi8(-(mac_tx_beacon))
 2031 0a3c DF01      		movw r26,r30
 2032 0a3e 1996      		adiw r26,9
 2033 0a40 8185      		ldd r24,Z+9
 2034 0a42 4817      		cp r20,r24
 2035 0a44 E9F4      		brne .L115
 2036 0a46 9D89      		ldd r25,Y+21
 2037 0a48 FD01      		movw r30,r26
 2038 0a4a 8181      		ldd r24,Z+1
 2039 0a4c 9817      		cp r25,r24
 2040 0a4e C1F4      		brne .L115
 2041 0a50 9E89      		ldd r25,Y+22
 2042 0a52 8281      		ldd r24,Z+2
 2043 0a54 9817      		cp r25,r24
 2044 0a56 A1F4      		brne .L115
 2045 0a58 9F89      		ldd r25,Y+23
 2046 0a5a 8381      		ldd r24,Z+3
 2047 0a5c 9817      		cp r25,r24
 2048 0a5e 81F4      		brne .L115
 2049 0a60 988D      		ldd r25,Y+24
 2050 0a62 8481      		ldd r24,Z+4
 2051 0a64 9817      		cp r25,r24
 2052 0a66 61F4      		brne .L115
 2053 0a68 998D      		ldd r25,Y+25
 2054 0a6a 8581      		ldd r24,Z+5
 2055 0a6c 9817      		cp r25,r24
 2056 0a6e 41F4      		brne .L115
 2057 0a70 9A8D      		ldd r25,Y+26
 2058 0a72 8681      		ldd r24,Z+6
 2059 0a74 9817      		cp r25,r24
 2060 0a76 21F4      		brne .L115
 2061 0a78 9B8D      		ldd r25,Y+27
 2062 0a7a 8781      		ldd r24,Z+7
 2063 0a7c 9817      		cp r25,r24
 2064 0a7e 11F0      		breq .L114
 2065               	.L115:
 2066 0a80 5717      		cp r21,r23
 2067 0a82 88F6      		brsh .L116
 2068               	.L114:
 2070               	.LM191:
 2071 0a84 F901      		movw r30,r18
 2072 0a86 B3E0      		ldi r27,3
 2073 0a88 EE0F      	1:	lsl r30
 2074 0a8a FF1F      		rol r31
 2075 0a8c BA95      		dec r27
 2076 0a8e E1F7      		brne 1b
 2077 0a90 E050      		subi r30,lo8(-(mac_tx_beacon))
 2078 0a92 F040      		sbci r31,hi8(-(mac_tx_beacon))
 2079 0a94 DF01      		movw r26,r30
 2080 0a96 1996      		adiw r26,9
 2081 0a98 8185      		ldd r24,Z+9
 2082 0a9a 4817      		cp r20,r24
 2083 0a9c 09F0      		breq .+2
 2084 0a9e 4BC0      		rjmp .L111
 2085 0aa0 9D89      		ldd r25,Y+21
 2086 0aa2 FD01      		movw r30,r26
 2087 0aa4 8181      		ldd r24,Z+1
 2088 0aa6 9817      		cp r25,r24
 2089 0aa8 09F0      		breq .+2
 2090 0aaa 45C0      		rjmp .L111
 2091 0aac 9E89      		ldd r25,Y+22
 2092 0aae 8281      		ldd r24,Z+2
 2093 0ab0 9817      		cp r25,r24
 2094 0ab2 09F0      		breq .+2
 2095 0ab4 40C0      		rjmp .L111
 2096 0ab6 9F89      		ldd r25,Y+23
 2097 0ab8 8381      		ldd r24,Z+3
 2098 0aba 9817      		cp r25,r24
 2099 0abc E1F5      		brne .L111
 2100 0abe 988D      		ldd r25,Y+24
 2101 0ac0 8481      		ldd r24,Z+4
 2102 0ac2 9817      		cp r25,r24
 2103 0ac4 C1F5      		brne .L111
 2104 0ac6 998D      		ldd r25,Y+25
 2105 0ac8 8581      		ldd r24,Z+5
 2106 0aca 9817      		cp r25,r24
 2107 0acc A1F5      		brne .L111
 2108 0ace 9A8D      		ldd r25,Y+26
 2109 0ad0 8681      		ldd r24,Z+6
 2110 0ad2 9817      		cp r25,r24
 2111 0ad4 81F5      		brne .L111
 2112 0ad6 9B8D      		ldd r25,Y+27
 2113 0ad8 8781      		ldd r24,Z+7
 2114 0ada 9817      		cp r25,r24
 2115 0adc 61F5      		brne .L111
 2117               	.LM192:
 2118 0ade 8091 0000 		lds r24,mac_tx_beacon+4
 2119 0ae2 9927      		clr r25
 2120 0ae4 0197      		sbiw r24,1
 2121 0ae6 8217      		cp r24,r18
 2122 0ae8 9307      		cpc r25,r19
 2123 0aea DCF0      		brlt .L127
 2124 0aec 48E0      		ldi r20,lo8(8)
 2125               	.L121:
 2127               	.LM193:
 2128 0aee F901      		movw r30,r18
 2129 0af0 A3E0      		ldi r26,3
 2130 0af2 EE0F      	1:	lsl r30
 2131 0af4 FF1F      		rol r31
 2132 0af6 AA95      		dec r26
 2133 0af8 E1F7      		brne 1b
 2134 0afa DF01      		movw r26,r30
 2135 0afc A050      		subi r26,lo8(-(mac_tx_beacon+17))
 2136 0afe B040      		sbci r27,hi8(-(mac_tx_beacon+17))
 2137 0b00 E050      		subi r30,lo8(-(mac_tx_beacon+9))
 2138 0b02 F040      		sbci r31,hi8(-(mac_tx_beacon+9))
 2139 0b04 842F      		mov r24,r20
 2140 0b06 0D90      		ld __tmp_reg__,X+
 2141 0b08 0192      		st Z+,__tmp_reg__
 2142 0b0a 8A95      		dec r24
 2143 0b0c E1F7      		brne .-8
 2145               	.LM194:
 2146 0b0e 7F5F      		subi r23,lo8(-(1))
 2147 0b10 272F      		mov r18,r23
 2148 0b12 3327      		clr r19
 2149 0b14 8091 0000 		lds r24,mac_tx_beacon+4
 2150 0b18 9927      		clr r25
 2151 0b1a 0197      		sbiw r24,1
 2152 0b1c 8217      		cp r24,r18
 2153 0b1e 9307      		cpc r25,r19
 2154 0b20 34F7      		brge .L121
 2155               	.L127:
 2157               	.LM195:
 2158 0b22 8091 0000 		lds r24,mac_tx_beacon+4
 2159 0b26 8150      		subi r24,lo8(-(-1))
 2160 0b28 8093 0000 		sts mac_tx_beacon+4,r24
 2162               	.LM196:
 2163 0b2c 8091 0000 		lds r24,mac_tx_beacon+2
 2164 0b30 8051      		subi r24,lo8(-(-16))
 2165               	.L131:
 2166 0b32 8093 0000 		sts mac_tx_beacon+2,r24
 2167               	.L111:
 2169               	.LM197:
 2170 0b36 CE01      		movw r24,r28
 2171 0b38 0E94 0000 		call free
 2173               	.LM198:
 2174 0b3c 8091 0000 		lds r24,current_pending_num
 2175 0b40 8150      		subi r24,lo8(-(-1))
 2176 0b42 8093 0000 		sts current_pending_num,r24
 2177               	.L89:
 2178               	/* epilogue: frame size=0 */
 2179 0b46 DF91      		pop r29
 2180 0b48 CF91      		pop r28
 2181 0b4a 0895      		ret
 2182               	/* epilogue end (size=3) */
 2183               	/* function remove_pending_queue size 306 (301) */
 2190               	.Lscope22:
 2192               	.global	pending_frame_handle
 2194               	pending_frame_handle:
 2196               	.LM199:
 2197               	/* prologue: frame size=0 */
 2198 0b4c CF93      		push r28
 2199 0b4e DF93      		push r29
 2200               	/* prologue end (size=2) */
 2202               	.LM200:
 2203 0b50 C091 0000 		lds r28,head_of_indirect_pending_buffer
 2204 0b54 D091 0000 		lds r29,(head_of_indirect_pending_buffer)+1
 2206               	.LM201:
 2207 0b58 2097      		sbiw r28,0
 2208 0b5a C9F0      		breq .L139
 2209               	.L137:
 2211               	.LM202:
 2212 0b5c 8981      		ldd r24,Y+1
 2213 0b5e 9A81      		ldd r25,Y+2
 2214 0b60 0197      		sbiw r24,1
 2215 0b62 8983      		std Y+1,r24
 2216 0b64 9A83      		std Y+2,r25
 2218               	.LM203:
 2219 0b66 892B      		or r24,r25
 2220 0b68 69F4      		brne .L135
 2222               	.LM204:
 2223 0b6a 8C81      		ldd r24,Y+4
 2224 0b6c 9927      		clr r25
 2225 0b6e 8770      		andi r24,lo8(7)
 2226 0b70 9070      		andi r25,hi8(7)
 2227 0b72 0197      		sbiw r24,1
 2228 0b74 21F4      		brne .L136
 2230               	.LM205:
 2231 0b76 6B81      		ldd r22,Y+3
 2232 0b78 80EF      		ldi r24,lo8(-16)
 2233 0b7a 0E94 0000 		call mcpsDataConfirm
 2234               	.L136:
 2236               	.LM206:
 2237 0b7e CE01      		movw r24,r28
 2238 0b80 0E94 0000 		call remove_pending_queue
 2239               	.L135:
 2241               	.LM207:
 2242 0b84 08A8      		ldd __tmp_reg__,Y+48
 2243 0b86 D9A9      		ldd r29,Y+49
 2244 0b88 C02D      		mov r28,__tmp_reg__
 2245 0b8a 2097      		sbiw r28,0
 2246 0b8c 39F7      		brne .L137
 2247               	.L139:
 2248               	/* epilogue: frame size=0 */
 2249 0b8e DF91      		pop r29
 2250 0b90 CF91      		pop r28
 2251 0b92 0895      		ret
 2252               	/* epilogue end (size=3) */
 2253               	/* function pending_frame_handle size 37 (32) */
 2258               	.Lscope23:
 2261               	.global	remove_from_rx_buffer
 2263               	remove_from_rx_buffer:
 2265               	.LM208:
 2266               	/* prologue: frame size=0 */
 2267 0b94 0F93      		push r16
 2268 0b96 1F93      		push r17
 2269               	/* prologue end (size=2) */
 2270 0b98 8C01      		movw r16,r24
 2272               	.LM209:
 2273 0b9a FC01      		movw r30,r24
 2274 0b9c 8181      		ldd r24,Z+1
 2275 0b9e 9281      		ldd r25,Z+2
 2276 0ba0 0E94 0000 		call free
 2278               	.LM210:
 2279 0ba4 C801      		movw r24,r16
 2280 0ba6 0E94 0000 		call free
 2281               	/* epilogue: frame size=0 */
 2282 0baa 1F91      		pop r17
 2283 0bac 0F91      		pop r16
 2284 0bae 0895      		ret
 2285               	/* epilogue end (size=3) */
 2286               	/* function remove_from_rx_buffer size 14 (9) */
 2288               	.Lscope24:
 2289               		.data
 2290               	.LC9:
 2291 017b 0A20 6361 		.string	"\n cannot find the corresponding frame in the tx buffer\n"
 2291      6E6E 6F74 
 2291      2066 696E 
 2291      6420 7468 
 2291      6520 636F 
 2292               		.text
 2295               	.global	remove_tx_queue
 2297               	remove_tx_queue:
 2299               	.LM211:
 2300               	/* prologue: frame size=0 */
 2301 0bb0 CF93      		push r28
 2302 0bb2 DF93      		push r29
 2303               	/* prologue end (size=2) */
 2304 0bb4 982F      		mov r25,r24
 2306               	.LM212:
 2307 0bb6 C091 0000 		lds r28,head_of_tx_buffer
 2308 0bba D091 0000 		lds r29,(head_of_tx_buffer)+1
 2310               	.LM213:
 2311 0bbe FE01      		movw r30,r28
 2312 0bc0 06C0      		rjmp .L151
 2313               	.L150:
 2315               	.LM214:
 2316 0bc2 2097      		sbiw r28,0
 2317 0bc4 39F0      		breq .L143
 2319               	.LM215:
 2320 0bc6 FE01      		movw r30,r28
 2322               	.LM216:
 2323 0bc8 0984      		ldd __tmp_reg__,Y+9
 2324 0bca DA85      		ldd r29,Y+10
 2325 0bcc C02D      		mov r28,__tmp_reg__
 2326               	.L151:
 2327 0bce 8B81      		ldd r24,Y+3
 2328 0bd0 8917      		cp r24,r25
 2329 0bd2 B9F7      		brne .L150
 2330               	.L143:
 2332               	.LM217:
 2333 0bd4 2097      		sbiw r28,0
 2334 0bd6 29F4      		brne .L145
 2336               	.LM218:
 2337 0bd8 80E0      		ldi r24,lo8(.LC9)
 2338 0bda 90E0      		ldi r25,hi8(.LC9)
 2339 0bdc 0E94 0000 		call error
 2340 0be0 19C0      		rjmp .L141
 2341               	.L145:
 2342 0be2 8985      		ldd r24,Y+9
 2343 0be4 9A85      		ldd r25,Y+10
 2345               	.LM219:
 2346 0be6 EC17      		cp r30,r28
 2347 0be8 FD07      		cpc r31,r29
 2348 0bea 49F4      		brne .L147
 2350               	.LM220:
 2351 0bec 9093 0000 		sts (head_of_tx_buffer)+1,r25
 2352 0bf0 8093 0000 		sts head_of_tx_buffer,r24
 2354               	.LM221:
 2355 0bf4 9093 0000 		sts (tail_of_tx_buffer)+1,r25
 2356 0bf8 8093 0000 		sts tail_of_tx_buffer,r24
 2357 0bfc 04C0      		rjmp .L148
 2358               	.L147:
 2360               	.LM222:
 2361 0bfe 8187      		std Z+9,r24
 2362 0c00 9287      		std Z+10,r25
 2364               	.LM223:
 2365 0c02 1986      		std Y+9,__zero_reg__
 2366 0c04 1A86      		std Y+10,__zero_reg__
 2367               	.L148:
 2369               	.LM224:
 2370 0c06 8F81      		ldd r24,Y+7
 2371 0c08 9885      		ldd r25,Y+8
 2372 0c0a 0E94 0000 		call free
 2374               	.LM225:
 2375 0c0e CE01      		movw r24,r28
 2376 0c10 0E94 0000 		call free
 2377               	.L141:
 2378               	/* epilogue: frame size=0 */
 2379 0c14 DF91      		pop r29
 2380 0c16 CF91      		pop r28
 2381 0c18 0895      		ret
 2382               	/* epilogue end (size=3) */
 2383               	/* function remove_tx_queue size 53 (48) */
 2389               	.Lscope25:
 2391               	.global	mac_timer3queue_getnextinterval
 2393               	mac_timer3queue_getnextinterval:
 2395               	.LM226:
 2396               	/* prologue: frame size=0 */
 2397               	/* prologue end (size=0) */
 2399               	.LM227:
 2400 0c1a E091 0000 		lds r30,head_of_timer_queue
 2401 0c1e F091 0000 		lds r31,(head_of_timer_queue)+1
 2402 0c22 0184      		ldd __tmp_reg__,Z+9
 2403 0c24 F285      		ldd r31,Z+10
 2404 0c26 E02D      		mov r30,__tmp_reg__
 2406               	.LM228:
 2407 0c28 3097      		sbiw r30,0
 2408 0c2a 19F0      		breq .L153
 2410               	.LM229:
 2411 0c2c 8381      		ldd r24,Z+3
 2412 0c2e 9481      		ldd r25,Z+4
 2413 0c30 0895      		ret
 2414               	.L153:
 2416               	.LM230:
 2417 0c32 CF01      		movw r24,r30
 2419               	.LM231:
 2420 0c34 0895      		ret
 2421               	/* epilogue: frame size=0 */
 2422 0c36 0895      		ret
 2423               	/* epilogue end (size=1) */
 2424               	/* function mac_timer3queue_getnextinterval size 15 (14) */
 2429               	.Lscope26:
 2431               	.global	initial_tx_queue
 2433               	initial_tx_queue:
 2435               	.LM232:
 2436               	/* prologue: frame size=0 */
 2437               	/* prologue end (size=0) */
 2438               	/* epilogue: frame size=0 */
 2439 0c38 0895      		ret
 2440               	/* epilogue end (size=1) */
 2441               	/* function initial_tx_queue size 1 (0) */
 2443               	.Lscope27:
 2455               	.global	add_pending_queue
 2457               	add_pending_queue:
 2459               	.LM233:
 2460               	/* prologue: frame size=3 */
 2461 0c3a AF92      		push r10
 2462 0c3c BF92      		push r11
 2463 0c3e CF92      		push r12
 2464 0c40 DF92      		push r13
 2465 0c42 EF92      		push r14
 2466 0c44 FF92      		push r15
 2467 0c46 0F93      		push r16
 2468 0c48 1F93      		push r17
 2469 0c4a CF93      		push r28
 2470 0c4c DF93      		push r29
 2471 0c4e CDB7      		in r28,__SP_L__
 2472 0c50 DEB7      		in r29,__SP_H__
 2473 0c52 2397      		sbiw r28,3
 2474 0c54 0FB6      		in __tmp_reg__,__SREG__
 2475 0c56 F894      		cli
 2476 0c58 DEBF      		out __SP_H__,r29
 2477 0c5a 0FBE      		out __SREG__,__tmp_reg__
 2478 0c5c CDBF      		out __SP_L__,r28
 2479               	/* prologue end (size=18) */
 2480 0c5e E82E      		mov r14,r24
 2481 0c60 4983      		std Y+1,r20
 2482 0c62 5A83      		std Y+2,r21
 2483 0c64 6B83      		std Y+3,r22
 2484 0c66 FAA4      		ldd r15,Y+42
 2485 0c68 0BA5      		ldd r16,Y+43
 2486 0c6a 1CA5      		ldd r17,Y+44
 2487 0c6c ADA4      		ldd r10,Y+45
 2488 0c6e BEA4      		ldd r11,Y+46
 2489 0c70 CFA8      		ldd r12,Y+55
 2490 0c72 D8AC      		ldd r13,Y+56
 2492               	.LM234:
 2493 0c74 82E3      		ldi r24,lo8(50)
 2494 0c76 90E0      		ldi r25,hi8(50)
 2495 0c78 0E94 0000 		call malloc
 2496 0c7c AC01      		movw r20,r24
 2498               	.LM235:
 2499 0c7e 4C5F      		subi r20,lo8(-(4))
 2500 0c80 5F4F      		sbci r21,hi8(-(4))
 2501 0c82 83E0      		ldi r24,lo8(3)
 2502 0c84 9E01      		movw r18,r28
 2503 0c86 2F5F      		subi r18,lo8(-(1))
 2504 0c88 3F4F      		sbci r19,hi8(-(1))
 2505 0c8a DA01      		movw r26,r20
 2506 0c8c F901      		movw r30,r18
 2507 0c8e 0190      		ld __tmp_reg__,Z+
 2508 0c90 0D92      		st X+,__tmp_reg__
 2509 0c92 8A95      		dec r24
 2510 0c94 E1F7      		brne .-8
 2511 0c96 4450      		subi r20,lo8(-(-4))
 2512 0c98 5040      		sbci r21,hi8(-(-4))
 2514               	.LM236:
 2515 0c9a FA01      		movw r30,r20
 2516 0c9c E382      		std Z+3,r14
 2518               	.LM237:
 2519 0c9e F5A6      		std Z+45,r15
 2521               	.LM238:
 2522 0ca0 06A7      		std Z+46,r16
 2523 0ca2 17A7      		std Z+47,r17
 2525               	.LM239:
 2526 0ca4 8091 0000 		lds r24,mac_pib_data+43
 2527 0ca8 9091 0000 		lds r25,(mac_pib_data+43)+1
 2528 0cac 8183      		std Z+1,r24
 2529 0cae 9283      		std Z+2,r25
 2531               	.LM240:
 2532 0cb0 B782      		std Z+7,r11
 2534               	.LM241:
 2535 0cb2 8481      		ldd r24,Z+4
 2536 0cb4 9927      		clr r25
 2537 0cb6 8770      		andi r24,lo8(7)
 2538 0cb8 9070      		andi r25,hi8(7)
 2539 0cba 0197      		sbiw r24,1
 2540 0cbc E9F0      		breq .L157
 2541 0cbe BA01      		movw r22,r20
 2542 0cc0 655F      		subi r22,lo8(-(11))
 2543 0cc2 7F4F      		sbci r23,hi8(-(11))
 2544 0cc4 9E01      		movw r18,r28
 2545 0cc6 215D      		subi r18,lo8(-(47))
 2546 0cc8 3F4F      		sbci r19,hi8(-(47))
 2548               	.LM242:
 2549 0cca BB20      		tst r11
 2550 0ccc 61F0      		breq .L158
 2552               	.LM243:
 2553 0cce A286      		std Z+10,r10
 2555               	.LM244:
 2556 0cd0 88E0      		ldi r24,lo8(8)
 2557 0cd2 DB01      		movw r26,r22
 2558 0cd4 F901      		movw r30,r18
 2559 0cd6 0190      		ld __tmp_reg__,Z+
 2560 0cd8 0D92      		st X+,__tmp_reg__
 2561 0cda 8A95      		dec r24
 2562 0cdc E1F7      		brne .-8
 2564               	.LM245:
 2565 0cde FA01      		movw r30,r20
 2566 0ce0 C086      		std Z+8,r12
 2567 0ce2 D186      		std Z+9,r13
 2568 0ce4 09C0      		rjmp .L157
 2569               	.L158:
 2571               	.LM246:
 2572 0ce6 FA01      		movw r30,r20
 2573 0ce8 A286      		std Z+10,r10
 2575               	.LM247:
 2576 0cea 88E0      		ldi r24,lo8(8)
 2577 0cec DB01      		movw r26,r22
 2578 0cee F901      		movw r30,r18
 2579 0cf0 0190      		ld __tmp_reg__,Z+
 2580 0cf2 0D92      		st X+,__tmp_reg__
 2581 0cf4 8A95      		dec r24
 2582 0cf6 E1F7      		brne .-8
 2583               	.L157:
 2585               	.LM248:
 2586 0cf8 8DE0      		ldi r24,lo8(13)
 2587 0cfa 4D5E      		subi r20,lo8(-(19))
 2588 0cfc 5F4F      		sbci r21,hi8(-(19))
 2589 0cfe DA01      		movw r26,r20
 2590 0d00 E0E1      		ldi r30,lo8(16)
 2591 0d02 F0E0      		ldi r31,hi8(16)
 2592 0d04 EC0F      		add r30,r28
 2593 0d06 FD1F      		adc r31,r29
 2594 0d08 982F      		mov r25,r24
 2595 0d0a 0190      		ld __tmp_reg__,Z+
 2596 0d0c 0D92      		st X+,__tmp_reg__
 2597 0d0e 9A95      		dec r25
 2598 0d10 E1F7      		brne .-8
 2600               	.LM249:
 2601 0d12 435F      		subi r20,lo8(-(13))
 2602 0d14 5F4F      		sbci r21,hi8(-(13))
 2603 0d16 FE01      		movw r30,r28
 2604 0d18 7D96      		adiw r30,29
 2605 0d1a DA01      		movw r26,r20
 2606 0d1c 0190      		ld __tmp_reg__,Z+
 2607 0d1e 0D92      		st X+,__tmp_reg__
 2608 0d20 8A95      		dec r24
 2609 0d22 E1F7      		brne .-8
 2610 0d24 4052      		subi r20,lo8(-(-32))
 2611 0d26 5040      		sbci r21,hi8(-(-32))
 2613               	.LM250:
 2614 0d28 81E0      		ldi r24,lo8(1)
 2615 0d2a FA01      		movw r30,r20
 2616 0d2c 8083      		st Z,r24
 2618               	.LM251:
 2619 0d2e 10AA      		std Z+48,__zero_reg__
 2620 0d30 11AA      		std Z+49,__zero_reg__
 2622               	.LM252:
 2623 0d32 E091 0000 		lds r30,tail_of_indirect_pending_buffer
 2624 0d36 F091 0000 		lds r31,(tail_of_indirect_pending_buffer)+1
 2625 0d3a 3097      		sbiw r30,0
 2626 0d3c 29F4      		brne .L160
 2628               	.LM253:
 2629 0d3e 5093 0000 		sts (head_of_indirect_pending_buffer)+1,r21
 2630 0d42 4093 0000 		sts head_of_indirect_pending_buffer,r20
 2631 0d46 02C0      		rjmp .L164
 2632               	.L160:
 2634               	.LM254:
 2635 0d48 40AB      		std Z+48,r20
 2636 0d4a 51AB      		std Z+49,r21
 2637               	.L164:
 2639               	.LM255:
 2640 0d4c 5093 0000 		sts (tail_of_indirect_pending_buffer)+1,r21
 2641 0d50 4093 0000 		sts tail_of_indirect_pending_buffer,r20
 2643               	.LM256:
 2644 0d54 8889      		ldd r24,Y+16
 2645 0d56 8230      		cpi r24,lo8(2)
 2646 0d58 99F4      		brne .L162
 2648               	.LM257:
 2649 0d5a 2091 0000 		lds r18,mac_tx_beacon+3
 2650 0d5e E22F      		mov r30,r18
 2651 0d60 FF27      		clr r31
 2652 0d62 EE0F      		add r30,r30
 2653 0d64 FF1F      		adc r31,r31
 2654 0d66 E050      		subi r30,lo8(-(mac_tx_beacon))
 2655 0d68 F040      		sbci r31,hi8(-(mac_tx_beacon))
 2656 0d6a 898D      		ldd r24,Y+25
 2657 0d6c 9A8D      		ldd r25,Y+26
 2658 0d6e 8583      		std Z+5,r24
 2659 0d70 9683      		std Z+6,r25
 2660 0d72 2F5F      		subi r18,lo8(-(1))
 2661 0d74 2093 0000 		sts mac_tx_beacon+3,r18
 2663               	.LM258:
 2664 0d78 8091 0000 		lds r24,mac_tx_beacon+2
 2665 0d7c 8F5F      		subi r24,lo8(-(1))
 2666 0d7e 18C0      		rjmp .L165
 2667               	.L162:
 2669               	.LM259:
 2670 0d80 8091 0000 		lds r24,mac_tx_beacon+4
 2671 0d84 E82F      		mov r30,r24
 2672 0d86 FF27      		clr r31
 2673 0d88 93E0      		ldi r25,3
 2674 0d8a EE0F      	1:	lsl r30
 2675 0d8c FF1F      		rol r31
 2676 0d8e 9A95      		dec r25
 2677 0d90 E1F7      		brne 1b
 2678 0d92 E050      		subi r30,lo8(-(mac_tx_beacon+9))
 2679 0d94 F040      		sbci r31,hi8(-(mac_tx_beacon+9))
 2680 0d96 98E0      		ldi r25,lo8(8)
 2681 0d98 DE01      		movw r26,r28
 2682 0d9a 5196      		adiw r26,17
 2683 0d9c 0D90      		ld __tmp_reg__,X+
 2684 0d9e 0192      		st Z+,__tmp_reg__
 2685 0da0 9A95      		dec r25
 2686 0da2 E1F7      		brne .-8
 2687 0da4 8F5F      		subi r24,lo8(-(1))
 2688 0da6 8093 0000 		sts mac_tx_beacon+4,r24
 2690               	.LM260:
 2691 0daa 8091 0000 		lds r24,mac_tx_beacon+2
 2692 0dae 805F      		subi r24,lo8(-(16))
 2693               	.L165:
 2694 0db0 8093 0000 		sts mac_tx_beacon+2,r24
 2696               	.LM261:
 2697 0db4 8091 0000 		lds r24,current_pending_num
 2698 0db8 8F5F      		subi r24,lo8(-(1))
 2699 0dba 8093 0000 		sts current_pending_num,r24
 2700               	/* epilogue: frame size=3 */
 2701 0dbe 2396      		adiw r28,3
 2702 0dc0 0FB6      		in __tmp_reg__,__SREG__
 2703 0dc2 F894      		cli
 2704 0dc4 DEBF      		out __SP_H__,r29
 2705 0dc6 0FBE      		out __SREG__,__tmp_reg__
 2706 0dc8 CDBF      		out __SP_L__,r28
 2707 0dca DF91      		pop r29
 2708 0dcc CF91      		pop r28
 2709 0dce 1F91      		pop r17
 2710 0dd0 0F91      		pop r16
 2711 0dd2 FF90      		pop r15
 2712 0dd4 EF90      		pop r14
 2713 0dd6 DF90      		pop r13
 2714 0dd8 CF90      		pop r12
 2715 0dda BF90      		pop r11
 2716 0ddc AF90      		pop r10
 2717 0dde 0895      		ret
 2718               	/* epilogue end (size=17) */
 2719               	/* function add_pending_queue size 212 (177) */
 2729               	.Lscope28:
 2735               	.global	mlmeAssociateResponse
 2737               	mlmeAssociateResponse:
 2739               	.LM262:
 2740               	/* prologue: frame size=37 */
 2741 0de0 CF93      		push r28
 2742 0de2 DF93      		push r29
 2743 0de4 CDB7      		in r28,__SP_L__
 2744 0de6 DEB7      		in r29,__SP_H__
 2745 0de8 A597      		sbiw r28,37
 2746 0dea 0FB6      		in __tmp_reg__,__SREG__
 2747 0dec F894      		cli
 2748 0dee DEBF      		out __SP_H__,r29
 2749 0df0 0FBE      		out __SREG__,__tmp_reg__
 2750 0df2 CDBF      		out __SP_L__,r28
 2751               	/* prologue end (size=10) */
 2752 0df4 2983      		std Y+1,r18
 2753 0df6 3A83      		std Y+2,r19
 2754 0df8 4B83      		std Y+3,r20
 2755 0dfa 5C83      		std Y+4,r21
 2756 0dfc 6D83      		std Y+5,r22
 2757 0dfe 7E83      		std Y+6,r23
 2758 0e00 8F83      		std Y+7,r24
 2759 0e02 9887      		std Y+8,r25
 2761               	.LM263:
 2762 0e04 83E0      		ldi r24,lo8(3)
 2763 0e06 8C87      		std Y+12,r24
 2765               	.LM264:
 2766 0e08 898F      		std Y+25,r24
 2768               	.LM265:
 2769 0e0a 8091 0000 		lds r24,mac_pib_data+28
 2770 0e0e 9091 0000 		lds r25,(mac_pib_data+28)+1
 2771 0e12 8F8B      		std Y+23,r24
 2772 0e14 988F      		std Y+24,r25
 2774               	.LM266:
 2775 0e16 8CA3      		std Y+36,r24
 2776 0e18 9DA3      		std Y+37,r25
 2778               	.LM267:
 2779 0e1a 88E0      		ldi r24,lo8(8)
 2780 0e1c A0E0      		ldi r26,lo8(mac_pib_data+34)
 2781 0e1e B0E0      		ldi r27,hi8(mac_pib_data+34)
 2782 0e20 FE01      		movw r30,r28
 2783 0e22 7A96      		adiw r30,26
 2784 0e24 982F      		mov r25,r24
 2785 0e26 0D90      		ld __tmp_reg__,X+
 2786 0e28 0192      		st Z+,__tmp_reg__
 2787 0e2a 9A95      		dec r25
 2788 0e2c E1F7      		brne .-8
 2790               	.LM268:
 2791 0e2e DE01      		movw r26,r28
 2792 0e30 1196      		adiw r26,1
 2793 0e32 FE01      		movw r30,r28
 2794 0e34 3D96      		adiw r30,13
 2795 0e36 0D90      		ld __tmp_reg__,X+
 2796 0e38 0192      		st Z+,__tmp_reg__
 2797 0e3a 8A95      		dec r24
 2798 0e3c E1F7      		brne .-8
 2799               	/* epilogue: frame size=37 */
 2800 0e3e A596      		adiw r28,37
 2801 0e40 0FB6      		in __tmp_reg__,__SREG__
 2802 0e42 F894      		cli
 2803 0e44 DEBF      		out __SP_H__,r29
 2804 0e46 0FBE      		out __SREG__,__tmp_reg__
 2805 0e48 CDBF      		out __SP_L__,r28
 2806 0e4a DF91      		pop r29
 2807 0e4c CF91      		pop r28
 2808 0e4e 0895      		ret
 2809               	/* epilogue end (size=9) */
 2810               	/* function mlmeAssociateResponse size 56 (37) */
 2817               	.Lscope29:
 2818               		.data
 2819               	.LC10:
 2820 01b3 0A2D 2D2D 		.string	"\n---allocated short addr is %04x---\n"
 2820      616C 6C6F 
 2820      6361 7465 
 2820      6420 7368 
 2820      6F72 7420 
 2821               		.text
 2824               	.global	mlmeAssociateIndication
 2826               	mlmeAssociateIndication:
 2828               	.LM269:
 2829               	/* prologue: frame size=11 */
 2830 0e50 CF92      		push r12
 2831 0e52 EF92      		push r14
 2832 0e54 FF92      		push r15
 2833 0e56 0F93      		push r16
 2834 0e58 1F93      		push r17
 2835 0e5a CF93      		push r28
 2836 0e5c DF93      		push r29
 2837 0e5e CDB7      		in r28,__SP_L__
 2838 0e60 DEB7      		in r29,__SP_H__
 2839 0e62 2B97      		sbiw r28,11
 2840 0e64 0FB6      		in __tmp_reg__,__SREG__
 2841 0e66 F894      		cli
 2842 0e68 DEBF      		out __SP_H__,r29
 2843 0e6a 0FBE      		out __SREG__,__tmp_reg__
 2844 0e6c CDBF      		out __SP_L__,r28
 2845               	/* prologue end (size=15) */
 2846 0e6e E982      		std Y+1,r14
 2847 0e70 FA82      		std Y+2,r15
 2848 0e72 0B83      		std Y+3,r16
 2849 0e74 1C83      		std Y+4,r17
 2850 0e76 2D83      		std Y+5,r18
 2851 0e78 3E83      		std Y+6,r19
 2852 0e7a 4F83      		std Y+7,r20
 2853 0e7c 5887      		std Y+8,r21
 2854 0e7e 6987      		std Y+9,r22
 2855 0e80 7A87      		std Y+10,r23
 2856 0e82 8B87      		std Y+11,r24
 2858               	.LM270:
 2859 0e84 2E2D      		mov r18,r14
 2860 0e86 3F2D      		mov r19,r15
 2861 0e88 402F      		mov r20,r16
 2862 0e8a 512F      		mov r21,r17
 2863 0e8c 6D81      		ldd r22,Y+5
 2864 0e8e 7E81      		ldd r23,Y+6
 2865 0e90 8F81      		ldd r24,Y+7
 2866 0e92 9885      		ldd r25,Y+8
 2867 0e94 0E94 0000 		call short_address_allocate_req
 2868 0e98 8C01      		movw r16,r24
 2870               	.LM271:
 2871 0e9a 9F93      		push r25
 2872 0e9c 8F93      		push r24
 2873 0e9e 80E0      		ldi r24,lo8(.LC10)
 2874 0ea0 90E0      		ldi r25,hi8(.LC10)
 2875 0ea2 9F93      		push r25
 2876 0ea4 8F93      		push r24
 2877 0ea6 0E94 0000 		call printf
 2879               	.LM272:
 2880 0eaa 80E0      		ldi r24,lo8(0)
 2882               	.LM273:
 2883 0eac C82E      		mov r12,r24
 2884 0eae E82E      		mov r14,r24
 2885 0eb0 2981      		ldd r18,Y+1
 2886 0eb2 3A81      		ldd r19,Y+2
 2887 0eb4 4B81      		ldd r20,Y+3
 2888 0eb6 5C81      		ldd r21,Y+4
 2889 0eb8 6D81      		ldd r22,Y+5
 2890 0eba 7E81      		ldd r23,Y+6
 2891 0ebc 8F81      		ldd r24,Y+7
 2892 0ebe 9885      		ldd r25,Y+8
 2893 0ec0 0E94 0000 		call mlmeAssociateResponse
 2894 0ec4 0F90      		pop __tmp_reg__
 2895 0ec6 0F90      		pop __tmp_reg__
 2896 0ec8 0F90      		pop __tmp_reg__
 2897 0eca 0F90      		pop __tmp_reg__
 2898               	/* epilogue: frame size=11 */
 2899 0ecc 2B96      		adiw r28,11
 2900 0ece 0FB6      		in __tmp_reg__,__SREG__
 2901 0ed0 F894      		cli
 2902 0ed2 DEBF      		out __SP_H__,r29
 2903 0ed4 0FBE      		out __SREG__,__tmp_reg__
 2904 0ed6 CDBF      		out __SP_L__,r28
 2905 0ed8 DF91      		pop r29
 2906 0eda CF91      		pop r28
 2907 0edc 1F91      		pop r17
 2908 0ede 0F91      		pop r16
 2909 0ee0 FF90      		pop r15
 2910 0ee2 EF90      		pop r14
 2911 0ee4 CF90      		pop r12
 2912 0ee6 0895      		ret
 2913               	/* epilogue end (size=14) */
 2914               	/* function mlmeAssociateIndication size 76 (47) */
 2920               	.Lscope30:
 2921               		.data
 2922               	.LC11:
 2923 01d8 0A6D 656D 		.string	"\nmemory allocated failure\n"
 2923      6F72 7920 
 2923      616C 6C6F 
 2923      6361 7465 
 2923      6420 6661 
 2924               		.text
 2930               	.global	add_to_rx_buffer
 2932               	add_to_rx_buffer:
 2934               	.LM274:
 2935               	/* prologue: frame size=0 */
 2936 0ee8 AF92      		push r10
 2937 0eea BF92      		push r11
 2938 0eec CF92      		push r12
 2939 0eee DF92      		push r13
 2940 0ef0 EF92      		push r14
 2941 0ef2 FF92      		push r15
 2942 0ef4 0F93      		push r16
 2943 0ef6 1F93      		push r17
 2944 0ef8 CF93      		push r28
 2945 0efa DF93      		push r29
 2946               	/* prologue end (size=10) */
 2947 0efc B82E      		mov r11,r24
 2948 0efe 6B01      		movw r12,r22
 2949 0f00 A42E      		mov r10,r20
 2950 0f02 7801      		movw r14,r16
 2951 0f04 8901      		movw r16,r18
 2953               	.LM275:
 2954 0f06 8AE0      		ldi r24,lo8(10)
 2955 0f08 90E0      		ldi r25,hi8(10)
 2956 0f0a 0E94 0000 		call malloc
 2957 0f0e EC01      		movw r28,r24
 2959               	.LM276:
 2960 0f10 0097      		sbiw r24,0
 2961 0f12 29F4      		brne .L172
 2963               	.LM277:
 2964 0f14 80E0      		ldi r24,lo8(.LC11)
 2965 0f16 90E0      		ldi r25,hi8(.LC11)
 2966 0f18 0E94 0000 		call error
 2967 0f1c 1BC0      		rjmp .L176
 2968               	.L172:
 2970               	.LM278:
 2971 0f1e B882      		st Y,r11
 2973               	.LM279:
 2974 0f20 C982      		std Y+1,r12
 2975 0f22 DA82      		std Y+2,r13
 2977               	.LM280:
 2978 0f24 AB82      		std Y+3,r10
 2980               	.LM281:
 2981 0f26 EC82      		std Y+4,r14
 2982 0f28 FD82      		std Y+5,r15
 2983 0f2a 0E83      		std Y+6,r16
 2984 0f2c 1F83      		std Y+7,r17
 2986               	.LM282:
 2987 0f2e 1886      		std Y+8,__zero_reg__
 2988 0f30 1986      		std Y+9,__zero_reg__
 2990               	.LM283:
 2991 0f32 E091 0000 		lds r30,tail_of_rx_buffer
 2992 0f36 F091 0000 		lds r31,(tail_of_rx_buffer)+1
 2993 0f3a 3097      		sbiw r30,0
 2994 0f3c 29F4      		brne .L173
 2996               	.LM284:
 2997 0f3e 9093 0000 		sts (head_of_rx_buffer)+1,r25
 2998 0f42 8093 0000 		sts head_of_rx_buffer,r24
 2999 0f46 02C0      		rjmp .L175
 3000               	.L173:
 3002               	.LM285:
 3003 0f48 8087      		std Z+8,r24
 3004 0f4a 9187      		std Z+9,r25
 3005               	.L175:
 3007               	.LM286:
 3008 0f4c D093 0000 		sts (tail_of_rx_buffer)+1,r29
 3009 0f50 C093 0000 		sts tail_of_rx_buffer,r28
 3010               	.L176:
 3012               	.LM287:
 3013 0f54 CE01      		movw r24,r28
 3014               	/* epilogue: frame size=0 */
 3015 0f56 DF91      		pop r29
 3016 0f58 CF91      		pop r28
 3017 0f5a 1F91      		pop r17
 3018 0f5c 0F91      		pop r16
 3019 0f5e FF90      		pop r15
 3020 0f60 EF90      		pop r14
 3021 0f62 DF90      		pop r13
 3022 0f64 CF90      		pop r12
 3023 0f66 BF90      		pop r11
 3024 0f68 AF90      		pop r10
 3025 0f6a 0895      		ret
 3026               	/* epilogue end (size=11) */
 3027               	/* function add_to_rx_buffer size 66 (45) */
 3032               	.Lscope31:
 3038               	.global	PD_DATA_indication
 3040               	PD_DATA_indication:
 3042               	.LM288:
 3043               	/* prologue: frame size=0 */
 3044 0f6c 0F93      		push r16
 3045 0f6e 1F93      		push r17
 3046               	/* prologue end (size=2) */
 3047 0f70 942F      		mov r25,r20
 3048 0f72 A901      		movw r20,r18
 3049 0f74 9801      		movw r18,r16
 3051               	.LM289:
 3052 0f76 8901      		movw r16,r18
 3053 0f78 9A01      		movw r18,r20
 3054 0f7a 492F      		mov r20,r25
 3055 0f7c 0E94 0000 		call add_to_rx_buffer
 3056 0f80 9093 0000 		sts (head_of_rx_buffer)+1,r25
 3057 0f84 8093 0000 		sts head_of_rx_buffer,r24
 3059               	.LM290:
 3060 0f88 80E0      		ldi r24,lo8(pm(mac_get_received_frame))
 3061 0f8a 90E0      		ldi r25,hi8(pm(mac_get_received_frame))
 3062 0f8c 0E94 0000 		call OS_post
 3063               	/* epilogue: frame size=0 */
 3064 0f90 1F91      		pop r17
 3065 0f92 0F91      		pop r16
 3066 0f94 0895      		ret
 3067               	/* epilogue end (size=3) */
 3068               	/* function PD_DATA_indication size 21 (16) */
 3070               	.Lscope32:
 3078               	.global	add_tx_queue
 3080               	add_tx_queue:
 3082               	.LM291:
 3083               	/* prologue: frame size=0 */
 3084 0f96 BF92      		push r11
 3085 0f98 CF92      		push r12
 3086 0f9a DF92      		push r13
 3087 0f9c EF92      		push r14
 3088 0f9e FF92      		push r15
 3089 0fa0 0F93      		push r16
 3090 0fa2 1F93      		push r17
 3091 0fa4 CF93      		push r28
 3092 0fa6 DF93      		push r29
 3093               	/* prologue end (size=9) */
 3094 0fa8 F82E      		mov r15,r24
 3095 0faa 6B01      		movw r12,r22
 3096 0fac 142F      		mov r17,r20
 3097 0fae B22E      		mov r11,r18
 3099               	.LM292:
 3100 0fb0 8BE0      		ldi r24,lo8(11)
 3101 0fb2 90E0      		ldi r25,hi8(11)
 3102 0fb4 0E94 0000 		call malloc
 3103 0fb8 EC01      		movw r28,r24
 3105               	.LM293:
 3106 0fba 892B      		or r24,r25
 3107 0fbc 29F4      		brne .L179
 3109               	.LM294:
 3110 0fbe 80E0      		ldi r24,lo8(.LC11)
 3111 0fc0 90E0      		ldi r25,hi8(.LC11)
 3112 0fc2 0E94 0000 		call error
 3113 0fc6 1DC0      		rjmp .L183
 3114               	.L179:
 3116               	.LM295:
 3117 0fc8 CF82      		std Y+7,r12
 3118 0fca D886      		std Y+8,r13
 3120               	.LM296:
 3121 0fcc 1983      		std Y+1,r17
 3123               	.LM297:
 3124 0fce 82E0      		ldi r24,lo8(2)
 3125 0fd0 8C83      		std Y+4,r24
 3127               	.LM298:
 3128 0fd2 FD82      		std Y+5,r15
 3130               	.LM299:
 3131 0fd4 0B83      		std Y+3,r16
 3133               	.LM300:
 3134 0fd6 1986      		std Y+9,__zero_reg__
 3135 0fd8 1A86      		std Y+10,__zero_reg__
 3137               	.LM301:
 3138 0fda B882      		st Y,r11
 3140               	.LM302:
 3141 0fdc 1A82      		std Y+2,__zero_reg__
 3143               	.LM303:
 3144 0fde EE82      		std Y+6,r14
 3146               	.LM304:
 3147 0fe0 E091 0000 		lds r30,tail_of_tx_buffer
 3148 0fe4 F091 0000 		lds r31,(tail_of_tx_buffer)+1
 3149 0fe8 3097      		sbiw r30,0
 3150 0fea 29F4      		brne .L180
 3152               	.LM305:
 3153 0fec D093 0000 		sts (head_of_tx_buffer)+1,r29
 3154 0ff0 C093 0000 		sts head_of_tx_buffer,r28
 3155 0ff4 02C0      		rjmp .L182
 3156               	.L180:
 3158               	.LM306:
 3159 0ff6 C187      		std Z+9,r28
 3160 0ff8 D287      		std Z+10,r29
 3161               	.L182:
 3163               	.LM307:
 3164 0ffa D093 0000 		sts (tail_of_tx_buffer)+1,r29
 3165 0ffe C093 0000 		sts tail_of_tx_buffer,r28
 3166               	.L183:
 3168               	.LM308:
 3169 1002 CE01      		movw r24,r28
 3170               	/* epilogue: frame size=0 */
 3171 1004 DF91      		pop r29
 3172 1006 CF91      		pop r28
 3173 1008 1F91      		pop r17
 3174 100a 0F91      		pop r16
 3175 100c FF90      		pop r15
 3176 100e EF90      		pop r14
 3177 1010 DF90      		pop r13
 3178 1012 CF90      		pop r12
 3179 1014 BF90      		pop r11
 3180 1016 0895      		ret
 3181               	/* epilogue end (size=10) */
 3182               	/* function add_tx_queue size 65 (46) */
 3187               	.Lscope33:
 3191               	.global	direct_transmit
 3193               	direct_transmit:
 3195               	.LM309:
 3196               	/* prologue: frame size=0 */
 3197 1018 CF92      		push r12
 3198 101a DF92      		push r13
 3199 101c EF92      		push r14
 3200 101e FF92      		push r15
 3201 1020 0F93      		push r16
 3202 1022 1F93      		push r17
 3203               	/* prologue end (size=6) */
 3204 1024 6B01      		movw r12,r22
 3206               	.LM310:
 3207 1026 0E94 0000 		call PD_DATA_request
 3208 102a 7B01      		movw r14,r22
 3209 102c 8C01      		movw r16,r24
 3211               	.LM311:
 3212 102e C601      		movw r24,r12
 3213 1030 0E94 0000 		call free
 3215               	.LM312:
 3216 1034 C801      		movw r24,r16
 3217 1036 B701      		movw r22,r14
 3218               	/* epilogue: frame size=0 */
 3219 1038 1F91      		pop r17
 3220 103a 0F91      		pop r16
 3221 103c FF90      		pop r15
 3222 103e EF90      		pop r14
 3223 1040 DF90      		pop r13
 3224 1042 CF90      		pop r12
 3225 1044 0895      		ret
 3226               	/* epilogue end (size=7) */
 3227               	/* function direct_transmit size 23 (10) */
 3232               	.Lscope34:
 3233               		.data
 3234               	.LC12:
 3235 01f3 0A72 6573 		.string	"\nreserved dst address mode is used!\n"
 3235      6572 7665 
 3235      6420 6473 
 3235      7420 6164 
 3235      6472 6573 
 3236               	.LC13:
 3237 0218 0A72 6573 		.string	"\nreserved src address mode is used!\n"
 3237      6572 7665 
 3237      6420 7372 
 3237      6320 6164 
 3237      6472 6573 
 3238               	.LC14:
 3239 023d 0A74 7820 		.string	"\ntx buffer is full\n"
 3239      6275 6666 
 3239      6572 2069 
 3239      7320 6675 
 3239      6C6C 0A00 
 3240               		.text
 3242               	.global	mac_frame_send
 3244               	mac_frame_send:
 3246               	.LM313:
 3247               	/* prologue: frame size=0 */
 3248 1046 CF92      		push r12
 3249 1048 DF92      		push r13
 3250 104a EF92      		push r14
 3251 104c FF92      		push r15
 3252 104e 0F93      		push r16
 3253 1050 1F93      		push r17
 3254 1052 CF93      		push r28
 3255 1054 DF93      		push r29
 3256               	/* prologue end (size=8) */
 3258               	.LM314:
 3259 1056 86E6      		ldi r24,lo8(102)
 3260 1058 90E0      		ldi r25,hi8(102)
 3261 105a 0E94 0000 		call malloc
 3262 105e EC01      		movw r28,r24
 3264               	.LM315:
 3265 1060 8091 0000 		lds r24,mac_tx_current_frame+36
 3266 1064 8883      		st Y,r24
 3268               	.LM316:
 3269 1066 9091 0000 		lds r25,mac_tx_current_frame+37
 3270 106a 9983      		std Y+1,r25
 3272               	.LM317:
 3273 106c D090 0000 		lds r13,mac_tx_current_frame+28
 3274 1070 DA82      		std Y+2,r13
 3275 1072 13E0      		ldi r17,lo8(3)
 3277               	.LM318:
 3278 1074 F82E      		mov r15,r24
 3279 1076 F694      		lsr r15
 3280 1078 F694      		lsr r15
 3281 107a F694      		lsr r15
 3282 107c F694      		lsr r15
 3283 107e F694      		lsr r15
 3284 1080 81E0      		ldi r24,lo8(1)
 3285 1082 F822      		and r15,r24
 3287               	.LM319:
 3288 1084 00E0      		ldi r16,lo8(0)
 3290               	.LM320:
 3291 1086 C090 0000 		lds r12,mac_rx_current_frame+30
 3293               	.LM321:
 3294 108a E92F      		mov r30,r25
 3295 108c FF27      		clr r31
 3296 108e EC70      		andi r30,lo8(12)
 3297 1090 F070      		andi r31,hi8(12)
 3298 1092 E830      		cpi r30,8
 3299 1094 F105      		cpc r31,__zero_reg__
 3300 1096 59F1      		breq .L188
 3302               	.LM322:
 3303 1098 E930      		cpi r30,9
 3304 109a F105      		cpc r31,__zero_reg__
 3305 109c 1CF4      		brge .L191
 3306 109e 3497      		sbiw r30,4
 3307 10a0 A1F1      		breq .L190
 3308 10a2 37C0      		rjmp .L186
 3309               	.L191:
 3310 10a4 EC30      		cpi r30,12
 3311 10a6 F105      		cpc r31,__zero_reg__
 3312 10a8 A1F5      		brne .L186
 3314               	.LM323:
 3315 10aa 8091 0000 		lds r24,mac_tx_current_frame+11
 3316 10ae 8B83      		std Y+3,r24
 3318               	.LM324:
 3319 10b0 8091 0000 		lds r24,mac_tx_current_frame+12
 3320 10b4 8C83      		std Y+4,r24
 3322               	.LM325:
 3323 10b6 8091 0000 		lds r24,mac_tx_current_frame+1
 3324 10ba 8D83      		std Y+5,r24
 3326               	.LM326:
 3327 10bc 8091 0000 		lds r24,mac_tx_current_frame+2
 3328 10c0 8E83      		std Y+6,r24
 3330               	.LM327:
 3331 10c2 8091 0000 		lds r24,mac_tx_current_frame+3
 3332 10c6 8F83      		std Y+7,r24
 3334               	.LM328:
 3335 10c8 8091 0000 		lds r24,mac_tx_current_frame+4
 3336 10cc 8887      		std Y+8,r24
 3338               	.LM329:
 3339 10ce 8091 0000 		lds r24,mac_tx_current_frame+5
 3340 10d2 8987      		std Y+9,r24
 3342               	.LM330:
 3343 10d4 8091 0000 		lds r24,mac_tx_current_frame+6
 3344 10d8 8A87      		std Y+10,r24
 3346               	.LM331:
 3347 10da 8091 0000 		lds r24,mac_tx_current_frame+7
 3348 10de 8B87      		std Y+11,r24
 3350               	.LM332:
 3351 10e0 EC0F      		add r30,r28
 3352 10e2 FD1F      		adc r31,r29
 3353 10e4 8091 0000 		lds r24,mac_tx_current_frame+8
 3354 10e8 8083      		st Z,r24
 3355 10ea 1DE0      		ldi r17,lo8(13)
 3357               	.LM333:
 3358 10ec 12C0      		rjmp .L186
 3359               	.L188:
 3361               	.LM334:
 3362 10ee 8091 0000 		lds r24,mac_tx_current_frame+11
 3363 10f2 8B83      		std Y+3,r24
 3365               	.LM335:
 3366 10f4 8091 0000 		lds r24,mac_tx_current_frame+12
 3367 10f8 8C83      		std Y+4,r24
 3369               	.LM336:
 3370 10fa 8091 0000 		lds r24,mac_tx_current_frame+9
 3371 10fe 8D83      		std Y+5,r24
 3373               	.LM337:
 3374 1100 8091 0000 		lds r24,mac_tx_current_frame+10
 3375 1104 8E83      		std Y+6,r24
 3376 1106 17E0      		ldi r17,lo8(7)
 3378               	.LM338:
 3379 1108 04C0      		rjmp .L186
 3380               	.L190:
 3382               	.LM339:
 3383 110a 80E0      		ldi r24,lo8(.LC12)
 3384 110c 90E0      		ldi r25,hi8(.LC12)
 3385 110e 0E94 0000 		call error
 3386               	.L186:
 3388               	.LM340:
 3389 1112 8091 0000 		lds r24,mac_tx_current_frame+37
 3390 1116 9927      		clr r25
 3391 1118 807C      		andi r24,lo8(192)
 3392 111a 9070      		andi r25,hi8(192)
 3393 111c 8038      		cpi r24,128
 3394 111e 9105      		cpc r25,__zero_reg__
 3395 1120 09F4      		brne .+2
 3396 1122 51C0      		rjmp .L194
 3397 1124 8138      		cpi r24,129
 3398 1126 9105      		cpc r25,__zero_reg__
 3399 1128 2CF4      		brge .L197
 3400 112a 8034      		cpi r24,64
 3401 112c 9105      		cpc r25,__zero_reg__
 3402 112e 09F4      		brne .+2
 3403 1130 67C0      		rjmp .L196
 3404 1132 6AC0      		rjmp .L192
 3405               	.L197:
 3406 1134 803C      		cpi r24,192
 3407 1136 9105      		cpc r25,__zero_reg__
 3408 1138 09F0      		breq .+2
 3409 113a 66C0      		rjmp .L192
 3411               	.LM341:
 3412 113c FE01      		movw r30,r28
 3413 113e E10F      		add r30,r17
 3414 1140 F11D      		adc r31,__zero_reg__
 3415 1142 8091 0000 		lds r24,mac_tx_current_frame+24
 3416 1146 8083      		st Z,r24
 3417 1148 1F5F      		subi r17,lo8(-(1))
 3419               	.LM342:
 3420 114a FE01      		movw r30,r28
 3421 114c E10F      		add r30,r17
 3422 114e F11D      		adc r31,__zero_reg__
 3423 1150 8091 0000 		lds r24,mac_tx_current_frame+25
 3424 1154 8083      		st Z,r24
 3425 1156 1F5F      		subi r17,lo8(-(1))
 3427               	.LM343:
 3428 1158 FE01      		movw r30,r28
 3429 115a E10F      		add r30,r17
 3430 115c F11D      		adc r31,__zero_reg__
 3431 115e 8091 0000 		lds r24,mac_tx_current_frame+14
 3432 1162 8083      		st Z,r24
 3433 1164 1F5F      		subi r17,lo8(-(1))
 3435               	.LM344:
 3436 1166 FE01      		movw r30,r28
 3437 1168 E10F      		add r30,r17
 3438 116a F11D      		adc r31,__zero_reg__
 3439 116c 8091 0000 		lds r24,mac_tx_current_frame+15
 3440 1170 8083      		st Z,r24
 3441 1172 1F5F      		subi r17,lo8(-(1))
 3443               	.LM345:
 3444 1174 FE01      		movw r30,r28
 3445 1176 E10F      		add r30,r17
 3446 1178 F11D      		adc r31,__zero_reg__
 3447 117a 8091 0000 		lds r24,mac_tx_current_frame+16
 3448 117e 8083      		st Z,r24
 3449 1180 1F5F      		subi r17,lo8(-(1))
 3451               	.LM346:
 3452 1182 FE01      		movw r30,r28
 3453 1184 E10F      		add r30,r17
 3454 1186 F11D      		adc r31,__zero_reg__
 3455 1188 8091 0000 		lds r24,mac_tx_current_frame+17
 3456 118c 8083      		st Z,r24
 3457 118e 1F5F      		subi r17,lo8(-(1))
 3459               	.LM347:
 3460 1190 FE01      		movw r30,r28
 3461 1192 E10F      		add r30,r17
 3462 1194 F11D      		adc r31,__zero_reg__
 3463 1196 8091 0000 		lds r24,mac_tx_current_frame+18
 3464 119a 8083      		st Z,r24
 3465 119c 1F5F      		subi r17,lo8(-(1))
 3467               	.LM348:
 3468 119e FE01      		movw r30,r28
 3469 11a0 E10F      		add r30,r17
 3470 11a2 F11D      		adc r31,__zero_reg__
 3471 11a4 8091 0000 		lds r24,mac_tx_current_frame+19
 3472 11a8 8083      		st Z,r24
 3473 11aa 1F5F      		subi r17,lo8(-(1))
 3475               	.LM349:
 3476 11ac FE01      		movw r30,r28
 3477 11ae E10F      		add r30,r17
 3478 11b0 F11D      		adc r31,__zero_reg__
 3479 11b2 8091 0000 		lds r24,mac_tx_current_frame+20
 3480 11b6 8083      		st Z,r24
 3481 11b8 1F5F      		subi r17,lo8(-(1))
 3483               	.LM350:
 3484 11ba FE01      		movw r30,r28
 3485 11bc E10F      		add r30,r17
 3486 11be F11D      		adc r31,__zero_reg__
 3487 11c0 8091 0000 		lds r24,mac_tx_current_frame+21
 3488 11c4 1AC0      		rjmp .L241
 3489               	.L194:
 3491               	.LM351:
 3492 11c6 FE01      		movw r30,r28
 3493 11c8 E10F      		add r30,r17
 3494 11ca F11D      		adc r31,__zero_reg__
 3495 11cc 8091 0000 		lds r24,mac_tx_current_frame+24
 3496 11d0 8083      		st Z,r24
 3497 11d2 1F5F      		subi r17,lo8(-(1))
 3499               	.LM352:
 3500 11d4 FE01      		movw r30,r28
 3501 11d6 E10F      		add r30,r17
 3502 11d8 F11D      		adc r31,__zero_reg__
 3503 11da 8091 0000 		lds r24,mac_tx_current_frame+25
 3504 11de 8083      		st Z,r24
 3505 11e0 1F5F      		subi r17,lo8(-(1))
 3507               	.LM353:
 3508 11e2 FE01      		movw r30,r28
 3509 11e4 E10F      		add r30,r17
 3510 11e6 F11D      		adc r31,__zero_reg__
 3511 11e8 8091 0000 		lds r24,mac_tx_current_frame+22
 3512 11ec 8083      		st Z,r24
 3513 11ee 1F5F      		subi r17,lo8(-(1))
 3515               	.LM354:
 3516 11f0 FE01      		movw r30,r28
 3517 11f2 E10F      		add r30,r17
 3518 11f4 F11D      		adc r31,__zero_reg__
 3519 11f6 8091 0000 		lds r24,mac_tx_current_frame+23
 3520               	.L241:
 3521 11fa 8083      		st Z,r24
 3522 11fc 1F5F      		subi r17,lo8(-(1))
 3524               	.LM355:
 3525 11fe 04C0      		rjmp .L192
 3526               	.L196:
 3528               	.LM356:
 3529 1200 80E0      		ldi r24,lo8(.LC13)
 3530 1202 90E0      		ldi r25,hi8(.LC13)
 3531 1204 0E94 0000 		call error
 3532               	.L192:
 3534               	.LM357:
 3535 1208 8091 0000 		lds r24,mac_tx_current_frame+26
 3536 120c 9927      		clr r25
 3537 120e 8130      		cpi r24,1
 3538 1210 9105      		cpc r25,__zero_reg__
 3539 1212 09F4      		brne .+2
 3540 1214 B5C0      		rjmp .L212
 3541 1216 8230      		cpi r24,2
 3542 1218 9105      		cpc r25,__zero_reg__
 3543 121a 1CF4      		brge .L230
 3544 121c 892B      		or r24,r25
 3545 121e 29F0      		breq .L199
 3546 1220 2EC1      		rjmp .L198
 3547               	.L230:
 3548 1222 0397      		sbiw r24,3
 3549 1224 09F4      		brne .+2
 3550 1226 C2C0      		rjmp .L218
 3551 1228 2AC1      		rjmp .L198
 3552               	.L199:
 3554               	.LM358:
 3555 122a FE01      		movw r30,r28
 3556 122c E10F      		add r30,r17
 3557 122e F11D      		adc r31,__zero_reg__
 3558 1230 8091 0000 		lds r24,mac_tx_current_frame+144
 3559 1234 8083      		st Z,r24
 3560 1236 1F5F      		subi r17,lo8(-(1))
 3562               	.LM359:
 3563 1238 FE01      		movw r30,r28
 3564 123a E10F      		add r30,r17
 3565 123c F11D      		adc r31,__zero_reg__
 3566 123e 8091 0000 		lds r24,mac_tx_current_frame+145
 3567 1242 8083      		st Z,r24
 3568 1244 1F5F      		subi r17,lo8(-(1))
 3570               	.LM360:
 3571 1246 FE01      		movw r30,r28
 3572 1248 E10F      		add r30,r17
 3573 124a F11D      		adc r31,__zero_reg__
 3574 124c 1082      		st Z,__zero_reg__
 3575 124e 1F5F      		subi r17,lo8(-(1))
 3577               	.LM361:
 3578 1250 FE01      		movw r30,r28
 3579 1252 E10F      		add r30,r17
 3580 1254 F11D      		adc r31,__zero_reg__
 3581 1256 8091 0000 		lds r24,mac_tx_current_frame+146
 3582 125a 8083      		st Z,r24
 3583 125c 1F5F      		subi r17,lo8(-(1))
 3585               	.LM362:
 3586 125e 8091 0000 		lds r24,mac_tx_current_frame+147
 3587 1262 8823      		tst r24
 3588 1264 A9F0      		breq .L234
 3589 1266 982F      		mov r25,r24
 3590 1268 A0E0      		ldi r26,lo8(mac_tx_current_frame+149)
 3591 126a B0E0      		ldi r27,hi8(mac_tx_current_frame+149)
 3592               	.L203:
 3594               	.LM363:
 3595 126c FE01      		movw r30,r28
 3596 126e E10F      		add r30,r17
 3597 1270 F11D      		adc r31,__zero_reg__
 3598 1272 8C91      		ld r24,X
 3599 1274 8083      		st Z,r24
 3600 1276 1F5F      		subi r17,lo8(-(1))
 3602               	.LM364:
 3603 1278 9E01      		movw r18,r28
 3604 127a 210F      		add r18,r17
 3605 127c 311D      		adc r19,__zero_reg__
 3606 127e FD01      		movw r30,r26
 3607 1280 8181      		ldd r24,Z+1
 3608 1282 F901      		movw r30,r18
 3609 1284 8083      		st Z,r24
 3610 1286 1F5F      		subi r17,lo8(-(1))
 3612               	.LM365:
 3613 1288 9150      		subi r25,lo8(-(-1))
 3614 128a 1296      		adiw r26,2
 3615 128c 9923      		tst r25
 3616 128e 71F7      		brne .L203
 3617               	.L234:
 3619               	.LM366:
 3620 1290 8091 0000 		lds r24,mac_tx_current_frame+148
 3621 1294 8823      		tst r24
 3622 1296 09F4      		brne .+2
 3623 1298 46C0      		rjmp .L236
 3624 129a A0E0      		ldi r26,lo8(mac_tx_current_frame+153)
 3625 129c B0E0      		ldi r27,hi8(mac_tx_current_frame+153)
 3626 129e 982F      		mov r25,r24
 3627               	.L207:
 3629               	.LM367:
 3630 12a0 FE01      		movw r30,r28
 3631 12a2 E10F      		add r30,r17
 3632 12a4 F11D      		adc r31,__zero_reg__
 3633 12a6 8C91      		ld r24,X
 3634 12a8 8083      		st Z,r24
 3635 12aa 1F5F      		subi r17,lo8(-(1))
 3637               	.LM368:
 3638 12ac 9E01      		movw r18,r28
 3639 12ae 210F      		add r18,r17
 3640 12b0 311D      		adc r19,__zero_reg__
 3641 12b2 FD01      		movw r30,r26
 3642 12b4 8181      		ldd r24,Z+1
 3643 12b6 F901      		movw r30,r18
 3644 12b8 8083      		st Z,r24
 3645 12ba 1F5F      		subi r17,lo8(-(1))
 3647               	.LM369:
 3648 12bc 9E01      		movw r18,r28
 3649 12be 210F      		add r18,r17
 3650 12c0 311D      		adc r19,__zero_reg__
 3651 12c2 FD01      		movw r30,r26
 3652 12c4 8281      		ldd r24,Z+2
 3653 12c6 F901      		movw r30,r18
 3654 12c8 8083      		st Z,r24
 3655 12ca 1F5F      		subi r17,lo8(-(1))
 3657               	.LM370:
 3658 12cc 9E01      		movw r18,r28
 3659 12ce 210F      		add r18,r17
 3660 12d0 311D      		adc r19,__zero_reg__
 3661 12d2 FD01      		movw r30,r26
 3662 12d4 8381      		ldd r24,Z+3
 3663 12d6 F901      		movw r30,r18
 3664 12d8 8083      		st Z,r24
 3665 12da 1F5F      		subi r17,lo8(-(1))
 3667               	.LM371:
 3668 12dc 9E01      		movw r18,r28
 3669 12de 210F      		add r18,r17
 3670 12e0 311D      		adc r19,__zero_reg__
 3671 12e2 FD01      		movw r30,r26
 3672 12e4 8481      		ldd r24,Z+4
 3673 12e6 F901      		movw r30,r18
 3674 12e8 8083      		st Z,r24
 3675 12ea 1F5F      		subi r17,lo8(-(1))
 3677               	.LM372:
 3678 12ec 9E01      		movw r18,r28
 3679 12ee 210F      		add r18,r17
 3680 12f0 311D      		adc r19,__zero_reg__
 3681 12f2 FD01      		movw r30,r26
 3682 12f4 8581      		ldd r24,Z+5
 3683 12f6 F901      		movw r30,r18
 3684 12f8 8083      		st Z,r24
 3685 12fa 1F5F      		subi r17,lo8(-(1))
 3687               	.LM373:
 3688 12fc 9E01      		movw r18,r28
 3689 12fe 210F      		add r18,r17
 3690 1300 311D      		adc r19,__zero_reg__
 3691 1302 FD01      		movw r30,r26
 3692 1304 8681      		ldd r24,Z+6
 3693 1306 F901      		movw r30,r18
 3694 1308 8083      		st Z,r24
 3695 130a 1F5F      		subi r17,lo8(-(1))
 3697               	.LM374:
 3698 130c 9E01      		movw r18,r28
 3699 130e 210F      		add r18,r17
 3700 1310 311D      		adc r19,__zero_reg__
 3701 1312 FD01      		movw r30,r26
 3702 1314 8781      		ldd r24,Z+7
 3703 1316 F901      		movw r30,r18
 3704 1318 8083      		st Z,r24
 3705 131a 1F5F      		subi r17,lo8(-(1))
 3707               	.LM375:
 3708 131c 9150      		subi r25,lo8(-(-1))
 3709 131e 1896      		adiw r26,8
 3710 1320 9923      		tst r25
 3711 1322 09F0      		breq .+2
 3712 1324 BDCF      		rjmp .L207
 3713               	.L236:
 3715               	.LM376:
 3716 1326 FE01      		movw r30,r28
 3717 1328 E10F      		add r30,r17
 3718 132a F11D      		adc r31,__zero_reg__
 3719 132c 8091 0000 		lds r24,mac_tx_current_frame+40
 3720 1330 8083      		st Z,r24
 3721 1332 1F5F      		subi r17,lo8(-(1))
 3723               	.LM377:
 3724 1334 8823      		tst r24
 3725 1336 59F0      		breq .L238
 3726 1338 A0E0      		ldi r26,lo8(mac_tx_current_frame+41)
 3727 133a B0E0      		ldi r27,hi8(mac_tx_current_frame+41)
 3728 133c 982F      		mov r25,r24
 3729               	.L211:
 3731               	.LM378:
 3732 133e FE01      		movw r30,r28
 3733 1340 E10F      		add r30,r17
 3734 1342 F11D      		adc r31,__zero_reg__
 3735 1344 8D91      		ld r24,X+
 3736 1346 8083      		st Z,r24
 3737 1348 1F5F      		subi r17,lo8(-(1))
 3739               	.LM379:
 3740 134a 9150      		subi r25,lo8(-(-1))
 3741 134c C1F7      		brne .L211
 3742               	.L238:
 3744               	.LM380:
 3745 134e BE01      		movw r22,r28
 3746 1350 812F      		mov r24,r17
 3747 1352 0E94 0000 		call direct_transmit
 3748 1356 DC01      		movw r26,r24
 3749 1358 CB01      		movw r24,r22
 3750 135a 8093 0000 		sts last_beacon_tx_timestamp,r24
 3751 135e 9093 0000 		sts (last_beacon_tx_timestamp)+1,r25
 3752 1362 A093 0000 		sts (last_beacon_tx_timestamp)+2,r26
 3753 1366 B093 0000 		sts (last_beacon_tx_timestamp)+3,r27
 3755               	.LM381:
 3756 136a 1092 0000 		sts phy_channel_state,__zero_reg__
 3758               	.LM382:
 3759 136e 80E1      		ldi r24,lo8(16)
 3760 1370 8093 0000 		sts mac_current_state,r24
 3762               	.LM383:
 3763 1374 86E0      		ldi r24,lo8(6)
 3764 1376 0E94 0000 		call PLME_SET_TRX_STATE_request
 3766               	.LM384:
 3767 137a 80E0      		ldi r24,lo8(pm(beacon_frame_tx_timing))
 3768 137c 90E0      		ldi r25,hi8(pm(beacon_frame_tx_timing))
 3769 137e B2C0      		rjmp .L243
 3770               	.L212:
 3772               	.LM385:
 3773 1380 FE01      		movw r30,r28
 3774 1382 E10F      		add r30,r17
 3775 1384 F11D      		adc r31,__zero_reg__
 3776 1386 8091 0000 		lds r24,mac_tx_current_frame+39
 3777 138a 8083      		st Z,r24
 3778 138c 1F5F      		subi r17,lo8(-(1))
 3780               	.LM386:
 3781 138e 8823      		tst r24
 3782 1390 09F4      		brne .+2
 3783 1392 75C0      		rjmp .L198
 3784 1394 A0E0      		ldi r26,lo8(mac_tx_current_frame+41)
 3785 1396 B0E0      		ldi r27,hi8(mac_tx_current_frame+41)
 3786 1398 982F      		mov r25,r24
 3787               	.L216:
 3789               	.LM387:
 3790 139a FE01      		movw r30,r28
 3791 139c E10F      		add r30,r17
 3792 139e F11D      		adc r31,__zero_reg__
 3793 13a0 8D91      		ld r24,X+
 3794 13a2 8083      		st Z,r24
 3795 13a4 1F5F      		subi r17,lo8(-(1))
 3797               	.LM388:
 3798 13a6 9150      		subi r25,lo8(-(-1))
 3799 13a8 C1F7      		brne .L216
 3801               	.LM389:
 3802 13aa 69C0      		rjmp .L198
 3803               	.L218:
 3805               	.LM390:
 3806 13ac FE01      		movw r30,r28
 3807 13ae E10F      		add r30,r17
 3808 13b0 F11D      		adc r31,__zero_reg__
 3809 13b2 8091 0000 		lds r24,mac_tx_current_frame+27
 3810 13b6 8083      		st Z,r24
 3811 13b8 1F5F      		subi r17,lo8(-(1))
 3813               	.LM391:
 3814 13ba 082F      		mov r16,r24
 3816               	.LM392:
 3817 13bc 9927      		clr r25
 3818 13be 8230      		cpi r24,2
 3819 13c0 9105      		cpc r25,__zero_reg__
 3820 13c2 91F0      		breq .L221
 3821 13c4 8330      		cpi r24,3
 3822 13c6 9105      		cpc r25,__zero_reg__
 3823 13c8 1CF4      		brge .L229
 3824 13ca 0197      		sbiw r24,1
 3825 13cc 39F0      		breq .L220
 3826 13ce 57C0      		rjmp .L198
 3827               	.L229:
 3828 13d0 8330      		cpi r24,3
 3829 13d2 9105      		cpc r25,__zero_reg__
 3830 13d4 E9F0      		breq .L222
 3831 13d6 0897      		sbiw r24,8
 3832 13d8 09F1      		breq .L227
 3833 13da 51C0      		rjmp .L198
 3834               	.L220:
 3836               	.LM393:
 3837 13dc FE01      		movw r30,r28
 3838 13de E10F      		add r30,r17
 3839 13e0 F11D      		adc r31,__zero_reg__
 3840 13e2 8091 0000 		lds r24,mac_tx_current_frame+143
 3841 13e6 49C0      		rjmp .L242
 3842               	.L221:
 3844               	.LM394:
 3845 13e8 FE01      		movw r30,r28
 3846 13ea E10F      		add r30,r17
 3847 13ec F11D      		adc r31,__zero_reg__
 3848 13ee 8091 0000 		lds r24,mac_tx_current_frame+169
 3849 13f2 8083      		st Z,r24
 3850 13f4 1F5F      		subi r17,lo8(-(1))
 3852               	.LM395:
 3853 13f6 FE01      		movw r30,r28
 3854 13f8 E10F      		add r30,r17
 3855 13fa F11D      		adc r31,__zero_reg__
 3856 13fc 8091 0000 		lds r24,mac_tx_current_frame+170
 3857 1400 8083      		st Z,r24
 3858 1402 1F5F      		subi r17,lo8(-(1))
 3860               	.LM396:
 3861 1404 FE01      		movw r30,r28
 3862 1406 E10F      		add r30,r17
 3863 1408 F11D      		adc r31,__zero_reg__
 3864 140a 8091 0000 		lds r24,mac_tx_current_frame+171
 3865 140e 35C0      		rjmp .L242
 3866               	.L222:
 3868               	.LM397:
 3869 1410 FE01      		movw r30,r28
 3870 1412 E10F      		add r30,r17
 3871 1414 F11D      		adc r31,__zero_reg__
 3872 1416 8091 0000 		lds r24,mac_tx_current_frame+172
 3873 141a 2FC0      		rjmp .L242
 3874               	.L227:
 3876               	.LM398:
 3877 141c FE01      		movw r30,r28
 3878 141e E10F      		add r30,r17
 3879 1420 F11D      		adc r31,__zero_reg__
 3880 1422 8091 0000 		lds r24,mac_tx_current_frame+173
 3881 1426 8083      		st Z,r24
 3882 1428 1F5F      		subi r17,lo8(-(1))
 3884               	.LM399:
 3885 142a FE01      		movw r30,r28
 3886 142c E10F      		add r30,r17
 3887 142e F11D      		adc r31,__zero_reg__
 3888 1430 8091 0000 		lds r24,mac_tx_current_frame+174
 3889 1434 8083      		st Z,r24
 3890 1436 1F5F      		subi r17,lo8(-(1))
 3892               	.LM400:
 3893 1438 FE01      		movw r30,r28
 3894 143a E10F      		add r30,r17
 3895 143c F11D      		adc r31,__zero_reg__
 3896 143e 8091 0000 		lds r24,mac_tx_current_frame+175
 3897 1442 8083      		st Z,r24
 3898 1444 1F5F      		subi r17,lo8(-(1))
 3900               	.LM401:
 3901 1446 FE01      		movw r30,r28
 3902 1448 E10F      		add r30,r17
 3903 144a F11D      		adc r31,__zero_reg__
 3904 144c 8091 0000 		lds r24,mac_tx_current_frame+176
 3905 1450 8083      		st Z,r24
 3906 1452 1F5F      		subi r17,lo8(-(1))
 3908               	.LM402:
 3909 1454 FE01      		movw r30,r28
 3910 1456 E10F      		add r30,r17
 3911 1458 F11D      		adc r31,__zero_reg__
 3912 145a 8091 0000 		lds r24,mac_tx_current_frame+177
 3913 145e 8083      		st Z,r24
 3914 1460 1F5F      		subi r17,lo8(-(1))
 3916               	.LM403:
 3917 1462 FE01      		movw r30,r28
 3918 1464 E10F      		add r30,r17
 3919 1466 F11D      		adc r31,__zero_reg__
 3920 1468 8091 0000 		lds r24,mac_tx_current_frame+178
 3921 146c 8083      		st Z,r24
 3922 146e 1F5F      		subi r17,lo8(-(1))
 3924               	.LM404:
 3925 1470 FE01      		movw r30,r28
 3926 1472 E10F      		add r30,r17
 3927 1474 F11D      		adc r31,__zero_reg__
 3928 1476 8091 0000 		lds r24,mac_tx_current_frame+179
 3929               	.L242:
 3930 147a 8083      		st Z,r24
 3931 147c 1F5F      		subi r17,lo8(-(1))
 3932               	.L198:
 3934               	.LM405:
 3935 147e E02E      		mov r14,r16
 3936 1480 0D2D      		mov r16,r13
 3937 1482 2F2D      		mov r18,r15
 3938 1484 4C2D      		mov r20,r12
 3939 1486 BE01      		movw r22,r28
 3940 1488 812F      		mov r24,r17
 3941 148a 0E94 0000 		call add_tx_queue
 3942 148e 8C01      		movw r16,r24
 3944               	.LM406:
 3945 1490 9093 0000 		sts (head_of_tx_buffer)+1,r25
 3946 1494 8093 0000 		sts head_of_tx_buffer,r24
 3948               	.LM407:
 3949 1498 8091 0000 		lds r24,Parameter_list+10
 3950 149c 282F      		mov r18,r24
 3951 149e 3327      		clr r19
 3952 14a0 8091 0000 		lds r24,Parameter_list+11
 3953 14a4 E82F      		mov r30,r24
 3954 14a6 FF27      		clr r31
 3955 14a8 EF01      		movw r28,r30
 3956 14aa 2196      		adiw r28,1
 3957 14ac CE01      		movw r24,r28
 3958 14ae 65E0      		ldi r22,lo8(5)
 3959 14b0 70E0      		ldi r23,hi8(5)
 3960 14b2 0E94 0000 		call __divmodhi4
 3961 14b6 2817      		cp r18,r24
 3962 14b8 3907      		cpc r19,r25
 3963 14ba 29F4      		brne .L231
 3965               	.LM408:
 3966 14bc 80E0      		ldi r24,lo8(.LC14)
 3967 14be 90E0      		ldi r25,hi8(.LC14)
 3968 14c0 0E94 0000 		call error
 3969 14c4 11C0      		rjmp .L185
 3970               	.L231:
 3972               	.LM409:
 3973 14c6 EE0F      		add r30,r30
 3974 14c8 FF1F      		adc r31,r31
 3975 14ca E050      		subi r30,lo8(-(Parameter_list))
 3976 14cc F040      		sbci r31,hi8(-(Parameter_list))
 3977 14ce 0083      		st Z,r16
 3978 14d0 1183      		std Z+1,r17
 3980               	.LM410:
 3981 14d2 CE01      		movw r24,r28
 3982 14d4 65E0      		ldi r22,lo8(5)
 3983 14d6 70E0      		ldi r23,hi8(5)
 3984 14d8 0E94 0000 		call __divmodhi4
 3985 14dc 8093 0000 		sts Parameter_list+11,r24
 3987               	.LM411:
 3988 14e0 80E0      		ldi r24,lo8(pm(transmit_with_csmaca))
 3989 14e2 90E0      		ldi r25,hi8(pm(transmit_with_csmaca))
 3990               	.L243:
 3991 14e4 0E94 0000 		call OS_post
 3992               	.L185:
 3993               	/* epilogue: frame size=0 */
 3994 14e8 DF91      		pop r29
 3995 14ea CF91      		pop r28
 3996 14ec 1F91      		pop r17
 3997 14ee 0F91      		pop r16
 3998 14f0 FF90      		pop r15
 3999 14f2 EF90      		pop r14
 4000 14f4 DF90      		pop r13
 4001 14f6 CF90      		pop r12
 4002 14f8 0895      		ret
 4003               	/* epilogue end (size=9) */
 4004               	/* function mac_frame_send size 608 (591) */
 4015               	.Lscope35:
 4018               	.global	beacon_frame_send
 4020               	beacon_frame_send:
 4022               	.LM412:
 4023               	/* prologue: frame size=0 */
 4024 14fa CF93      		push r28
 4025 14fc DF93      		push r29
 4026               	/* prologue end (size=2) */
 4028               	.LM413:
 4029 14fe 1092 0000 		sts mac_tx_current_frame+26,__zero_reg__
 4031               	.LM414:
 4032 1502 9091 0000 		lds r25,mac_pib_data+13
 4033 1506 292F      		mov r18,r25
 4034 1508 9F5F      		subi r25,lo8(-(1))
 4035 150a 9093 0000 		sts mac_pib_data+13,r25
 4036 150e 2093 0000 		sts mac_tx_current_frame+28,r18
 4038               	.LM415:
 4039 1512 1092 0000 		sts mac_tx_current_frame,__zero_reg__
 4041               	.LM416:
 4042 1516 2091 0000 		lds r18,mac_pib_data+28
 4043 151a 3091 0000 		lds r19,(mac_pib_data+28)+1
 4044 151e 3093 0000 		sts (mac_tx_current_frame+24)+1,r19
 4045 1522 2093 0000 		sts mac_tx_current_frame+24,r18
 4047               	.LM417:
 4048 1526 8823      		tst r24
 4049 1528 61F0      		breq .L245
 4051               	.LM418:
 4052 152a 82E0      		ldi r24,lo8(2)
 4053 152c 8093 0000 		sts mac_tx_current_frame+13,r24
 4055               	.LM419:
 4056 1530 8091 0000 		lds r24,mac_pib_data+32
 4057 1534 9091 0000 		lds r25,(mac_pib_data+32)+1
 4058 1538 9093 0000 		sts (mac_tx_current_frame+22)+1,r25
 4059 153c 8093 0000 		sts mac_tx_current_frame+22,r24
 4060 1540 0CC0      		rjmp .L246
 4061               	.L245:
 4063               	.LM420:
 4064 1542 83E0      		ldi r24,lo8(3)
 4065 1544 8093 0000 		sts mac_tx_current_frame+13,r24
 4067               	.LM421:
 4068 1548 88E0      		ldi r24,lo8(8)
 4069 154a A0E0      		ldi r26,lo8(mac_pib_data+34)
 4070 154c B0E0      		ldi r27,hi8(mac_pib_data+34)
 4071 154e E0E0      		ldi r30,lo8(mac_tx_current_frame+14)
 4072 1550 F0E0      		ldi r31,hi8(mac_tx_current_frame+14)
 4073 1552 0D90      		ld __tmp_reg__,X+
 4074 1554 0192      		st Z+,__tmp_reg__
 4075 1556 8A95      		dec r24
 4076 1558 E1F7      		brne .-8
 4077               	.L246:
 4079               	.LM422:
 4080 155a 8091 0000 		lds r24,mac_tx_beacon
 4081 155e 9091 0000 		lds r25,(mac_tx_beacon)+1
 4082 1562 9093 0000 		sts (mac_tx_current_frame+144)+1,r25
 4083 1566 8093 0000 		sts mac_tx_current_frame+144,r24
 4085               	.LM423:
 4086 156a 8091 0000 		lds r24,mac_tx_beacon+2
 4087 156e 8093 0000 		sts mac_tx_current_frame+146,r24
 4089               	.LM424:
 4090 1572 8091 0000 		lds r24,mac_tx_beacon+3
 4091 1576 8093 0000 		sts mac_tx_current_frame+147,r24
 4093               	.LM425:
 4094 157a 8823      		tst r24
 4095 157c 59F0      		breq .L260
 4096 157e 282F      		mov r18,r24
 4097 1580 A0E0      		ldi r26,lo8(mac_tx_current_frame+149)
 4098 1582 B0E0      		ldi r27,hi8(mac_tx_current_frame+149)
 4099 1584 E0E0      		ldi r30,lo8(mac_tx_beacon+5)
 4100 1586 F0E0      		ldi r31,hi8(mac_tx_beacon+5)
 4101               	.L250:
 4103               	.LM426:
 4104 1588 8191      		ld r24,Z+
 4105 158a 9191      		ld r25,Z+
 4106 158c 8D93      		st X+,r24
 4107 158e 9D93      		st X+,r25
 4109               	.LM427:
 4110 1590 2150      		subi r18,lo8(-(-1))
 4111 1592 D1F7      		brne .L250
 4112               	.L260:
 4114               	.LM428:
 4115 1594 8091 0000 		lds r24,mac_tx_beacon+4
 4116 1598 8093 0000 		sts mac_tx_current_frame+148,r24
 4118               	.LM429:
 4119 159c 8823      		tst r24
 4120 159e 91F0      		breq .L262
 4121 15a0 98E0      		ldi r25,lo8(8)
 4122 15a2 A0E0      		ldi r26,lo8(mac_tx_current_frame+153)
 4123 15a4 B0E0      		ldi r27,hi8(mac_tx_current_frame+153)
 4124 15a6 40E0      		ldi r20,lo8(mac_tx_beacon+9)
 4125 15a8 50E0      		ldi r21,hi8(mac_tx_beacon+9)
 4126 15aa 282F      		mov r18,r24
 4127               	.L254:
 4129               	.LM430:
 4130 15ac ED01      		movw r28,r26
 4131 15ae FA01      		movw r30,r20
 4132 15b0 892F      		mov r24,r25
 4133 15b2 0190      		ld __tmp_reg__,Z+
 4134 15b4 0992      		st Y+,__tmp_reg__
 4135 15b6 8A95      		dec r24
 4136 15b8 E1F7      		brne .-8
 4137 15ba 485F      		subi r20,lo8(-(8))
 4138 15bc 5F4F      		sbci r21,hi8(-(8))
 4139 15be 1896      		adiw r26,8
 4141               	.LM431:
 4142 15c0 2150      		subi r18,lo8(-(-1))
 4143 15c2 A1F7      		brne .L254
 4144               	.L262:
 4146               	.LM432:
 4147 15c4 8091 0000 		lds r24,mac_tx_beacon+25
 4148 15c8 8093 0000 		sts mac_tx_current_frame+40,r24
 4150               	.LM433:
 4151 15cc 8823      		tst r24
 4152 15ce 49F0      		breq .L264
 4153 15d0 A0E0      		ldi r26,lo8(mac_tx_current_frame+41)
 4154 15d2 B0E0      		ldi r27,hi8(mac_tx_current_frame+41)
 4155 15d4 E0E0      		ldi r30,lo8(mac_tx_beacon+26)
 4156 15d6 F0E0      		ldi r31,hi8(mac_tx_beacon+26)
 4157 15d8 282F      		mov r18,r24
 4158               	.L258:
 4160               	.LM434:
 4161 15da 8191      		ld r24,Z+
 4162 15dc 8D93      		st X+,r24
 4164               	.LM435:
 4165 15de 2150      		subi r18,lo8(-(-1))
 4166 15e0 E1F7      		brne .L258
 4167               	.L264:
 4169               	.LM436:
 4170 15e2 1092 0000 		sts mac_tx_current_frame+36,__zero_reg__
 4172               	.LM437:
 4173 15e6 8091 0000 		lds r24,mac_tx_current_frame+13
 4174 15ea 8295      		swap r24
 4175 15ec 880F      		lsl r24
 4176 15ee 880F      		lsl r24
 4177 15f0 807C      		andi r24,0xc0
 4178 15f2 8093 0000 		sts mac_tx_current_frame+37,r24
 4180               	.LM438:
 4181 15f6 80E0      		ldi r24,lo8(pm(pending_frame_handle))
 4182 15f8 90E0      		ldi r25,hi8(pm(pending_frame_handle))
 4183 15fa 0E94 0000 		call OS_post
 4185               	.LM439:
 4186 15fe 0E94 0000 		call mac_frame_send
 4187               	/* epilogue: frame size=0 */
 4188 1602 DF91      		pop r29
 4189 1604 CF91      		pop r28
 4190 1606 0895      		ret
 4191               	/* epilogue end (size=3) */
 4192               	/* function beacon_frame_send size 138 (133) */
 4197               	.Lscope36:
 4203               	.global	associate_response_frame_send
 4205               	associate_response_frame_send:
 4207               	.LM440:
 4208               	/* prologue: frame size=8 */
 4209 1608 CF92      		push r12
 4210 160a DF92      		push r13
 4211 160c EF92      		push r14
 4212 160e FF92      		push r15
 4213 1610 0F93      		push r16
 4214 1612 1F93      		push r17
 4215 1614 CF93      		push r28
 4216 1616 DF93      		push r29
 4217 1618 CDB7      		in r28,__SP_L__
 4218 161a DEB7      		in r29,__SP_H__
 4219 161c 2897      		sbiw r28,8
 4220 161e 0FB6      		in __tmp_reg__,__SREG__
 4221 1620 F894      		cli
 4222 1622 DEBF      		out __SP_H__,r29
 4223 1624 0FBE      		out __SREG__,__tmp_reg__
 4224 1626 CDBF      		out __SP_L__,r28
 4225               	/* prologue end (size=16) */
 4226 1628 E982      		std Y+1,r14
 4227 162a FA82      		std Y+2,r15
 4228 162c 0B83      		std Y+3,r16
 4229 162e 1C83      		std Y+4,r17
 4230 1630 2D83      		std Y+5,r18
 4231 1632 3E83      		std Y+6,r19
 4232 1634 4F83      		std Y+7,r20
 4233 1636 5887      		std Y+8,r21
 4235               	.LM441:
 4236 1638 82E0      		ldi r24,lo8(2)
 4237 163a 8093 0000 		sts mac_tx_current_frame+27,r24
 4239               	.LM442:
 4240 163e 93E0      		ldi r25,lo8(3)
 4241 1640 9093 0000 		sts mac_tx_current_frame+26,r25
 4243               	.LM443:
 4244 1644 8091 0000 		lds r24,mac_pib_data+24
 4245 1648 282F      		mov r18,r24
 4246 164a 8F5F      		subi r24,lo8(-(1))
 4247 164c 8093 0000 		sts mac_pib_data+24,r24
 4248 1650 2093 0000 		sts mac_tx_current_frame+28,r18
 4250               	.LM444:
 4251 1654 9093 0000 		sts mac_tx_current_frame+13,r25
 4253               	.LM445:
 4254 1658 9093 0000 		sts mac_tx_current_frame,r25
 4256               	.LM446:
 4257 165c 8091 0000 		lds r24,mac_pib_data+28
 4258 1660 9091 0000 		lds r25,(mac_pib_data+28)+1
 4259 1664 9093 0000 		sts (mac_tx_current_frame+24)+1,r25
 4260 1668 8093 0000 		sts mac_tx_current_frame+24,r24
 4262               	.LM447:
 4263 166c 9093 0000 		sts (mac_tx_current_frame+11)+1,r25
 4264 1670 8093 0000 		sts mac_tx_current_frame+11,r24
 4266               	.LM448:
 4267 1674 00E0      		ldi r16,lo8(mac_tx_current_frame+14)
 4268 1676 10E0      		ldi r17,hi8(mac_tx_current_frame+14)
 4269 1678 88E0      		ldi r24,lo8(8)
 4270 167a 20E0      		ldi r18,lo8(mac_pib_data+34)
 4271 167c 30E0      		ldi r19,hi8(mac_pib_data+34)
 4272 167e D801      		movw r26,r16
 4273 1680 F901      		movw r30,r18
 4274 1682 982F      		mov r25,r24
 4275 1684 0190      		ld __tmp_reg__,Z+
 4276 1686 0D92      		st X+,__tmp_reg__
 4277 1688 9A95      		dec r25
 4278 168a E1F7      		brne .-8
 4280               	.LM449:
 4281 168c F801      		movw r30,r16
 4282 168e 3D97      		sbiw r30,13
 4283 1690 DE01      		movw r26,r28
 4284 1692 1196      		adiw r26,1
 4285 1694 0D90      		ld __tmp_reg__,X+
 4286 1696 0192      		st Z+,__tmp_reg__
 4287 1698 8A95      		dec r24
 4288 169a E1F7      		brne .-8
 4290               	.LM450:
 4291 169c D092 0000 		sts (mac_tx_current_frame+169)+1,r13
 4292 16a0 C092 0000 		sts mac_tx_current_frame+169,r12
 4294               	.LM451:
 4295 16a4 6093 0000 		sts mac_tx_current_frame+171,r22
 4297               	.LM452:
 4298 16a8 83E2      		ldi r24,lo8(35)
 4299 16aa 8093 0000 		sts mac_tx_current_frame+36,r24
 4301               	.LM453:
 4302 16ae 8CEC      		ldi r24,lo8(-52)
 4303 16b0 8093 0000 		sts mac_tx_current_frame+37,r24
 4305               	.LM454:
 4306 16b4 0E94 0000 		call mac_frame_send
 4307               	/* epilogue: frame size=8 */
 4308 16b8 2896      		adiw r28,8
 4309 16ba 0FB6      		in __tmp_reg__,__SREG__
 4310 16bc F894      		cli
 4311 16be DEBF      		out __SP_H__,r29
 4312 16c0 0FBE      		out __SREG__,__tmp_reg__
 4313 16c2 CDBF      		out __SP_L__,r28
 4314 16c4 DF91      		pop r29
 4315 16c6 CF91      		pop r28
 4316 16c8 1F91      		pop r17
 4317 16ca 0F91      		pop r16
 4318 16cc FF90      		pop r15
 4319 16ce EF90      		pop r14
 4320 16d0 DF90      		pop r13
 4321 16d2 CF90      		pop r12
 4322 16d4 0895      		ret
 4323               	/* epilogue end (size=15) */
 4324               	/* function associate_response_frame_send size 103 (72) */
 4326               	.Lscope37:
 4331               	.global	coordinator_realignment_frame_send
 4333               	coordinator_realignment_frame_send:
 4335               	.LM455:
 4336               	/* prologue: frame size=13 */
 4337 16d6 8F92      		push r8
 4338 16d8 9F92      		push r9
 4339 16da AF92      		push r10
 4340 16dc BF92      		push r11
 4341 16de CF92      		push r12
 4342 16e0 DF92      		push r13
 4343 16e2 EF92      		push r14
 4344 16e4 FF92      		push r15
 4345 16e6 0F93      		push r16
 4346 16e8 1F93      		push r17
 4347 16ea CF93      		push r28
 4348 16ec DF93      		push r29
 4349 16ee CDB7      		in r28,__SP_L__
 4350 16f0 DEB7      		in r29,__SP_H__
 4351 16f2 2D97      		sbiw r28,13
 4352 16f4 0FB6      		in __tmp_reg__,__SREG__
 4353 16f6 F894      		cli
 4354 16f8 DEBF      		out __SP_H__,r29
 4355 16fa 0FBE      		out __SREG__,__tmp_reg__
 4356 16fc CDBF      		out __SP_L__,r28
 4357               	/* prologue end (size=20) */
 4358 16fe A982      		std Y+1,r10
 4359 1700 BA82      		std Y+2,r11
 4360 1702 CB82      		std Y+3,r12
 4361 1704 DC82      		std Y+4,r13
 4362 1706 ED82      		std Y+5,r14
 4363 1708 FE82      		std Y+6,r15
 4364 170a 0F83      		std Y+7,r16
 4365 170c 1887      		std Y+8,r17
 4366 170e 2987      		std Y+9,r18
 4367 1710 3A87      		std Y+10,r19
 4368 1712 4B87      		std Y+11,r20
 4369 1714 5C87      		std Y+12,r21
 4370 1716 6D87      		std Y+13,r22
 4372               	.LM456:
 4373 1718 78E0      		ldi r23,lo8(8)
 4374 171a 7093 0000 		sts mac_tx_current_frame+27,r23
 4376               	.LM457:
 4377 171e 63E0      		ldi r22,lo8(3)
 4378 1720 6093 0000 		sts mac_tx_current_frame+26,r22
 4380               	.LM458:
 4381 1724 9091 0000 		lds r25,mac_pib_data+24
 4382 1728 292F      		mov r18,r25
 4383 172a 9F5F      		subi r25,lo8(-(1))
 4384 172c 9093 0000 		sts mac_pib_data+24,r25
 4385 1730 2093 0000 		sts mac_tx_current_frame+28,r18
 4387               	.LM459:
 4388 1734 6093 0000 		sts mac_tx_current_frame+13,r22
 4390               	.LM460:
 4391 1738 00E0      		ldi r16,lo8(mac_tx_current_frame+14)
 4392 173a 10E0      		ldi r17,hi8(mac_tx_current_frame+14)
 4393 173c 20E0      		ldi r18,lo8(mac_pib_data+34)
 4394 173e 30E0      		ldi r19,hi8(mac_pib_data+34)
 4395 1740 D801      		movw r26,r16
 4396 1742 F901      		movw r30,r18
 4397 1744 972F      		mov r25,r23
 4398 1746 0190      		ld __tmp_reg__,Z+
 4399 1748 0D92      		st X+,__tmp_reg__
 4400 174a 9A95      		dec r25
 4401 174c E1F7      		brne .-8
 4403               	.LM461:
 4404 174e 4091 0000 		lds r20,mac_pib_data+28
 4405 1752 5091 0000 		lds r21,(mac_pib_data+28)+1
 4406 1756 5093 0000 		sts (mac_tx_current_frame+24)+1,r21
 4407 175a 4093 0000 		sts mac_tx_current_frame+24,r20
 4409               	.LM462:
 4410 175e 2091 0000 		lds r18,default_short_addr
 4411 1762 3091 0000 		lds r19,(default_short_addr)+1
 4412 1766 3093 0000 		sts (mac_tx_current_frame+11)+1,r19
 4413 176a 2093 0000 		sts mac_tx_current_frame+11,r18
 4415               	.LM463:
 4416 176e 8823      		tst r24
 4417 1770 99F0      		breq .L267
 4419               	.LM464:
 4420 1772 6093 0000 		sts mac_tx_current_frame,r22
 4422               	.LM465:
 4423 1776 F801      		movw r30,r16
 4424 1778 3D97      		sbiw r30,13
 4425 177a DE01      		movw r26,r28
 4426 177c 1296      		adiw r26,2
 4427 177e 0D90      		ld __tmp_reg__,X+
 4428 1780 0192      		st Z+,__tmp_reg__
 4429 1782 7A95      		dec r23
 4430 1784 E1F7      		brne .-8
 4432               	.LM466:
 4433 1786 9092 0000 		sts (mac_tx_current_frame+178)+1,r9
 4434 178a 8092 0000 		sts mac_tx_current_frame+178,r8
 4436               	.LM467:
 4437 178e 83E2      		ldi r24,lo8(35)
 4438 1790 8093 0000 		sts mac_tx_current_frame+36,r24
 4440               	.LM468:
 4441 1794 8CEC      		ldi r24,lo8(-52)
 4442 1796 0EC0      		rjmp .L269
 4443               	.L267:
 4445               	.LM469:
 4446 1798 82E0      		ldi r24,lo8(2)
 4447 179a 8093 0000 		sts mac_tx_current_frame,r24
 4449               	.LM470:
 4450 179e 3093 0000 		sts (mac_tx_current_frame+9)+1,r19
 4451 17a2 2093 0000 		sts mac_tx_current_frame+9,r18
 4453               	.LM471:
 4454 17a6 3093 0000 		sts (mac_tx_current_frame+178)+1,r19
 4455 17aa 2093 0000 		sts mac_tx_current_frame+178,r18
 4457               	.LM472:
 4458 17ae 6093 0000 		sts mac_tx_current_frame+36,r22
 4460               	.LM473:
 4461 17b2 88EC      		ldi r24,lo8(-56)
 4462               	.L269:
 4463 17b4 8093 0000 		sts mac_tx_current_frame+37,r24
 4465               	.LM474:
 4466 17b8 5093 0000 		sts (mac_tx_current_frame+173)+1,r21
 4467 17bc 4093 0000 		sts mac_tx_current_frame+173,r20
 4469               	.LM475:
 4470 17c0 8091 0000 		lds r24,mac_pib_data+32
 4471 17c4 9091 0000 		lds r25,(mac_pib_data+32)+1
 4472 17c8 9093 0000 		sts (mac_tx_current_frame+175)+1,r25
 4473 17cc 8093 0000 		sts mac_tx_current_frame+175,r24
 4475               	.LM476:
 4476 17d0 8091 0000 		lds r24,ppib
 4477 17d4 8093 0000 		sts mac_tx_current_frame+177,r24
 4479               	.LM477:
 4480 17d8 0E94 0000 		call mac_frame_send
 4481               	/* epilogue: frame size=13 */
 4482 17dc 2D96      		adiw r28,13
 4483 17de 0FB6      		in __tmp_reg__,__SREG__
 4484 17e0 F894      		cli
 4485 17e2 DEBF      		out __SP_H__,r29
 4486 17e4 0FBE      		out __SREG__,__tmp_reg__
 4487 17e6 CDBF      		out __SP_L__,r28
 4488 17e8 DF91      		pop r29
 4489 17ea CF91      		pop r28
 4490 17ec 1F91      		pop r17
 4491 17ee 0F91      		pop r16
 4492 17f0 FF90      		pop r15
 4493 17f2 EF90      		pop r14
 4494 17f4 DF90      		pop r13
 4495 17f6 CF90      		pop r12
 4496 17f8 BF90      		pop r11
 4497 17fa AF90      		pop r10
 4498 17fc 9F90      		pop r9
 4499 17fe 8F90      		pop r8
 4500 1800 0895      		ret
 4501               	/* epilogue end (size=19) */
 4502               	/* function coordinator_realignment_frame_send size 150 (111) */
 4504               	.Lscope38:
 4507               	.global	mlmeSyncLossIndication
 4509               	mlmeSyncLossIndication:
 4511               	.LM478:
 4512               	/* prologue: frame size=13 */
 4513 1802 CF93      		push r28
 4514 1804 DF93      		push r29
 4515 1806 CDB7      		in r28,__SP_L__
 4516 1808 DEB7      		in r29,__SP_H__
 4517 180a 2D97      		sbiw r28,13
 4518 180c 0FB6      		in __tmp_reg__,__SREG__
 4519 180e F894      		cli
 4520 1810 DEBF      		out __SP_H__,r29
 4521 1812 0FBE      		out __SREG__,__tmp_reg__
 4522 1814 CDBF      		out __SP_L__,r28
 4523               	/* prologue end (size=10) */
 4525               	.LM479:
 4526 1816 803E      		cpi r24,lo8(-32)
 4527 1818 11F4      		brne .L270
 4529               	.LM480:
 4530 181a 1092 0000 		sts mac_current_state,__zero_reg__
 4531               	.L270:
 4532               	/* epilogue: frame size=13 */
 4533 181e 2D96      		adiw r28,13
 4534 1820 0FB6      		in __tmp_reg__,__SREG__
 4535 1822 F894      		cli
 4536 1824 DEBF      		out __SP_H__,r29
 4537 1826 0FBE      		out __SREG__,__tmp_reg__
 4538 1828 CDBF      		out __SP_L__,r28
 4539 182a DF91      		pop r29
 4540 182c CF91      		pop r28
 4541 182e 0895      		ret
 4542               	/* epilogue end (size=9) */
 4543               	/* function mlmeSyncLossIndication size 23 (4) */
 4548               	.Lscope39:
 4554               	.global	mlmeOrphanResponse
 4556               	mlmeOrphanResponse:
 4558               	.LM481:
 4559               	/* prologue: frame size=21 */
 4560 1830 CF93      		push r28
 4561 1832 DF93      		push r29
 4562 1834 CDB7      		in r28,__SP_L__
 4563 1836 DEB7      		in r29,__SP_H__
 4564 1838 6597      		sbiw r28,21
 4565 183a 0FB6      		in __tmp_reg__,__SREG__
 4566 183c F894      		cli
 4567 183e DEBF      		out __SP_H__,r29
 4568 1840 0FBE      		out __SREG__,__tmp_reg__
 4569 1842 CDBF      		out __SP_L__,r28
 4570               	/* prologue end (size=10) */
 4571               	/* epilogue: frame size=21 */
 4572 1844 6596      		adiw r28,21
 4573 1846 0FB6      		in __tmp_reg__,__SREG__
 4574 1848 F894      		cli
 4575 184a DEBF      		out __SP_H__,r29
 4576 184c 0FBE      		out __SREG__,__tmp_reg__
 4577 184e CDBF      		out __SP_L__,r28
 4578 1850 DF91      		pop r29
 4579 1852 CF91      		pop r28
 4580 1854 0895      		ret
 4581               	/* epilogue end (size=9) */
 4582               	/* function mlmeOrphanResponse size 19 (0) */
 4587               	.Lscope40:
 4588               		.data
 4589               	.LC15:
 4590 0251 0A73 7563 		.string	"\nsuccess received a orphan notification frame"
 4590      6365 7373 
 4590      2072 6563 
 4590      6569 7665 
 4590      6420 6120 
 4591               		.text
 4596               	.global	mlmeOrphanIndication
 4598               	mlmeOrphanIndication:
 4600               	.LM482:
 4601               	/* prologue: frame size=8 */
 4602 1856 CF93      		push r28
 4603 1858 DF93      		push r29
 4604 185a CDB7      		in r28,__SP_L__
 4605 185c DEB7      		in r29,__SP_H__
 4606 185e 2897      		sbiw r28,8
 4607 1860 0FB6      		in __tmp_reg__,__SREG__
 4608 1862 F894      		cli
 4609 1864 DEBF      		out __SP_H__,r29
 4610 1866 0FBE      		out __SREG__,__tmp_reg__
 4611 1868 CDBF      		out __SP_L__,r28
 4612               	/* prologue end (size=10) */
 4613 186a 2983      		std Y+1,r18
 4614 186c 3A83      		std Y+2,r19
 4615 186e 4B83      		std Y+3,r20
 4616 1870 5C83      		std Y+4,r21
 4617 1872 6D83      		std Y+5,r22
 4618 1874 7E83      		std Y+6,r23
 4619 1876 8F83      		std Y+7,r24
 4620 1878 9887      		std Y+8,r25
 4622               	.LM483:
 4623 187a 80E0      		ldi r24,lo8(.LC15)
 4624 187c 90E0      		ldi r25,hi8(.LC15)
 4625 187e 0E94 0000 		call puts
 4627               	.LM484:
 4628 1882 2981      		ldd r18,Y+1
 4629 1884 3A81      		ldd r19,Y+2
 4630 1886 4B81      		ldd r20,Y+3
 4631 1888 5C81      		ldd r21,Y+4
 4632 188a 6D81      		ldd r22,Y+5
 4633 188c 7E81      		ldd r23,Y+6
 4634 188e 8F81      		ldd r24,Y+7
 4635 1890 9885      		ldd r25,Y+8
 4636 1892 0E94 0000 		call short_address_allocate_req
 4637               	/* epilogue: frame size=8 */
 4638 1896 2896      		adiw r28,8
 4639 1898 0FB6      		in __tmp_reg__,__SREG__
 4640 189a F894      		cli
 4641 189c DEBF      		out __SP_H__,r29
 4642 189e 0FBE      		out __SREG__,__tmp_reg__
 4643 18a0 CDBF      		out __SP_L__,r28
 4644 18a2 DF91      		pop r29
 4645 18a4 CF91      		pop r28
 4646 18a6 0895      		ret
 4647               	/* epilogue end (size=9) */
 4648               	/* function mlmeOrphanIndication size 41 (22) */
 4650               	.Lscope41:
 4661               	.global	mlmeStartRequest
 4663               	mlmeStartRequest:
 4665               	.LM485:
 4666               	/* prologue: frame size=0 */
 4667 18a8 8F92      		push r8
 4668 18aa 9F92      		push r9
 4669 18ac AF92      		push r10
 4670 18ae BF92      		push r11
 4671 18b0 CF92      		push r12
 4672 18b2 DF92      		push r13
 4673 18b4 EF92      		push r14
 4674 18b6 FF92      		push r15
 4675 18b8 0F93      		push r16
 4676 18ba 1F93      		push r17
 4677 18bc CF93      		push r28
 4678 18be DF93      		push r29
 4679 18c0 CDB7      		in r28,__SP_L__
 4680 18c2 DEB7      		in r29,__SP_H__
 4681               	/* prologue end (size=14) */
 4682 18c4 DC01      		movw r26,r24
 4683 18c6 522F      		mov r21,r18
 4685               	.LM486:
 4686 18c8 1092 0000 		sts mac_tx_beacon+25,__zero_reg__
 4688               	.LM487:
 4689 18cc 1092 0000 		sts mac_tx_beacon+4,__zero_reg__
 4691               	.LM488:
 4692 18d0 1092 0000 		sts mac_tx_beacon+3,__zero_reg__
 4694               	.LM489:
 4695 18d4 E22F      		mov r30,r18
 4696 18d6 FF27      		clr r31
 4697 18d8 9F01      		movw r18,r30
 4698 18da 74E0      		ldi r23,4
 4699 18dc 220F      	1:	lsl r18
 4700 18de 331F      		rol r19
 4701 18e0 7A95      		dec r23
 4702 18e2 E1F7      		brne 1b
 4703 18e4 942F      		mov r25,r20
 4704 18e6 922B      		or r25,r18
 4705 18e8 9093 0000 		sts mac_tx_beacon,r25
 4707               	.LM490:
 4708 18ec 0023      		tst r16
 4709 18ee 11F0      		breq .L278
 4711               	.LM491:
 4712 18f0 8FEC      		ldi r24,lo8(-49)
 4713 18f2 01C0      		rjmp .L282
 4714               	.L278:
 4716               	.LM492:
 4717 18f4 8FE8      		ldi r24,lo8(-113)
 4718               	.L282:
 4719 18f6 8093 0000 		sts mac_tx_beacon+1,r24
 4721               	.LM493:
 4722 18fa B093 0000 		sts (mac_pib_data+28)+1,r27
 4723 18fe A093 0000 		sts mac_pib_data+28,r26
 4725               	.LM494:
 4726 1902 4093 0000 		sts mac_pib_data+8,r20
 4728               	.LM495:
 4729 1906 5093 0000 		sts mac_pib_data+42,r21
 4731               	.LM496:
 4732 190a 6093 0000 		sts ppib,r22
 4734               	.LM497:
 4735 190e 80EA      		ldi r24,lo8(160)
 4736 1910 90E0      		ldi r25,hi8(160)
 4737 1912 A0E0      		ldi r26,hlo8(160)
 4738 1914 B0E0      		ldi r27,hhi8(160)
 4739 1916 7C01      		movw r14,r24
 4740 1918 8D01      		movw r16,r26
 4741 191a 04C0      		rjmp 2f
 4742 191c EE0C      	1:	lsl r14
 4743 191e FF1C      		rol r15
 4744 1920 001F      		rol r16
 4745 1922 111F      		rol r17
 4746 1924 4A95      	2:	dec r20
 4747 1926 D2F7      		brpl 1b
 4748 1928 E092 0000 		sts MAC_SUPERFRAME_PERIOD,r14
 4749 192c F092 0000 		sts (MAC_SUPERFRAME_PERIOD)+1,r15
 4750 1930 0093 0000 		sts (MAC_SUPERFRAME_PERIOD)+2,r16
 4751 1934 1093 0000 		sts (MAC_SUPERFRAME_PERIOD)+3,r17
 4753               	.LM498:
 4754 1938 04C0      		rjmp 2f
 4755 193a 880F      	1:	lsl r24
 4756 193c 991F      		rol r25
 4757 193e AA1F      		rol r26
 4758 1940 BB1F      		rol r27
 4759 1942 EA95      	2:	dec r30
 4760 1944 D2F7      		brpl 1b
 4761 1946 8093 0000 		sts MAC_CAP_PERIOD,r24
 4762 194a 9093 0000 		sts (MAC_CAP_PERIOD)+1,r25
 4763 194e A093 0000 		sts (MAC_CAP_PERIOD)+2,r26
 4764 1952 B093 0000 		sts (MAC_CAP_PERIOD)+3,r27
 4766               	.LM499:
 4767 1956 80E0      		ldi r24,lo8(0)
 4768 1958 0E94 0000 		call PLME_SET_request
 4770               	.LM500:
 4771 195c CC20      		tst r12
 4772 195e 21F4      		brne .L280
 4774               	.LM501:
 4775 1960 81E0      		ldi r24,lo8(1)
 4776 1962 0E94 0000 		call beacon_frame_send
 4777 1966 21C0      		rjmp .L277
 4778               	.L280:
 4780               	.LM502:
 4781 1968 8090 0000 		lds r8,default_short_addr
 4782 196c 9090 0000 		lds r9,(default_short_addr)+1
 4783 1970 A090 0000 		lds r10,default_node
 4784 1974 B090 0000 		lds r11,default_node+1
 4785 1978 C090 0000 		lds r12,default_node+2
 4786 197c D090 0000 		lds r13,default_node+3
 4787 1980 E090 0000 		lds r14,default_node+4
 4788 1984 F090 0000 		lds r15,default_node+5
 4789 1988 0091 0000 		lds r16,default_node+6
 4790 198c 1091 0000 		lds r17,default_node+7
 4791 1990 2091 0000 		lds r18,default_node+8
 4792 1994 3091 0000 		lds r19,default_node+9
 4793 1998 4091 0000 		lds r20,default_node+10
 4794 199c 5091 0000 		lds r21,default_node+11
 4795 19a0 6091 0000 		lds r22,default_node+12
 4796 19a4 80E0      		ldi r24,lo8(0)
 4797 19a6 0E94 0000 		call coordinator_realignment_frame_send
 4798               	.L277:
 4799               	/* epilogue: frame size=0 */
 4800 19aa DF91      		pop r29
 4801 19ac CF91      		pop r28
 4802 19ae 1F91      		pop r17
 4803 19b0 0F91      		pop r16
 4804 19b2 FF90      		pop r15
 4805 19b4 EF90      		pop r14
 4806 19b6 DF90      		pop r13
 4807 19b8 CF90      		pop r12
 4808 19ba BF90      		pop r11
 4809 19bc AF90      		pop r10
 4810 19be 9F90      		pop r9
 4811 19c0 8F90      		pop r8
 4812 19c2 0895      		ret
 4813               	/* epilogue end (size=13) */
 4814               	/* function mlmeStartRequest size 144 (117) */
 4816               	.Lscope42:
 4818               	.global	orphan_notification_frame_send
 4820               	orphan_notification_frame_send:
 4822               	.LM503:
 4823               	/* prologue: frame size=0 */
 4824 19c4 0F93      		push r16
 4825 19c6 1F93      		push r17
 4826               	/* prologue end (size=2) */
 4828               	.LM504:
 4829 19c8 86E0      		ldi r24,lo8(6)
 4830 19ca 8093 0000 		sts mac_tx_current_frame+27,r24
 4832               	.LM505:
 4833 19ce 33E0      		ldi r19,lo8(3)
 4834 19d0 3093 0000 		sts mac_tx_current_frame+26,r19
 4836               	.LM506:
 4837 19d4 8091 0000 		lds r24,mac_pib_data+24
 4838 19d8 982F      		mov r25,r24
 4839 19da 8F5F      		subi r24,lo8(-(1))
 4840 19dc 8093 0000 		sts mac_pib_data+24,r24
 4841 19e0 9093 0000 		sts mac_tx_current_frame+28,r25
 4843               	.LM507:
 4844 19e4 3093 0000 		sts mac_tx_current_frame+13,r19
 4846               	.LM508:
 4847 19e8 82E0      		ldi r24,lo8(2)
 4848 19ea 8093 0000 		sts mac_tx_current_frame,r24
 4850               	.LM509:
 4851 19ee 8091 0000 		lds r24,default_short_addr
 4852 19f2 9091 0000 		lds r25,(default_short_addr)+1
 4853 19f6 9093 0000 		sts (mac_tx_current_frame+24)+1,r25
 4854 19fa 8093 0000 		sts mac_tx_current_frame+24,r24
 4856               	.LM510:
 4857 19fe 28E0      		ldi r18,lo8(8)
 4858 1a00 A0E0      		ldi r26,lo8(mac_pib_data+34)
 4859 1a02 B0E0      		ldi r27,hi8(mac_pib_data+34)
 4860 1a04 E0E0      		ldi r30,lo8(mac_tx_current_frame+14)
 4861 1a06 F0E0      		ldi r31,hi8(mac_tx_current_frame+14)
 4862 1a08 0D90      		ld __tmp_reg__,X+
 4863 1a0a 0192      		st Z+,__tmp_reg__
 4864 1a0c 2A95      		dec r18
 4865 1a0e E1F7      		brne .-8
 4867               	.LM511:
 4868 1a10 9093 0000 		sts (mac_tx_current_frame+11)+1,r25
 4869 1a14 8093 0000 		sts mac_tx_current_frame+11,r24
 4871               	.LM512:
 4872 1a18 9093 0000 		sts (mac_tx_current_frame+9)+1,r25
 4873 1a1c 8093 0000 		sts mac_tx_current_frame+9,r24
 4875               	.LM513:
 4876 1a20 3093 0000 		sts mac_tx_current_frame+36,r19
 4878               	.LM514:
 4879 1a24 88EC      		ldi r24,lo8(-56)
 4880 1a26 8093 0000 		sts mac_tx_current_frame+37,r24
 4882               	.LM515:
 4883 1a2a 0E94 0000 		call mac_frame_send
 4885               	.LM516:
 4886 1a2e 00E4      		ldi r16,lo8(1600)
 4887 1a30 16E0      		ldi r17,hi8(1600)
 4888 1a32 21E0      		ldi r18,lo8(1)
 4889 1a34 4091 0000 		lds r20,mac_tx_current_frame+28
 4890 1a38 622F      		mov r22,r18
 4891 1a3a 8091 0000 		lds r24,head_of_timer_queue
 4892 1a3e 9091 0000 		lds r25,(head_of_timer_queue)+1
 4893 1a42 0E94 0000 		call timer3queue_start
 4894 1a46 9093 0000 		sts (head_of_timer_queue)+1,r25
 4895 1a4a 8093 0000 		sts head_of_timer_queue,r24
 4896               	/* epilogue: frame size=0 */
 4897 1a4e 1F91      		pop r17
 4898 1a50 0F91      		pop r16
 4899 1a52 0895      		ret
 4900               	/* epilogue end (size=3) */
 4901               	/* function orphan_notification_frame_send size 72 (67) */
 4903               	.Lscope43:
 4904               		.data
 4905               	.LC16:
 4906 027f 0A2D 2D2D 		.string	"\n---Retransmit---"
 4906      5265 7472 
 4906      616E 736D 
 4906      6974 2D2D 
 4906      2D00 
 4907               	.LC17:
 4908 0291 0A73 6574 		.string	"\nset the %d channel & waitting for beacon\n"
 4908      2074 6865 
 4908      2025 6420 
 4908      6368 616E 
 4908      6E65 6C20 
 4909               		.text
 4911               	.global	mac_timer_task
 4913               	mac_timer_task:
 4915               	.LM517:
 4916               	/* prologue: frame size=0 */
 4917 1a54 EF92      		push r14
 4918 1a56 FF92      		push r15
 4919 1a58 0F93      		push r16
 4920 1a5a 1F93      		push r17
 4921 1a5c CF93      		push r28
 4922 1a5e DF93      		push r29
 4923               	/* prologue end (size=6) */
 4925               	.LM518:
 4926 1a60 E091 0000 		lds r30,current_timer_elem
 4927 1a64 F091 0000 		lds r31,(current_timer_elem)+1
 4928 1a68 8281      		ldd r24,Z+2
 4929 1a6a 9927      		clr r25
 4930 1a6c 8230      		cpi r24,2
 4931 1a6e 9105      		cpc r25,__zero_reg__
 4932 1a70 09F4      		brne .+2
 4933 1a72 F6C0      		rjmp .L314
 4935               	.LM519:
 4936 1a74 8330      		cpi r24,3
 4937 1a76 9105      		cpc r25,__zero_reg__
 4938 1a78 34F4      		brge .L317
 4939 1a7a 0097      		sbiw r24,0
 4940 1a7c 61F0      		breq .L286
 4941 1a7e 0197      		sbiw r24,1
 4942 1a80 09F4      		brne .+2
 4943 1a82 76C0      		rjmp .L303
 4944 1a84 21C1      		rjmp .L285
 4945               	.L317:
 4946 1a86 8330      		cpi r24,3
 4947 1a88 9105      		cpc r25,__zero_reg__
 4948 1a8a 09F4      		brne .+2
 4949 1a8c 7FC0      		rjmp .L308
 4950 1a8e 0497      		sbiw r24,4
 4951 1a90 09F4      		brne .+2
 4952 1a92 13C1      		rjmp .L315
 4953 1a94 19C1      		rjmp .L285
 4954               	.L286:
 4956               	.LM520:
 4957 1a96 1092 0000 		sts phy_channel_state,__zero_reg__
 4959               	.LM521:
 4960 1a9a 8181      		ldd r24,Z+1
 4961 1a9c 0E94 0000 		call get_frame_pointer
 4962 1aa0 EC01      		movw r28,r24
 4964               	.LM522:
 4965 1aa2 892B      		or r24,r25
 4966 1aa4 09F4      		brne .+2
 4967 1aa6 10C1      		rjmp .L285
 4969               	.LM523:
 4970 1aa8 8C81      		ldd r24,Y+4
 4971 1aaa 8823      		tst r24
 4972 1aac 89F1      		breq .L288
 4974               	.LM524:
 4975 1aae 80E0      		ldi r24,lo8(.LC16)
 4976 1ab0 90E0      		ldi r25,hi8(.LC16)
 4977 1ab2 0E94 0000 		call puts
 4979               	.LM525:
 4980 1ab6 8091 0000 		lds r24,Parameter_list+10
 4981 1aba 282F      		mov r18,r24
 4982 1abc 3327      		clr r19
 4983 1abe 8091 0000 		lds r24,Parameter_list+11
 4984 1ac2 E82F      		mov r30,r24
 4985 1ac4 FF27      		clr r31
 4986 1ac6 8F01      		movw r16,r30
 4987 1ac8 0F5F      		subi r16,lo8(-(1))
 4988 1aca 1F4F      		sbci r17,hi8(-(1))
 4989 1acc C801      		movw r24,r16
 4990 1ace 65E0      		ldi r22,lo8(5)
 4991 1ad0 70E0      		ldi r23,hi8(5)
 4992 1ad2 0E94 0000 		call __divmodhi4
 4993 1ad6 2817      		cp r18,r24
 4994 1ad8 3907      		cpc r19,r25
 4995 1ada 29F4      		brne .L289
 4997               	.LM526:
 4998 1adc 80E0      		ldi r24,lo8(.LC14)
 4999 1ade 90E0      		ldi r25,hi8(.LC14)
 5000 1ae0 0E94 0000 		call error
 5001 1ae4 11C0      		rjmp .L290
 5002               	.L289:
 5004               	.LM527:
 5005 1ae6 EE0F      		add r30,r30
 5006 1ae8 FF1F      		adc r31,r31
 5007 1aea E050      		subi r30,lo8(-(Parameter_list))
 5008 1aec F040      		sbci r31,hi8(-(Parameter_list))
 5009 1aee C083      		st Z,r28
 5010 1af0 D183      		std Z+1,r29
 5012               	.LM528:
 5013 1af2 C801      		movw r24,r16
 5014 1af4 65E0      		ldi r22,lo8(5)
 5015 1af6 70E0      		ldi r23,hi8(5)
 5016 1af8 0E94 0000 		call __divmodhi4
 5017 1afc 8093 0000 		sts Parameter_list+11,r24
 5019               	.LM529:
 5020 1b00 80E0      		ldi r24,lo8(pm(transmit_with_csmaca))
 5021 1b02 90E0      		ldi r25,hi8(pm(transmit_with_csmaca))
 5022 1b04 0E94 0000 		call OS_post
 5023               	.L290:
 5025               	.LM530:
 5026 1b08 8C81      		ldd r24,Y+4
 5027 1b0a 8150      		subi r24,lo8(-(-1))
 5028 1b0c 8C83      		std Y+4,r24
 5029 1b0e DCC0      		rjmp .L285
 5030               	.L288:
 5032               	.LM531:
 5033 1b10 8E81      		ldd r24,Y+6
 5034 1b12 9927      		clr r25
 5035 1b14 8130      		cpi r24,1
 5036 1b16 9105      		cpc r25,__zero_reg__
 5037 1b18 99F0      		breq .L295
 5038 1b1a 8230      		cpi r24,2
 5039 1b1c 9105      		cpc r25,__zero_reg__
 5040 1b1e 1CF4      		brge .L302
 5041 1b20 892B      		or r24,r25
 5042 1b22 D1F0      		breq .L297
 5043 1b24 21C0      		rjmp .L292
 5044               	.L302:
 5045 1b26 8330      		cpi r24,3
 5046 1b28 9105      		cpc r25,__zero_reg__
 5047 1b2a D9F0      		breq .L298
 5048 1b2c 0497      		sbiw r24,4
 5049 1b2e E1F4      		brne .L292
 5051               	.LM532:
 5052 1b30 8091 0000 		lds r24,IS_NETWORK_FORMED
 5053 1b34 8823      		tst r24
 5054 1b36 C1F4      		brne .L292
 5056               	.LM533:
 5057 1b38 8AE0      		ldi r24,lo8(10)
 5058 1b3a 8093 0000 		sts mac_current_state,r24
 5060               	.LM534:
 5061 1b3e 14C0      		rjmp .L292
 5062               	.L295:
 5064               	.LM535:
 5065 1b40 8091 0000 		lds r24,mac_current_state
 5066 1b44 8330      		cpi r24,lo8(3)
 5067 1b46 81F4      		brne .L292
 5069               	.LM536:
 5070 1b48 69EE      		ldi r22,lo8(-23)
 5071 1b4a 8091 0000 		lds r24,default_short_addr
 5072 1b4e 9091 0000 		lds r25,(default_short_addr)+1
 5073 1b52 0E94 0000 		call mlmeAssociateConfirm
 5075               	.LM537:
 5076 1b56 08C0      		rjmp .L292
 5077               	.L297:
 5079               	.LM538:
 5080 1b58 6981      		ldd r22,Y+1
 5081 1b5a 89EE      		ldi r24,lo8(-23)
 5082 1b5c 0E94 0000 		call mcpsDataConfirm
 5084               	.LM539:
 5085 1b60 03C0      		rjmp .L292
 5086               	.L298:
 5088               	.LM540:
 5089 1b62 89EE      		ldi r24,lo8(-23)
 5090 1b64 0E94 0000 		call mlmeDisassociateConfirm
 5091               	.L292:
 5093               	.LM541:
 5094 1b68 8B81      		ldd r24,Y+3
 5095 1b6a 0E94 0000 		call remove_tx_queue
 5097               	.LM542:
 5098 1b6e ACC0      		rjmp .L285
 5099               	.L303:
 5101               	.LM543:
 5102 1b70 8091 0000 		lds r24,mac_current_state
 5103 1b74 8330      		cpi r24,lo8(3)
 5104 1b76 09F4      		brne .+2
 5105 1b78 73C0      		rjmp .L314
 5106 1b7a 8131      		cpi r24,lo8(17)
 5107 1b7c 09F4      		brne .+2
 5108 1b7e 70C0      		rjmp .L314
 5110               	.LM544:
 5111 1b80 8830      		cpi r24,lo8(8)
 5112 1b82 09F0      		breq .+2
 5113 1b84 A1C0      		rjmp .L285
 5115               	.LM545:
 5116 1b86 0E94 0000 		call orphan_notification_frame_send
 5118               	.LM546:
 5119 1b8a 9EC0      		rjmp .L285
 5120               	.L308:
 5122               	.LM547:
 5123 1b8c 8091 0000 		lds r24,mac_current_state
 5124 1b90 8730      		cpi r24,lo8(7)
 5125 1b92 09F0      		breq .+2
 5126 1b94 99C0      		rjmp .L285
 5128               	.LM548:
 5129 1b96 C091 0000 		lds r28,scan_channel
 5130 1b9a D091 0000 		lds r29,(scan_channel)+1
 5131 1b9e E091 0000 		lds r30,(scan_channel)+2
 5132 1ba2 F091 0000 		lds r31,(scan_channel)+3
 5133 1ba6 CE01      		movw r24,r28
 5134 1ba8 DF01      		movw r26,r30
 5135 1baa 0090 0000 		lds r0,scan_channel_index
 5136 1bae 04C0      		rjmp 2f
 5137 1bb0 B695      	1:	lsr r27
 5138 1bb2 A795      		ror r26
 5139 1bb4 9795      		ror r25
 5140 1bb6 8795      		ror r24
 5141 1bb8 0A94      	2:	dec r0
 5142 1bba D2F7      		brpl 1b
 5143 1bbc 21E0      		ldi r18,lo8(1)
 5144 1bbe 30E0      		ldi r19,hi8(1)
 5145 1bc0 40E0      		ldi r20,hlo8(1)
 5146 1bc2 50E0      		ldi r21,hhi8(1)
 5147               	.L321:
 5148 1bc4 8227      		eor r24,r18
 5149 1bc6 9327      		eor r25,r19
 5150 1bc8 A427      		eor r26,r20
 5151 1bca B527      		eor r27,r21
 5152 1bcc 8170      		andi r24,lo8(1)
 5153 1bce 9070      		andi r25,hi8(1)
 5154 1bd0 892B      		or r24,r25
 5155 1bd2 A1F0      		breq .L319
 5157               	.LM549:
 5158 1bd4 8091 0000 		lds r24,scan_channel_index
 5159 1bd8 8F5F      		subi r24,lo8(-(1))
 5160 1bda 8093 0000 		sts scan_channel_index,r24
 5162               	.LM550:
 5163 1bde 8031      		cpi r24,lo8(16)
 5164 1be0 08F0      		brlo .+2
 5165 1be2 46C0      		rjmp .L320
 5167               	.LM551:
 5168 1be4 7E01      		movw r14,r28
 5169 1be6 8F01      		movw r16,r30
 5170 1be8 04C0      		rjmp 2f
 5171 1bea 1695      	1:	lsr r17
 5172 1bec 0795      		ror r16
 5173 1bee F794      		ror r15
 5174 1bf0 E794      		ror r14
 5175 1bf2 8A95      	2:	dec r24
 5176 1bf4 D2F7      		brpl 1b
 5177 1bf6 D801      		movw r26,r16
 5178 1bf8 C701      		movw r24,r14
 5179 1bfa E4CF      		rjmp .L321
 5180               	.L319:
 5182               	.LM552:
 5183 1bfc 8091 0000 		lds r24,scan_channel_index
 5184 1c00 982F      		mov r25,r24
 5185 1c02 8F5F      		subi r24,lo8(-(1))
 5186 1c04 8093 0000 		sts scan_channel_index,r24
 5187 1c08 692F      		mov r22,r25
 5188 1c0a 80E0      		ldi r24,lo8(0)
 5189 1c0c 0E94 0000 		call PLME_SET_request
 5191               	.LM553:
 5192 1c10 86E0      		ldi r24,lo8(6)
 5193 1c12 0E94 0000 		call PLME_SET_TRX_STATE_request
 5195               	.LM554:
 5196 1c16 84E0      		ldi r24,lo8(4)
 5197 1c18 8093 0000 		sts phy_channel_state,r24
 5199               	.LM555:
 5200 1c1c 0091 0000 		lds r16,scan_time_period
 5201 1c20 1091 0000 		lds r17,(scan_time_period)+1
 5202 1c24 23E0      		ldi r18,lo8(3)
 5203 1c26 40E0      		ldi r20,lo8(0)
 5204 1c28 61E0      		ldi r22,lo8(1)
 5205 1c2a 8091 0000 		lds r24,head_of_timer_queue
 5206 1c2e 9091 0000 		lds r25,(head_of_timer_queue)+1
 5207 1c32 0E94 0000 		call timer3queue_start
 5208 1c36 9093 0000 		sts (head_of_timer_queue)+1,r25
 5209 1c3a 8093 0000 		sts head_of_timer_queue,r24
 5211               	.LM556:
 5212 1c3e 8091 0000 		lds r24,scan_channel_index
 5213 1c42 9927      		clr r25
 5214 1c44 0197      		sbiw r24,1
 5215 1c46 9F93      		push r25
 5216 1c48 8F93      		push r24
 5217 1c4a 80E0      		ldi r24,lo8(.LC17)
 5218 1c4c 90E0      		ldi r25,hi8(.LC17)
 5219 1c4e 9F93      		push r25
 5220 1c50 8F93      		push r24
 5221 1c52 0E94 0000 		call printf
 5222 1c56 0F90      		pop __tmp_reg__
 5223 1c58 0F90      		pop __tmp_reg__
 5224 1c5a 0F90      		pop __tmp_reg__
 5225 1c5c 0F90      		pop __tmp_reg__
 5227               	.LM557:
 5228 1c5e 34C0      		rjmp .L285
 5229               	.L314:
 5231               	.LM558:
 5232 1c60 6BEE      		ldi r22,lo8(-21)
 5233 1c62 8091 0000 		lds r24,default_short_addr
 5234 1c66 9091 0000 		lds r25,(default_short_addr)+1
 5235 1c6a 0E94 0000 		call mlmeAssociateConfirm
 5237               	.LM559:
 5238 1c6e 2CC0      		rjmp .L285
 5239               	.L320:
 5241               	.LM560:
 5242 1c70 85E0      		ldi r24,lo8(5)
 5243 1c72 8093 0000 		sts phy_channel_state,r24
 5245               	.LM561:
 5246 1c76 88E0      		ldi r24,lo8(8)
 5247 1c78 0E94 0000 		call PLME_SET_TRX_STATE_request
 5249               	.LM562:
 5250 1c7c 0DB7      		in r16,__SP_L__
 5251 1c7e 1EB7      		in r17,__SP_H__
 5252 1c80 0458      		subi r16,lo8(-(-132))
 5253 1c82 1040      		sbci r17,hi8(-(-132))
 5254 1c84 0FB6      		in __tmp_reg__,__SREG__
 5255 1c86 F894      		cli
 5256 1c88 1EBF      		out __SP_H__,r17
 5257 1c8a 0FBE      		out __SREG__,__tmp_reg__
 5258 1c8c 0DBF      		out __SP_L__,r16
 5259 1c8e ADB7      		in r26,__SP_L__
 5260 1c90 BEB7      		in r27,__SP_H__
 5261 1c92 1196      		adiw r26,1
 5262 1c94 84E8      		ldi r24,lo8(-124)
 5263 1c96 E0E0      		ldi r30,lo8(scan_result_info)
 5264 1c98 F0E0      		ldi r31,hi8(scan_result_info)
 5265 1c9a 0190      		ld __tmp_reg__,Z+
 5266 1c9c 0D92      		st X+,__tmp_reg__
 5267 1c9e 8A95      		dec r24
 5268 1ca0 E1F7      		brne .-8
 5269 1ca2 0E94 0000 		call mlmeScanConfirm
 5271               	.LM563:
 5272 1ca6 8DB7      		in r24,__SP_L__
 5273 1ca8 9EB7      		in r25,__SP_H__
 5274 1caa 8C57      		subi r24,lo8(-(132))
 5275 1cac 9F4F      		sbci r25,hi8(-(132))
 5276 1cae 0FB6      		in __tmp_reg__,__SREG__
 5277 1cb0 F894      		cli
 5278 1cb2 9EBF      		out __SP_H__,r25
 5279 1cb4 0FBE      		out __SREG__,__tmp_reg__
 5280 1cb6 8DBF      		out __SP_L__,r24
 5281 1cb8 0DC0      		rjmp .L284
 5282               	.L315:
 5284               	.LM564:
 5285 1cba 8091 0000 		lds r24,IS_MAC_SYNING
 5286 1cbe 8823      		tst r24
 5287 1cc0 19F0      		breq .L285
 5289               	.LM565:
 5290 1cc2 80EE      		ldi r24,lo8(-32)
 5291 1cc4 0E94 0000 		call mlmeSyncLossIndication
 5292               	.L285:
 5294               	.LM566:
 5295 1cc8 8091 0000 		lds r24,current_timer_elem
 5296 1ccc 9091 0000 		lds r25,(current_timer_elem)+1
 5297 1cd0 0E94 0000 		call free
 5298               	.L284:
 5299               	/* epilogue: frame size=0 */
 5300 1cd4 DF91      		pop r29
 5301 1cd6 CF91      		pop r28
 5302 1cd8 1F91      		pop r17
 5303 1cda 0F91      		pop r16
 5304 1cdc FF90      		pop r15
 5305 1cde EF90      		pop r14
 5306 1ce0 0895      		ret
 5307               	/* epilogue end (size=7) */
 5308               	/* function mac_timer_task size 331 (318) */
 5313               	.Lscope44:
 5318               	.global	mlmeScanRequest
 5320               	mlmeScanRequest:
 5322               	.LM567:
 5323               	/* prologue: frame size=0 */
 5324 1ce2 4F92      		push r4
 5325 1ce4 5F92      		push r5
 5326 1ce6 6F92      		push r6
 5327 1ce8 7F92      		push r7
 5328 1cea 8F92      		push r8
 5329 1cec 9F92      		push r9
 5330 1cee AF92      		push r10
 5331 1cf0 BF92      		push r11
 5332 1cf2 CF92      		push r12
 5333 1cf4 DF92      		push r13
 5334 1cf6 EF92      		push r14
 5335 1cf8 FF92      		push r15
 5336 1cfa 0F93      		push r16
 5337 1cfc 1F93      		push r17
 5338 1cfe CF93      		push r28
 5339 1d00 DF93      		push r29
 5340               	/* prologue end (size=16) */
 5341 1d02 4A01      		movw r8,r20
 5342 1d04 5B01      		movw r10,r22
 5344               	.LM568:
 5345 1d06 C0EA      		ldi r28,lo8(160)
 5346 1d08 D0E0      		ldi r29,hi8(160)
 5347 1d0a 02C0      		rjmp 2f
 5348 1d0c CC0F      	1:	lsl r28
 5349 1d0e DD1F      		rol r29
 5350 1d10 2A95      	2:	dec r18
 5351 1d12 E2F7      		brpl 1b
 5352 1d14 C056      		subi r28,lo8(-(160))
 5353 1d16 DF4F      		sbci r29,hi8(-(160))
 5355               	.LM569:
 5356 1d18 1092 0000 		sts scan_result_info+6,__zero_reg__
 5358               	.LM570:
 5359 1d1c 282F      		mov r18,r24
 5360 1d1e 3327      		clr r19
 5361 1d20 2130      		cpi r18,1
 5362 1d22 3105      		cpc r19,__zero_reg__
 5363 1d24 09F4      		brne .+2
 5364 1d26 72C0      		rjmp .L336
 5366               	.LM571:
 5367 1d28 2230      		cpi r18,2
 5368 1d2a 3105      		cpc r19,__zero_reg__
 5369 1d2c 24F4      		brge .L342
 5370 1d2e 2115      		cp r18,__zero_reg__
 5371 1d30 3105      		cpc r19,__zero_reg__
 5372 1d32 31F0      		breq .L324
 5373 1d34 DBC0      		rjmp .L323
 5374               	.L342:
 5375 1d36 2330      		cpi r18,3
 5376 1d38 3105      		cpc r19,__zero_reg__
 5377 1d3a 09F4      		brne .+2
 5378 1d3c D2C0      		rjmp .L341
 5379 1d3e D6C0      		rjmp .L323
 5380               	.L324:
 5382               	.LM572:
 5383 1d40 85E0      		ldi r24,lo8(5)
 5384 1d42 8093 0000 		sts mac_current_state,r24
 5386               	.LM573:
 5387 1d46 8093 0000 		sts phy_channel_state,r24
 5389               	.LM574:
 5390 1d4a 7090 0000 		lds r7,scan_result_info+6
 5391 1d4e 2901      		movw r4,r18
 5392               	.L335:
 5394               	.LM575:
 5395 1d50 81E0      		ldi r24,lo8(1)
 5396 1d52 90E0      		ldi r25,hi8(1)
 5397 1d54 042C      		mov r0,r4
 5398 1d56 02C0      		rjmp 2f
 5399 1d58 880F      	1:	lsl r24
 5400 1d5a 991F      		rol r25
 5401 1d5c 0A94      	2:	dec r0
 5402 1d5e E2F7      		brpl 1b
 5403 1d60 AA27      		clr r26
 5404 1d62 97FD      		sbrc r25,7
 5405 1d64 A095      		com r26
 5406 1d66 BA2F      		mov r27,r26
 5407 1d68 8821      		and r24,r8
 5408 1d6a 9921      		and r25,r9
 5409 1d6c AA21      		and r26,r10
 5410 1d6e BB21      		and r27,r11
 5411 1d70 0097      		sbiw r24,0
 5412 1d72 A105      		cpc r26,__zero_reg__
 5413 1d74 B105      		cpc r27,__zero_reg__
 5414 1d76 A1F1      		breq .L328
 5416               	.LM576:
 5417 1d78 0E94 0000 		call systime32
 5418 1d7c 6B01      		movw r12,r22
 5419 1d7e 7C01      		movw r14,r24
 5420 1d80 CE01      		movw r24,r28
 5421 1d82 AA27      		clr r26
 5422 1d84 BB27      		clr r27
 5423 1d86 880F      		lsl r24
 5424 1d88 991F      		rol r25
 5425 1d8a AA1F      		rol r26
 5426 1d8c BB1F      		rol r27
 5427 1d8e C80E      		add r12,r24
 5428 1d90 D91E      		adc r13,r25
 5429 1d92 EA1E      		adc r14,r26
 5430 1d94 FB1E      		adc r15,r27
 5432               	.LM577:
 5433 1d96 E0E8      		ldi r30,lo8(-128)
 5434 1d98 6E2E      		mov r6,r30
 5436               	.LM578:
 5437 1d9a 672D      		mov r22,r7
 5438 1d9c 80E0      		ldi r24,lo8(0)
 5439 1d9e 0E94 0000 		call PLME_SET_request
 5440 1da2 8C01      		movw r16,r24
 5442               	.LM579:
 5443 1da4 86E0      		ldi r24,lo8(6)
 5444 1da6 0E94 0000 		call PLME_SET_TRX_STATE_request
 5446               	.LM580:
 5447 1daa 0730      		cpi r16,lo8(7)
 5448 1dac C9F4      		brne .L328
 5450               	.LM581:
 5451 1dae 05C0      		rjmp .L351
 5452               	.L333:
 5454               	.LM582:
 5455 1db0 0E94 0000 		call PLME_ED_request
 5457               	.LM583:
 5458 1db4 9615      		cp r25,r6
 5459 1db6 0CF0      		brlt .L351
 5461               	.LM584:
 5462 1db8 692E      		mov r6,r25
 5463               	.L351:
 5464 1dba 0E94 0000 		call systime32
 5465 1dbe DC01      		movw r26,r24
 5466 1dc0 CB01      		movw r24,r22
 5467 1dc2 8C15      		cp r24,r12
 5468 1dc4 9D05      		cpc r25,r13
 5469 1dc6 AE05      		cpc r26,r14
 5470 1dc8 BF05      		cpc r27,r15
 5471 1dca 91F7      		brne .L333
 5473               	.LM585:
 5474 1dcc 8091 0000 		lds r24,scan_result_info+6
 5475 1dd0 E82F      		mov r30,r24
 5476 1dd2 FF27      		clr r31
 5477 1dd4 E050      		subi r30,lo8(-(scan_result_info))
 5478 1dd6 F040      		sbci r31,hi8(-(scan_result_info))
 5479 1dd8 6782      		std Z+7,r6
 5480 1dda 8F5F      		subi r24,lo8(-(1))
 5481 1ddc 8093 0000 		sts scan_result_info+6,r24
 5482               	.L328:
 5484               	.LM586:
 5485 1de0 8091 0000 		lds r24,scan_result_info+6
 5486 1de4 8031      		cpi r24,lo8(16)
 5487 1de6 40F4      		brsh .L326
 5489               	.LM587:
 5490 1de8 7394      		inc r7
 5491 1dea 0894      		sec
 5492 1dec 411C      		adc r4,__zero_reg__
 5493 1dee 511C      		adc r5,__zero_reg__
 5494 1df0 8FE0      		ldi r24,lo8(15)
 5495 1df2 8715      		cp r24,r7
 5496 1df4 08F0      		brlo .+2
 5497 1df6 ACCF      		rjmp .L335
 5498               	.L326:
 5500               	.LM588:
 5501 1df8 86E0      		ldi r24,lo8(6)
 5502 1dfa 8093 0000 		sts mac_current_state,r24
 5504               	.LM589:
 5505 1dfe 85E0      		ldi r24,lo8(5)
 5506 1e00 8093 0000 		sts phy_channel_state,r24
 5508               	.LM590:
 5509 1e04 88E0      		ldi r24,lo8(8)
 5510 1e06 0E94 0000 		call PLME_SET_TRX_STATE_request
 5512               	.LM591:
 5513 1e0a 70C0      		rjmp .L323
 5514               	.L336:
 5516               	.LM592:
 5517 1e0c 1092 0000 		sts scan_channel_index,__zero_reg__
 5519               	.LM593:
 5520 1e10 4093 0000 		sts scan_channel,r20
 5521 1e14 5093 0000 		sts (scan_channel)+1,r21
 5522 1e18 6093 0000 		sts (scan_channel)+2,r22
 5523 1e1c 7093 0000 		sts (scan_channel)+3,r23
 5525               	.LM594:
 5526 1e20 D093 0000 		sts (scan_time_period)+1,r29
 5527 1e24 C093 0000 		sts scan_time_period,r28
 5529               	.LM595:
 5530 1e28 0E94 0000 		call cc2420_bcn_accept
 5532               	.LM596:
 5533 1e2c 8091 0000 		lds r24,default_short_addr
 5534 1e30 9091 0000 		lds r25,(default_short_addr)+1
 5535 1e34 0E94 0000 		call cc2420_setshortaddress
 5537               	.LM597:
 5538 1e38 8091 0000 		lds r24,default_short_addr
 5539 1e3c 9091 0000 		lds r25,(default_short_addr)+1
 5540 1e40 0E94 0000 		call cc2420_setpanid
 5542               	.LM598:
 5543 1e44 87E0      		ldi r24,lo8(7)
 5544 1e46 8093 0000 		sts mac_current_state,r24
 5546               	.LM599:
 5547 1e4a D501      		movw r26,r10
 5548 1e4c C401      		movw r24,r8
 5549 1e4e 0090 0000 		lds r0,scan_channel_index
 5550 1e52 04C0      		rjmp 2f
 5551 1e54 B695      	1:	lsr r27
 5552 1e56 A795      		ror r26
 5553 1e58 9795      		ror r25
 5554 1e5a 8795      		ror r24
 5555 1e5c 0A94      	2:	dec r0
 5556 1e5e D2F7      		brpl 1b
 5557 1e60 21E0      		ldi r18,lo8(1)
 5558 1e62 30E0      		ldi r19,hi8(1)
 5559 1e64 40E0      		ldi r20,hlo8(1)
 5560 1e66 50E0      		ldi r21,hhi8(1)
 5561               	.L350:
 5562 1e68 8227      		eor r24,r18
 5563 1e6a 9327      		eor r25,r19
 5564 1e6c A427      		eor r26,r20
 5565 1e6e B527      		eor r27,r21
 5566 1e70 8170      		andi r24,lo8(1)
 5567 1e72 9070      		andi r25,hi8(1)
 5568 1e74 892B      		or r24,r25
 5569 1e76 99F0      		breq .L345
 5571               	.LM600:
 5572 1e78 8091 0000 		lds r24,scan_channel_index
 5573 1e7c 8F5F      		subi r24,lo8(-(1))
 5574 1e7e 8093 0000 		sts scan_channel_index,r24
 5576               	.LM601:
 5577 1e82 8031      		cpi r24,lo8(16)
 5578 1e84 99F1      		breq .L323
 5580               	.LM602:
 5581 1e86 F501      		movw r30,r10
 5582 1e88 E401      		movw r28,r8
 5583 1e8a 04C0      		rjmp 2f
 5584 1e8c F695      	1:	lsr r31
 5585 1e8e E795      		ror r30
 5586 1e90 D795      		ror r29
 5587 1e92 C795      		ror r28
 5588 1e94 8A95      	2:	dec r24
 5589 1e96 D2F7      		brpl 1b
 5590 1e98 CE01      		movw r24,r28
 5591 1e9a DF01      		movw r26,r30
 5592 1e9c E5CF      		rjmp .L350
 5593               	.L345:
 5595               	.LM603:
 5596 1e9e 8091 0000 		lds r24,scan_channel_index
 5597 1ea2 982F      		mov r25,r24
 5598 1ea4 8F5F      		subi r24,lo8(-(1))
 5599 1ea6 8093 0000 		sts scan_channel_index,r24
 5600 1eaa 692F      		mov r22,r25
 5601 1eac 80E0      		ldi r24,lo8(0)
 5602 1eae 0E94 0000 		call PLME_SET_request
 5604               	.LM604:
 5605 1eb2 0091 0000 		lds r16,scan_time_period
 5606 1eb6 1091 0000 		lds r17,(scan_time_period)+1
 5607 1eba 23E0      		ldi r18,lo8(3)
 5608 1ebc 40E0      		ldi r20,lo8(0)
 5609 1ebe 61E0      		ldi r22,lo8(1)
 5610 1ec0 8091 0000 		lds r24,head_of_timer_queue
 5611 1ec4 9091 0000 		lds r25,(head_of_timer_queue)+1
 5612 1ec8 0E94 0000 		call timer3queue_start
 5613 1ecc 9093 0000 		sts (head_of_timer_queue)+1,r25
 5614 1ed0 8093 0000 		sts head_of_timer_queue,r24
 5616               	.LM605:
 5617 1ed4 86E0      		ldi r24,lo8(6)
 5618 1ed6 0E94 0000 		call PLME_SET_TRX_STATE_request
 5620               	.LM606:
 5621 1eda 84E0      		ldi r24,lo8(4)
 5622 1edc 8093 0000 		sts phy_channel_state,r24
 5624               	.LM607:
 5625 1ee0 05C0      		rjmp .L323
 5626               	.L341:
 5628               	.LM608:
 5629 1ee2 88E0      		ldi r24,lo8(8)
 5630 1ee4 8093 0000 		sts mac_current_state,r24
 5632               	.LM609:
 5633 1ee8 0E94 0000 		call orphan_notification_frame_send
 5634               	.L323:
 5635               	/* epilogue: frame size=0 */
 5636 1eec DF91      		pop r29
 5637 1eee CF91      		pop r28
 5638 1ef0 1F91      		pop r17
 5639 1ef2 0F91      		pop r16
 5640 1ef4 FF90      		pop r15
 5641 1ef6 EF90      		pop r14
 5642 1ef8 DF90      		pop r13
 5643 1efa CF90      		pop r12
 5644 1efc BF90      		pop r11
 5645 1efe AF90      		pop r10
 5646 1f00 9F90      		pop r9
 5647 1f02 8F90      		pop r8
 5648 1f04 7F90      		pop r7
 5649 1f06 6F90      		pop r6
 5650 1f08 5F90      		pop r5
 5651 1f0a 4F90      		pop r4
 5652 1f0c 0895      		ret
 5653               	/* epilogue end (size=17) */
 5654               	/* function mlmeScanRequest size 280 (247) */
 5664               	.Lscope45:
 5666               	.global	scan_task
 5668               	scan_task:
 5670               	.LM610:
 5671               	/* prologue: frame size=0 */
 5672               	/* prologue end (size=0) */
 5674               	.LM611:
 5675 1f0e 26E0      		ldi r18,lo8(6)
 5676 1f10 48E0      		ldi r20,lo8(8)
 5677 1f12 50E0      		ldi r21,hi8(8)
 5678 1f14 60E0      		ldi r22,hlo8(8)
 5679 1f16 70E0      		ldi r23,hhi8(8)
 5680 1f18 81E0      		ldi r24,lo8(1)
 5681 1f1a 0E94 0000 		call mlmeScanRequest
 5682               	/* epilogue: frame size=0 */
 5683 1f1e 0895      		ret
 5684               	/* epilogue end (size=1) */
 5685               	/* function scan_task size 9 (8) */
 5687               	.Lscope46:
 5689               	.global	panid_confilct_frame_send
 5691               	panid_confilct_frame_send:
 5693               	.LM612:
 5694               	/* prologue: frame size=0 */
 5695               	/* prologue end (size=0) */
 5697               	.LM613:
 5698 1f20 85E0      		ldi r24,lo8(5)
 5699 1f22 8093 0000 		sts mac_tx_current_frame+27,r24
 5701               	.LM614:
 5702 1f26 23E0      		ldi r18,lo8(3)
 5703 1f28 2093 0000 		sts mac_tx_current_frame+26,r18
 5705               	.LM615:
 5706 1f2c 8091 0000 		lds r24,mac_pib_data+24
 5707 1f30 982F      		mov r25,r24
 5708 1f32 8F5F      		subi r24,lo8(-(1))
 5709 1f34 8093 0000 		sts mac_pib_data+24,r24
 5710 1f38 9093 0000 		sts mac_tx_current_frame+28,r25
 5712               	.LM616:
 5713 1f3c 2093 0000 		sts mac_tx_current_frame+13,r18
 5715               	.LM617:
 5716 1f40 82E0      		ldi r24,lo8(2)
 5717 1f42 8093 0000 		sts mac_tx_current_frame,r24
 5719               	.LM618:
 5720 1f46 8091 0000 		lds r24,mac_pib_data+28
 5721 1f4a 9091 0000 		lds r25,(mac_pib_data+28)+1
 5722 1f4e 9093 0000 		sts (mac_tx_current_frame+24)+1,r25
 5723 1f52 8093 0000 		sts mac_tx_current_frame+24,r24
 5725               	.LM619:
 5726 1f56 9093 0000 		sts (mac_tx_current_frame+11)+1,r25
 5727 1f5a 8093 0000 		sts mac_tx_current_frame+11,r24
 5729               	.LM620:
 5730 1f5e 88E0      		ldi r24,lo8(8)
 5731 1f60 A0E0      		ldi r26,lo8(mac_pib_data+34)
 5732 1f62 B0E0      		ldi r27,hi8(mac_pib_data+34)
 5733 1f64 E0E0      		ldi r30,lo8(mac_tx_current_frame+14)
 5734 1f66 F0E0      		ldi r31,hi8(mac_tx_current_frame+14)
 5735 1f68 0D90      		ld __tmp_reg__,X+
 5736 1f6a 0192      		st Z+,__tmp_reg__
 5737 1f6c 8A95      		dec r24
 5738 1f6e E1F7      		brne .-8
 5740               	.LM621:
 5741 1f70 8091 0000 		lds r24,mac_pib_data+22
 5742 1f74 9091 0000 		lds r25,(mac_pib_data+22)+1
 5743 1f78 9093 0000 		sts (mac_tx_current_frame+9)+1,r25
 5744 1f7c 8093 0000 		sts mac_tx_current_frame+9,r24
 5746               	.LM622:
 5747 1f80 83E2      		ldi r24,lo8(35)
 5748 1f82 8093 0000 		sts mac_tx_current_frame+36,r24
 5750               	.LM623:
 5751 1f86 88EC      		ldi r24,lo8(-56)
 5752 1f88 8093 0000 		sts mac_tx_current_frame+37,r24
 5754               	.LM624:
 5755 1f8c 0E94 0000 		call mac_frame_send
 5756               	/* epilogue: frame size=0 */
 5757 1f90 0895      		ret
 5758               	/* epilogue end (size=1) */
 5759               	/* function panid_confilct_frame_send size 57 (56) */
 5761               	.Lscope47:
 5765               	.global	disassociate_notification_frame_send
 5767               	disassociate_notification_frame_send:
 5769               	.LM625:
 5770               	/* prologue: frame size=8 */
 5771 1f92 0F93      		push r16
 5772 1f94 1F93      		push r17
 5773 1f96 CF93      		push r28
 5774 1f98 DF93      		push r29
 5775 1f9a CDB7      		in r28,__SP_L__
 5776 1f9c DEB7      		in r29,__SP_H__
 5777 1f9e 2897      		sbiw r28,8
 5778 1fa0 0FB6      		in __tmp_reg__,__SREG__
 5779 1fa2 F894      		cli
 5780 1fa4 DEBF      		out __SP_H__,r29
 5781 1fa6 0FBE      		out __SREG__,__tmp_reg__
 5782 1fa8 CDBF      		out __SP_L__,r28
 5783               	/* prologue end (size=12) */
 5784 1faa 0983      		std Y+1,r16
 5785 1fac 1A83      		std Y+2,r17
 5786 1fae 2B83      		std Y+3,r18
 5787 1fb0 3C83      		std Y+4,r19
 5788 1fb2 4D83      		std Y+5,r20
 5789 1fb4 5E83      		std Y+6,r21
 5790 1fb6 6F83      		std Y+7,r22
 5791 1fb8 7887      		std Y+8,r23
 5792 1fba 23E0      		ldi r18,lo8(3)
 5793 1fbc 2093 0000 		sts mac_tx_current_frame+27,r18
 5795               	.LM626:
 5796 1fc0 2093 0000 		sts mac_tx_current_frame+26,r18
 5798               	.LM627:
 5799 1fc4 9091 0000 		lds r25,mac_pib_data+24
 5800 1fc8 392F      		mov r19,r25
 5801 1fca 9F5F      		subi r25,lo8(-(1))
 5802 1fcc 9093 0000 		sts mac_pib_data+24,r25
 5803 1fd0 3093 0000 		sts mac_tx_current_frame+28,r19
 5805               	.LM628:
 5806 1fd4 2093 0000 		sts mac_tx_current_frame+13,r18
 5808               	.LM629:
 5809 1fd8 92E0      		ldi r25,lo8(2)
 5810 1fda 9093 0000 		sts mac_tx_current_frame,r25
 5812               	.LM630:
 5813 1fde 2091 0000 		lds r18,mac_pib_data+28
 5814 1fe2 3091 0000 		lds r19,(mac_pib_data+28)+1
 5815 1fe6 3093 0000 		sts (mac_tx_current_frame+24)+1,r19
 5816 1fea 2093 0000 		sts mac_tx_current_frame+24,r18
 5818               	.LM631:
 5819 1fee 3093 0000 		sts (mac_tx_current_frame+11)+1,r19
 5820 1ff2 2093 0000 		sts mac_tx_current_frame+11,r18
 5822               	.LM632:
 5823 1ff6 98E0      		ldi r25,lo8(8)
 5824 1ff8 A0E0      		ldi r26,lo8(mac_pib_data+34)
 5825 1ffa B0E0      		ldi r27,hi8(mac_pib_data+34)
 5826 1ffc E0E0      		ldi r30,lo8(mac_tx_current_frame+14)
 5827 1ffe F0E0      		ldi r31,hi8(mac_tx_current_frame+14)
 5828 2000 0D90      		ld __tmp_reg__,X+
 5829 2002 0192      		st Z+,__tmp_reg__
 5830 2004 9A95      		dec r25
 5831 2006 E1F7      		brne .-8
 5833               	.LM633:
 5834 2008 2091 0000 		lds r18,mac_pib_data+22
 5835 200c 3091 0000 		lds r19,(mac_pib_data+22)+1
 5836 2010 3093 0000 		sts (mac_tx_current_frame+9)+1,r19
 5837 2014 2093 0000 		sts mac_tx_current_frame+9,r18
 5839               	.LM634:
 5840 2018 8093 0000 		sts mac_tx_current_frame+172,r24
 5842               	.LM635:
 5843 201c 83E2      		ldi r24,lo8(35)
 5844 201e 8093 0000 		sts mac_tx_current_frame+36,r24
 5846               	.LM636:
 5847 2022 88EC      		ldi r24,lo8(-56)
 5848 2024 8093 0000 		sts mac_tx_current_frame+37,r24
 5850               	.LM637:
 5851 2028 0E94 0000 		call mac_frame_send
 5852               	/* epilogue: frame size=8 */
 5853 202c 2896      		adiw r28,8
 5854 202e 0FB6      		in __tmp_reg__,__SREG__
 5855 2030 F894      		cli
 5856 2032 DEBF      		out __SP_H__,r29
 5857 2034 0FBE      		out __SREG__,__tmp_reg__
 5858 2036 CDBF      		out __SP_L__,r28
 5859 2038 DF91      		pop r29
 5860 203a CF91      		pop r28
 5861 203c 1F91      		pop r17
 5862 203e 0F91      		pop r16
 5863 2040 0895      		ret
 5864               	/* epilogue end (size=11) */
 5865               	/* function disassociate_notification_frame_send size 88 (65) */
 5867               	.Lscope48:
 5872               	.global	mlmeDisassociateRequest
 5874               	mlmeDisassociateRequest:
 5876               	.LM638:
 5877               	/* prologue: frame size=37 */
 5878 2042 FF92      		push r15
 5879 2044 0F93      		push r16
 5880 2046 1F93      		push r17
 5881 2048 CF93      		push r28
 5882 204a DF93      		push r29
 5883 204c CDB7      		in r28,__SP_L__
 5884 204e DEB7      		in r29,__SP_H__
 5885 2050 A597      		sbiw r28,37
 5886 2052 0FB6      		in __tmp_reg__,__SREG__
 5887 2054 F894      		cli
 5888 2056 DEBF      		out __SP_H__,r29
 5889 2058 0FBE      		out __SREG__,__tmp_reg__
 5890 205a CDBF      		out __SP_L__,r28
 5891               	/* prologue end (size=13) */
 5892 205c 2983      		std Y+1,r18
 5893 205e 3A83      		std Y+2,r19
 5894 2060 4B83      		std Y+3,r20
 5895 2062 5C83      		std Y+4,r21
 5896 2064 6D83      		std Y+5,r22
 5897 2066 7E83      		std Y+6,r23
 5898 2068 8F83      		std Y+7,r24
 5899 206a 9887      		std Y+8,r25
 5900 206c F02E      		mov r15,r16
 5902               	.LM639:
 5903 206e 83E0      		ldi r24,lo8(3)
 5904 2070 8C87      		std Y+12,r24
 5906               	.LM640:
 5907 2072 898F      		std Y+25,r24
 5909               	.LM641:
 5910 2074 8091 0000 		lds r24,mac_pib_data+28
 5911 2078 9091 0000 		lds r25,(mac_pib_data+28)+1
 5912 207c 8F8B      		std Y+23,r24
 5913 207e 988F      		std Y+24,r25
 5915               	.LM642:
 5916 2080 8CA3      		std Y+36,r24
 5917 2082 9DA3      		std Y+37,r25
 5919               	.LM643:
 5920 2084 20E0      		ldi r18,lo8(mac_pib_data+34)
 5921 2086 30E0      		ldi r19,hi8(mac_pib_data+34)
 5922 2088 98E0      		ldi r25,lo8(8)
 5923 208a FE01      		movw r30,r28
 5924 208c 7A96      		adiw r30,26
 5925 208e D901      		movw r26,r18
 5926 2090 892F      		mov r24,r25
 5927 2092 0D90      		ld __tmp_reg__,X+
 5928 2094 0192      		st Z+,__tmp_reg__
 5929 2096 8A95      		dec r24
 5930 2098 E1F7      		brne .-8
 5932               	.LM644:
 5933 209a 83E2      		ldi r24,lo8(35)
 5934 209c 8987      		std Y+9,r24
 5936               	.LM645:
 5937 209e 88EC      		ldi r24,lo8(-56)
 5938 20a0 8A87      		std Y+10,r24
 5940               	.LM646:
 5941 20a2 8091 0000 		lds r24,mac_current_state
 5942 20a6 8031      		cpi r24,lo8(16)
 5943 20a8 D9F4      		brne .L361
 5945               	.LM647:
 5946 20aa F901      		movw r30,r18
 5947 20ac 7497      		sbiw r30,20
 5948 20ae DE01      		movw r26,r28
 5949 20b0 1D96      		adiw r26,13
 5950 20b2 0190      		ld __tmp_reg__,Z+
 5951 20b4 0D92      		st X+,__tmp_reg__
 5952 20b6 9A95      		dec r25
 5953 20b8 E1F7      		brne .-8
 5955               	.LM648:
 5956 20ba 0091 0000 		lds r16,mac_pib_data+14
 5957 20be 1091 0000 		lds r17,mac_pib_data+15
 5958 20c2 2091 0000 		lds r18,mac_pib_data+16
 5959 20c6 3091 0000 		lds r19,mac_pib_data+17
 5960 20ca 4091 0000 		lds r20,mac_pib_data+18
 5961 20ce 5091 0000 		lds r21,mac_pib_data+19
 5962 20d2 6091 0000 		lds r22,mac_pib_data+20
 5963 20d6 7091 0000 		lds r23,mac_pib_data+21
 5964 20da 8F2D      		mov r24,r15
 5965 20dc 0E94 0000 		call disassociate_notification_frame_send
 5966               	.L361:
 5967               	/* epilogue: frame size=37 */
 5968 20e0 A596      		adiw r28,37
 5969 20e2 0FB6      		in __tmp_reg__,__SREG__
 5970 20e4 F894      		cli
 5971 20e6 DEBF      		out __SP_H__,r29
 5972 20e8 0FBE      		out __SREG__,__tmp_reg__
 5973 20ea CDBF      		out __SP_L__,r28
 5974 20ec DF91      		pop r29
 5975 20ee CF91      		pop r28
 5976 20f0 1F91      		pop r17
 5977 20f2 0F91      		pop r16
 5978 20f4 FF90      		pop r15
 5979 20f6 0895      		ret
 5980               	/* epilogue end (size=12) */
 5981               	/* function mlmeDisassociateRequest size 91 (66) */
 5988               	.Lscope49:
 5993               	.global	associate_request_frame_send
 5995               	associate_request_frame_send:
 5997               	.LM649:
 5998               	/* prologue: frame size=13 */
 5999 20f8 8F92      		push r8
 6000 20fa AF92      		push r10
 6001 20fc BF92      		push r11
 6002 20fe CF92      		push r12
 6003 2100 DF92      		push r13
 6004 2102 EF92      		push r14
 6005 2104 FF92      		push r15
 6006 2106 0F93      		push r16
 6007 2108 1F93      		push r17
 6008 210a CF93      		push r28
 6009 210c DF93      		push r29
 6010 210e CDB7      		in r28,__SP_L__
 6011 2110 DEB7      		in r29,__SP_H__
 6012 2112 2D97      		sbiw r28,13
 6013 2114 0FB6      		in __tmp_reg__,__SREG__
 6014 2116 F894      		cli
 6015 2118 DEBF      		out __SP_H__,r29
 6016 211a 0FBE      		out __SREG__,__tmp_reg__
 6017 211c CDBF      		out __SP_L__,r28
 6018               	/* prologue end (size=19) */
 6019 211e A982      		std Y+1,r10
 6020 2120 BA82      		std Y+2,r11
 6021 2122 CB82      		std Y+3,r12
 6022 2124 DC82      		std Y+4,r13
 6023 2126 ED82      		std Y+5,r14
 6024 2128 FE82      		std Y+6,r15
 6025 212a 0F83      		std Y+7,r16
 6026 212c 1887      		std Y+8,r17
 6027 212e 2987      		std Y+9,r18
 6028 2130 3A87      		std Y+10,r19
 6029 2132 4B87      		std Y+11,r20
 6030 2134 5C87      		std Y+12,r21
 6031 2136 6D87      		std Y+13,r22
 6033               	.LM650:
 6034 2138 81E0      		ldi r24,lo8(1)
 6035 213a 8093 0000 		sts mac_tx_current_frame+27,r24
 6037               	.LM651:
 6038 213e 23E0      		ldi r18,lo8(3)
 6039 2140 2093 0000 		sts mac_tx_current_frame+26,r18
 6041               	.LM652:
 6042 2144 8091 0000 		lds r24,mac_pib_data+24
 6043 2148 982F      		mov r25,r24
 6044 214a 8F5F      		subi r24,lo8(-(1))
 6045 214c 8093 0000 		sts mac_pib_data+24,r24
 6046 2150 9093 0000 		sts mac_tx_current_frame+28,r25
 6048               	.LM653:
 6049 2154 2093 0000 		sts mac_tx_current_frame+13,r18
 6051               	.LM654:
 6052 2158 60E0      		ldi r22,lo8(mac_tx_current_frame)
 6053 215a 70E0      		ldi r23,hi8(mac_tx_current_frame)
 6054 215c 8DE0      		ldi r24,lo8(13)
 6055 215e AE01      		movw r20,r28
 6056 2160 4F5F      		subi r20,lo8(-(1))
 6057 2162 5F4F      		sbci r21,hi8(-(1))
 6058 2164 DB01      		movw r26,r22
 6059 2166 FA01      		movw r30,r20
 6060 2168 0190      		ld __tmp_reg__,Z+
 6061 216a 0D92      		st X+,__tmp_reg__
 6062 216c 8A95      		dec r24
 6063 216e E1F7      		brne .-8
 6065               	.LM655:
 6066 2170 8091 0000 		lds r24,default_short_addr
 6067 2174 9091 0000 		lds r25,(default_short_addr)+1
 6068 2178 9093 0000 		sts (mac_tx_current_frame+24)+1,r25
 6069 217c 8093 0000 		sts mac_tx_current_frame+24,r24
 6071               	.LM656:
 6072 2180 FB01      		movw r30,r22
 6073 2182 3E96      		adiw r30,14
 6074 2184 88E0      		ldi r24,lo8(8)
 6075 2186 A0E0      		ldi r26,lo8(mac_pib_data+34)
 6076 2188 B0E0      		ldi r27,hi8(mac_pib_data+34)
 6077 218a 0D90      		ld __tmp_reg__,X+
 6078 218c 0192      		st Z+,__tmp_reg__
 6079 218e 8A95      		dec r24
 6080 2190 E1F7      		brne .-8
 6082               	.LM657:
 6083 2192 8092 0000 		sts mac_tx_current_frame+143,r8
 6085               	.LM658:
 6086 2196 83E2      		ldi r24,lo8(35)
 6087 2198 8093 0000 		sts mac_tx_current_frame+36,r24
 6089               	.LM659:
 6090 219c 8091 0000 		lds r24,mac_tx_current_frame
 6091 21a0 282F      		mov r18,r24
 6092 21a2 3327      		clr r19
 6093 21a4 220F      		lsl r18
 6094 21a6 331F      		rol r19
 6095 21a8 220F      		lsl r18
 6096 21aa 331F      		rol r19
 6097 21ac 8091 0000 		lds r24,mac_tx_current_frame+13
 6098 21b0 9927      		clr r25
 6099 21b2 A6E0      		ldi r26,6
 6100 21b4 880F      	1:	lsl r24
 6101 21b6 991F      		rol r25
 6102 21b8 AA95      		dec r26
 6103 21ba E1F7      		brne 1b
 6104 21bc 822B      		or r24,r18
 6105 21be 8093 0000 		sts mac_tx_current_frame+37,r24
 6107               	.LM660:
 6108 21c2 0E94 0000 		call mac_frame_send
 6109               	/* epilogue: frame size=13 */
 6110 21c6 2D96      		adiw r28,13
 6111 21c8 0FB6      		in __tmp_reg__,__SREG__
 6112 21ca F894      		cli
 6113 21cc DEBF      		out __SP_H__,r29
 6114 21ce 0FBE      		out __SREG__,__tmp_reg__
 6115 21d0 CDBF      		out __SP_L__,r28
 6116 21d2 DF91      		pop r29
 6117 21d4 CF91      		pop r28
 6118 21d6 1F91      		pop r17
 6119 21d8 0F91      		pop r16
 6120 21da FF90      		pop r15
 6121 21dc EF90      		pop r14
 6122 21de DF90      		pop r13
 6123 21e0 CF90      		pop r12
 6124 21e2 BF90      		pop r11
 6125 21e4 AF90      		pop r10
 6126 21e6 8F90      		pop r8
 6127 21e8 0895      		ret
 6128               	/* epilogue end (size=18) */
 6129               	/* function associate_request_frame_send size 121 (84) */
 6131               	.Lscope50:
 6139               	.global	mlmeAssociateRequest
 6141               	mlmeAssociateRequest:
 6143               	.LM661:
 6144               	/* prologue: frame size=21 */
 6145 21ea 6F92      		push r6
 6146 21ec 7F92      		push r7
 6147 21ee 8F92      		push r8
 6148 21f0 AF92      		push r10
 6149 21f2 BF92      		push r11
 6150 21f4 CF92      		push r12
 6151 21f6 DF92      		push r13
 6152 21f8 EF92      		push r14
 6153 21fa FF92      		push r15
 6154 21fc 0F93      		push r16
 6155 21fe 1F93      		push r17
 6156 2200 CF93      		push r28
 6157 2202 DF93      		push r29
 6158 2204 CDB7      		in r28,__SP_L__
 6159 2206 DEB7      		in r29,__SP_H__
 6160 2208 6597      		sbiw r28,21
 6161 220a 0FB6      		in __tmp_reg__,__SREG__
 6162 220c F894      		cli
 6163 220e DEBF      		out __SP_H__,r29
 6164 2210 0FBE      		out __SREG__,__tmp_reg__
 6165 2212 CDBF      		out __SP_L__,r28
 6166               	/* prologue end (size=21) */
 6167 2214 782F      		mov r23,r24
 6168 2216 3A01      		movw r6,r20
 6169 2218 C982      		std Y+1,r12
 6170 221a DA82      		std Y+2,r13
 6171 221c EB82      		std Y+3,r14
 6172 221e FC82      		std Y+4,r15
 6173 2220 0D83      		std Y+5,r16
 6174 2222 1E83      		std Y+6,r17
 6175 2224 2F83      		std Y+7,r18
 6176 2226 3887      		std Y+8,r19
 6177 2228 8A2C      		mov r8,r10
 6179               	.LM662:
 6180 222a 6987      		std Y+9,r22
 6182               	.LM663:
 6183 222c 4C8B      		std Y+20,r20
 6184 222e 5D8B      		std Y+21,r21
 6186               	.LM664:
 6187 2230 6330      		cpi r22,lo8(3)
 6188 2232 51F4      		brne .L369
 6190               	.LM665:
 6191 2234 88E0      		ldi r24,lo8(8)
 6192 2236 DE01      		movw r26,r28
 6193 2238 1196      		adiw r26,1
 6194 223a FE01      		movw r30,r28
 6195 223c 3A96      		adiw r30,10
 6196 223e 0D90      		ld __tmp_reg__,X+
 6197 2240 0192      		st Z+,__tmp_reg__
 6198 2242 8A95      		dec r24
 6199 2244 E1F7      		brne .-8
 6200 2246 06C0      		rjmp .L370
 6201               	.L369:
 6203               	.LM666:
 6204 2248 6230      		cpi r22,lo8(2)
 6205 224a 21F4      		brne .L370
 6207               	.LM667:
 6208 224c 8981      		ldd r24,Y+1
 6209 224e 9A81      		ldd r25,Y+2
 6210 2250 8A8B      		std Y+18,r24
 6211 2252 9B8B      		std Y+19,r25
 6212               	.L370:
 6214               	.LM668:
 6215 2254 672F      		mov r22,r23
 6216 2256 80E0      		ldi r24,lo8(0)
 6217 2258 0E94 0000 		call PLME_SET_request
 6219               	.LM669:
 6220 225c 82E0      		ldi r24,lo8(2)
 6221 225e 8093 0000 		sts mac_current_state,r24
 6223               	.LM670:
 6224 2262 A984      		ldd r10,Y+9
 6225 2264 BA84      		ldd r11,Y+10
 6226 2266 CB84      		ldd r12,Y+11
 6227 2268 DC84      		ldd r13,Y+12
 6228 226a ED84      		ldd r14,Y+13
 6229 226c FE84      		ldd r15,Y+14
 6230 226e 0F85      		ldd r16,Y+15
 6231 2270 1889      		ldd r17,Y+16
 6232 2272 2989      		ldd r18,Y+17
 6233 2274 3A89      		ldd r19,Y+18
 6234 2276 4B89      		ldd r20,Y+19
 6235 2278 5C89      		ldd r21,Y+20
 6236 227a 6D89      		ldd r22,Y+21
 6237 227c C301      		movw r24,r6
 6238 227e 0E94 0000 		call associate_request_frame_send
 6239               	/* epilogue: frame size=21 */
 6240 2282 6596      		adiw r28,21
 6241 2284 0FB6      		in __tmp_reg__,__SREG__
 6242 2286 F894      		cli
 6243 2288 DEBF      		out __SP_H__,r29
 6244 228a 0FBE      		out __SREG__,__tmp_reg__
 6245 228c CDBF      		out __SP_L__,r28
 6246 228e DF91      		pop r29
 6247 2290 CF91      		pop r28
 6248 2292 1F91      		pop r17
 6249 2294 0F91      		pop r16
 6250 2296 FF90      		pop r15
 6251 2298 EF90      		pop r14
 6252 229a DF90      		pop r13
 6253 229c CF90      		pop r12
 6254 229e BF90      		pop r11
 6255 22a0 AF90      		pop r10
 6256 22a2 8F90      		pop r8
 6257 22a4 7F90      		pop r7
 6258 22a6 6F90      		pop r6
 6259 22a8 0895      		ret
 6260               	/* epilogue end (size=20) */
 6261               	/* function mlmeAssociateRequest size 96 (55) */
 6266               	.Lscope51:
 6273               	.global	data_frame_send
 6275               	data_frame_send:
 6277               	.LM671:
 6278               	/* prologue: frame size=13 */
 6279 22aa 6F92      		push r6
 6280 22ac 7F92      		push r7
 6281 22ae 8F92      		push r8
 6282 22b0 9F92      		push r9
 6283 22b2 AF92      		push r10
 6284 22b4 BF92      		push r11
 6285 22b6 CF92      		push r12
 6286 22b8 DF92      		push r13
 6287 22ba EF92      		push r14
 6288 22bc FF92      		push r15
 6289 22be 0F93      		push r16
 6290 22c0 1F93      		push r17
 6291 22c2 CF93      		push r28
 6292 22c4 DF93      		push r29
 6293 22c6 CDB7      		in r28,__SP_L__
 6294 22c8 DEB7      		in r29,__SP_H__
 6295 22ca 2D97      		sbiw r28,13
 6296 22cc 0FB6      		in __tmp_reg__,__SREG__
 6297 22ce F894      		cli
 6298 22d0 DEBF      		out __SP_H__,r29
 6299 22d2 0FBE      		out __SREG__,__tmp_reg__
 6300 22d4 CDBF      		out __SP_L__,r28
 6301               	/* prologue end (size=22) */
 6302 22d6 3C01      		movw r6,r24
 6303 22d8 562F      		mov r21,r22
 6304 22da 8982      		std Y+1,r8
 6305 22dc 9A82      		std Y+2,r9
 6306 22de AB82      		std Y+3,r10
 6307 22e0 BC82      		std Y+4,r11
 6308 22e2 CD82      		std Y+5,r12
 6309 22e4 DE82      		std Y+6,r13
 6310 22e6 EF82      		std Y+7,r14
 6311 22e8 F886      		std Y+8,r15
 6312 22ea 0987      		std Y+9,r16
 6313 22ec 1A87      		std Y+10,r17
 6314 22ee 2B87      		std Y+11,r18
 6315 22f0 3C87      		std Y+12,r19
 6316 22f2 4D87      		std Y+13,r20
 6317 22f4 2BA5      		ldd r18,Y+43
 6319               	.LM672:
 6320 22f6 1092 0000 		sts mac_tx_current_frame+27,__zero_reg__
 6322               	.LM673:
 6323 22fa 81E0      		ldi r24,lo8(1)
 6324 22fc 8093 0000 		sts mac_tx_current_frame+26,r24
 6326               	.LM674:
 6327 2300 8091 0000 		lds r24,mac_pib_data+24
 6328 2304 982F      		mov r25,r24
 6329 2306 8F5F      		subi r24,lo8(-(1))
 6330 2308 8093 0000 		sts mac_pib_data+24,r24
 6331 230c 9093 0000 		sts mac_tx_current_frame+28,r25
 6333               	.LM675:
 6334 2310 8DE0      		ldi r24,lo8(13)
 6335 2312 60E0      		ldi r22,lo8(mac_tx_current_frame)
 6336 2314 70E0      		ldi r23,hi8(mac_tx_current_frame)
 6337 2316 8E01      		movw r16,r28
 6338 2318 0F5F      		subi r16,lo8(-(1))
 6339 231a 1F4F      		sbci r17,hi8(-(1))
 6340 231c DB01      		movw r26,r22
 6341 231e F801      		movw r30,r16
 6342 2320 982F      		mov r25,r24
 6343 2322 0190      		ld __tmp_reg__,Z+
 6344 2324 0D92      		st X+,__tmp_reg__
 6345 2326 9A95      		dec r25
 6346 2328 E1F7      		brne .-8
 6348               	.LM676:
 6349 232a FB01      		movw r30,r22
 6350 232c 3D96      		adiw r30,13
 6351 232e AEE1      		ldi r26,lo8(30)
 6352 2330 B0E0      		ldi r27,hi8(30)
 6353 2332 AC0F      		add r26,r28
 6354 2334 BD1F      		adc r27,r29
 6355 2336 0D90      		ld __tmp_reg__,X+
 6356 2338 0192      		st Z+,__tmp_reg__
 6357 233a 8A95      		dec r24
 6358 233c E1F7      		brne .-8
 6360               	.LM677:
 6361 233e 5093 0000 		sts mac_tx_current_frame+39,r21
 6363               	.LM678:
 6364 2342 2093 0000 		sts mac_tx_current_frame+30,r18
 6366               	.LM679:
 6367 2346 852F      		mov r24,r21
 6368 2348 9927      		clr r25
 6369 234a 0097      		sbiw r24,0
 6370 234c 51F0      		breq .L381
 6371 234e FB01      		movw r30,r22
 6372 2350 B996      		adiw r30,41
 6373 2352 9C01      		movw r18,r24
 6374               	.L377:
 6376               	.LM680:
 6377 2354 D301      		movw r26,r6
 6378 2356 8D91      		ld r24,X+
 6379 2358 3D01      		movw r6,r26
 6380 235a 8193      		st Z+,r24
 6382               	.LM681:
 6383 235c 2150      		subi r18,lo8(-(-1))
 6384 235e 3040      		sbci r19,hi8(-(-1))
 6385 2360 C9F7      		brne .L377
 6386               	.L381:
 6388               	.LM682:
 6389 2362 C980      		ldd r12,Y+1
 6390 2364 DA80      		ldd r13,Y+2
 6391 2366 EB80      		ldd r14,Y+3
 6392 2368 FC80      		ldd r15,Y+4
 6393 236a 0D81      		ldd r16,Y+5
 6394 236c 1E81      		ldd r17,Y+6
 6395 236e 2F81      		ldd r18,Y+7
 6396 2370 3885      		ldd r19,Y+8
 6397 2372 4985      		ldd r20,Y+9
 6398 2374 5A85      		ldd r21,Y+10
 6399 2376 6B85      		ldd r22,Y+11
 6400 2378 7C85      		ldd r23,Y+12
 6401 237a 8D85      		ldd r24,Y+13
 6402 237c 0E94 0000 		call Is_data_pending
 6404               	.LM683:
 6405 2380 81E0      		ldi r24,lo8(1)
 6406 2382 8093 0000 		sts mac_tx_current_frame+36,r24
 6408               	.LM684:
 6409 2386 8091 0000 		lds r24,mac_tx_current_frame
 6410 238a 282F      		mov r18,r24
 6411 238c 3327      		clr r19
 6412 238e 220F      		lsl r18
 6413 2390 331F      		rol r19
 6414 2392 220F      		lsl r18
 6415 2394 331F      		rol r19
 6416 2396 8091 0000 		lds r24,mac_tx_current_frame+13
 6417 239a 9927      		clr r25
 6418 239c 16E0      		ldi r17,6
 6419 239e 880F      	1:	lsl r24
 6420 23a0 991F      		rol r25
 6421 23a2 1A95      		dec r17
 6422 23a4 E1F7      		brne 1b
 6423 23a6 822B      		or r24,r18
 6424 23a8 8093 0000 		sts mac_tx_current_frame+37,r24
 6426               	.LM685:
 6427 23ac 0E94 0000 		call mac_frame_send
 6428               	/* epilogue: frame size=13 */
 6429 23b0 2D96      		adiw r28,13
 6430 23b2 0FB6      		in __tmp_reg__,__SREG__
 6431 23b4 F894      		cli
 6432 23b6 DEBF      		out __SP_H__,r29
 6433 23b8 0FBE      		out __SREG__,__tmp_reg__
 6434 23ba CDBF      		out __SP_L__,r28
 6435 23bc DF91      		pop r29
 6436 23be CF91      		pop r28
 6437 23c0 1F91      		pop r17
 6438 23c2 0F91      		pop r16
 6439 23c4 FF90      		pop r15
 6440 23c6 EF90      		pop r14
 6441 23c8 DF90      		pop r13
 6442 23ca CF90      		pop r12
 6443 23cc BF90      		pop r11
 6444 23ce AF90      		pop r10
 6445 23d0 9F90      		pop r9
 6446 23d2 8F90      		pop r8
 6447 23d4 7F90      		pop r7
 6448 23d6 6F90      		pop r6
 6449 23d8 0895      		ret
 6450               	/* epilogue end (size=21) */
 6451               	/* function data_frame_send size 154 (111) */
 6457               	.Lscope52:
 6460               	.global	pending_data_send
 6462               	pending_data_send:
 6464               	.LM686:
 6465               	/* prologue: frame size=13 */
 6466 23da 6F92      		push r6
 6467 23dc 7F92      		push r7
 6468 23de 8F92      		push r8
 6469 23e0 9F92      		push r9
 6470 23e2 AF92      		push r10
 6471 23e4 BF92      		push r11
 6472 23e6 CF92      		push r12
 6473 23e8 DF92      		push r13
 6474 23ea EF92      		push r14
 6475 23ec FF92      		push r15
 6476 23ee 0F93      		push r16
 6477 23f0 1F93      		push r17
 6478 23f2 CF93      		push r28
 6479 23f4 DF93      		push r29
 6480 23f6 CDB7      		in r28,__SP_L__
 6481 23f8 DEB7      		in r29,__SP_H__
 6482 23fa 2D97      		sbiw r28,13
 6483 23fc 0FB6      		in __tmp_reg__,__SREG__
 6484 23fe F894      		cli
 6485 2400 DEBF      		out __SP_H__,r29
 6486 2402 0FBE      		out __SREG__,__tmp_reg__
 6487 2404 CDBF      		out __SP_L__,r28
 6488               	/* prologue end (size=22) */
 6489 2406 C982      		std Y+1,r12
 6490 2408 DA82      		std Y+2,r13
 6491 240a EB82      		std Y+3,r14
 6492 240c FC82      		std Y+4,r15
 6493 240e 0D83      		std Y+5,r16
 6494 2410 1E83      		std Y+6,r17
 6495 2412 2F83      		std Y+7,r18
 6496 2414 3887      		std Y+8,r19
 6497 2416 4987      		std Y+9,r20
 6498 2418 5A87      		std Y+10,r21
 6499 241a 6B87      		std Y+11,r22
 6500 241c 7C87      		std Y+12,r23
 6501 241e 8D87      		std Y+13,r24
 6503               	.LM687:
 6504 2420 0E94 0000 		call get_pending_frame
 6505 2424 3C01      		movw r6,r24
 6507               	.LM688:
 6508 2426 C980      		ldd r12,Y+1
 6509 2428 DA80      		ldd r13,Y+2
 6510 242a EB80      		ldd r14,Y+3
 6511 242c FC80      		ldd r15,Y+4
 6512 242e 0D81      		ldd r16,Y+5
 6513 2430 1E81      		ldd r17,Y+6
 6514 2432 2F81      		ldd r18,Y+7
 6515 2434 3885      		ldd r19,Y+8
 6516 2436 4985      		ldd r20,Y+9
 6517 2438 5A85      		ldd r21,Y+10
 6518 243a 6B85      		ldd r22,Y+11
 6519 243c 7C85      		ldd r23,Y+12
 6520 243e 8D85      		ldd r24,Y+13
 6521 2440 0E94 0000 		call Is_data_pending
 6522 2444 8823      		tst r24
 6523 2446 09F4      		brne .+2
 6524 2448 9AC0      		rjmp .L382
 6526               	.LM689:
 6527 244a 6114      		cp r6,__zero_reg__
 6528 244c 7104      		cpc r7,__zero_reg__
 6529 244e A1F1      		breq .L385
 6530 2450 F301      		movw r30,r6
 6531 2452 668D      		ldd r22,Z+30
 6532 2454 778D      		ldd r23,Z+31
 6533 2456 4C85      		ldd r20,Y+12
 6534 2458 5D85      		ldd r21,Y+13
 6535 245a EA80      		ldd r14,Y+2
 6536 245c FB80      		ldd r15,Y+3
 6537 245e 0C81      		ldd r16,Y+4
 6538 2460 1D81      		ldd r17,Y+5
 6539 2462 BE81      		ldd r27,Y+6
 6540 2464 AF81      		ldd r26,Y+7
 6541 2466 D884      		ldd r13,Y+8
 6542 2468 C984      		ldd r12,Y+9
 6543 246a 2A85      		ldd r18,Y+10
 6544 246c 3B85      		ldd r19,Y+11
 6545               	.L389:
 6547               	.LM690:
 6548 246e 6417      		cp r22,r20
 6549 2470 7507      		cpc r23,r21
 6550 2472 F9F4      		brne .L384
 6551 2474 F301      		movw r30,r6
 6552 2476 8489      		ldd r24,Z+20
 6553 2478 8E15      		cp r24,r14
 6554 247a A9F4      		brne .L388
 6555 247c 8589      		ldd r24,Z+21
 6556 247e 8F15      		cp r24,r15
 6557 2480 91F4      		brne .L388
 6558 2482 8689      		ldd r24,Z+22
 6559 2484 8017      		cp r24,r16
 6560 2486 79F4      		brne .L388
 6561 2488 8789      		ldd r24,Z+23
 6562 248a 8117      		cp r24,r17
 6563 248c 61F4      		brne .L388
 6564 248e 808D      		ldd r24,Z+24
 6565 2490 8B17      		cp r24,r27
 6566 2492 49F4      		brne .L388
 6567 2494 818D      		ldd r24,Z+25
 6568 2496 8A17      		cp r24,r26
 6569 2498 31F4      		brne .L388
 6570 249a 828D      		ldd r24,Z+26
 6571 249c 8D15      		cp r24,r13
 6572 249e 19F4      		brne .L388
 6573 24a0 838D      		ldd r24,Z+27
 6574 24a2 8C15      		cp r24,r12
 6575 24a4 49F0      		breq .L385
 6576               	.L388:
 6577 24a6 F301      		movw r30,r6
 6578 24a8 848D      		ldd r24,Z+28
 6579 24aa 958D      		ldd r25,Z+29
 6580 24ac 8217      		cp r24,r18
 6581 24ae 9307      		cpc r25,r19
 6582 24b0 19F0      		breq .L385
 6583               	.L384:
 6585               	.LM691:
 6586 24b2 6114      		cp r6,__zero_reg__
 6587 24b4 7104      		cpc r7,__zero_reg__
 6588 24b6 D9F6      		brne .L389
 6589               	.L385:
 6591               	.LM692:
 6592 24b8 F301      		movw r30,r6
 6593 24ba 8481      		ldd r24,Z+4
 6594 24bc 9927      		clr r25
 6595 24be 8770      		andi r24,lo8(7)
 6596 24c0 9070      		andi r25,hi8(7)
 6597 24c2 0197      		sbiw r24,1
 6598 24c4 B9F5      		brne .L390
 6600               	.LM693:
 6601 24c6 8381      		ldd r24,Z+3
 6602 24c8 8F93      		push r24
 6603 24ca 8DB7      		in r24,__SP_L__
 6604 24cc 9EB7      		in r25,__SP_H__
 6605 24ce 0D97      		sbiw r24,13
 6606 24d0 0FB6      		in __tmp_reg__,__SREG__
 6607 24d2 F894      		cli
 6608 24d4 9EBF      		out __SP_H__,r25
 6609 24d6 0FBE      		out __SREG__,__tmp_reg__
 6610 24d8 8DBF      		out __SP_L__,r24
 6611 24da EDB7      		in r30,__SP_L__
 6612 24dc FEB7      		in r31,__SP_H__
 6613 24de 3196      		adiw r30,1
 6614 24e0 A0E2      		ldi r26,lo8(32)
 6615 24e2 B0E0      		ldi r27,hi8(32)
 6616 24e4 6A0E      		add r6,r26
 6617 24e6 7B1E      		adc r7,r27
 6618 24e8 8DE0      		ldi r24,lo8(13)
 6619 24ea D301      		movw r26,r6
 6620 24ec 0D90      		ld __tmp_reg__,X+
 6621 24ee 0192      		st Z+,__tmp_reg__
 6622 24f0 8A95      		dec r24
 6623 24f2 E1F7      		brne .-8
 6624 24f4 E0EE      		ldi r30,lo8(-32)
 6625 24f6 FFEF      		ldi r31,hi8(-32)
 6626 24f8 6E0E      		add r6,r30
 6627 24fa 7F1E      		adc r7,r31
 6628 24fc F301      		movw r30,r6
 6629 24fe 8388      		ldd r8,Z+19
 6630 2500 9488      		ldd r9,Z+20
 6631 2502 A588      		ldd r10,Z+21
 6632 2504 B688      		ldd r11,Z+22
 6633 2506 C788      		ldd r12,Z+23
 6634 2508 D08C      		ldd r13,Z+24
 6635 250a E18C      		ldd r14,Z+25
 6636 250c F28C      		ldd r15,Z+26
 6637 250e 038D      		ldd r16,Z+27
 6638 2510 148D      		ldd r17,Z+28
 6639 2512 258D      		ldd r18,Z+29
 6640 2514 368D      		ldd r19,Z+30
 6641 2516 478D      		ldd r20,Z+31
 6642 2518 65A5      		ldd r22,Z+45
 6643 251a 86A5      		ldd r24,Z+46
 6644 251c 97A5      		ldd r25,Z+47
 6645 251e 0E94 0000 		call data_frame_send
 6646 2522 8DB7      		in r24,__SP_L__
 6647 2524 9EB7      		in r25,__SP_H__
 6648 2526 0E96      		adiw r24,14
 6649 2528 0FB6      		in __tmp_reg__,__SREG__
 6650 252a F894      		cli
 6651 252c 9EBF      		out __SP_H__,r25
 6652 252e 0FBE      		out __SREG__,__tmp_reg__
 6653 2530 8DBF      		out __SP_L__,r24
 6654 2532 22C0      		rjmp .L391
 6655               	.L390:
 6657               	.LM694:
 6658 2534 F301      		movw r30,r6
 6659 2536 8781      		ldd r24,Z+7
 6660 2538 8823      		tst r24
 6661 253a 91F0      		breq .L392
 6663               	.LM695:
 6664 253c C084      		ldd r12,Z+8
 6665 253e D184      		ldd r13,Z+9
 6666 2540 E384      		ldd r14,Z+11
 6667 2542 F484      		ldd r15,Z+12
 6668 2544 0585      		ldd r16,Z+13
 6669 2546 1685      		ldd r17,Z+14
 6670 2548 2785      		ldd r18,Z+15
 6671 254a 3089      		ldd r19,Z+16
 6672 254c 4189      		ldd r20,Z+17
 6673 254e 5289      		ldd r21,Z+18
 6674 2550 6285      		ldd r22,Z+10
 6675 2552 8091 0000 		lds r24,mac_pib_data+22
 6676 2556 9091 0000 		lds r25,(mac_pib_data+22)+1
 6677 255a 0E94 0000 		call associate_response_frame_send
 6678 255e 0CC0      		rjmp .L391
 6679               	.L392:
 6681               	.LM696:
 6682 2560 F301      		movw r30,r6
 6683 2562 0385      		ldd r16,Z+11
 6684 2564 1485      		ldd r17,Z+12
 6685 2566 2585      		ldd r18,Z+13
 6686 2568 3685      		ldd r19,Z+14
 6687 256a 4785      		ldd r20,Z+15
 6688 256c 5089      		ldd r21,Z+16
 6689 256e 6189      		ldd r22,Z+17
 6690 2570 7289      		ldd r23,Z+18
 6691 2572 8285      		ldd r24,Z+10
 6692 2574 0E94 0000 		call disassociate_notification_frame_send
 6693               	.L391:
 6695               	.LM697:
 6696 2578 C301      		movw r24,r6
 6697 257a 0E94 0000 		call remove_pending_queue
 6698               	.L382:
 6699               	/* epilogue: frame size=13 */
 6700 257e 2D96      		adiw r28,13
 6701 2580 0FB6      		in __tmp_reg__,__SREG__
 6702 2582 F894      		cli
 6703 2584 DEBF      		out __SP_H__,r29
 6704 2586 0FBE      		out __SREG__,__tmp_reg__
 6705 2588 CDBF      		out __SP_L__,r28
 6706 258a DF91      		pop r29
 6707 258c CF91      		pop r28
 6708 258e 1F91      		pop r17
 6709 2590 0F91      		pop r16
 6710 2592 FF90      		pop r15
 6711 2594 EF90      		pop r14
 6712 2596 DF90      		pop r13
 6713 2598 CF90      		pop r12
 6714 259a BF90      		pop r11
 6715 259c AF90      		pop r10
 6716 259e 9F90      		pop r9
 6717 25a0 8F90      		pop r8
 6718 25a2 7F90      		pop r7
 6719 25a4 6F90      		pop r6
 6720 25a6 0895      		ret
 6721               	/* epilogue end (size=21) */
 6722               	/* function pending_data_send size 232 (189) */
 6727               	.Lscope53:
 6735               	.global	mcpsDataRequest
 6737               	mcpsDataRequest:
 6739               	.LM698:
 6740               	/* prologue: frame size=16 */
 6741 25a8 6F92      		push r6
 6742 25aa 7F92      		push r7
 6743 25ac 8F92      		push r8
 6744 25ae 9F92      		push r9
 6745 25b0 AF92      		push r10
 6746 25b2 BF92      		push r11
 6747 25b4 CF92      		push r12
 6748 25b6 DF92      		push r13
 6749 25b8 EF92      		push r14
 6750 25ba FF92      		push r15
 6751 25bc 0F93      		push r16
 6752 25be 1F93      		push r17
 6753 25c0 CF93      		push r28
 6754 25c2 DF93      		push r29
 6755 25c4 CDB7      		in r28,__SP_L__
 6756 25c6 DEB7      		in r29,__SP_H__
 6757 25c8 6097      		sbiw r28,16
 6758 25ca 0FB6      		in __tmp_reg__,__SREG__
 6759 25cc F894      		cli
 6760 25ce DEBF      		out __SP_H__,r29
 6761 25d0 0FBE      		out __SREG__,__tmp_reg__
 6762 25d2 CDBF      		out __SP_L__,r28
 6763               	/* prologue end (size=22) */
 6764 25d4 C982      		std Y+1,r12
 6765 25d6 DA82      		std Y+2,r13
 6766 25d8 EB82      		std Y+3,r14
 6767 25da FC82      		std Y+4,r15
 6768 25dc 0D83      		std Y+5,r16
 6769 25de 1E83      		std Y+6,r17
 6770 25e0 2F83      		std Y+7,r18
 6771 25e2 3887      		std Y+8,r19
 6772 25e4 4987      		std Y+9,r20
 6773 25e6 5A87      		std Y+10,r21
 6774 25e8 6B87      		std Y+11,r22
 6775 25ea 7C87      		std Y+12,r23
 6776 25ec 8D87      		std Y+13,r24
 6777 25ee 6EA5      		ldd r22,Y+46
 6778 25f0 6FA4      		ldd r6,Y+47
 6779 25f2 78A8      		ldd r7,Y+48
 6780 25f4 79A9      		ldd r23,Y+49
 6781 25f6 8AA9      		ldd r24,Y+50
 6783               	.LM699:
 6784 25f8 282F      		mov r18,r24
 6785 25fa 3327      		clr r19
 6786 25fc C901      		movw r24,r18
 6787 25fe 9695      		lsr r25
 6788 2600 8795      		ror r24
 6789 2602 9695      		lsr r25
 6790 2604 8795      		ror r24
 6791 2606 41E0      		ldi r20,lo8(1)
 6792 2608 50E0      		ldi r21,hi8(1)
 6793 260a 8423      		and r24,r20
 6794 260c 9523      		and r25,r21
 6795 260e 8417      		cp r24,r20
 6796 2610 9507      		cpc r25,r21
 6797 2612 79F1      		breq .L397
 6799               	.LM700:
 6800 2614 7F93      		push r23
 6801 2616 2DB7      		in r18,__SP_L__
 6802 2618 3EB7      		in r19,__SP_H__
 6803 261a 2D50      		subi r18,lo8(-(-13))
 6804 261c 3040      		sbci r19,hi8(-(-13))
 6805 261e 0FB6      		in __tmp_reg__,__SREG__
 6806 2620 F894      		cli
 6807 2622 3EBF      		out __SP_H__,r19
 6808 2624 0FBE      		out __SREG__,__tmp_reg__
 6809 2626 2DBF      		out __SP_L__,r18
 6810 2628 EDB7      		in r30,__SP_L__
 6811 262a FEB7      		in r31,__SP_H__
 6812 262c E40F      		add r30,r20
 6813 262e F51F      		adc r31,r21
 6814 2630 8DE0      		ldi r24,lo8(13)
 6815 2632 A1E2      		ldi r26,lo8(33)
 6816 2634 B0E0      		ldi r27,hi8(33)
 6817 2636 AC0F      		add r26,r28
 6818 2638 BD1F      		adc r27,r29
 6819 263a 0D90      		ld __tmp_reg__,X+
 6820 263c 0192      		st Z+,__tmp_reg__
 6821 263e 8A95      		dec r24
 6822 2640 E1F7      		brne .-8
 6823 2642 8980      		ldd r8,Y+1
 6824 2644 9A80      		ldd r9,Y+2
 6825 2646 AB80      		ldd r10,Y+3
 6826 2648 BC80      		ldd r11,Y+4
 6827 264a CD80      		ldd r12,Y+5
 6828 264c DE80      		ldd r13,Y+6
 6829 264e EF80      		ldd r14,Y+7
 6830 2650 F884      		ldd r15,Y+8
 6831 2652 0985      		ldd r16,Y+9
 6832 2654 1A85      		ldd r17,Y+10
 6833 2656 2B85      		ldd r18,Y+11
 6834 2658 3C85      		ldd r19,Y+12
 6835 265a 4D85      		ldd r20,Y+13
 6836 265c C301      		movw r24,r6
 6837 265e 0E94 0000 		call data_frame_send
 6839               	.LM701:
 6840 2662 80E1      		ldi r24,lo8(16)
 6841 2664 8093 0000 		sts mac_current_state,r24
 6842 2668 2DB7      		in r18,__SP_L__
 6843 266a 3EB7      		in r19,__SP_H__
 6844 266c 225F      		subi r18,lo8(-(14))
 6845 266e 3F4F      		sbci r19,hi8(-(14))
 6846 2670 6AC0      		rjmp .L407
 6847               	.L397:
 6849               	.LM702:
 6850 2672 9981      		ldd r25,Y+1
 6851 2674 9230      		cpi r25,lo8(2)
 6852 2676 08F4      		brsh .+2
 6853 2678 6FC0      		rjmp .L399
 6855               	.LM703:
 6856 267a 2170      		andi r18,lo8(1)
 6857 267c 3070      		andi r19,hi8(1)
 6858 267e 2417      		cp r18,r20
 6859 2680 3507      		cpc r19,r21
 6860 2682 11F0      		breq .L400
 6862               	.LM704:
 6863 2684 81E0      		ldi r24,lo8(1)
 6864 2686 01C0      		rjmp .L405
 6865               	.L400:
 6867               	.LM705:
 6868 2688 81E2      		ldi r24,lo8(33)
 6869               	.L405:
 6870 268a 8E87      		std Y+14,r24
 6872               	.LM706:
 6873 268c 892F      		mov r24,r25
 6874 268e 9927      		clr r25
 6875 2690 880F      		lsl r24
 6876 2692 991F      		rol r25
 6877 2694 880F      		lsl r24
 6878 2696 991F      		rol r25
 6879 2698 29A1      		ldd r18,Y+33
 6880 269a 2295      		swap r18
 6881 269c 220F      		lsl r18
 6882 269e 220F      		lsl r18
 6883 26a0 207C      		andi r18,0xc0
 6884 26a2 2823      		and r18,r24
 6885 26a4 2F87      		std Y+15,r18
 6887               	.LM707:
 6888 26a6 8091 0000 		lds r24,current_pending_num
 6889 26aa 8330      		cpi r24,lo8(3)
 6890 26ac 08F0      		brlo .+2
 6891 26ae 51C0      		rjmp .L402
 6893               	.LM708:
 6894 26b0 8091 0000 		lds r24,default_short_addr
 6895 26b4 9091 0000 		lds r25,(default_short_addr)+1
 6896 26b8 9F93      		push r25
 6897 26ba 8F93      		push r24
 6898 26bc 8DB7      		in r24,__SP_L__
 6899 26be 9EB7      		in r25,__SP_H__
 6900 26c0 0897      		sbiw r24,8
 6901 26c2 0FB6      		in __tmp_reg__,__SREG__
 6902 26c4 F894      		cli
 6903 26c6 9EBF      		out __SP_H__,r25
 6904 26c8 0FBE      		out __SREG__,__tmp_reg__
 6905 26ca 8DBF      		out __SP_L__,r24
 6906 26cc ADB7      		in r26,__SP_L__
 6907 26ce BEB7      		in r27,__SP_H__
 6908 26d0 1196      		adiw r26,1
 6909 26d2 88E0      		ldi r24,lo8(8)
 6910 26d4 E0E0      		ldi r30,lo8(default_long_addr)
 6911 26d6 F0E0      		ldi r31,hi8(default_long_addr)
 6912 26d8 0190      		ld __tmp_reg__,Z+
 6913 26da 0D92      		st X+,__tmp_reg__
 6914 26dc 8A95      		dec r24
 6915 26de E1F7      		brne .-8
 6916 26e0 1F92      		push __zero_reg__
 6917 26e2 1F92      		push __zero_reg__
 6918 26e4 7F92      		push r7
 6919 26e6 6F92      		push r6
 6920 26e8 6F93      		push r22
 6921 26ea ADB7      		in r26,__SP_L__
 6922 26ec BEB7      		in r27,__SP_H__
 6923 26ee 1D97      		sbiw r26,13
 6924 26f0 0FB6      		in __tmp_reg__,__SREG__
 6925 26f2 F894      		cli
 6926 26f4 BEBF      		out __SP_H__,r27
 6927 26f6 0FBE      		out __SREG__,__tmp_reg__
 6928 26f8 ADBF      		out __SP_L__,r26
 6929 26fa EDB7      		in r30,__SP_L__
 6930 26fc FEB7      		in r31,__SP_H__
 6931 26fe 3196      		adiw r30,1
 6932 2700 8DE0      		ldi r24,lo8(13)
 6933 2702 A1E2      		ldi r26,lo8(33)
 6934 2704 B0E0      		ldi r27,hi8(33)
 6935 2706 AC0F      		add r26,r28
 6936 2708 BD1F      		adc r27,r29
 6937 270a 282F      		mov r18,r24
 6938 270c 0D90      		ld __tmp_reg__,X+
 6939 270e 0192      		st Z+,__tmp_reg__
 6940 2710 2A95      		dec r18
 6941 2712 E1F7      		brne .-8
 6942 2714 ADB7      		in r26,__SP_L__
 6943 2716 BEB7      		in r27,__SP_H__
 6944 2718 1D97      		sbiw r26,13
 6945 271a 0FB6      		in __tmp_reg__,__SREG__
 6946 271c F894      		cli
 6947 271e BEBF      		out __SP_H__,r27
 6948 2720 0FBE      		out __SREG__,__tmp_reg__
 6949 2722 ADBF      		out __SP_L__,r26
 6950 2724 1196      		adiw r26,1
 6951 2726 FE01      		movw r30,r28
 6952 2728 3196      		adiw r30,1
 6953 272a 0190      		ld __tmp_reg__,Z+
 6954 272c 0D92      		st X+,__tmp_reg__
 6955 272e 8A95      		dec r24
 6956 2730 E1F7      		brne .-8
 6957 2732 4E85      		ldd r20,Y+14
 6958 2734 5F85      		ldd r21,Y+15
 6959 2736 6889      		ldd r22,Y+16
 6960 2738 872F      		mov r24,r23
 6961 273a 0E94 0000 		call add_pending_queue
 6962 273e 2DB7      		in r18,__SP_L__
 6963 2740 3EB7      		in r19,__SP_H__
 6964 2742 275D      		subi r18,lo8(-(41))
 6965 2744 3F4F      		sbci r19,hi8(-(41))
 6966               	.L407:
 6967 2746 0FB6      		in __tmp_reg__,__SREG__
 6968 2748 F894      		cli
 6969 274a 3EBF      		out __SP_H__,r19
 6970 274c 0FBE      		out __SREG__,__tmp_reg__
 6971 274e 2DBF      		out __SP_L__,r18
 6972 2750 07C0      		rjmp .L396
 6973               	.L402:
 6975               	.LM709:
 6976 2752 672F      		mov r22,r23
 6977 2754 81EF      		ldi r24,lo8(-15)
 6978 2756 02C0      		rjmp .L406
 6979               	.L399:
 6981               	.LM710:
 6982 2758 672F      		mov r22,r23
 6983 275a 88EE      		ldi r24,lo8(-24)
 6984               	.L406:
 6985 275c 0E94 0000 		call mcpsDataConfirm
 6986               	.L396:
 6987               	/* epilogue: frame size=16 */
 6988 2760 6096      		adiw r28,16
 6989 2762 0FB6      		in __tmp_reg__,__SREG__
 6990 2764 F894      		cli
 6991 2766 DEBF      		out __SP_H__,r29
 6992 2768 0FBE      		out __SREG__,__tmp_reg__
 6993 276a CDBF      		out __SP_L__,r28
 6994 276c DF91      		pop r29
 6995 276e CF91      		pop r28
 6996 2770 1F91      		pop r17
 6997 2772 0F91      		pop r16
 6998 2774 FF90      		pop r15
 6999 2776 EF90      		pop r14
 7000 2778 DF90      		pop r13
 7001 277a CF90      		pop r12
 7002 277c BF90      		pop r11
 7003 277e AF90      		pop r10
 7004 2780 9F90      		pop r9
 7005 2782 8F90      		pop r8
 7006 2784 7F90      		pop r7
 7007 2786 6F90      		pop r6
 7008 2788 0895      		ret
 7009               	/* epilogue end (size=21) */
 7010               	/* function mcpsDataRequest size 241 (198) */
 7019               	.Lscope54:
 7021               	.global	data_request_frame_send
 7023               	data_request_frame_send:
 7025               	.LM711:
 7026               	/* prologue: frame size=0 */
 7027               	/* prologue end (size=0) */
 7029               	.LM712:
 7030 278a 84E0      		ldi r24,lo8(4)
 7031 278c 8093 0000 		sts mac_tx_current_frame+27,r24
 7033               	.LM713:
 7034 2790 83E0      		ldi r24,lo8(3)
 7035 2792 8093 0000 		sts mac_tx_current_frame+26,r24
 7037               	.LM714:
 7038 2796 8091 0000 		lds r24,mac_pib_data+24
 7039 279a 982F      		mov r25,r24
 7040 279c 8F5F      		subi r24,lo8(-(1))
 7041 279e 8093 0000 		sts mac_pib_data+24,r24
 7042 27a2 9093 0000 		sts mac_tx_current_frame+28,r25
 7044               	.LM715:
 7045 27a6 2091 0000 		lds r18,mac_pib_data+28
 7046 27aa 3091 0000 		lds r19,(mac_pib_data+28)+1
 7047 27ae 3093 0000 		sts (mac_tx_current_frame+24)+1,r19
 7048 27b2 2093 0000 		sts mac_tx_current_frame+24,r18
 7050               	.LM716:
 7051 27b6 8091 0000 		lds r24,mac_current_state
 7052 27ba 8330      		cpi r24,lo8(3)
 7053 27bc 19F4      		brne .L409
 7055               	.LM717:
 7056 27be 1092 0000 		sts mac_tx_current_frame,__zero_reg__
 7057 27c2 0FC0      		rjmp .L410
 7058               	.L409:
 7060               	.LM718:
 7061 27c4 82E0      		ldi r24,lo8(2)
 7062 27c6 8093 0000 		sts mac_tx_current_frame,r24
 7064               	.LM719:
 7065 27ca 8091 0000 		lds r24,mac_pib_data+22
 7066 27ce 9091 0000 		lds r25,(mac_pib_data+22)+1
 7067 27d2 9093 0000 		sts (mac_tx_current_frame+9)+1,r25
 7068 27d6 8093 0000 		sts mac_tx_current_frame+9,r24
 7070               	.LM720:
 7071 27da 3093 0000 		sts (mac_tx_current_frame+11)+1,r19
 7072 27de 2093 0000 		sts mac_tx_current_frame+11,r18
 7073               	.L410:
 7075               	.LM721:
 7076 27e2 2091 0000 		lds r18,mac_pib_data+32
 7077 27e6 3091 0000 		lds r19,(mac_pib_data+32)+1
 7078 27ea 8091 0000 		lds r24,default_short_addr
 7079 27ee 9091 0000 		lds r25,(default_short_addr)+1
 7080 27f2 2817      		cp r18,r24
 7081 27f4 3907      		cpc r19,r25
 7082 27f6 39F0      		breq .L412
 7083 27f8 8091 0000 		lds r24,no_short_addr
 7084 27fc 9091 0000 		lds r25,(no_short_addr)+1
 7085 2800 2817      		cp r18,r24
 7086 2802 3907      		cpc r19,r25
 7087 2804 69F4      		brne .L411
 7088               	.L412:
 7090               	.LM722:
 7091 2806 83E0      		ldi r24,lo8(3)
 7092 2808 8093 0000 		sts mac_tx_current_frame+13,r24
 7094               	.LM723:
 7095 280c 88E0      		ldi r24,lo8(8)
 7096 280e A0E0      		ldi r26,lo8(mac_pib_data+34)
 7097 2810 B0E0      		ldi r27,hi8(mac_pib_data+34)
 7098 2812 E0E0      		ldi r30,lo8(mac_tx_current_frame+14)
 7099 2814 F0E0      		ldi r31,hi8(mac_tx_current_frame+14)
 7100 2816 0D90      		ld __tmp_reg__,X+
 7101 2818 0192      		st Z+,__tmp_reg__
 7102 281a 8A95      		dec r24
 7103 281c E1F7      		brne .-8
 7104 281e 07C0      		rjmp .L413
 7105               	.L411:
 7107               	.LM724:
 7108 2820 82E0      		ldi r24,lo8(2)
 7109 2822 8093 0000 		sts mac_tx_current_frame+13,r24
 7111               	.LM725:
 7112 2826 3093 0000 		sts (mac_tx_current_frame+22)+1,r19
 7113 282a 2093 0000 		sts mac_tx_current_frame+22,r18
 7114               	.L413:
 7116               	.LM726:
 7117 282e 83E2      		ldi r24,lo8(35)
 7118 2830 8093 0000 		sts mac_tx_current_frame+36,r24
 7120               	.LM727:
 7121 2834 8091 0000 		lds r24,mac_tx_current_frame
 7122 2838 282F      		mov r18,r24
 7123 283a 3327      		clr r19
 7124 283c 220F      		lsl r18
 7125 283e 331F      		rol r19
 7126 2840 220F      		lsl r18
 7127 2842 331F      		rol r19
 7128 2844 8091 0000 		lds r24,mac_tx_current_frame+13
 7129 2848 9927      		clr r25
 7130 284a 56E0      		ldi r21,6
 7131 284c 880F      	1:	lsl r24
 7132 284e 991F      		rol r25
 7133 2850 5A95      		dec r21
 7134 2852 E1F7      		brne 1b
 7135 2854 822B      		or r24,r18
 7136 2856 8093 0000 		sts mac_tx_current_frame+37,r24
 7138               	.LM728:
 7139 285a 0E94 0000 		call mac_frame_send
 7140               	/* epilogue: frame size=0 */
 7141 285e 0895      		ret
 7142               	/* epilogue end (size=1) */
 7143               	/* function data_request_frame_send size 107 (106) */
 7145               	.Lscope55:
 7148               	.global	mlmeBeaconNotifyIndication
 7150               	mlmeBeaconNotifyIndication:
 7152               	.LM729:
 7153               	/* prologue: frame size=0 */
 7154 2860 1F93      		push r17
 7155 2862 CF93      		push r28
 7156 2864 DF93      		push r29
 7157 2866 CDB7      		in r28,__SP_L__
 7158 2868 DEB7      		in r29,__SP_H__
 7159               	/* prologue end (size=5) */
 7161               	.LM730:
 7162 286a 60E0      		ldi r22,lo8(0)
 7164               	.LM731:
 7165 286c 8091 0000 		lds r24,mac_current_state
 7166 2870 8730      		cpi r24,lo8(7)
 7167 2872 09F0      		breq .+2
 7168 2874 55C0      		rjmp .L415
 7170               	.LM732:
 7171 2876 81E0      		ldi r24,lo8(1)
 7172 2878 8093 0000 		sts scan_result_info+1,r24
 7174               	.LM733:
 7175 287c 6093 0000 		sts scan_result_info,r22
 7177               	.LM734:
 7178 2880 2091 0000 		lds r18,scan_result_info+6
 7179 2884 2630      		cpi r18,lo8(6)
 7180 2886 98F1      		brlo .L416
 7182               	.LM735:
 7183 2888 43E0      		ldi r20,lo8(3)
 7184 288a 8091 0000 		lds r24,head_of_timer_queue
 7185 288e 9091 0000 		lds r25,(head_of_timer_queue)+1
 7186 2892 0E94 0000 		call timer3quere_cancel
 7187 2896 9093 0000 		sts (head_of_timer_queue)+1,r25
 7188 289a 8093 0000 		sts head_of_timer_queue,r24
 7190               	.LM736:
 7191 289e 8DB7      		in r24,__SP_L__
 7192 28a0 9EB7      		in r25,__SP_H__
 7193 28a2 8458      		subi r24,lo8(-(-132))
 7194 28a4 9040      		sbci r25,hi8(-(-132))
 7195 28a6 0FB6      		in __tmp_reg__,__SREG__
 7196 28a8 F894      		cli
 7197 28aa 9EBF      		out __SP_H__,r25
 7198 28ac 0FBE      		out __SREG__,__tmp_reg__
 7199 28ae 8DBF      		out __SP_L__,r24
 7200 28b0 ADB7      		in r26,__SP_L__
 7201 28b2 BEB7      		in r27,__SP_H__
 7202 28b4 1196      		adiw r26,1
 7203 28b6 84E8      		ldi r24,lo8(-124)
 7204 28b8 E0E0      		ldi r30,lo8(scan_result_info)
 7205 28ba F0E0      		ldi r31,hi8(scan_result_info)
 7206 28bc 0190      		ld __tmp_reg__,Z+
 7207 28be 0D92      		st X+,__tmp_reg__
 7208 28c0 8A95      		dec r24
 7209 28c2 E1F7      		brne .-8
 7210 28c4 0E94 0000 		call mlmeScanConfirm
 7212               	.LM737:
 7213 28c8 8AE0      		ldi r24,lo8(10)
 7214 28ca 8093 0000 		sts mac_current_state,r24
 7216               	.LM738:
 7217 28ce 8DB7      		in r24,__SP_L__
 7218 28d0 9EB7      		in r25,__SP_H__
 7219 28d2 8C57      		subi r24,lo8(-(132))
 7220 28d4 9F4F      		sbci r25,hi8(-(132))
 7221 28d6 0FB6      		in __tmp_reg__,__SREG__
 7222 28d8 F894      		cli
 7223 28da 9EBF      		out __SP_H__,r25
 7224 28dc 0FBE      		out __SREG__,__tmp_reg__
 7225 28de 8DBF      		out __SP_L__,r24
 7226 28e0 88E0      		ldi r24,lo8(8)
 7227 28e2 0E94 0000 		call PLME_SET_TRX_STATE_request
 7229               	.LM739:
 7230 28e6 85E0      		ldi r24,lo8(5)
 7231 28e8 8093 0000 		sts phy_channel_state,r24
 7232 28ec 64C0      		rjmp .L414
 7233               	.L416:
 7235               	.LM740:
 7236 28ee 3327      		clr r19
 7237 28f0 89E1      		ldi r24,lo8(25)
 7238 28f2 90E0      		ldi r25,hi8(25)
 7239 28f4 289F      		mul r18,r24
 7240 28f6 F001      		movw r30,r0
 7241 28f8 299F      		mul r18,r25
 7242 28fa F00D      		add r31,r0
 7243 28fc 389F      		mul r19,r24
 7244 28fe F00D      		add r31,r0
 7245 2900 1124      		clr r1
 7246 2902 E050      		subi r30,lo8(-(scan_result_info+7))
 7247 2904 F040      		sbci r31,hi8(-(scan_result_info+7))
 7248 2906 89E1      		ldi r24,lo8(25)
 7249 2908 DE01      		movw r26,r28
 7250 290a 1796      		adiw r26,7
 7251 290c 0D90      		ld __tmp_reg__,X+
 7252 290e 0192      		st Z+,__tmp_reg__
 7253 2910 8A95      		dec r24
 7254 2912 E1F7      		brne .-8
 7256               	.LM741:
 7257 2914 8091 0000 		lds r24,scan_result_info+6
 7258 2918 8F5F      		subi r24,lo8(-(1))
 7259 291a 8093 0000 		sts scan_result_info+6,r24
 7260 291e 4BC0      		rjmp .L414
 7261               	.L415:
 7263               	.LM742:
 7264 2920 89A1      		ldd r24,Y+33
 7265 2922 6817      		cp r22,r24
 7266 2924 78F4      		brsh .L431
 7267 2926 4091 0000 		lds r20,mac_pib_data+32
 7268 292a 5091 0000 		lds r21,(mac_pib_data+32)+1
 7269 292e 282F      		mov r18,r24
 7270 2930 FE01      		movw r30,r28
 7271 2932 B396      		adiw r30,35
 7272               	.L423:
 7274               	.LM743:
 7275 2934 8191      		ld r24,Z+
 7276 2936 9191      		ld r25,Z+
 7277 2938 8417      		cp r24,r20
 7278 293a 9507      		cpc r25,r21
 7279 293c 09F4      		brne .L421
 7281               	.LM744:
 7282 293e 61E0      		ldi r22,lo8(1)
 7283               	.L421:
 7285               	.LM745:
 7286 2940 2150      		subi r18,lo8(-(-1))
 7287 2942 C1F7      		brne .L423
 7288               	.L431:
 7290               	.LM746:
 7291 2944 8AA1      		ldd r24,Y+34
 7292 2946 8823      		tst r24
 7293 2948 91F1      		breq .L433
 7294 294a 1091 0000 		lds r17,mac_pib_data+34
 7295 294e B091 0000 		lds r27,mac_pib_data+35
 7296 2952 A091 0000 		lds r26,mac_pib_data+36
 7297 2956 7091 0000 		lds r23,mac_pib_data+37
 7298 295a 5091 0000 		lds r21,mac_pib_data+38
 7299 295e 4091 0000 		lds r20,mac_pib_data+39
 7300 2962 3091 0000 		lds r19,mac_pib_data+40
 7301 2966 9091 0000 		lds r25,mac_pib_data+41
 7302 296a E6E0      		ldi r30,lo8(6)
 7303 296c F0E0      		ldi r31,hi8(6)
 7304 296e EC0F      		add r30,r28
 7305 2970 FD1F      		adc r31,r29
 7306 2972 282F      		mov r18,r24
 7307               	.L428:
 7309               	.LM747:
 7310 2974 81A1      		ldd r24,Z+33
 7311 2976 8117      		cp r24,r17
 7312 2978 B1F4      		brne .L426
 7313 297a 82A1      		ldd r24,Z+34
 7314 297c 8B17      		cp r24,r27
 7315 297e 99F4      		brne .L426
 7316 2980 83A1      		ldd r24,Z+35
 7317 2982 8A17      		cp r24,r26
 7318 2984 81F4      		brne .L426
 7319 2986 84A1      		ldd r24,Z+36
 7320 2988 8717      		cp r24,r23
 7321 298a 69F4      		brne .L426
 7322 298c 85A1      		ldd r24,Z+37
 7323 298e 8517      		cp r24,r21
 7324 2990 51F4      		brne .L426
 7325 2992 86A1      		ldd r24,Z+38
 7326 2994 8417      		cp r24,r20
 7327 2996 39F4      		brne .L426
 7328 2998 87A1      		ldd r24,Z+39
 7329 299a 8317      		cp r24,r19
 7330 299c 21F4      		brne .L426
 7331 299e 80A5      		ldd r24,Z+40
 7332 29a0 8917      		cp r24,r25
 7333 29a2 09F4      		brne .L426
 7335               	.LM748:
 7336 29a4 61E0      		ldi r22,lo8(1)
 7337               	.L426:
 7339               	.LM749:
 7340 29a6 2150      		subi r18,lo8(-(-1))
 7341 29a8 3896      		adiw r30,8
 7342 29aa 2223      		tst r18
 7343 29ac 19F7      		brne .L428
 7344               	.L433:
 7346               	.LM750:
 7347 29ae 6623      		tst r22
 7348 29b0 11F0      		breq .L414
 7350               	.LM751:
 7351 29b2 0E94 0000 		call data_request_frame_send
 7352               	.L414:
 7353               	/* epilogue: frame size=0 */
 7354 29b6 DF91      		pop r29
 7355 29b8 CF91      		pop r28
 7356 29ba 1F91      		pop r17
 7357 29bc 0895      		ret
 7358               	/* epilogue end (size=4) */
 7359               	/* function mlmeBeaconNotifyIndication size 176 (167) */
 7365               	.Lscope56:
 7366               		.data
 7367               	.LC18:
 7368 02bc 0A73 7563 		.string	"\nsuccess receive a association req ack frame"
 7368      6365 7373 
 7368      2072 6563 
 7368      6569 7665 
 7368      2061 2061 
 7369               	.LC19:
 7370 02e9 0A73 7563 		.string	"\nsuccess received the data request ack"
 7370      6365 7373 
 7370      2072 6563 
 7370      6569 7665 
 7370      6420 7468 
 7371               	.LC20:
 7372 0310 0A2D 2D2D 		.string	"\n------synchronizing success------ "
 7372      2D2D 2D73 
 7372      796E 6368 
 7372      726F 6E69 
 7372      7A69 6E67 
 7373               	.LC21:
 7374 0334 0A2D 2D2D 		.string	"\n-------success received a association reply frame------"
 7374      2D2D 2D2D 
 7374      7375 6363 
 7374      6573 7320 
 7374      7265 6365 
 7375               	.LC22:
 7376 036d 0A2D 2D2D 		.string	"\n---success received the coordinator realignment frame----"
 7376      7375 6363 
 7376      6573 7320 
 7376      7265 6365 
 7376      6976 6564 
 7377               		.text
 7379               	.global	mac_frame_rcvd
 7381               	mac_frame_rcvd:
 7383               	.LM752:
 7384               	/* prologue: frame size=0 */
 7385 29be CF92      		push r12
 7386 29c0 EF92      		push r14
 7387 29c2 0F93      		push r16
 7388 29c4 1F93      		push r17
 7389 29c6 CF93      		push r28
 7390 29c8 DF93      		push r29
 7391               	/* prologue end (size=6) */
 7393               	.LM753:
 7394 29ca 8091 0000 		lds r24,mac_rx_current_frame+26
 7395 29ce 9927      		clr r25
 7396 29d0 8130      		cpi r24,1
 7397 29d2 9105      		cpc r25,__zero_reg__
 7398 29d4 09F4      		brne .+2
 7399 29d6 59C1      		rjmp .L471
 7401               	.LM754:
 7402 29d8 8230      		cpi r24,2
 7403 29da 9105      		cpc r25,__zero_reg__
 7404 29dc 24F4      		brge .L497
 7405 29de 892B      		or r24,r25
 7406 29e0 09F4      		brne .+2
 7407 29e2 5AC0      		rjmp .L450
 7408 29e4 5DC2      		rjmp .L434
 7409               	.L497:
 7410 29e6 8230      		cpi r24,2
 7411 29e8 9105      		cpc r25,__zero_reg__
 7412 29ea 21F0      		breq .L436
 7413 29ec 0397      		sbiw r24,3
 7414 29ee 09F4      		brne .+2
 7415 29f0 95C1      		rjmp .L477
 7416 29f2 56C2      		rjmp .L434
 7417               	.L436:
 7419               	.LM755:
 7420 29f4 8091 0000 		lds r24,mac_rx_current_frame+28
 7421 29f8 0E94 0000 		call get_frame_pointer
 7422 29fc FC01      		movw r30,r24
 7424               	.LM756:
 7425 29fe 892B      		or r24,r25
 7426 2a00 09F4      		brne .+2
 7427 2a02 4EC2      		rjmp .L434
 7429               	.LM757:
 7430 2a04 8681      		ldd r24,Z+6
 7431 2a06 9927      		clr r25
 7432 2a08 8130      		cpi r24,1
 7433 2a0a 9105      		cpc r25,__zero_reg__
 7434 2a0c 61F0      		breq .L439
 7435 2a0e 8230      		cpi r24,2
 7436 2a10 9105      		cpc r25,__zero_reg__
 7437 2a12 1CF4      		brge .L448
 7438 2a14 892B      		or r24,r25
 7439 2a16 99F1      		breq .L443
 7440 2a18 3AC0      		rjmp .L438
 7441               	.L448:
 7442 2a1a 8330      		cpi r24,3
 7443 2a1c 9105      		cpc r25,__zero_reg__
 7444 2a1e A1F1      		breq .L445
 7445 2a20 0497      		sbiw r24,4
 7446 2a22 69F0      		breq .L441
 7447 2a24 34C0      		rjmp .L438
 7448               	.L439:
 7450               	.LM758:
 7451 2a26 80E0      		ldi r24,lo8(.LC18)
 7452 2a28 90E0      		ldi r25,hi8(.LC18)
 7453 2a2a 0E94 0000 		call puts
 7455               	.LM759:
 7456 2a2e 8091 0000 		lds r24,mac_current_state
 7457 2a32 8230      		cpi r24,lo8(2)
 7458 2a34 61F5      		brne .L438
 7460               	.LM760:
 7461 2a36 83E0      		ldi r24,lo8(3)
 7462 2a38 8093 0000 		sts mac_current_state,r24
 7464               	.LM761:
 7465 2a3c 28C0      		rjmp .L438
 7466               	.L441:
 7468               	.LM762:
 7469 2a3e 80E0      		ldi r24,lo8(.LC19)
 7470 2a40 90E0      		ldi r25,hi8(.LC19)
 7471 2a42 0E94 0000 		call puts
 7473               	.LM763:
 7474 2a46 E090 0000 		lds r14,IS_NETWORK_FORMED
 7475 2a4a EE20      		tst r14
 7476 2a4c 01F5      		brne .L438
 7478               	.LM764:
 7479 2a4e 04EC      		ldi r16,lo8(1220)
 7480 2a50 14E0      		ldi r17,hi8(1220)
 7481 2a52 22E0      		ldi r18,lo8(2)
 7482 2a54 4E2D      		mov r20,r14
 7483 2a56 61E0      		ldi r22,lo8(1)
 7484 2a58 8091 0000 		lds r24,head_of_timer_queue
 7485 2a5c 9091 0000 		lds r25,(head_of_timer_queue)+1
 7486 2a60 0E94 0000 		call timer3queue_start
 7487 2a64 9093 0000 		sts (head_of_timer_queue)+1,r25
 7488 2a68 8093 0000 		sts head_of_timer_queue,r24
 7490               	.LM765:
 7491 2a6c E092 0000 		sts phy_channel_state,r14
 7493               	.LM766:
 7494 2a70 83E0      		ldi r24,lo8(3)
 7495 2a72 8093 0000 		sts mac_current_state,r24
 7497               	.LM767:
 7498 2a76 86E0      		ldi r24,lo8(6)
 7499 2a78 0E94 0000 		call PLME_SET_TRX_STATE_request
 7501               	.LM768:
 7502 2a7c 08C0      		rjmp .L438
 7503               	.L443:
 7505               	.LM769:
 7506 2a7e 6181      		ldd r22,Z+1
 7507 2a80 80E0      		ldi r24,lo8(0)
 7508 2a82 0E94 0000 		call mcpsDataConfirm
 7510               	.LM770:
 7511 2a86 03C0      		rjmp .L438
 7512               	.L445:
 7514               	.LM771:
 7515 2a88 80E0      		ldi r24,lo8(0)
 7516 2a8a 0E94 0000 		call mlmeDisassociateConfirm
 7517               	.L438:
 7519               	.LM772:
 7520 2a8e 8091 0000 		lds r24,mac_rx_current_frame+28
 7521 2a92 0E94 0000 		call remove_tx_queue
 7523               	.LM773:
 7524 2a96 04C2      		rjmp .L434
 7525               	.L450:
 7527               	.LM774:
 7528 2a98 4091 0000 		lds r20,mac_rx_current_frame+32
 7529 2a9c 5091 0000 		lds r21,(mac_rx_current_frame+32)+1
 7530 2aa0 6091 0000 		lds r22,(mac_rx_current_frame+32)+2
 7531 2aa4 7091 0000 		lds r23,(mac_rx_current_frame+32)+3
 7532 2aa8 4093 0000 		sts last_beacon_rx_timestamp,r20
 7533 2aac 5093 0000 		sts (last_beacon_rx_timestamp)+1,r21
 7534 2ab0 6093 0000 		sts (last_beacon_rx_timestamp)+2,r22
 7535 2ab4 7093 0000 		sts (last_beacon_rx_timestamp)+3,r23
 7537               	.LM775:
 7538 2ab8 8091 0000 		lds r24,IS_MAC_SYNING
 7539 2abc 8823      		tst r24
 7540 2abe 89F1      		breq .L452
 7542               	.LM776:
 7543 2ac0 64E0      		ldi r22,lo8(4)
 7544 2ac2 8091 0000 		lds r24,head_of_systimer_queue
 7545 2ac6 9091 0000 		lds r25,(head_of_systimer_queue)+1
 7546 2aca 0E94 0000 		call systimer_stop_task
 7547 2ace 9093 0000 		sts (head_of_systimer_queue)+1,r25
 7548 2ad2 8093 0000 		sts head_of_systimer_queue,r24
 7550               	.LM777:
 7551 2ad6 8FE0      		ldi r24,lo8(15)
 7552 2ad8 8093 0000 		sts mac_current_state,r24
 7554               	.LM778:
 7555 2adc 1092 0000 		sts IS_MAC_SYNING,__zero_reg__
 7557               	.LM779:
 7558 2ae0 8091 0000 		lds r24,mac_rx_current_frame+32
 7559 2ae4 9091 0000 		lds r25,(mac_rx_current_frame+32)+1
 7560 2ae8 A091 0000 		lds r26,(mac_rx_current_frame+32)+2
 7561 2aec B091 0000 		lds r27,(mac_rx_current_frame+32)+3
 7562 2af0 8093 0000 		sts last_beacon_rx_timestamp,r24
 7563 2af4 9093 0000 		sts (last_beacon_rx_timestamp)+1,r25
 7564 2af8 A093 0000 		sts (last_beacon_rx_timestamp)+2,r26
 7565 2afc B093 0000 		sts (last_beacon_rx_timestamp)+3,r27
 7567               	.LM780:
 7568 2b00 0E94 0000 		call mlmesyn_finished
 7570               	.LM781:
 7571 2b04 1092 0000 		sts phy_channel_state,__zero_reg__
 7573               	.LM782:
 7574 2b08 86E0      		ldi r24,lo8(6)
 7575 2b0a 0E94 0000 		call PLME_SET_TRX_STATE_request
 7577               	.LM783:
 7578 2b0e 81E0      		ldi r24,lo8(1)
 7579 2b10 8093 0000 		sts Is_received_beacon,r24
 7581               	.LM784:
 7582 2b14 1092 0000 		sts loss_sync_number,__zero_reg__
 7584               	.LM785:
 7585 2b18 80E0      		ldi r24,lo8(.LC20)
 7586 2b1a 90E0      		ldi r25,hi8(.LC20)
 7587 2b1c 0E94 0000 		call puts
 7588 2b20 BFC1      		rjmp .L434
 7589               	.L452:
 7591               	.LM786:
 7592 2b22 2091 0000 		lds r18,mac_rx_current_frame+40
 7593 2b26 2223      		tst r18
 7594 2b28 49F4      		brne .L455
 7595 2b2a 8091 0000 		lds r24,mac_pib_data+2
 7596 2b2e 8823      		tst r24
 7597 2b30 29F0      		breq .L455
 7598 2b32 8091 0000 		lds r24,mac_current_state
 7599 2b36 8730      		cpi r24,lo8(7)
 7600 2b38 09F0      		breq .+2
 7601 2b3a B2C1      		rjmp .L434
 7602               	.L455:
 7604               	.LM787:
 7605 2b3c 8091 0000 		lds r24,mac_rx_current_frame+22
 7606 2b40 9091 0000 		lds r25,(mac_rx_current_frame+22)+1
 7607 2b44 9093 0000 		sts (mac_pib_data+22)+1,r25
 7608 2b48 8093 0000 		sts mac_pib_data+22,r24
 7610               	.LM788:
 7611 2b4c 8091 0000 		lds r24,mac_rx_current_frame+28
 7612 2b50 8093 0000 		sts beacon_info,r24
 7614               	.LM789:
 7615 2b54 2093 0000 		sts beacon_info+49,r18
 7617               	.LM790:
 7618 2b58 8091 0000 		lds r24,mac_rx_current_frame+146
 7619 2b5c 8093 0000 		sts beacon_info+26,r24
 7621               	.LM791:
 7622 2b60 E091 0000 		lds r30,mac_rx_current_frame+147
 7623 2b64 E093 0000 		sts beacon_info+27,r30
 7625               	.LM792:
 7626 2b68 8091 0000 		lds r24,mac_rx_current_frame+148
 7627 2b6c 8093 0000 		sts beacon_info+28,r24
 7629               	.LM793:
 7630 2b70 EE23      		tst r30
 7631 2b72 59F0      		breq .L499
 7632 2b74 2E2F      		mov r18,r30
 7633 2b76 A0E0      		ldi r26,lo8(beacon_info+29)
 7634 2b78 B0E0      		ldi r27,hi8(beacon_info+29)
 7635 2b7a E0E0      		ldi r30,lo8(mac_rx_current_frame+149)
 7636 2b7c F0E0      		ldi r31,hi8(mac_rx_current_frame+149)
 7637               	.L459:
 7639               	.LM794:
 7640 2b7e 8191      		ld r24,Z+
 7641 2b80 9191      		ld r25,Z+
 7642 2b82 8D93      		st X+,r24
 7643 2b84 9D93      		st X+,r25
 7645               	.LM795:
 7646 2b86 2150      		subi r18,lo8(-(-1))
 7647 2b88 D1F7      		brne .L459
 7648               	.L499:
 7650               	.LM796:
 7651 2b8a 20E0      		ldi r18,lo8(0)
 7652 2b8c 8091 0000 		lds r24,beacon_info+28
 7653 2b90 2817      		cp r18,r24
 7654 2b92 B8F4      		brsh .L501
 7655 2b94 98E0      		ldi r25,lo8(8)
 7656               	.L463:
 7658               	.LM797:
 7659 2b96 E22F      		mov r30,r18
 7660 2b98 FF27      		clr r31
 7661 2b9a A3E0      		ldi r26,3
 7662 2b9c EE0F      	1:	lsl r30
 7663 2b9e FF1F      		rol r31
 7664 2ba0 AA95      		dec r26
 7665 2ba2 E1F7      		brne 1b
 7666 2ba4 DF01      		movw r26,r30
 7667 2ba6 A050      		subi r26,lo8(-(mac_rx_current_frame+153))
 7668 2ba8 B040      		sbci r27,hi8(-(mac_rx_current_frame+153))
 7669 2baa E050      		subi r30,lo8(-(beacon_info+33))
 7670 2bac F040      		sbci r31,hi8(-(beacon_info+33))
 7671 2bae 392F      		mov r19,r25
 7672 2bb0 0D90      		ld __tmp_reg__,X+
 7673 2bb2 0192      		st Z+,__tmp_reg__
 7674 2bb4 3A95      		dec r19
 7675 2bb6 E1F7      		brne .-8
 7677               	.LM798:
 7678 2bb8 2F5F      		subi r18,lo8(-(1))
 7679 2bba 8091 0000 		lds r24,beacon_info+28
 7680 2bbe 2817      		cp r18,r24
 7681 2bc0 50F3      		brlo .L463
 7682               	.L501:
 7684               	.LM799:
 7685 2bc2 E091 0000 		lds r30,beacon_info+49
 7686 2bc6 EE23      		tst r30
 7687 2bc8 49F0      		breq .L503
 7688 2bca C0E0      		ldi r28,lo8(beacon_info+50)
 7689 2bcc D0E0      		ldi r29,hi8(beacon_info+50)
 7690 2bce A0E0      		ldi r26,lo8(mac_rx_current_frame+41)
 7691 2bd0 B0E0      		ldi r27,hi8(mac_rx_current_frame+41)
 7692 2bd2 2E2F      		mov r18,r30
 7693               	.L467:
 7695               	.LM800:
 7696 2bd4 8D91      		ld r24,X+
 7697 2bd6 8993      		st Y+,r24
 7699               	.LM801:
 7700 2bd8 2150      		subi r18,lo8(-(-1))
 7701 2bda E1F7      		brne .L467
 7702               	.L503:
 7704               	.LM802:
 7705 2bdc 8DE0      		ldi r24,lo8(13)
 7706 2bde A0E0      		ldi r26,lo8(mac_rx_current_frame+13)
 7707 2be0 B0E0      		ldi r27,hi8(mac_rx_current_frame+13)
 7708 2be2 E0E0      		ldi r30,lo8(beacon_info+2)
 7709 2be4 F0E0      		ldi r31,hi8(beacon_info+2)
 7710 2be6 0D90      		ld __tmp_reg__,X+
 7711 2be8 0192      		st Z+,__tmp_reg__
 7712 2bea 8A95      		dec r24
 7713 2bec E1F7      		brne .-8
 7715               	.LM803:
 7716 2bee 4093 0000 		sts beacon_info+19,r20
 7717 2bf2 5093 0000 		sts (beacon_info+19)+1,r21
 7718 2bf6 6093 0000 		sts (beacon_info+19)+2,r22
 7719 2bfa 7093 0000 		sts (beacon_info+19)+3,r23
 7721               	.LM804:
 7722 2bfe 8091 0000 		lds r24,mac_rx_current_frame+31
 7723 2c02 8093 0000 		sts beacon_info+18,r24
 7725               	.LM805:
 7726 2c06 8091 0000 		lds r24,mac_rx_current_frame+144
 7727 2c0a 9091 0000 		lds r25,(mac_rx_current_frame+144)+1
 7728 2c0e 9093 0000 		sts (beacon_info+15)+1,r25
 7729 2c12 8093 0000 		sts beacon_info+15,r24
 7731               	.LM806:
 7732 2c16 8091 0000 		lds r24,mac_rx_current_frame+177
 7733 2c1a 8093 0000 		sts beacon_info+1,r24
 7735               	.LM807:
 7736 2c1e 8091 0000 		lds r24,mac_current_state_saved
 7737 2c22 8330      		cpi r24,lo8(3)
 7738 2c24 11F0      		breq .L469
 7739 2c26 8830      		cpi r24,lo8(8)
 7740 2c28 11F4      		brne .L468
 7741               	.L469:
 7743               	.LM808:
 7744 2c2a 8093 0000 		sts mac_current_state,r24
 7745               	.L468:
 7747               	.LM809:
 7748 2c2e 8DB7      		in r24,__SP_L__
 7749 2c30 9EB7      		in r25,__SP_H__
 7750 2c32 8656      		subi r24,lo8(-(-102))
 7751 2c34 9040      		sbci r25,hi8(-(-102))
 7752 2c36 0FB6      		in __tmp_reg__,__SREG__
 7753 2c38 F894      		cli
 7754 2c3a 9EBF      		out __SP_H__,r25
 7755 2c3c 0FBE      		out __SREG__,__tmp_reg__
 7756 2c3e 8DBF      		out __SP_L__,r24
 7757 2c40 ADB7      		in r26,__SP_L__
 7758 2c42 BEB7      		in r27,__SP_H__
 7759 2c44 1196      		adiw r26,1
 7760 2c46 86E6      		ldi r24,lo8(102)
 7761 2c48 E0E0      		ldi r30,lo8(beacon_info)
 7762 2c4a F0E0      		ldi r31,hi8(beacon_info)
 7763 2c4c 0190      		ld __tmp_reg__,Z+
 7764 2c4e 0D92      		st X+,__tmp_reg__
 7765 2c50 8A95      		dec r24
 7766 2c52 E1F7      		brne .-8
 7767 2c54 0E94 0000 		call mlmeBeaconNotifyIndication
 7769               	.LM810:
 7770 2c58 8091 0000 		lds r24,mac_current_state
 7771 2c5c CDB7      		in r28,__SP_L__
 7772 2c5e DEB7      		in r29,__SP_H__
 7773 2c60 CA59      		subi r28,lo8(-(102))
 7774 2c62 DF4F      		sbci r29,hi8(-(102))
 7775 2c64 0FB6      		in __tmp_reg__,__SREG__
 7776 2c66 F894      		cli
 7777 2c68 DEBF      		out __SP_H__,r29
 7778 2c6a 0FBE      		out __SREG__,__tmp_reg__
 7779 2c6c CDBF      		out __SP_L__,r28
 7780 2c6e 8730      		cpi r24,lo8(7)
 7781 2c70 09F4      		brne .+2
 7782 2c72 16C1      		rjmp .L434
 7784               	.LM811:
 7785 2c74 81E0      		ldi r24,lo8(1)
 7786 2c76 8093 0000 		sts Is_received_beacon,r24
 7788               	.LM812:
 7789 2c7a 0E94 0000 		call mlmesyn_finished
 7791               	.LM813:
 7792 2c7e 1092 0000 		sts phy_channel_state,__zero_reg__
 7794               	.LM814:
 7795 2c82 86E0      		ldi r24,lo8(6)
 7796 2c84 0E94 0000 		call PLME_SET_TRX_STATE_request
 7798               	.LM815:
 7799 2c88 0BC1      		rjmp .L434
 7800               	.L471:
 7802               	.LM816:
 7803 2c8a 8091 0000 		lds r24,mac_current_state
 7804 2c8e 8031      		cpi r24,lo8(16)
 7805 2c90 09F0      		breq .+2
 7806 2c92 06C1      		rjmp .L434
 7808               	.LM817:
 7809 2c94 20E0      		ldi r18,lo8(mac_rx_current_frame+13)
 7810 2c96 30E0      		ldi r19,hi8(mac_rx_current_frame+13)
 7811 2c98 8DE0      		ldi r24,lo8(13)
 7812 2c9a A0E0      		ldi r26,lo8(mcps_data_indication_info)
 7813 2c9c B0E0      		ldi r27,hi8(mcps_data_indication_info)
 7814 2c9e FD01      		movw r30,r26
 7815 2ca0 E901      		movw r28,r18
 7816 2ca2 982F      		mov r25,r24
 7817 2ca4 0990      		ld __tmp_reg__,Y+
 7818 2ca6 0192      		st Z+,__tmp_reg__
 7819 2ca8 9A95      		dec r25
 7820 2caa E1F7      		brne .-8
 7822               	.LM818:
 7823 2cac 1D96      		adiw r26,13
 7824 2cae F901      		movw r30,r18
 7825 2cb0 3D97      		sbiw r30,13
 7826 2cb2 ED01      		movw r28,r26
 7827 2cb4 0190      		ld __tmp_reg__,Z+
 7828 2cb6 0992      		st Y+,__tmp_reg__
 7829 2cb8 8A95      		dec r24
 7830 2cba E1F7      		brne .-8
 7831 2cbc 1D97      		sbiw r26,13
 7833               	.LM819:
 7834 2cbe 8091 0000 		lds r24,mac_rx_current_frame+31
 7835 2cc2 8093 0000 		sts mcps_data_indication_info+26,r24
 7837               	.LM820:
 7838 2cc6 8091 0000 		lds r24,mac_rx_current_frame+39
 7839 2cca 8093 0000 		sts mcps_data_indication_info+29,r24
 7841               	.LM821:
 7842 2cce 8823      		tst r24
 7843 2cd0 41F0      		breq .L505
 7844 2cd2 5E96      		adiw r26,30
 7845 2cd4 F901      		movw r30,r18
 7846 2cd6 7C96      		adiw r30,28
 7847 2cd8 282F      		mov r18,r24
 7848               	.L476:
 7850               	.LM822:
 7851 2cda 8191      		ld r24,Z+
 7852 2cdc 8D93      		st X+,r24
 7854               	.LM823:
 7855 2cde 2150      		subi r18,lo8(-(-1))
 7856 2ce0 E1F7      		brne .L476
 7857               	.L505:
 7859               	.LM824:
 7860 2ce2 EDB7      		in r30,__SP_L__
 7861 2ce4 FEB7      		in r31,__SP_H__
 7862 2ce6 E458      		subi r30,lo8(-(-132))
 7863 2ce8 F040      		sbci r31,hi8(-(-132))
 7864 2cea 0FB6      		in __tmp_reg__,__SREG__
 7865 2cec F894      		cli
 7866 2cee FEBF      		out __SP_H__,r31
 7867 2cf0 0FBE      		out __SREG__,__tmp_reg__
 7868 2cf2 EDBF      		out __SP_L__,r30
 7869 2cf4 3196      		adiw r30,1
 7870 2cf6 84E8      		ldi r24,lo8(-124)
 7871 2cf8 A0E0      		ldi r26,lo8(mcps_data_indication_info)
 7872 2cfa B0E0      		ldi r27,hi8(mcps_data_indication_info)
 7873 2cfc 0D90      		ld __tmp_reg__,X+
 7874 2cfe 0192      		st Z+,__tmp_reg__
 7875 2d00 8A95      		dec r24
 7876 2d02 E1F7      		brne .-8
 7877 2d04 0E94 0000 		call mcpsDataIndication
 7878 2d08 2DB7      		in r18,__SP_L__
 7879 2d0a 3EB7      		in r19,__SP_H__
 7880 2d0c 2C57      		subi r18,lo8(-(132))
 7881 2d0e 3F4F      		sbci r19,hi8(-(132))
 7882 2d10 0FB6      		in __tmp_reg__,__SREG__
 7883 2d12 F894      		cli
 7884 2d14 3EBF      		out __SP_H__,r19
 7885 2d16 0FBE      		out __SREG__,__tmp_reg__
 7886 2d18 2DBF      		out __SP_L__,r18
 7888               	.LM825:
 7889 2d1a C2C0      		rjmp .L434
 7890               	.L477:
 7892               	.LM826:
 7893 2d1c 8091 0000 		lds r24,mac_rx_current_frame+27
 7894 2d20 9927      		clr r25
 7895 2d22 8430      		cpi r24,4
 7896 2d24 9105      		cpc r25,__zero_reg__
 7897 2d26 09F4      		brne .+2
 7898 2d28 BBC0      		rjmp .L434
 7899 2d2a 8530      		cpi r24,5
 7900 2d2c 9105      		cpc r25,__zero_reg__
 7901 2d2e 34F4      		brge .L496
 7902 2d30 8230      		cpi r24,2
 7903 2d32 9105      		cpc r25,__zero_reg__
 7904 2d34 79F0      		breq .L481
 7905 2d36 0397      		sbiw r24,3
 7906 2d38 74F5      		brge .L484
 7907 2d3a B2C0      		rjmp .L434
 7908               	.L496:
 7909 2d3c 8630      		cpi r24,6
 7910 2d3e 9105      		cpc r25,__zero_reg__
 7911 2d40 09F4      		brne .+2
 7912 2d42 AEC0      		rjmp .L434
 7913 2d44 8630      		cpi r24,6
 7914 2d46 9105      		cpc r25,__zero_reg__
 7915 2d48 0CF4      		brge .+2
 7916 2d4a 4BC0      		rjmp .L488
 7917 2d4c 0897      		sbiw r24,8
 7918 2d4e 09F4      		brne .+2
 7919 2d50 4CC0      		rjmp .L492
 7920 2d52 A6C0      		rjmp .L434
 7921               	.L481:
 7923               	.LM827:
 7924 2d54 8091 0000 		lds r24,mac_current_state
 7925 2d58 8330      		cpi r24,lo8(3)
 7926 2d5a 09F0      		breq .+2
 7927 2d5c A1C0      		rjmp .L434
 7929               	.LM828:
 7930 2d5e 80E0      		ldi r24,lo8(.LC21)
 7931 2d60 90E0      		ldi r25,hi8(.LC21)
 7932 2d62 0E94 0000 		call puts
 7934               	.LM829:
 7935 2d66 42E0      		ldi r20,lo8(2)
 7936 2d68 60E0      		ldi r22,lo8(0)
 7937 2d6a 8091 0000 		lds r24,head_of_timer_queue
 7938 2d6e 9091 0000 		lds r25,(head_of_timer_queue)+1
 7939 2d72 0E94 0000 		call timer3quere_cancel
 7940 2d76 9093 0000 		sts (head_of_timer_queue)+1,r25
 7941 2d7a 8093 0000 		sts head_of_timer_queue,r24
 7943               	.LM830:
 7944 2d7e 80E1      		ldi r24,lo8(16)
 7945 2d80 8093 0000 		sts mac_current_state,r24
 7947               	.LM831:
 7948 2d84 6091 0000 		lds r22,mac_rx_current_frame+171
 7949 2d88 8091 0000 		lds r24,mac_rx_current_frame+169
 7950 2d8c 9091 0000 		lds r25,(mac_rx_current_frame+169)+1
 7951 2d90 0E94 0000 		call mlmeAssociateConfirm
 7953               	.LM832:
 7954 2d94 85C0      		rjmp .L434
 7955               	.L484:
 7957               	.LM833:
 7958 2d96 42E0      		ldi r20,lo8(2)
 7959 2d98 60E0      		ldi r22,lo8(0)
 7960 2d9a 8091 0000 		lds r24,head_of_timer_queue
 7961 2d9e 9091 0000 		lds r25,(head_of_timer_queue)+1
 7962 2da2 0E94 0000 		call timer3quere_cancel
 7963 2da6 9093 0000 		sts (head_of_timer_queue)+1,r25
 7964 2daa 8093 0000 		sts head_of_timer_queue,r24
 7966               	.LM834:
 7967 2dae 8DE0      		ldi r24,lo8(13)
 7968 2db0 8093 0000 		sts mac_current_state,r24
 7970               	.LM835:
 7971 2db4 CC24      		clr r12
 7972 2db6 EC2C      		mov r14,r12
 7973 2db8 0091 0000 		lds r16,mac_rx_current_frame+172
 7974 2dbc 2091 0000 		lds r18,mac_rx_current_frame+14
 7975 2dc0 3091 0000 		lds r19,mac_rx_current_frame+15
 7976 2dc4 4091 0000 		lds r20,mac_rx_current_frame+16
 7977 2dc8 5091 0000 		lds r21,mac_rx_current_frame+17
 7978 2dcc 6091 0000 		lds r22,mac_rx_current_frame+18
 7979 2dd0 7091 0000 		lds r23,mac_rx_current_frame+19
 7980 2dd4 8091 0000 		lds r24,mac_rx_current_frame+20
 7981 2dd8 9091 0000 		lds r25,mac_rx_current_frame+21
 7982 2ddc 0E94 0000 		call mlmeDisassociateIndication
 7984               	.LM836:
 7985 2de0 5FC0      		rjmp .L434
 7986               	.L488:
 7988               	.LM837:
 7989 2de2 8EEE      		ldi r24,lo8(-18)
 7990 2de4 0E94 0000 		call mlmeSyncLossIndication
 7992               	.LM838:
 7993 2de8 5BC0      		rjmp .L434
 7994               	.L492:
 7996               	.LM839:
 7997 2dea C091 0000 		lds r28,mac_current_state
 7998 2dee C830      		cpi r28,lo8(8)
 7999 2df0 09F0      		breq .+2
 8000 2df2 56C0      		rjmp .L434
 8002               	.LM840:
 8003 2df4 80E0      		ldi r24,lo8(.LC22)
 8004 2df6 90E0      		ldi r25,hi8(.LC22)
 8005 2df8 0E94 0000 		call puts
 8007               	.LM841:
 8008 2dfc 41E0      		ldi r20,lo8(1)
 8009 2dfe 60E0      		ldi r22,lo8(0)
 8010 2e00 8091 0000 		lds r24,head_of_timer_queue
 8011 2e04 9091 0000 		lds r25,(head_of_timer_queue)+1
 8012 2e08 0E94 0000 		call timer3quere_cancel
 8013 2e0c 9093 0000 		sts (head_of_timer_queue)+1,r25
 8014 2e10 8093 0000 		sts head_of_timer_queue,r24
 8016               	.LM842:
 8017 2e14 8091 0000 		lds r24,mac_rx_current_frame+175
 8018 2e18 9091 0000 		lds r25,(mac_rx_current_frame+175)+1
 8019 2e1c 9093 0000 		sts (mac_pib_data+22)+1,r25
 8020 2e20 8093 0000 		sts mac_pib_data+22,r24
 8022               	.LM843:
 8023 2e24 8091 0000 		lds r24,mac_rx_current_frame+173
 8024 2e28 9091 0000 		lds r25,(mac_rx_current_frame+173)+1
 8025 2e2c 9093 0000 		sts (mac_pib_data+28)+1,r25
 8026 2e30 8093 0000 		sts mac_pib_data+28,r24
 8028               	.LM844:
 8029 2e34 8091 0000 		lds r24,mac_rx_current_frame+178
 8030 2e38 9091 0000 		lds r25,(mac_rx_current_frame+178)+1
 8031 2e3c 9093 0000 		sts (mac_pib_data+32)+1,r25
 8032 2e40 8093 0000 		sts mac_pib_data+32,r24
 8034               	.LM845:
 8035 2e44 A0E0      		ldi r26,lo8(mac_rx_current_frame+14)
 8036 2e46 B0E0      		ldi r27,hi8(mac_rx_current_frame+14)
 8037 2e48 E0E0      		ldi r30,lo8(mac_pib_data+14)
 8038 2e4a F0E0      		ldi r31,hi8(mac_pib_data+14)
 8039 2e4c 0D90      		ld __tmp_reg__,X+
 8040 2e4e 0192      		st Z+,__tmp_reg__
 8041 2e50 CA95      		dec r28
 8042 2e52 E1F7      		brne .-8
 8044               	.LM846:
 8045 2e54 1092 0000 		sts scan_result_info,__zero_reg__
 8047               	.LM847:
 8048 2e58 83E0      		ldi r24,lo8(3)
 8049 2e5a 8093 0000 		sts scan_result_info+1,r24
 8051               	.LM848:
 8052 2e5e 80E1      		ldi r24,lo8(16)
 8053 2e60 8093 0000 		sts mac_current_state,r24
 8055               	.LM849:
 8056 2e64 8DB7      		in r24,__SP_L__
 8057 2e66 9EB7      		in r25,__SP_H__
 8058 2e68 8458      		subi r24,lo8(-(-132))
 8059 2e6a 9040      		sbci r25,hi8(-(-132))
 8060 2e6c 0FB6      		in __tmp_reg__,__SREG__
 8061 2e6e F894      		cli
 8062 2e70 9EBF      		out __SP_H__,r25
 8063 2e72 0FBE      		out __SREG__,__tmp_reg__
 8064 2e74 8DBF      		out __SP_L__,r24
 8065 2e76 ADB7      		in r26,__SP_L__
 8066 2e78 BEB7      		in r27,__SP_H__
 8067 2e7a 1196      		adiw r26,1
 8068 2e7c 84E8      		ldi r24,lo8(-124)
 8069 2e7e E0E0      		ldi r30,lo8(scan_result_info)
 8070 2e80 F0E0      		ldi r31,hi8(scan_result_info)
 8071 2e82 0190      		ld __tmp_reg__,Z+
 8072 2e84 0D92      		st X+,__tmp_reg__
 8073 2e86 8A95      		dec r24
 8074 2e88 E1F7      		brne .-8
 8075 2e8a 0E94 0000 		call mlmeScanConfirm
 8076 2e8e CDB7      		in r28,__SP_L__
 8077 2e90 DEB7      		in r29,__SP_H__
 8078 2e92 CC57      		subi r28,lo8(-(132))
 8079 2e94 DF4F      		sbci r29,hi8(-(132))
 8080 2e96 0FB6      		in __tmp_reg__,__SREG__
 8081 2e98 F894      		cli
 8082 2e9a DEBF      		out __SP_H__,r29
 8083 2e9c 0FBE      		out __SREG__,__tmp_reg__
 8084 2e9e CDBF      		out __SP_L__,r28
 8085               	.L434:
 8086               	/* epilogue: frame size=0 */
 8087 2ea0 DF91      		pop r29
 8088 2ea2 CF91      		pop r28
 8089 2ea4 1F91      		pop r17
 8090 2ea6 0F91      		pop r16
 8091 2ea8 EF90      		pop r14
 8092 2eaa CF90      		pop r12
 8093 2eac 0895      		ret
 8094               	/* epilogue end (size=7) */
 8095               	/* function mac_frame_rcvd size 639 (626) */
 8101               	.Lscope57:
 8102               		.data
 8103               	.LC23:
 8104 03a8 0A74 6865 		.string	"\nthe received frame length  is %d\n"
 8104      2072 6563 
 8104      6569 7665 
 8104      6420 6672 
 8104      616D 6520 
 8105               	.LC24:
 8106 03cb 0A21 2121 		.string	"\n!!!received frame length error\n"
 8106      7265 6365 
 8106      6976 6564 
 8106      2066 7261 
 8106      6D65 206C 
 8107               		.text
 8109               	.global	mac_get_received_frame
 8111               	mac_get_received_frame:
 8113               	.LM850:
 8114               	/* prologue: frame size=0 */
 8115 2eae 1F93      		push r17
 8116 2eb0 CF93      		push r28
 8117 2eb2 DF93      		push r29
 8118               	/* prologue end (size=3) */
 8120               	.LM851:
 8121 2eb4 C091 0000 		lds r28,head_of_rx_buffer
 8122 2eb8 D091 0000 		lds r29,(head_of_rx_buffer)+1
 8124               	.LM852:
 8125 2ebc 8091 0000 		lds r24,tail_of_rx_buffer
 8126 2ec0 9091 0000 		lds r25,(tail_of_rx_buffer)+1
 8127 2ec4 8C17      		cp r24,r28
 8128 2ec6 9D07      		cpc r25,r29
 8129 2ec8 31F4      		brne .L507
 8131               	.LM853:
 8132 2eca 8885      		ldd r24,Y+8
 8133 2ecc 9985      		ldd r25,Y+9
 8134 2ece 9093 0000 		sts (tail_of_rx_buffer)+1,r25
 8135 2ed2 8093 0000 		sts tail_of_rx_buffer,r24
 8136               	.L507:
 8138               	.LM854:
 8139 2ed6 8885      		ldd r24,Y+8
 8140 2ed8 9985      		ldd r25,Y+9
 8141 2eda 9093 0000 		sts (head_of_rx_buffer)+1,r25
 8142 2ede 8093 0000 		sts head_of_rx_buffer,r24
 8144               	.LM855:
 8145 2ee2 2881      		ld r18,Y
 8146 2ee4 2250      		subi r18,lo8(-(-2))
 8147 2ee6 2093 0000 		sts mac_rx_current_frame+29,r18
 8149               	.LM856:
 8150 2eea 8B81      		ldd r24,Y+3
 8151 2eec 8093 0000 		sts mac_rx_current_frame+31,r24
 8153               	.LM857:
 8154 2ef0 8C81      		ldd r24,Y+4
 8155 2ef2 9D81      		ldd r25,Y+5
 8156 2ef4 AE81      		ldd r26,Y+6
 8157 2ef6 BF81      		ldd r27,Y+7
 8158 2ef8 8093 0000 		sts mac_rx_current_frame+32,r24
 8159 2efc 9093 0000 		sts (mac_rx_current_frame+32)+1,r25
 8160 2f00 A093 0000 		sts (mac_rx_current_frame+32)+2,r26
 8161 2f04 B093 0000 		sts (mac_rx_current_frame+32)+3,r27
 8163               	.LM858:
 8164 2f08 822F      		mov r24,r18
 8165 2f0a 9927      		clr r25
 8166 2f0c 9F93      		push r25
 8167 2f0e 8F93      		push r24
 8168 2f10 80E0      		ldi r24,lo8(.LC23)
 8169 2f12 90E0      		ldi r25,hi8(.LC23)
 8170 2f14 9F93      		push r25
 8171 2f16 8F93      		push r24
 8172 2f18 0E94 0000 		call printf
 8174               	.LM859:
 8175 2f1c E981      		ldd r30,Y+1
 8176 2f1e FA81      		ldd r31,Y+2
 8177 2f20 8181      		ldd r24,Z+1
 8178 2f22 8093 0000 		sts mac_rx_current_frame+36,r24
 8180               	.LM860:
 8181 2f26 E981      		ldd r30,Y+1
 8182 2f28 FA81      		ldd r31,Y+2
 8183 2f2a 9281      		ldd r25,Z+2
 8184 2f2c 9093 0000 		sts mac_rx_current_frame+37,r25
 8186               	.LM861:
 8187 2f30 E981      		ldd r30,Y+1
 8188 2f32 FA81      		ldd r31,Y+2
 8189 2f34 14E0      		ldi r17,lo8(4)
 8190 2f36 8381      		ldd r24,Z+3
 8191 2f38 8093 0000 		sts mac_rx_current_frame+28,r24
 8193               	.LM862:
 8194 2f3c 8091 0000 		lds r24,ppib
 8195 2f40 8093 0000 		sts mac_rx_current_frame+177,r24
 8197               	.LM863:
 8198 2f44 0F90      		pop __tmp_reg__
 8199 2f46 0F90      		pop __tmp_reg__
 8200 2f48 0F90      		pop __tmp_reg__
 8201 2f4a 0F90      		pop __tmp_reg__
 8202 2f4c 292F      		mov r18,r25
 8203 2f4e 3327      		clr r19
 8204 2f50 2C70      		andi r18,lo8(12)
 8205 2f52 3070      		andi r19,hi8(12)
 8206 2f54 2430      		cpi r18,4
 8207 2f56 3105      		cpc r19,__zero_reg__
 8208 2f58 09F4      		brne .+2
 8209 2f5a 63C0      		rjmp .L512
 8210 2f5c 2530      		cpi r18,5
 8211 2f5e 3105      		cpc r19,__zero_reg__
 8212 2f60 24F4      		brge .L513
 8213 2f62 232B      		or r18,r19
 8214 2f64 09F4      		brne .+2
 8215 2f66 5AC0      		rjmp .L511
 8216 2f68 60C0      		rjmp .L508
 8217               	.L513:
 8218 2f6a 2830      		cpi r18,8
 8219 2f6c 3105      		cpc r19,__zero_reg__
 8220 2f6e E9F1      		breq .L510
 8221 2f70 2C30      		cpi r18,12
 8222 2f72 3105      		cpc r19,__zero_reg__
 8223 2f74 09F0      		breq .+2
 8224 2f76 59C0      		rjmp .L508
 8226               	.LM864:
 8227 2f78 8CE0      		ldi r24,lo8(12)
 8228 2f7a 8093 0000 		sts mac_rx_current_frame,r24
 8230               	.LM865:
 8231 2f7e E981      		ldd r30,Y+1
 8232 2f80 FA81      		ldd r31,Y+2
 8233 2f82 8481      		ldd r24,Z+4
 8234 2f84 8093 0000 		sts mac_rx_current_frame+11,r24
 8236               	.LM866:
 8237 2f88 E981      		ldd r30,Y+1
 8238 2f8a FA81      		ldd r31,Y+2
 8239 2f8c 8581      		ldd r24,Z+5
 8240 2f8e 8093 0000 		sts mac_rx_current_frame+12,r24
 8242               	.LM867:
 8243 2f92 E981      		ldd r30,Y+1
 8244 2f94 FA81      		ldd r31,Y+2
 8245 2f96 8681      		ldd r24,Z+6
 8246 2f98 8093 0000 		sts mac_rx_current_frame+1,r24
 8248               	.LM868:
 8249 2f9c E981      		ldd r30,Y+1
 8250 2f9e FA81      		ldd r31,Y+2
 8251 2fa0 8781      		ldd r24,Z+7
 8252 2fa2 8093 0000 		sts mac_rx_current_frame+2,r24
 8254               	.LM869:
 8255 2fa6 E981      		ldd r30,Y+1
 8256 2fa8 FA81      		ldd r31,Y+2
 8257 2faa 8085      		ldd r24,Z+8
 8258 2fac 8093 0000 		sts mac_rx_current_frame+3,r24
 8260               	.LM870:
 8261 2fb0 E981      		ldd r30,Y+1
 8262 2fb2 FA81      		ldd r31,Y+2
 8263 2fb4 8185      		ldd r24,Z+9
 8264 2fb6 8093 0000 		sts mac_rx_current_frame+4,r24
 8266               	.LM871:
 8267 2fba E981      		ldd r30,Y+1
 8268 2fbc FA81      		ldd r31,Y+2
 8269 2fbe 8285      		ldd r24,Z+10
 8270 2fc0 8093 0000 		sts mac_rx_current_frame+5,r24
 8272               	.LM872:
 8273 2fc4 E981      		ldd r30,Y+1
 8274 2fc6 FA81      		ldd r31,Y+2
 8275 2fc8 8385      		ldd r24,Z+11
 8276 2fca 8093 0000 		sts mac_rx_current_frame+6,r24
 8278               	.LM873:
 8279 2fce E981      		ldd r30,Y+1
 8280 2fd0 FA81      		ldd r31,Y+2
 8281 2fd2 E20F      		add r30,r18
 8282 2fd4 F31F      		adc r31,r19
 8283 2fd6 8081      		ld r24,Z
 8284 2fd8 8093 0000 		sts mac_rx_current_frame+7,r24
 8286               	.LM874:
 8287 2fdc E981      		ldd r30,Y+1
 8288 2fde FA81      		ldd r31,Y+2
 8289 2fe0 1EE0      		ldi r17,lo8(14)
 8290 2fe2 8585      		ldd r24,Z+13
 8291 2fe4 8093 0000 		sts mac_rx_current_frame+8,r24
 8293               	.LM875:
 8294 2fe8 20C0      		rjmp .L508
 8295               	.L510:
 8297               	.LM876:
 8298 2fea 98E0      		ldi r25,lo8(8)
 8299 2fec 9093 0000 		sts mac_rx_current_frame,r25
 8301               	.LM877:
 8302 2ff0 E981      		ldd r30,Y+1
 8303 2ff2 FA81      		ldd r31,Y+2
 8304 2ff4 8481      		ldd r24,Z+4
 8305 2ff6 8093 0000 		sts mac_rx_current_frame+11,r24
 8307               	.LM878:
 8308 2ffa E981      		ldd r30,Y+1
 8309 2ffc FA81      		ldd r31,Y+2
 8310 2ffe 8581      		ldd r24,Z+5
 8311 3000 8093 0000 		sts mac_rx_current_frame+12,r24
 8313               	.LM879:
 8314 3004 E981      		ldd r30,Y+1
 8315 3006 FA81      		ldd r31,Y+2
 8316 3008 8681      		ldd r24,Z+6
 8317 300a 8093 0000 		sts mac_rx_current_frame+9,r24
 8319               	.LM880:
 8320 300e E981      		ldd r30,Y+1
 8321 3010 FA81      		ldd r31,Y+2
 8322 3012 192F      		mov r17,r25
 8323 3014 8781      		ldd r24,Z+7
 8324 3016 8093 0000 		sts mac_rx_current_frame+10,r24
 8326               	.LM881:
 8327 301a 07C0      		rjmp .L508
 8328               	.L511:
 8330               	.LM882:
 8331 301c 1092 0000 		sts mac_rx_current_frame,__zero_reg__
 8333               	.LM883:
 8334 3020 04C0      		rjmp .L508
 8335               	.L512:
 8337               	.LM884:
 8338 3022 80E0      		ldi r24,lo8(.LC12)
 8339 3024 90E0      		ldi r25,hi8(.LC12)
 8340 3026 0E94 0000 		call error
 8341               	.L508:
 8343               	.LM885:
 8344 302a 8091 0000 		lds r24,mac_rx_current_frame+37
 8345 302e 9927      		clr r25
 8346 3030 807C      		andi r24,lo8(192)
 8347 3032 9070      		andi r25,hi8(192)
 8348 3034 8034      		cpi r24,64
 8349 3036 9105      		cpc r25,__zero_reg__
 8350 3038 09F4      		brne .+2
 8351 303a 8AC0      		rjmp .L518
 8352 303c 8134      		cpi r24,65
 8353 303e 9105      		cpc r25,__zero_reg__
 8354 3040 24F4      		brge .L519
 8355 3042 892B      		or r24,r25
 8356 3044 09F4      		brne .+2
 8357 3046 81C0      		rjmp .L517
 8358 3048 87C0      		rjmp .L514
 8359               	.L519:
 8360 304a 8038      		cpi r24,128
 8361 304c 9105      		cpc r25,__zero_reg__
 8362 304e 09F4      		brne .+2
 8363 3050 58C0      		rjmp .L516
 8364 3052 803C      		cpi r24,192
 8365 3054 9105      		cpc r25,__zero_reg__
 8366 3056 09F0      		breq .+2
 8367 3058 7FC0      		rjmp .L514
 8369               	.LM886:
 8370 305a 80EC      		ldi r24,lo8(-64)
 8371 305c 8093 0000 		sts mac_rx_current_frame+13,r24
 8373               	.LM887:
 8374 3060 E981      		ldd r30,Y+1
 8375 3062 FA81      		ldd r31,Y+2
 8376 3064 E10F      		add r30,r17
 8377 3066 F11D      		adc r31,__zero_reg__
 8378 3068 1F5F      		subi r17,lo8(-(1))
 8379 306a 8081      		ld r24,Z
 8380 306c 8093 0000 		sts mac_rx_current_frame+24,r24
 8382               	.LM888:
 8383 3070 E981      		ldd r30,Y+1
 8384 3072 FA81      		ldd r31,Y+2
 8385 3074 E10F      		add r30,r17
 8386 3076 F11D      		adc r31,__zero_reg__
 8387 3078 1F5F      		subi r17,lo8(-(1))
 8388 307a 8081      		ld r24,Z
 8389 307c 8093 0000 		sts mac_rx_current_frame+25,r24
 8391               	.LM889:
 8392 3080 E981      		ldd r30,Y+1
 8393 3082 FA81      		ldd r31,Y+2
 8394 3084 E10F      		add r30,r17
 8395 3086 F11D      		adc r31,__zero_reg__
 8396 3088 1F5F      		subi r17,lo8(-(1))
 8397 308a 8081      		ld r24,Z
 8398 308c 8093 0000 		sts mac_rx_current_frame+14,r24
 8400               	.LM890:
 8401 3090 E981      		ldd r30,Y+1
 8402 3092 FA81      		ldd r31,Y+2
 8403 3094 E10F      		add r30,r17
 8404 3096 F11D      		adc r31,__zero_reg__
 8405 3098 1F5F      		subi r17,lo8(-(1))
 8406 309a 8081      		ld r24,Z
 8407 309c 8093 0000 		sts mac_rx_current_frame+15,r24
 8409               	.LM891:
 8410 30a0 E981      		ldd r30,Y+1
 8411 30a2 FA81      		ldd r31,Y+2
 8412 30a4 E10F      		add r30,r17
 8413 30a6 F11D      		adc r31,__zero_reg__
 8414 30a8 1F5F      		subi r17,lo8(-(1))
 8415 30aa 8081      		ld r24,Z
 8416 30ac 8093 0000 		sts mac_rx_current_frame+16,r24
 8418               	.LM892:
 8419 30b0 E981      		ldd r30,Y+1
 8420 30b2 FA81      		ldd r31,Y+2
 8421 30b4 E10F      		add r30,r17
 8422 30b6 F11D      		adc r31,__zero_reg__
 8423 30b8 1F5F      		subi r17,lo8(-(1))
 8424 30ba 8081      		ld r24,Z
 8425 30bc 8093 0000 		sts mac_rx_current_frame+17,r24
 8427               	.LM893:
 8428 30c0 E981      		ldd r30,Y+1
 8429 30c2 FA81      		ldd r31,Y+2
 8430 30c4 E10F      		add r30,r17
 8431 30c6 F11D      		adc r31,__zero_reg__
 8432 30c8 1F5F      		subi r17,lo8(-(1))
 8433 30ca 8081      		ld r24,Z
 8434 30cc 8093 0000 		sts mac_rx_current_frame+18,r24
 8436               	.LM894:
 8437 30d0 E981      		ldd r30,Y+1
 8438 30d2 FA81      		ldd r31,Y+2
 8439 30d4 E10F      		add r30,r17
 8440 30d6 F11D      		adc r31,__zero_reg__
 8441 30d8 1F5F      		subi r17,lo8(-(1))
 8442 30da 8081      		ld r24,Z
 8443 30dc 8093 0000 		sts mac_rx_current_frame+19,r24
 8445               	.LM895:
 8446 30e0 E981      		ldd r30,Y+1
 8447 30e2 FA81      		ldd r31,Y+2
 8448 30e4 E10F      		add r30,r17
 8449 30e6 F11D      		adc r31,__zero_reg__
 8450 30e8 1F5F      		subi r17,lo8(-(1))
 8451 30ea 8081      		ld r24,Z
 8452 30ec 8093 0000 		sts mac_rx_current_frame+20,r24
 8454               	.LM896:
 8455 30f0 E981      		ldd r30,Y+1
 8456 30f2 FA81      		ldd r31,Y+2
 8457 30f4 E10F      		add r30,r17
 8458 30f6 F11D      		adc r31,__zero_reg__
 8459 30f8 1F5F      		subi r17,lo8(-(1))
 8460 30fa 8081      		ld r24,Z
 8461 30fc 8093 0000 		sts mac_rx_current_frame+21,r24
 8463               	.LM897:
 8464 3100 2BC0      		rjmp .L514
 8465               	.L516:
 8467               	.LM898:
 8468 3102 80E8      		ldi r24,lo8(-128)
 8469 3104 8093 0000 		sts mac_rx_current_frame+13,r24
 8471               	.LM899:
 8472 3108 E981      		ldd r30,Y+1
 8473 310a FA81      		ldd r31,Y+2
 8474 310c E10F      		add r30,r17
 8475 310e F11D      		adc r31,__zero_reg__
 8476 3110 1F5F      		subi r17,lo8(-(1))
 8477 3112 8081      		ld r24,Z
 8478 3114 8093 0000 		sts mac_rx_current_frame+24,r24
 8480               	.LM900:
 8481 3118 E981      		ldd r30,Y+1
 8482 311a FA81      		ldd r31,Y+2
 8483 311c E10F      		add r30,r17
 8484 311e F11D      		adc r31,__zero_reg__
 8485 3120 1F5F      		subi r17,lo8(-(1))
 8486 3122 8081      		ld r24,Z
 8487 3124 8093 0000 		sts mac_rx_current_frame+25,r24
 8489               	.LM901:
 8490 3128 E981      		ldd r30,Y+1
 8491 312a FA81      		ldd r31,Y+2
 8492 312c E10F      		add r30,r17
 8493 312e F11D      		adc r31,__zero_reg__
 8494 3130 1F5F      		subi r17,lo8(-(1))
 8495 3132 8081      		ld r24,Z
 8496 3134 8093 0000 		sts mac_rx_current_frame+22,r24
 8498               	.LM902:
 8499 3138 E981      		ldd r30,Y+1
 8500 313a FA81      		ldd r31,Y+2
 8501 313c E10F      		add r30,r17
 8502 313e F11D      		adc r31,__zero_reg__
 8503 3140 1F5F      		subi r17,lo8(-(1))
 8504 3142 8081      		ld r24,Z
 8505 3144 8093 0000 		sts mac_rx_current_frame+23,r24
 8507               	.LM903:
 8508 3148 07C0      		rjmp .L514
 8509               	.L517:
 8511               	.LM904:
 8512 314a 1092 0000 		sts mac_rx_current_frame+13,__zero_reg__
 8514               	.LM905:
 8515 314e 04C0      		rjmp .L514
 8516               	.L518:
 8518               	.LM906:
 8519 3150 80E0      		ldi r24,lo8(.LC12)
 8520 3152 90E0      		ldi r25,hi8(.LC12)
 8521 3154 0E94 0000 		call error
 8522               	.L514:
 8524               	.LM907:
 8525 3158 8091 0000 		lds r24,mac_rx_current_frame+36
 8526 315c 8770      		andi r24,lo8(7)
 8527 315e 8093 0000 		sts mac_rx_current_frame+26,r24
 8529               	.LM908:
 8530 3162 9927      		clr r25
 8531 3164 8130      		cpi r24,1
 8532 3166 9105      		cpc r25,__zero_reg__
 8533 3168 09F4      		brne .+2
 8534 316a BCC0      		rjmp .L534
 8535 316c 8230      		cpi r24,2
 8536 316e 9105      		cpc r25,__zero_reg__
 8537 3170 1CF4      		brge .L552
 8538 3172 892B      		or r24,r25
 8539 3174 29F0      		breq .L521
 8540 3176 4CC1      		rjmp .L520
 8541               	.L552:
 8542 3178 0397      		sbiw r24,3
 8543 317a 09F4      		brne .+2
 8544 317c CDC0      		rjmp .L540
 8545 317e 48C1      		rjmp .L520
 8546               	.L521:
 8548               	.LM909:
 8549 3180 E981      		ldd r30,Y+1
 8550 3182 FA81      		ldd r31,Y+2
 8551 3184 E10F      		add r30,r17
 8552 3186 F11D      		adc r31,__zero_reg__
 8553 3188 1F5F      		subi r17,lo8(-(1))
 8554 318a 8081      		ld r24,Z
 8555 318c 8093 0000 		sts mac_rx_current_frame+144,r24
 8557               	.LM910:
 8558 3190 E981      		ldd r30,Y+1
 8559 3192 FA81      		ldd r31,Y+2
 8560 3194 E10F      		add r30,r17
 8561 3196 F11D      		adc r31,__zero_reg__
 8562 3198 1F5F      		subi r17,lo8(-(1))
 8563 319a 8081      		ld r24,Z
 8564 319c 8093 0000 		sts mac_rx_current_frame+145,r24
 8566               	.LM911:
 8567 31a0 E981      		ldd r30,Y+1
 8568 31a2 FA81      		ldd r31,Y+2
 8569 31a4 E10F      		add r30,r17
 8570 31a6 F11D      		adc r31,__zero_reg__
 8571 31a8 1F5F      		subi r17,lo8(-(1))
 8572 31aa 8081      		ld r24,Z
 8573 31ac 8093 0000 		sts mac_rx_current_frame+180,r24
 8575               	.LM912:
 8576 31b0 E981      		ldd r30,Y+1
 8577 31b2 FA81      		ldd r31,Y+2
 8578 31b4 E10F      		add r30,r17
 8579 31b6 F11D      		adc r31,__zero_reg__
 8580 31b8 1F5F      		subi r17,lo8(-(1))
 8581 31ba 8081      		ld r24,Z
 8582 31bc 8093 0000 		sts mac_rx_current_frame+146,r24
 8584               	.LM913:
 8585 31c0 282F      		mov r18,r24
 8586 31c2 2770      		andi r18,lo8(7)
 8587 31c4 2093 0000 		sts mac_rx_current_frame+147,r18
 8589               	.LM914:
 8590 31c8 9927      		clr r25
 8591 31ca 8077      		andi r24,lo8(112)
 8592 31cc 9070      		andi r25,hi8(112)
 8593 31ce 34E0      		ldi r19,4
 8594 31d0 9595      	1:	asr r25
 8595 31d2 8795      		ror r24
 8596 31d4 3A95      		dec r19
 8597 31d6 E1F7      		brne 1b
 8598 31d8 8093 0000 		sts mac_rx_current_frame+148,r24
 8600               	.LM915:
 8601 31dc 90E0      		ldi r25,lo8(0)
 8602 31de 9217      		cp r25,r18
 8603 31e0 E0F4      		brsh .L555
 8604               	.L525:
 8606               	.LM916:
 8607 31e2 E92F      		mov r30,r25
 8608 31e4 FF27      		clr r31
 8609 31e6 EE0F      		add r30,r30
 8610 31e8 FF1F      		adc r31,r31
 8611 31ea E050      		subi r30,lo8(-(mac_rx_current_frame))
 8612 31ec F040      		sbci r31,hi8(-(mac_rx_current_frame))
 8613 31ee EB56      		subi r30,lo8(-(149))
 8614 31f0 FF4F      		sbci r31,hi8(-(149))
 8615 31f2 A981      		ldd r26,Y+1
 8616 31f4 BA81      		ldd r27,Y+2
 8617 31f6 A10F      		add r26,r17
 8618 31f8 B11D      		adc r27,__zero_reg__
 8619 31fa 1F5F      		subi r17,lo8(-(1))
 8620 31fc 8C91      		ld r24,X
 8621 31fe 8193      		st Z+,r24
 8623               	.LM917:
 8624 3200 DF01      		movw r26,r30
 8625 3202 E981      		ldd r30,Y+1
 8626 3204 FA81      		ldd r31,Y+2
 8627 3206 E10F      		add r30,r17
 8628 3208 F11D      		adc r31,__zero_reg__
 8629 320a 1F5F      		subi r17,lo8(-(1))
 8630 320c 8081      		ld r24,Z
 8631 320e 8C93      		st X,r24
 8633               	.LM918:
 8634 3210 9F5F      		subi r25,lo8(-(1))
 8635 3212 8091 0000 		lds r24,mac_rx_current_frame+147
 8636 3216 9817      		cp r25,r24
 8637 3218 20F3      		brlo .L525
 8638               	.L555:
 8640               	.LM919:
 8641 321a 90E0      		ldi r25,lo8(0)
 8642               	.L562:
 8643 321c 8091 0000 		lds r24,mac_rx_current_frame+148
 8644 3220 9817      		cp r25,r24
 8645 3222 08F0      		brlo .+2
 8646 3224 45C0      		rjmp .L557
 8648               	.LM920:
 8649 3226 A92F      		mov r26,r25
 8650 3228 BB27      		clr r27
 8651 322a 83E0      		ldi r24,3
 8652 322c AA0F      	1:	lsl r26
 8653 322e BB1F      		rol r27
 8654 3230 8A95      		dec r24
 8655 3232 E1F7      		brne 1b
 8656 3234 A050      		subi r26,lo8(-(mac_rx_current_frame))
 8657 3236 B040      		sbci r27,hi8(-(mac_rx_current_frame))
 8658 3238 A756      		subi r26,lo8(-(153))
 8659 323a BF4F      		sbci r27,hi8(-(153))
 8660 323c E981      		ldd r30,Y+1
 8661 323e FA81      		ldd r31,Y+2
 8662 3240 E10F      		add r30,r17
 8663 3242 F11D      		adc r31,__zero_reg__
 8664 3244 1F5F      		subi r17,lo8(-(1))
 8665 3246 8081      		ld r24,Z
 8666 3248 8D93      		st X+,r24
 8668               	.LM921:
 8669 324a E981      		ldd r30,Y+1
 8670 324c FA81      		ldd r31,Y+2
 8671 324e E10F      		add r30,r17
 8672 3250 F11D      		adc r31,__zero_reg__
 8673 3252 1F5F      		subi r17,lo8(-(1))
 8674 3254 8081      		ld r24,Z
 8675 3256 8D93      		st X+,r24
 8677               	.LM922:
 8678 3258 E981      		ldd r30,Y+1
 8679 325a FA81      		ldd r31,Y+2
 8680 325c E10F      		add r30,r17
 8681 325e F11D      		adc r31,__zero_reg__
 8682 3260 1F5F      		subi r17,lo8(-(1))
 8683 3262 8081      		ld r24,Z
 8684 3264 8D93      		st X+,r24
 8686               	.LM923:
 8687 3266 E981      		ldd r30,Y+1
 8688 3268 FA81      		ldd r31,Y+2
 8689 326a E10F      		add r30,r17
 8690 326c F11D      		adc r31,__zero_reg__
 8691 326e 1F5F      		subi r17,lo8(-(1))
 8692 3270 8081      		ld r24,Z
 8693 3272 8D93      		st X+,r24
 8695               	.LM924:
 8696 3274 E981      		ldd r30,Y+1
 8697 3276 FA81      		ldd r31,Y+2
 8698 3278 E10F      		add r30,r17
 8699 327a F11D      		adc r31,__zero_reg__
 8700 327c 1F5F      		subi r17,lo8(-(1))
 8701 327e 8081      		ld r24,Z
 8702 3280 8D93      		st X+,r24
 8704               	.LM925:
 8705 3282 E981      		ldd r30,Y+1
 8706 3284 FA81      		ldd r31,Y+2
 8707 3286 E10F      		add r30,r17
 8708 3288 F11D      		adc r31,__zero_reg__
 8709 328a 1F5F      		subi r17,lo8(-(1))
 8710 328c 8081      		ld r24,Z
 8711 328e 8D93      		st X+,r24
 8713               	.LM926:
 8714 3290 E981      		ldd r30,Y+1
 8715 3292 FA81      		ldd r31,Y+2
 8716 3294 E10F      		add r30,r17
 8717 3296 F11D      		adc r31,__zero_reg__
 8718 3298 1F5F      		subi r17,lo8(-(1))
 8719 329a 8081      		ld r24,Z
 8720 329c 8D93      		st X+,r24
 8722               	.LM927:
 8723 329e E981      		ldd r30,Y+1
 8724 32a0 FA81      		ldd r31,Y+2
 8725 32a2 E10F      		add r30,r17
 8726 32a4 F11D      		adc r31,__zero_reg__
 8727 32a6 1F5F      		subi r17,lo8(-(1))
 8728 32a8 8081      		ld r24,Z
 8729 32aa 8C93      		st X,r24
 8731               	.LM928:
 8732 32ac 9F5F      		subi r25,lo8(-(1))
 8733 32ae B6CF      		rjmp .L562
 8734               	.L557:
 8736               	.LM929:
 8737 32b0 E981      		ldd r30,Y+1
 8738 32b2 FA81      		ldd r31,Y+2
 8739 32b4 E10F      		add r30,r17
 8740 32b6 F11D      		adc r31,__zero_reg__
 8741 32b8 1F5F      		subi r17,lo8(-(1))
 8742 32ba A081      		ld r26,Z
 8743 32bc A093 0000 		sts mac_rx_current_frame+40,r26
 8745               	.LM930:
 8746 32c0 AA23      		tst r26
 8747 32c2 09F4      		brne .+2
 8748 32c4 A5C0      		rjmp .L520
 8749 32c6 20E0      		ldi r18,lo8(mac_rx_current_frame+41)
 8750 32c8 30E0      		ldi r19,hi8(mac_rx_current_frame+41)
 8751 32ca 9A2F      		mov r25,r26
 8752               	.L533:
 8754               	.LM931:
 8755 32cc E981      		ldd r30,Y+1
 8756 32ce FA81      		ldd r31,Y+2
 8757 32d0 E10F      		add r30,r17
 8758 32d2 F11D      		adc r31,__zero_reg__
 8759 32d4 1F5F      		subi r17,lo8(-(1))
 8760 32d6 8081      		ld r24,Z
 8761 32d8 F901      		movw r30,r18
 8762 32da 8193      		st Z+,r24
 8763 32dc 9F01      		movw r18,r30
 8765               	.LM932:
 8766 32de 9150      		subi r25,lo8(-(-1))
 8767 32e0 A9F7      		brne .L533
 8769               	.LM933:
 8770 32e2 96C0      		rjmp .L520
 8771               	.L534:
 8773               	.LM934:
 8774 32e4 E981      		ldd r30,Y+1
 8775 32e6 FA81      		ldd r31,Y+2
 8776 32e8 E10F      		add r30,r17
 8777 32ea F11D      		adc r31,__zero_reg__
 8778 32ec 1F5F      		subi r17,lo8(-(1))
 8779 32ee A081      		ld r26,Z
 8780 32f0 A093 0000 		sts mac_rx_current_frame+39,r26
 8782               	.LM935:
 8783 32f4 AA23      		tst r26
 8784 32f6 09F4      		brne .+2
 8785 32f8 8BC0      		rjmp .L520
 8786 32fa 20E0      		ldi r18,lo8(mac_rx_current_frame+41)
 8787 32fc 30E0      		ldi r19,hi8(mac_rx_current_frame+41)
 8788 32fe 9A2F      		mov r25,r26
 8789               	.L538:
 8791               	.LM936:
 8792 3300 E981      		ldd r30,Y+1
 8793 3302 FA81      		ldd r31,Y+2
 8794 3304 E10F      		add r30,r17
 8795 3306 F11D      		adc r31,__zero_reg__
 8796 3308 1F5F      		subi r17,lo8(-(1))
 8797 330a 8081      		ld r24,Z
 8798 330c F901      		movw r30,r18
 8799 330e 8193      		st Z+,r24
 8800 3310 9F01      		movw r18,r30
 8802               	.LM937:
 8803 3312 9150      		subi r25,lo8(-(-1))
 8804 3314 A9F7      		brne .L538
 8806               	.LM938:
 8807 3316 7CC0      		rjmp .L520
 8808               	.L540:
 8810               	.LM939:
 8811 3318 E981      		ldd r30,Y+1
 8812 331a FA81      		ldd r31,Y+2
 8813 331c E10F      		add r30,r17
 8814 331e F11D      		adc r31,__zero_reg__
 8815 3320 1F5F      		subi r17,lo8(-(1))
 8816 3322 8081      		ld r24,Z
 8817 3324 8093 0000 		sts mac_rx_current_frame+27,r24
 8819               	.LM940:
 8820 3328 9927      		clr r25
 8821 332a 8230      		cpi r24,2
 8822 332c 9105      		cpc r25,__zero_reg__
 8823 332e B1F0      		breq .L543
 8824 3330 8330      		cpi r24,3
 8825 3332 9105      		cpc r25,__zero_reg__
 8826 3334 1CF4      		brge .L551
 8827 3336 0197      		sbiw r24,1
 8828 3338 41F0      		breq .L542
 8829 333a 6AC0      		rjmp .L520
 8830               	.L551:
 8831 333c 8330      		cpi r24,3
 8832 333e 9105      		cpc r25,__zero_reg__
 8833 3340 09F4      		brne .+2
 8834 3342 5EC0      		rjmp .L547
 8835 3344 0897      		sbiw r24,8
 8836 3346 19F1      		breq .L545
 8837 3348 63C0      		rjmp .L520
 8838               	.L542:
 8840               	.LM941:
 8841 334a E981      		ldd r30,Y+1
 8842 334c FA81      		ldd r31,Y+2
 8843 334e E10F      		add r30,r17
 8844 3350 F11D      		adc r31,__zero_reg__
 8845 3352 1F5F      		subi r17,lo8(-(1))
 8846 3354 8081      		ld r24,Z
 8847 3356 8093 0000 		sts mac_rx_current_frame+143,r24
 8849               	.LM942:
 8850 335a 5AC0      		rjmp .L520
 8851               	.L543:
 8853               	.LM943:
 8854 335c E981      		ldd r30,Y+1
 8855 335e FA81      		ldd r31,Y+2
 8856 3360 E10F      		add r30,r17
 8857 3362 F11D      		adc r31,__zero_reg__
 8858 3364 1F5F      		subi r17,lo8(-(1))
 8859 3366 8081      		ld r24,Z
 8860 3368 8093 0000 		sts mac_rx_current_frame+169,r24
 8862               	.LM944:
 8863 336c E981      		ldd r30,Y+1
 8864 336e FA81      		ldd r31,Y+2
 8865 3370 E10F      		add r30,r17
 8866 3372 F11D      		adc r31,__zero_reg__
 8867 3374 1F5F      		subi r17,lo8(-(1))
 8868 3376 8081      		ld r24,Z
 8869 3378 8093 0000 		sts mac_rx_current_frame+170,r24
 8871               	.LM945:
 8872 337c E981      		ldd r30,Y+1
 8873 337e FA81      		ldd r31,Y+2
 8874 3380 E10F      		add r30,r17
 8875 3382 F11D      		adc r31,__zero_reg__
 8876 3384 1F5F      		subi r17,lo8(-(1))
 8877 3386 8081      		ld r24,Z
 8878 3388 8093 0000 		sts mac_rx_current_frame+171,r24
 8880               	.LM946:
 8881 338c 41C0      		rjmp .L520
 8882               	.L545:
 8884               	.LM947:
 8885 338e E981      		ldd r30,Y+1
 8886 3390 FA81      		ldd r31,Y+2
 8887 3392 E10F      		add r30,r17
 8888 3394 F11D      		adc r31,__zero_reg__
 8889 3396 1F5F      		subi r17,lo8(-(1))
 8890 3398 8081      		ld r24,Z
 8891 339a 8093 0000 		sts mac_rx_current_frame+173,r24
 8893               	.LM948:
 8894 339e E981      		ldd r30,Y+1
 8895 33a0 FA81      		ldd r31,Y+2
 8896 33a2 E10F      		add r30,r17
 8897 33a4 F11D      		adc r31,__zero_reg__
 8898 33a6 1F5F      		subi r17,lo8(-(1))
 8899 33a8 8081      		ld r24,Z
 8900 33aa 8093 0000 		sts mac_rx_current_frame+174,r24
 8902               	.LM949:
 8903 33ae E981      		ldd r30,Y+1
 8904 33b0 FA81      		ldd r31,Y+2
 8905 33b2 E10F      		add r30,r17
 8906 33b4 F11D      		adc r31,__zero_reg__
 8907 33b6 1F5F      		subi r17,lo8(-(1))
 8908 33b8 8081      		ld r24,Z
 8909 33ba 8093 0000 		sts mac_rx_current_frame+175,r24
 8911               	.LM950:
 8912 33be E981      		ldd r30,Y+1
 8913 33c0 FA81      		ldd r31,Y+2
 8914 33c2 E10F      		add r30,r17
 8915 33c4 F11D      		adc r31,__zero_reg__
 8916 33c6 1F5F      		subi r17,lo8(-(1))
 8917 33c8 8081      		ld r24,Z
 8918 33ca 8093 0000 		sts mac_rx_current_frame+176,r24
 8920               	.LM951:
 8921 33ce E981      		ldd r30,Y+1
 8922 33d0 FA81      		ldd r31,Y+2
 8923 33d2 E10F      		add r30,r17
 8924 33d4 F11D      		adc r31,__zero_reg__
 8925 33d6 1F5F      		subi r17,lo8(-(1))
 8926 33d8 8081      		ld r24,Z
 8927 33da 8093 0000 		sts mac_rx_current_frame+177,r24
 8929               	.LM952:
 8930 33de E981      		ldd r30,Y+1
 8931 33e0 FA81      		ldd r31,Y+2
 8932 33e2 E10F      		add r30,r17
 8933 33e4 F11D      		adc r31,__zero_reg__
 8934 33e6 1F5F      		subi r17,lo8(-(1))
 8935 33e8 8081      		ld r24,Z
 8936 33ea 8093 0000 		sts mac_rx_current_frame+178,r24
 8938               	.LM953:
 8939 33ee E981      		ldd r30,Y+1
 8940 33f0 FA81      		ldd r31,Y+2
 8941 33f2 E10F      		add r30,r17
 8942 33f4 F11D      		adc r31,__zero_reg__
 8943 33f6 1F5F      		subi r17,lo8(-(1))
 8944 33f8 8081      		ld r24,Z
 8945 33fa 8093 0000 		sts mac_rx_current_frame+179,r24
 8947               	.LM954:
 8948 33fe 08C0      		rjmp .L520
 8949               	.L547:
 8951               	.LM955:
 8952 3400 E981      		ldd r30,Y+1
 8953 3402 FA81      		ldd r31,Y+2
 8954 3404 E10F      		add r30,r17
 8955 3406 F11D      		adc r31,__zero_reg__
 8956 3408 1F5F      		subi r17,lo8(-(1))
 8957 340a 8081      		ld r24,Z
 8958 340c 8093 0000 		sts mac_rx_current_frame+172,r24
 8959               	.L520:
 8961               	.LM956:
 8962 3410 812F      		mov r24,r17
 8963 3412 9927      		clr r25
 8964 3414 0197      		sbiw r24,1
 8965 3416 2091 0000 		lds r18,mac_rx_current_frame+29
 8966 341a 3327      		clr r19
 8967 341c 8217      		cp r24,r18
 8968 341e 9307      		cpc r25,r19
 8969 3420 29F0      		breq .L553
 8971               	.LM957:
 8972 3422 80E0      		ldi r24,lo8(.LC24)
 8973 3424 90E0      		ldi r25,hi8(.LC24)
 8974 3426 0E94 0000 		call error
 8976               	.LM958:
 8977 342a 05C0      		rjmp .L506
 8978               	.L553:
 8980               	.LM959:
 8981 342c CE01      		movw r24,r28
 8982 342e 0E94 0000 		call remove_from_rx_buffer
 8984               	.LM960:
 8985 3432 0E94 0000 		call mac_frame_rcvd
 8986               	.L506:
 8987               	/* epilogue: frame size=0 */
 8988 3436 DF91      		pop r29
 8989 3438 CF91      		pop r28
 8990 343a 1F91      		pop r17
 8991 343c 0895      		ret
 8992               	/* epilogue end (size=4) */
 8993               	/* function mac_get_received_frame size 717 (710) */
 9000               	.Lscope58:
 9002               	.global	initial_pending_queue
 9004               	initial_pending_queue:
 9006               	.LM961:
 9007               	/* prologue: frame size=0 */
 9008               	/* prologue end (size=0) */
 9009               	/* epilogue: frame size=0 */
 9010 343e 0895      		ret
 9011               	/* epilogue end (size=1) */
 9012               	/* function initial_pending_queue size 1 (0) */
 9014               	.Lscope59:
 9016               	.global	random_generate
 9018               	random_generate:
2349:mac.c         **** 
2350:mac.c         **** 
2351:mac.c         **** 
2352:mac.c         **** uint8_t   csma_state;
2353:mac.c         **** #define  csma_state_initial   0
2354:mac.c         **** #define   csma_state_delaying   1
2355:mac.c         **** 
2356:mac.c         **** 
2357:mac.c         **** TX_BUFFER   * temp_csma_ca_frame;
2358:mac.c         **** uint8_t BE;
2359:mac.c         **** uint8_t NB;
2360:mac.c         **** uint8_t CW;   
2361:mac.c         **** 
2362:mac.c         **** 
2363:mac.c         **** uint8_t  random_generate(void)
2364:mac.c         **** {
 9020               	.LM962:
 9021               	/* prologue: frame size=0 */
 9022               	/* prologue end (size=0) */
2365:mac.c         ****      return (TCNT1&0x07);
 9024               	.LM963:
 9025 3440 8CB5      		in r24,76-0x20
 9026 3442 9DB5      		in r25,(76)+1-0x20
 9027 3444 9927      		clr r25
2366:mac.c         **** }
 9029               	.LM964:
 9030 3446 8770      		andi r24,lo8(7)
 9031 3448 9070      		andi r25,hi8(7)
 9032               	/* epilogue: frame size=0 */
 9033 344a 0895      		ret
 9034               	/* epilogue end (size=1) */
 9035               	/* function random_generate size 6 (5) */
 9037               	.Lscope60:
 9039               	.global	do_backoff
 9041               	do_backoff:
2367:mac.c         **** /*
2368:mac.c         **** uint8_t  wait_for_backoff_boundary(void)
2369:mac.c         **** {
2370:mac.c         **** 
2371:mac.c         **** 
2372:mac.c         ****        uint32_t  delta; 
2373:mac.c         **** 	   
2374:mac.c         ****     	do{
2375:mac.c         **** 	    MAC_CURRENT_TICKS=systime32();
2376:mac.c         **** 	    delta=(MAC_CURRENT_TICKS>MAC_OBJECT_CAP_START_TICKS)?(MAC_CURRENT_TICKS-MAC_OBJECT_CAP_START_T
2377:mac.c         **** 	    if(phy_channel_state!=DOINGCSMA_CA)
2378:mac.c         ****                  return 0;
2379:mac.c         **** 	}while(!(delta%(2*aUnitBackoffPeriod)));
2380:mac.c         **** 	return 1;	
2381:mac.c         **** 	
2382:mac.c         **** }
2383:mac.c         **** */
2384:mac.c         **** uint8_t  do_backoff(void)
2385:mac.c         **** {
 9043               	.LM965:
 9044               	/* prologue: frame size=0 */
 9045               	/* prologue end (size=0) */
2386:mac.c         ****       uint8_t  random_backoff;
2387:mac.c         ****       uint32_t   timing_symbol_value;	  
2388:mac.c         ****       random_backoff=random_generate();
 9047               	.LM966:
 9048 344c 0E94 0000 		call random_generate
 9049 3450 282F      		mov r18,r24
2389:mac.c         ****       if(random_backoff==0)
 9051               	.LM967:
 9052 3452 8823      		tst r24
 9053 3454 29F4      		brne .L566
2390:mac.c         ****             OS_post(CSMA_CA_DOING);
 9055               	.LM968:
 9056 3456 80E0      		ldi r24,lo8(pm(CSMA_CA_DOING))
 9057 3458 90E0      		ldi r25,hi8(pm(CSMA_CA_DOING))
 9058 345a 0E94 0000 		call OS_post
 9059 345e 0895      		ret
 9060               	.L566:
2391:mac.c         ****       else
2392:mac.c         ****       	{
2393:mac.c         ****             random_backoff=(random_backoff<<BE)-random_backoff;	  
 9062               	.LM969:
 9063 3460 9927      		clr r25
 9064 3462 0090 0000 		lds r0,BE
 9065 3466 02C0      		rjmp 2f
 9066 3468 880F      	1:	lsl r24
 9067 346a 991F      		rol r25
 9068 346c 0A94      	2:	dec r0
 9069 346e E2F7      		brpl 1b
 9070 3470 821B      		sub r24,r18
 9071 3472 282F      		mov r18,r24
2394:mac.c         ****             timing_symbol_value=random_backoff*aUnitBackoffPeriod; 	
 9073               	.LM970:
 9074 3474 85E0      		ldi r24,lo8(5)
 9075 3476 289F      		mul r18,r24
 9076 3478 C001      		movw r24,r0
 9077 347a 1124      		clr r1
 9078 347c AA27      		clr r26
 9079 347e 97FD      		sbrc r25,7
 9080 3480 A095      		com r26
 9081 3482 BA2F      		mov r27,r26
2395:mac.c         ****             head_of_systimer_queue=systimer_start_task(head_of_systimer_queue, CSMA_TIMING, timing_
 9083               	.LM971:
 9084 3484 9C01      		movw r18,r24
 9085 3486 AD01      		movw r20,r26
 9086 3488 63E0      		ldi r22,lo8(3)
 9087 348a 8091 0000 		lds r24,head_of_systimer_queue
 9088 348e 9091 0000 		lds r25,(head_of_systimer_queue)+1
 9089 3492 0E94 0000 		call systimer_start_task
 9090 3496 9093 0000 		sts (head_of_systimer_queue)+1,r25
 9091 349a 8093 0000 		sts head_of_systimer_queue,r24
2396:mac.c         ****       	}		
2397:mac.c         **** }
 9093               	.LM972:
 9094 349e 0895      		ret
 9095               	/* epilogue: frame size=0 */
 9096 34a0 0895      		ret
 9097               	/* epilogue end (size=1) */
 9098               	/* function do_backoff size 43 (42) */
 9104               	.Lscope61:
 9106               	.global	csma_initial
 9108               	csma_initial:
2398:mac.c         **** 
2399:mac.c         **** 
2400:mac.c         **** uint8_t  csma_initial(void)
2401:mac.c         **** {
 9110               	.LM973:
 9111               	/* prologue: frame size=0 */
 9112 34a2 EF92      		push r14
 9113 34a4 FF92      		push r15
 9114 34a6 0F93      		push r16
 9115 34a8 1F93      		push r17
 9116 34aa CF93      		push r28
 9117 34ac DF93      		push r29
 9118               	/* prologue end (size=6) */
2402:mac.c         **** 
2403:mac.c         ****        uint32_t  wait_for_boundary_time;
2404:mac.c         **** 	uint32_t  delta_time;   
2405:mac.c         **** 	uint8_t    random_backoff;   
2406:mac.c         **** 	uint32_t   timing_symbol_value;
2407:mac.c         ****        
2408:mac.c         **** 	
2409:mac.c         **** 	//±äÁ¿µÄ³õÊ¼»¯
2410:mac.c         ****        NB=0;
 9120               	.LM974:
 9121 34ae 1092 0000 		sts NB,__zero_reg__
2411:mac.c         **** 	CW=1;
 9123               	.LM975:
 9124 34b2 81E0      		ldi r24,lo8(1)
 9125 34b4 8093 0000 		sts CW,r24
2412:mac.c         **** 	if(mac_pib_data.macBattLifeExt==FALSE)
 9127               	.LM976:
 9128 34b8 8091 0000 		lds r24,mac_pib_data+3
 9129 34bc 9091 0000 		lds r25,mac_pib_data+27
 9130 34c0 8823      		tst r24
 9131 34c2 19F4      		brne .L569
2413:mac.c         **** 		BE=mac_pib_data.macMinBE;
 9133               	.LM977:
 9134 34c4 9093 0000 		sts BE,r25
 9135 34c8 06C0      		rjmp .L570
 9136               	.L569:
2414:mac.c         **** 	else
2415:mac.c         **** 		BE=(mac_pib_data.macMinBE>2)? 2:mac_pib_data.macMinBE;
 9138               	.LM978:
 9139 34ca 892F      		mov r24,r25
 9140 34cc 9330      		cpi r25,lo8(3)
 9141 34ce 08F0      		brlo .L571
 9142 34d0 82E0      		ldi r24,lo8(2)
 9143               	.L571:
 9144 34d2 8093 0000 		sts BE,r24
 9145               	.L570:
2416:mac.c         ****        phy_channel_state=DOINGCSMA_CA;
 9147               	.LM979:
 9148 34d6 81E0      		ldi r24,lo8(1)
 9149 34d8 8093 0000 		sts phy_channel_state,r24
2417:mac.c         **** 	//¼ÆËã¶¨Ê±Æ÷µÄ¶¨Ê±Öµ,²¢Æô¶¯¶¨Ê±
2418:mac.c         **** 	MAC_CURRENT_TICKS=systime32();
 9151               	.LM980:
 9152 34dc 0E94 0000 		call systime32
 9153 34e0 DC01      		movw r26,r24
 9154 34e2 CB01      		movw r24,r22
 9155 34e4 8093 0000 		sts MAC_CURRENT_TICKS,r24
 9156 34e8 9093 0000 		sts (MAC_CURRENT_TICKS)+1,r25
 9157 34ec A093 0000 		sts (MAC_CURRENT_TICKS)+2,r26
 9158 34f0 B093 0000 		sts (MAC_CURRENT_TICKS)+3,r27
2419:mac.c         **** 
2420:mac.c         **** 	//¶¨Î»µ½backoffµÄ±ß½ç
2421:mac.c         ****        delta_time=(MAC_CURRENT_TICKS>MAC_OBJECT_CAP_START_TICKS)?(MAC_CURRENT_TICKS-MAC_OBJECT_CAP_
 9160               	.LM981:
 9161 34f4 2091 0000 		lds r18,MAC_OBJECT_CAP_START_TICKS
 9162 34f8 3091 0000 		lds r19,(MAC_OBJECT_CAP_START_TICKS)+1
 9163 34fc 4091 0000 		lds r20,(MAC_OBJECT_CAP_START_TICKS)+2
 9164 3500 5091 0000 		lds r21,(MAC_OBJECT_CAP_START_TICKS)+3
 9165 3504 FD01      		movw r30,r26
 9166 3506 EC01      		movw r28,r24
 9167 3508 C21B      		sub r28,r18
 9168 350a D30B      		sbc r29,r19
 9169 350c E40B      		sbc r30,r20
 9170 350e F50B      		sbc r31,r21
 9171 3510 2817      		cp r18,r24
 9172 3512 3907      		cpc r19,r25
 9173 3514 4A07      		cpc r20,r26
 9174 3516 5B07      		cpc r21,r27
 9175 3518 20F0      		brlo .L572
 9176 351a C050      		subi r28,lo8(-(1073741824))
 9177 351c D040      		sbci r29,hi8(-(1073741824))
 9178 351e E040      		sbci r30,hlo8(-(1073741824))
 9179 3520 F04C      		sbci r31,hhi8(-(1073741824))
 9180               	.L572:
2422:mac.c         **** 
2423:mac.c         **** 	//×ª»¯³ÉÊµ¼ÊµÄ·ûºÅÊýÄ¿  
2424:mac.c         **** 	delta_time=delta_time>>1;
 9182               	.LM982:
 9183 3522 F695      		lsr r31
 9184 3524 E795      		ror r30
 9185 3526 D795      		ror r29
 9186 3528 C795      		ror r28
2425:mac.c         **** 	wait_for_boundary_time=aUnitBackoffPeriod-(delta_time%aUnitBackoffPeriod);
 9188               	.LM983:
 9189 352a 45E0      		ldi r20,lo8(5)
 9190 352c E42E      		mov r14,r20
 9191 352e F12C      		mov r15,__zero_reg__
 9192 3530 012D      		mov r16,__zero_reg__
 9193 3532 112D      		mov r17,__zero_reg__
 9194 3534 BE01      		movw r22,r28
 9195 3536 CF01      		movw r24,r30
 9196 3538 A801      		movw r20,r16
 9197 353a 9701      		movw r18,r14
 9198 353c 0E94 0000 		call __udivmodsi4
 9199 3540 DC01      		movw r26,r24
 9200 3542 CB01      		movw r24,r22
 9201 3544 E81A      		sub r14,r24
 9202 3546 F90A      		sbc r15,r25
 9203 3548 0A0B      		sbc r16,r26
 9204 354a 1B0B      		sbc r17,r27
2426:mac.c         **** 	random_backoff=random_generate();
 9206               	.LM984:
 9207 354c 0E94 0000 		call random_generate
 9208 3550 282F      		mov r18,r24
2427:mac.c         **** 	random_backoff=(random_backoff<<BE)-random_backoff;
 9210               	.LM985:
 9211 3552 9927      		clr r25
 9212 3554 0090 0000 		lds r0,BE
 9213 3558 02C0      		rjmp 2f
 9214 355a 880F      	1:	lsl r24
 9215 355c 991F      		rol r25
 9216 355e 0A94      	2:	dec r0
 9217 3560 E2F7      		brpl 1b
 9218 3562 821B      		sub r24,r18
 9219 3564 282F      		mov r18,r24
2428:mac.c         **** 	timing_symbol_value=wait_for_boundary_time+random_backoff*aUnitBackoffPeriod;
 9221               	.LM986:
 9222 3566 85E0      		ldi r24,lo8(5)
 9223 3568 289F      		mul r18,r24
 9224 356a C001      		movw r24,r0
 9225 356c 1124      		clr r1
 9226 356e AA27      		clr r26
 9227 3570 97FD      		sbrc r25,7
 9228 3572 A095      		com r26
 9229 3574 BA2F      		mov r27,r26
 9230 3576 E80E      		add r14,r24
 9231 3578 F91E      		adc r15,r25
 9232 357a 0A1F      		adc r16,r26
 9233 357c 1B1F      		adc r17,r27
2429:mac.c         **** 	head_of_systimer_queue=systimer_start_task(head_of_systimer_queue, CSMA_TIMING, timing_symbol_valu
 9235               	.LM987:
 9236 357e A801      		movw r20,r16
 9237 3580 9701      		movw r18,r14
 9238 3582 63E0      		ldi r22,lo8(3)
 9239 3584 8091 0000 		lds r24,head_of_systimer_queue
 9240 3588 9091 0000 		lds r25,(head_of_systimer_queue)+1
 9241 358c 0E94 0000 		call systimer_start_task
 9242 3590 9093 0000 		sts (head_of_systimer_queue)+1,r25
 9243 3594 8093 0000 		sts head_of_systimer_queue,r24
 9244               	/* epilogue: frame size=0 */
 9245 3598 DF91      		pop r29
 9246 359a CF91      		pop r28
 9247 359c 1F91      		pop r17
 9248 359e 0F91      		pop r16
 9249 35a0 FF90      		pop r15
 9250 35a2 EF90      		pop r14
 9251 35a4 0895      		ret
 9252               	/* epilogue end (size=7) */
 9253               	/* function csma_initial size 130 (117) */
 9260               	.Lscope62:
 9261               		.data
 9262               	.LC25:
 9263 03ec 0A2D 2D2D 		.string	"\n---csma failure----"
 9263      6373 6D61 
 9263      2066 6169 
 9263      6C75 7265 
 9263      2D2D 2D2D 
 9264               		.text
 9266               	.global	failure_to_tx_with_csma
 9268               	failure_to_tx_with_csma:
2430:mac.c         ****        
2431:mac.c         **** 	//printf("\n----csma timing  start--time is %08lx---\n",systime32());
2432:mac.c         **** }
2433:mac.c         **** //bool  a;
2434:mac.c         **** void CSMA_CA_DOING(void)
2435:mac.c         **** {
2436:mac.c         ****         uint8_t  return_status;
2437:mac.c         **** 	 uint8_t  cca_result;
2438:mac.c         **** 	 uint32_t random_backoff;
2439:mac.c         **** 	 uint32_t  csma_ca_send_timestamp;
2440:mac.c         **** 	 uint32_t   now_time_ticks;
2441:mac.c         **** 	 uint16_t   timinglength;  
2442:mac.c         ****         switch(csma_state)
2443:mac.c         ****         	{
2444:mac.c         **** 		    case  csma_state_initial:
2445:mac.c         **** 				return_status=csma_initial();
2446:mac.c         **** 				//printf("\ncsma is init\n");
2447:mac.c         **** 				csma_state=csma_state_delaying;
2448:mac.c         **** 				break;
2449:mac.c         **** 		    case  csma_state_delaying:
2450:mac.c         **** 				cca_result=PLME_CCA_request();
2451:mac.c         **** 				Leds_redToggle();
2452:mac.c         **** 				if((phy_channel_state!=DOINGCSMA_CA))
2453:mac.c         **** 					{
2454:mac.c         **** 					   //free(temp_csma_ca_frame);
2455:mac.c         **** 					   failure_to_tx_with_csma();
2456:mac.c         **** 					   return;
2457:mac.c         **** 					}  
2458:mac.c         **** 				if((cca_result==IDLE)&&(CW!=0))
2459:mac.c         **** 					{
2460:mac.c         **** 					    csma_state=csma_state_delaying;
2461:mac.c         **** 					    head_of_systimer_queue=systimer_start_task(head_of_systimer_queue, CSMA_TIMING, aUnitBacko
2462:mac.c         **** 					    CW--;	
2463:mac.c         **** 					}
2464:mac.c         **** 				else if((cca_result==IDLE)&&(CW==0))
2465:mac.c         **** 					{
2466:mac.c         **** 					    //³É¹¦·¢ËÍ
2467:mac.c         **** 					    //printf("\nthe frame length is %d\n",temp_csma_ca_frame->frameLength);
2468:mac.c         **** 					    csma_ca_send_timestamp=PD_DATA_request(temp_csma_ca_frame->frameLength, temp_csma_ca_frame
2469:mac.c         **** 					    phy_channel_state=PHY_IDLE;
2470:mac.c         **** 					    Leds_redToggle();
2471:mac.c         **** 				           if(temp_csma_ca_frame->IsNeedAcked)	
2472:mac.c         **** 				           	{
2473:mac.c         **** 				           	      phy_channel_state=WAITING_FOR_ACK;
2474:mac.c         **** 						      PLME_SET_TRX_STATE_request(RX_ON);
2475:mac.c         **** 						      //wait_for_ack_timing 	  
2476:mac.c         **** 						      //printf("\nthe frame is need ack\n");
2477:mac.c         **** 						      now_time_ticks=systime32();
2478:mac.c         **** 						      timinglength=(uint16_t)((now_time_ticks>=csma_ca_send_timestamp)?(now_time_ticks-csma_c
2479:mac.c         **** 							  
2480:mac.c         **** 						      head_of_timer_queue=timer3queue_start(head_of_timer_queue, TIMER_ONE_SHOT, temp_csma_ca
2481:mac.c         ****                                                 //printf("\n---send at  %08lx---send time is %d---\
2482:mac.c         **** 						      //printf("\ntimer header ->framedsn is %d---\n",head_of_timer_queue->framedsn);
2483:mac.c         **** 						      //printf("\nthe csma tx frame's dsn is %d\n",temp_csma_ca_frame->FrameSeq);
2484:mac.c         **** 						     //printf("\nthis frame need acked, the phychannel is %d\n",phy_channel_state);
2485:mac.c         **** 				           	}
2486:mac.c         **** 						   //printf("\nthe csma transimitted frame is payload length is: %d",temp_csma_ca_frame->fram
2487:mac.c         ****                                        //for(uint8_t i=0;i<temp_csma_ca_frame->frameLength;i++)
2488:mac.c         ****                                        //	{
2489:mac.c         **** 					    //	 //printf("\nthe csma transimitted frame is payload[%d]: %02x",i,temp_csma_ca_frame->pa
2490:mac.c         ****                                        //	}			   
2491:mac.c         **** 					    //remove_tx_queue(temp_csma_ca_frame->FrameSeq);
2492:mac.c         **** 						//if()	
2493:mac.c         **** 						 //printf("\ncsma transmitted success\n");	
2494:mac.c         **** 						 if(temp_csma_ca_frame->cmd_type==0x00)
2495:mac.c         **** 						 	mac_current_state=MAC_STATE_START_TO_SLEEP;
2496:mac.c         **** 					}
2497:mac.c         **** 				else
2498:mac.c         **** 					{
2499:mac.c         **** 					    CW=1;
2500:mac.c         **** 					    NB++;
2501:mac.c         **** 					    BE++;	
2502:mac.c         **** 					    BE=(BE>aMaxBE)? aMaxBE:BE;
2503:mac.c         **** 					    if(NB>(mac_pib_data.macMaxCsmaBackoffs))
2504:mac.c         **** 					    	{
2505:mac.c         **** 					    	      //·¢ËÍÊ§°Ü,Ïò¸ß²ãÍ¨Öª
2506:mac.c         **** 					    	      failure_to_tx_with_csma();
2507:mac.c         **** 					    	}
2508:mac.c         **** 					    else
2509:mac.c         **** 					    	{
2510:mac.c         **** 					    	      csma_state=csma_state_delaying;
2511:mac.c         **** 					    	      do_backoff();
2512:mac.c         **** 					    	}
2513:mac.c         **** 					}
2514:mac.c         **** 				break;
2515:mac.c         **** 		    default :
2516:mac.c         **** 				break;
2517:mac.c         ****         	}
2518:mac.c         **** }
2519:mac.c         **** 
2520:mac.c         **** void  failure_to_tx_with_csma(void)
2521:mac.c         **** {
 9270               	.LM988:
 9271               	/* prologue: frame size=0 */
 9272               	/* prologue end (size=0) */
2522:mac.c         **** 
2523:mac.c         ****       //¸ù¾ÝÖ¡ÀàÐÍÏò¸ß²ãÍ¨Öª
2524:mac.c         ****       //------------------------------
2525:mac.c         ****       //------------------------------
2526:mac.c         ****       //-----´úÂëÌí¼Ó------------
2527:mac.c         ****       remove_tx_queue(temp_csma_ca_frame->FrameSeq);
 9274               	.LM989:
 9275 35a6 E091 0000 		lds r30,temp_csma_ca_frame
 9276 35aa F091 0000 		lds r31,(temp_csma_ca_frame)+1
 9277 35ae 8381      		ldd r24,Z+3
 9278 35b0 0E94 0000 		call remove_tx_queue
2528:mac.c         ****      if(temp_csma_ca_frame->cmd_type==0x00)
 9280               	.LM990:
 9281 35b4 E091 0000 		lds r30,temp_csma_ca_frame
 9282 35b8 F091 0000 		lds r31,(temp_csma_ca_frame)+1
 9283 35bc 8681      		ldd r24,Z+6
 9284 35be 8823      		tst r24
 9285 35c0 19F4      		brne .L574
2529:mac.c         **** 	 	mac_current_state=MAC_STATE_START_TO_SLEEP;
 9287               	.LM991:
 9288 35c2 82E1      		ldi r24,lo8(18)
 9289 35c4 8093 0000 		sts mac_current_state,r24
 9290               	.L574:
2530:mac.c         ****   printf("\n---csma failure----\n");	  
 9292               	.LM992:
 9293 35c8 80E0      		ldi r24,lo8(.LC25)
 9294 35ca 90E0      		ldi r25,hi8(.LC25)
 9295 35cc 0E94 0000 		call puts
 9296               	/* epilogue: frame size=0 */
 9297 35d0 0895      		ret
 9298               	/* epilogue end (size=1) */
 9299               	/* function failure_to_tx_with_csma size 22 (21) */
 9301               	.Lscope63:
 9303               	.global	CSMA_CA_DOING
 9305               	CSMA_CA_DOING:
 9307               	.LM993:
 9308               	/* prologue: frame size=0 */
 9309 35d2 DF92      		push r13
 9310 35d4 EF92      		push r14
 9311 35d6 FF92      		push r15
 9312 35d8 0F93      		push r16
 9313 35da 1F93      		push r17
 9314 35dc CF93      		push r28
 9315               	/* prologue end (size=6) */
 9317               	.LM994:
 9318 35de 8091 0000 		lds r24,csma_state
 9319 35e2 9927      		clr r25
 9320 35e4 0097      		sbiw r24,0
 9321 35e6 19F0      		breq .L577
 9323               	.LM995:
 9324 35e8 0197      		sbiw r24,1
 9325 35ea 39F0      		breq .L578
 9326 35ec 91C0      		rjmp .L575
 9327               	.L577:
 9329               	.LM996:
 9330 35ee 0E94 0000 		call csma_initial
 9332               	.LM997:
 9333 35f2 81E0      		ldi r24,lo8(1)
 9334 35f4 8093 0000 		sts csma_state,r24
 9336               	.LM998:
 9337 35f8 8BC0      		rjmp .L575
 9338               	.L578:
 9340               	.LM999:
 9341 35fa 0E94 0000 		call PLME_CCA_request
 9342 35fe 182F      		mov r17,r24
 9344               	.LM1000:
 9345 3600 0E94 0000 		call Leds_redToggle
 9347               	.LM1001:
 9348 3604 D090 0000 		lds r13,phy_channel_state
 9349 3608 81E0      		ldi r24,lo8(1)
 9350 360a D816      		cp r13,r24
 9351 360c 09F0      		breq .+2
 9352 360e 79C0      		rjmp .L592
 9354               	.LM1002:
 9355 3610 1430      		cpi r17,lo8(4)
 9356 3612 09F0      		breq .+2
 9357 3614 60C0      		rjmp .L582
 9358 3616 C091 0000 		lds r28,CW
 9359 361a CC23      		tst r28
 9360 361c B9F0      		breq .L591
 9362               	.LM1003:
 9363 361e D092 0000 		sts csma_state,r13
 9365               	.LM1004:
 9366 3622 25E0      		ldi r18,lo8(5)
 9367 3624 30E0      		ldi r19,hi8(5)
 9368 3626 40E0      		ldi r20,hlo8(5)
 9369 3628 50E0      		ldi r21,hhi8(5)
 9370 362a 63E0      		ldi r22,lo8(3)
 9371 362c 8091 0000 		lds r24,head_of_systimer_queue
 9372 3630 9091 0000 		lds r25,(head_of_systimer_queue)+1
 9373 3634 0E94 0000 		call systimer_start_task
 9374 3638 9093 0000 		sts (head_of_systimer_queue)+1,r25
 9375 363c 8093 0000 		sts head_of_systimer_queue,r24
 9377               	.LM1005:
 9378 3640 8091 0000 		lds r24,CW
 9379 3644 8150      		subi r24,lo8(-(-1))
 9380 3646 8093 0000 		sts CW,r24
 9381 364a 62C0      		rjmp .L575
 9382               	.L591:
 9384               	.LM1006:
 9385 364c E091 0000 		lds r30,temp_csma_ca_frame
 9386 3650 F091 0000 		lds r31,(temp_csma_ca_frame)+1
 9387 3654 6781      		ldd r22,Z+7
 9388 3656 7085      		ldd r23,Z+8
 9389 3658 8581      		ldd r24,Z+5
 9390 365a 0E94 0000 		call PD_DATA_request
 9391 365e 7B01      		movw r14,r22
 9392 3660 8C01      		movw r16,r24
 9394               	.LM1007:
 9395 3662 C093 0000 		sts phy_channel_state,r28
 9397               	.LM1008:
 9398 3666 0E94 0000 		call Leds_redToggle
 9400               	.LM1009:
 9401 366a E091 0000 		lds r30,temp_csma_ca_frame
 9402 366e F091 0000 		lds r31,(temp_csma_ca_frame)+1
 9403 3672 8081      		ld r24,Z
 9404 3674 8823      		tst r24
 9405 3676 21F1      		breq .L583
 9407               	.LM1010:
 9408 3678 83E0      		ldi r24,lo8(3)
 9409 367a 8093 0000 		sts phy_channel_state,r24
 9411               	.LM1011:
 9412 367e 86E0      		ldi r24,lo8(6)
 9413 3680 0E94 0000 		call PLME_SET_TRX_STATE_request
 9415               	.LM1012:
 9416 3684 0E94 0000 		call systime32
 9417 3688 DC01      		movw r26,r24
 9418 368a CB01      		movw r24,r22
 9420               	.LM1013:
 9421 368c 9C01      		movw r18,r24
 9422 368e 2E19      		sub r18,r14
 9423 3690 3F09      		sbc r19,r15
 9425               	.LM1014:
 9426 3692 8091 0000 		lds r24,mac_pib_data
 9427 3696 9927      		clr r25
 9428 3698 821B      		sub r24,r18
 9429 369a 930B      		sbc r25,r19
 9430 369c E091 0000 		lds r30,temp_csma_ca_frame
 9431 36a0 F091 0000 		lds r31,(temp_csma_ca_frame)+1
 9432 36a4 8C01      		movw r16,r24
 9433 36a6 2C2F      		mov r18,r28
 9434 36a8 4381      		ldd r20,Z+3
 9435 36aa 6D2D      		mov r22,r13
 9436 36ac 8091 0000 		lds r24,head_of_timer_queue
 9437 36b0 9091 0000 		lds r25,(head_of_timer_queue)+1
 9438 36b4 0E94 0000 		call timer3queue_start
 9439 36b8 9093 0000 		sts (head_of_timer_queue)+1,r25
 9440 36bc 8093 0000 		sts head_of_timer_queue,r24
 9441               	.L583:
 9443               	.LM1015:
 9444 36c0 E091 0000 		lds r30,temp_csma_ca_frame
 9445 36c4 F091 0000 		lds r31,(temp_csma_ca_frame)+1
 9446 36c8 8681      		ldd r24,Z+6
 9447 36ca 8823      		tst r24
 9448 36cc 09F5      		brne .L575
 9450               	.LM1016:
 9451 36ce 82E1      		ldi r24,lo8(18)
 9452 36d0 8093 0000 		sts mac_current_state,r24
 9453 36d4 1DC0      		rjmp .L575
 9454               	.L582:
 9456               	.LM1017:
 9457 36d6 21E0      		ldi r18,lo8(1)
 9458 36d8 2093 0000 		sts CW,r18
 9460               	.LM1018:
 9461 36dc 9091 0000 		lds r25,NB
 9462 36e0 920F      		add r25,r18
 9463 36e2 9093 0000 		sts NB,r25
 9465               	.LM1019:
 9466 36e6 8091 0000 		lds r24,BE
 9467 36ea 820F      		add r24,r18
 9468 36ec 8093 0000 		sts BE,r24
 9470               	.LM1020:
 9471 36f0 8630      		cpi r24,lo8(6)
 9472 36f2 08F0      		brlo .L586
 9473 36f4 85E0      		ldi r24,lo8(5)
 9474               	.L586:
 9475 36f6 8093 0000 		sts BE,r24
 9477               	.LM1021:
 9478 36fa 8091 0000 		lds r24,mac_pib_data+26
 9479 36fe 8917      		cp r24,r25
 9480 3700 18F4      		brsh .L587
 9481               	.L592:
 9483               	.LM1022:
 9484 3702 0E94 0000 		call failure_to_tx_with_csma
 9485 3706 04C0      		rjmp .L575
 9486               	.L587:
 9488               	.LM1023:
 9489 3708 2093 0000 		sts csma_state,r18
 9491               	.LM1024:
 9492 370c 0E94 0000 		call do_backoff
 9493               	.L575:
 9494               	/* epilogue: frame size=0 */
 9495 3710 CF91      		pop r28
 9496 3712 1F91      		pop r17
 9497 3714 0F91      		pop r16
 9498 3716 FF90      		pop r15
 9499 3718 EF90      		pop r14
 9500 371a DF90      		pop r13
 9501 371c 0895      		ret
 9502               	/* epilogue end (size=7) */
 9503               	/* function CSMA_CA_DOING size 167 (154) */
 9511               	.Lscope64:
 9512               		.data
 9513               	.LC26:
 9514 0401 0A65 7272 		.string	"\nerror:there is no frame in the tx buffer\n"
 9514      6F72 3A74 
 9514      6865 7265 
 9514      2069 7320 
 9514      6E6F 2066 
 9515               		.text
 9517               	.global	transmit_with_csmaca
 9519               	transmit_with_csmaca:
2531:mac.c         ****       //free(temp_csma_ca_frame);
2532:mac.c         **** }
2533:mac.c         **** 
2534:mac.c         **** /*
2535:mac.c         **** //slotted CSMA-CA algorithm
2536:mac.c         **** void CSMA_CA_DOING(void)
2537:mac.c         **** {
2538:mac.c         ****        TX_BUFFER * temp;
2539:mac.c         **** 
2540:mac.c         **** 	uint8_t BE;
2541:mac.c         ****        uint8_t NB;
2542:mac.c         **** 	uint8_t CW;   
2543:mac.c         **** 
2544:mac.c         **** 	uint8_t    random_backoff;   
2545:mac.c         **** 	uint8_t  status; 
2546:mac.c         **** 	uint32_t  object_backoff;
2547:mac.c         **** 	uint8_t    cca_result;
2548:mac.c         **** 	uint32_t  csma_ca_send_timestamp;
2549:mac.c         **** 	//uint32_t   start_backoff_time;
2550:mac.c         ****        //Ê×ÏÈ´Ó·¢ËÍ¶ÔÁÐÖÐÈ¡µÃ´ý·¢ËÍµÄÊý¾Ý
2551:mac.c         ****        temp=Parameter_list.parameter_tx_task[Parameter_list.top];
2552:mac.c         **** 	Parameter_list.top=(Parameter_list.top+1)%MAX_TX_BUFFER_SIZE;
2553:mac.c         **** 	if(temp==NULL)
2554:mac.c         **** 	{
2555:mac.c         **** 	     error("\nerror:there is no frame in the tx buffer\n");
2556:mac.c         **** 	     return;
2557:mac.c         **** 	}
2558:mac.c         **** 	
2559:mac.c         **** 	//±äÁ¿µÄ³õÊ¼»¯
2560:mac.c         ****        NB=0;
2561:mac.c         **** 	CW=2;
2562:mac.c         **** 	if(mac_pib_data.macBattLifeExt==FALSE)
2563:mac.c         **** 		BE=mac_pib_data.macMinBE;
2564:mac.c         **** 	else
2565:mac.c         **** 		BE=(mac_pib_data.macMinBE>2)? 2:mac_pib_data.macMinBE;
2566:mac.c         ****        phy_channel_state=DOINGCSMA_CA;
2567:mac.c         **** 	//mac_current_state=MAC_STATE
2568:mac.c         **** 	//¶¨Î»µ½backoffµÄ±ß½ç
2569:mac.c         ****       	status=wait_for_backoff_boundary();
2570:mac.c         ****        if(status==0)
2571:mac.c         **** 	   	return;
2572:mac.c         ****                 
2573:mac.c         **** 	//µ±Ç°ÒÑ¾­ÊÇunit boundary
2574:mac.c         ****        
2575:mac.c         ****        do{
2576:mac.c         **** 
2577:mac.c         **** 	    random_backoff=random_generate();
2578:mac.c         **** 	    random_backoff=(random_backoff<<BE)-random_backoff;
2579:mac.c         **** 	    MAC_CURRENT_TICKS=systime32();
2580:mac.c         **** 	    object_backoff=(uint32_t)(random_backoff*aUnitBackoffPeriod*2)+MAC_CURRENT_TICKS;
2581:mac.c         **** 	    if(object_backoff>=0x40000000)
2582:mac.c         **** 			object_backoff=object_backoff-0x40000000;
2583:mac.c         **** 	    //×÷»ØÍË			
2584:mac.c         **** 	    while(MAC_CURRENT_TICKS!=object_backoff)
2585:mac.c         **** 			{
2586:mac.c         **** 			     MAC_CURRENT_TICKS=systime32();
2587:mac.c         **** 			     if((phy_channel_state!=DOINGCSMA_CA))
2588:mac.c         ****                               return;	
2589:mac.c         **** 			     //ÓÐ¿ÉÄÜÖÐ¶ÏÊ¹µÃMAC_CURRENT_TICKSÓëobject_backoff´í¹ý±È½ÏÏàµÈµÄÊ±»ú.	 
2590:mac.c         **** 			     //ÐèÒªÌí¼Ó´úÂë
2591:mac.c         **** 			}
2592:mac.c         **** 	    //perform  CCA
2593:mac.c         **** 	    do{
2594:mac.c         **** 	         status=wait_for_backoff_boundary();
2595:mac.c         **** 	         if(status==0)
2596:mac.c         **** 			 	return;
2597:mac.c         **** 	         cca_result=PLME_CCA_request();
2598:mac.c         **** 		  if(cca_result!=IDLE)
2599:mac.c         **** 		  	break;
2600:mac.c         **** 	    }while((CW--));
2601:mac.c         **** 	    //cama³É¹¦,·¢ËÍ	
2602:mac.c         **** 	    if(cca_result==IDLE)
2603:mac.c         **** 	    	{
2604:mac.c         **** 		   csma_ca_send_timestamp=PD_DATA_request(temp->frameLength, temp->payload);
2605:mac.c         **** 		   
2606:mac.c         **** 		   return;
2607:mac.c         **** 	    	}  
2608:mac.c         **** 	    else
2609:mac.c         **** 	    	{
2610:mac.c         **** 	    	   CW=2;
2611:mac.c         **** 		   NB=NB+1;	   
2612:mac.c         **** 	    	}
2613:mac.c         **** 		
2614:mac.c         ****       	}
2615:mac.c         **** 	while(NB<(mac_pib_data.macMaxCsmaBackoffs));
2616:mac.c         ****   
2617:mac.c         **** }
2618:mac.c         **** */
2619:mac.c         **** void transmit_with_csmaca(void)
2620:mac.c         **** {
 9521               	.LM1025:
 9522               	/* prologue: frame size=0 */
 9523               	/* prologue end (size=0) */
2621:mac.c         ****        csma_state=csma_state_initial;
 9525               	.LM1026:
 9526 371e 1092 0000 		sts csma_state,__zero_reg__
2622:mac.c         **** 
2623:mac.c         **** 	temp_csma_ca_frame=Parameter_list.parameter_tx_task[Parameter_list.top];
 9528               	.LM1027:
 9529 3722 8091 0000 		lds r24,Parameter_list+10
 9530 3726 9927      		clr r25
 9531 3728 FC01      		movw r30,r24
 9532 372a E80F      		add r30,r24
 9533 372c F91F      		adc r31,r25
 9534 372e E050      		subi r30,lo8(-(Parameter_list))
 9535 3730 F040      		sbci r31,hi8(-(Parameter_list))
 9536 3732 2081      		ld r18,Z
 9537 3734 3181      		ldd r19,Z+1
 9538 3736 3093 0000 		sts (temp_csma_ca_frame)+1,r19
 9539 373a 2093 0000 		sts temp_csma_ca_frame,r18
2624:mac.c         **** 	Parameter_list.top=(Parameter_list.top+1)%MAX_TX_BUFFER_SIZE;
 9541               	.LM1028:
 9542 373e 0196      		adiw r24,1
 9543 3740 65E0      		ldi r22,lo8(5)
 9544 3742 70E0      		ldi r23,hi8(5)
 9545 3744 0E94 0000 		call __divmodhi4
 9546 3748 8093 0000 		sts Parameter_list+10,r24
2625:mac.c         **** 	if(temp_csma_ca_frame==NULL)
 9548               	.LM1029:
 9549 374c 232B      		or r18,r19
 9550 374e 29F4      		brne .L594
2626:mac.c         **** 	{
2627:mac.c         **** 	     error("\nerror:there is no frame in the tx buffer\n");
 9552               	.LM1030:
 9553 3750 80E0      		ldi r24,lo8(.LC26)
 9554 3752 90E0      		ldi r25,hi8(.LC26)
 9555 3754 0E94 0000 		call error
2628:mac.c         **** 	     return;
 9557               	.LM1031:
 9558 3758 0895      		ret
 9559               	.L594:
2629:mac.c         **** 	}   
2630:mac.c         **** 	if(phy_channel_state==PHY_IDLE)
 9561               	.LM1032:
 9562 375a 8091 0000 		lds r24,phy_channel_state
 9563 375e 8823      		tst r24
 9564 3760 31F4      		brne .L595
2631:mac.c         **** 		{
2632:mac.c         **** 		   PLME_SET_TRX_STATE_request(RX_ON);
 9566               	.LM1033:
 9567 3762 86E0      		ldi r24,lo8(6)
 9568 3764 0E94 0000 		call PLME_SET_TRX_STATE_request
2633:mac.c         **** 		   //printf("\n^^^^^^^^^^\n"); 
2634:mac.c         ****                  CSMA_CA_DOING();
 9570               	.LM1034:
 9571 3768 0E94 0000 		call CSMA_CA_DOING
 9572 376c 0895      		ret
 9573               	.L595:
2635:mac.c         ****                  //printf("\n^^^^^^^^^^\n");
2636:mac.c         **** 		}
2637:mac.c         **** 	else
2638:mac.c         **** 		failure_to_tx_with_csma();
 9575               	.LM1035:
 9576 376e 0E94 0000 		call failure_to_tx_with_csma
 9577 3772 0895      		ret
 9578               	/* epilogue: frame size=0 */
 9579 3774 0895      		ret
 9580               	/* epilogue end (size=1) */
 9581               	/* function transmit_with_csmaca size 44 (43) */
 9583               	.Lscope65:
 9584               		.comm OS_queue,16,1
 9585               		.comm OS_sched_full,1,1
 9586               		.comm OS_sched_free,1,1
 9587               		.comm currentTime,2,1
 9588               		.comm head_of_systimer_queue,2,1
 9589               		.comm timestamp_H,2,1
 9590               		.comm mState,4,1
 9591               		.comm setIntervalFlag,1,1
 9592               		.comm mScale,1,1
 9593               		.comm mInterval,1,1
 9594               		.comm queue_head,1,1
 9595               		.comm queue_tail,1,1
 9596               		.comm queue_size,1,1
 9597               		.comm queue,3,1
 9598               		.comm mTimerList,33,1
 9599               		.comm backoff_timer_Set,1,1
 9600               		.comm backoff_call,2,1
 9601               		.comm SENSOR_DATA_VALUE,20,1
 9602               		.comm ADC_INTERRUPT_FLAG,1,1
 9603               		.comm cc2420_bramspi,1,1
 9604               		.comm cc2420_rambuf,2,1
 9605               		.comm cc2420_ramlen,1,1
 9606               		.comm cc2420_ramaddr,2,1
 9607               		.comm cc2420fifo_bspi,1,1
 9608               		.comm cc2420fifo_txbuf,2,1
 9609               		.comm cc2420fifo_txlength,1,1
 9610               		.comm cc2420_rxbuf,4,1
 9611               		.comm cc2420_rxlength,1,1
 9612               		.comm cc2420_rxbuf_now,2,1
 9613               		.comm cc2420_rxlength_now,1,1
 9614               		.comm cc2420_rxbufuse,1,1
 9615               		.comm rfpackernum,1,1
 9616               		.comm cc2420_rxflag,1,1
 9617               		.comm cc2420_currentparameters,28,1
 9618               		.comm receive_timestamp,4,1
 9619               		.comm send_timestamp,4,1
 9620               		.comm cc2420_stateRadio,1,1
 9621               		.comm cc2420_LocalAddr,2,1
 9622               		.comm ieee_address,8,1
 9623               		.comm rxbuf_flag,1,1
 9624               		.comm ppib,3,1
 9625               		.comm MAC_OBJECT_CAP_START_TICKS,4,1
 9626               		.comm MAC_OBJECT_CAP_END_TICKS,4,1
 9627               		.comm head_of_timer_queue,2,1
 9628               		.comm GTSDirectionMask,1,1
 9629               		.comm phy_channel_state,1,1
 9630               		.comm mac_pib_data,45,1
 9631               		.comm scan_channel_index,1,1
 9632               		.comm scan_channel,4,1
 9633               		.comm scan_time_period,2,1
 9634               		.comm mac_working_state,1,1
 9635               		.comm mac_tx_current_frame,181,1
 9636               		.comm mac_rx_current_frame,181,1
 9637               		.comm mac_tx_beacon,78,1
 9638               		.comm mac_current_state,1,1
 9639               		.comm mac_current_state_saved,1,1
 9640               		.comm Is_mac_associated_successful,1,1
 9641               		.comm current_timer_elem,2,1
 9642               		.comm head_of_tx_buffer,2,1
 9643               		.comm tail_of_tx_buffer,2,1
 9644               		.comm Parameter_list,12,1
 9645               		.comm head_of_rx_buffer,2,1
 9646               		.comm tail_of_rx_buffer,2,1
 9647               		.comm head_of_indirect_pending_buffer,2,1
 9648               		.comm tail_of_indirect_pending_buffer,2,1
 9649               		.comm current_pending_num,1,1
 9650               		.comm TRACKBEACON,1,1
 9651               		.comm IS_MAC_SYNING,1,1
 9652               		.comm scan_result_info,132,1
 9653               		.comm mcps_data_indication_info,132,1
 9654               		.comm beacon_info,102,1
 9655               		.comm mlme_associate_indication_info,11,1
 9656               		.comm default_short_addr,2,1
 9657               		.comm no_short_addr,2,1
 9658               		.comm default_long_addr,8,1
 9659               		.comm default_node,13,1
 9660               		.comm MAC_SUPERFRAME_PERIOD,4,1
 9661               		.comm last_beacon_tx_timestamp,4,1
 9662               		.comm last_beacon_rx_timestamp,4,1
 9663               		.comm MAC_CAP_PERIOD,4,1
 9664               		.comm MAC_OBJECT_SUPERFRAME_TICKS,4,1
 9665               		.comm MAC_CURRENT_TICKS,4,1
 9666               		.comm Is_received_beacon,1,1
 9667               		.comm loss_sync_number,1,1
 9668               		.comm IS_NETWORK_FORMED,1,1
 9669               		.comm csma_state,1,1
 9670               		.comm temp_csma_ca_frame,2,1
 9671               		.comm BE,1,1
 9672               		.comm NB,1,1
 9673               		.comm CW,1,1
 9764               		.text
 9766               	Letext:
 9767               	/* File "mac.c": code 7135 = 0x1bdf (6237), prologues 439, epilogues 459 */
DEFINED SYMBOLS
                            *ABS*:00000000 mac.c
                            *ABS*:0000003f __SREG__
                            *ABS*:0000003e __SP_H__
                            *ABS*:0000003d __SP_L__
                            *ABS*:00000000 __tmp_reg__
                            *ABS*:00000001 __zero_reg__
C:\Users\sunhejie\AppData\Local\Temp/cc8wbaaa.s:221    .text:00000000 MAC_init
                            *COM*:00000002 head_of_timer_queue
                            *COM*:00000001 mac_current_state
                            *COM*:00000001 phy_channel_state
                            *COM*:00000002 head_of_tx_buffer
                            *COM*:00000002 tail_of_tx_buffer
                            *COM*:0000000c Parameter_list
                            *COM*:00000002 head_of_rx_buffer
                            *COM*:00000002 tail_of_rx_buffer
                            *COM*:00000002 head_of_indirect_pending_buffer
                            *COM*:00000002 tail_of_indirect_pending_buffer
                            *COM*:00000001 current_pending_num
                            *COM*:00000001 IS_MAC_SYNING
                            *COM*:00000002 default_short_addr
                            *COM*:00000008 default_long_addr
                            *COM*:00000002 no_short_addr
                            *COM*:0000000d default_node
                            *COM*:00000002 head_of_systimer_queue
                            *COM*:0000002d mac_pib_data
                            *COM*:00000084 scan_result_info
                            *COM*:00000001 loss_sync_number
C:\Users\sunhejie\AppData\Local\Temp/cc8wbaaa.s:346    .text:000000cc mlmeResetRequest
                            *COM*:00000001 IS_NETWORK_FORMED
C:\Users\sunhejie\AppData\Local\Temp/cc8wbaaa.s:572    .text:00000212 mlmeSetRequest
C:\Users\sunhejie\AppData\Local\Temp/cc8wbaaa.s:587    .text:00000214 mlmeScanConfirm
                            *COM*:00000003 ppib
C:\Users\sunhejie\AppData\Local\Temp/cc8wbaaa.s:697    .text:000002b4 mlmeStartConfirm
C:\Users\sunhejie\AppData\Local\Temp/cc8wbaaa.s:719    .text:000002b6 mlmeAssociateConfirm
C:\Users\sunhejie\AppData\Local\Temp/cc8wbaaa.s:799    .text:00000310 mlmeDisassociateIndication
C:\Users\sunhejie\AppData\Local\Temp/cc8wbaaa.s:840    .text:0000033c mlmeDisassociateConfirm
C:\Users\sunhejie\AppData\Local\Temp/cc8wbaaa.s:871    .text:0000034c mlmeCommStatusIndication
C:\Users\sunhejie\AppData\Local\Temp/cc8wbaaa.s:888    .text:0000034e mlmeRxEnableRequest
C:\Users\sunhejie\AppData\Local\Temp/cc8wbaaa.s:903    .text:00000350 mlmeRxEnableConfirm
C:\Users\sunhejie\AppData\Local\Temp/cc8wbaaa.s:919    .text:00000352 mlmeSyncRequest
                            *COM*:00000004 MAC_SUPERFRAME_PERIOD
                            *COM*:00000004 MAC_CAP_PERIOD
                            *COM*:00000001 Is_received_beacon
C:\Users\sunhejie\AppData\Local\Temp/cc8wbaaa.s:1017   .text:00000402 synrequest_task
C:\Users\sunhejie\AppData\Local\Temp/cc8wbaaa.s:1036   .text:0000040e mlmesyn_finished
                            *COM*:00000004 last_beacon_rx_timestamp
                            *COM*:00000004 MAC_OBJECT_CAP_START_TICKS
                            *COM*:00000004 MAC_OBJECT_CAP_END_TICKS
                            *COM*:00000004 MAC_OBJECT_SUPERFRAME_TICKS
C:\Users\sunhejie\AppData\Local\Temp/cc8wbaaa.s:1213   .text:0000057a mcpsDataConfirm
C:\Users\sunhejie\AppData\Local\Temp/cc8wbaaa.s:1241   .text:0000058a mcpsDataIndication
C:\Users\sunhejie\AppData\Local\Temp/cc8wbaaa.s:1267   .text:000005a0 get_frame_pointer
C:\Users\sunhejie\AppData\Local\Temp/cc8wbaaa.s:1308   .text:000005bc get_pending_frame
C:\Users\sunhejie\AppData\Local\Temp/cc8wbaaa.s:1446   .text:00000698 Is_data_pending
C:\Users\sunhejie\AppData\Local\Temp/cc8wbaaa.s:1576   .text:0000075c beacon_request_frame_send
C:\Users\sunhejie\AppData\Local\Temp/cc8wbaaa.s:1590   .text:0000075e beacon_frame_tx_timing
                            *COM*:00000004 last_beacon_tx_timestamp
C:\Users\sunhejie\AppData\Local\Temp/cc8wbaaa.s:1761   .text:000008ca timerqueue_adjust
                            *COM*:00000002 current_timer_elem
C:\Users\sunhejie\AppData\Local\Temp/cc8wbaaa.s:1796   .text:000008e8 remove_pending_queue
                            *COM*:0000004e mac_tx_beacon
C:\Users\sunhejie\AppData\Local\Temp/cc8wbaaa.s:2194   .text:00000b4c pending_frame_handle
C:\Users\sunhejie\AppData\Local\Temp/cc8wbaaa.s:2263   .text:00000b94 remove_from_rx_buffer
C:\Users\sunhejie\AppData\Local\Temp/cc8wbaaa.s:2297   .text:00000bb0 remove_tx_queue
C:\Users\sunhejie\AppData\Local\Temp/cc8wbaaa.s:2393   .text:00000c1a mac_timer3queue_getnextinterval
C:\Users\sunhejie\AppData\Local\Temp/cc8wbaaa.s:2433   .text:00000c38 initial_tx_queue
C:\Users\sunhejie\AppData\Local\Temp/cc8wbaaa.s:2457   .text:00000c3a add_pending_queue
C:\Users\sunhejie\AppData\Local\Temp/cc8wbaaa.s:2737   .text:00000de0 mlmeAssociateResponse
C:\Users\sunhejie\AppData\Local\Temp/cc8wbaaa.s:2826   .text:00000e50 mlmeAssociateIndication
C:\Users\sunhejie\AppData\Local\Temp/cc8wbaaa.s:2932   .text:00000ee8 add_to_rx_buffer
C:\Users\sunhejie\AppData\Local\Temp/cc8wbaaa.s:3040   .text:00000f6c PD_DATA_indication
C:\Users\sunhejie\AppData\Local\Temp/cc8wbaaa.s:8111   .text:00002eae mac_get_received_frame
C:\Users\sunhejie\AppData\Local\Temp/cc8wbaaa.s:3080   .text:00000f96 add_tx_queue
C:\Users\sunhejie\AppData\Local\Temp/cc8wbaaa.s:3193   .text:00001018 direct_transmit
C:\Users\sunhejie\AppData\Local\Temp/cc8wbaaa.s:3244   .text:00001046 mac_frame_send
                            *COM*:000000b5 mac_tx_current_frame
                            *COM*:000000b5 mac_rx_current_frame
C:\Users\sunhejie\AppData\Local\Temp/cc8wbaaa.s:9519   .text:0000371e transmit_with_csmaca
C:\Users\sunhejie\AppData\Local\Temp/cc8wbaaa.s:4020   .text:000014fa beacon_frame_send
C:\Users\sunhejie\AppData\Local\Temp/cc8wbaaa.s:4205   .text:00001608 associate_response_frame_send
C:\Users\sunhejie\AppData\Local\Temp/cc8wbaaa.s:4333   .text:000016d6 coordinator_realignment_frame_send
C:\Users\sunhejie\AppData\Local\Temp/cc8wbaaa.s:4509   .text:00001802 mlmeSyncLossIndication
C:\Users\sunhejie\AppData\Local\Temp/cc8wbaaa.s:4556   .text:00001830 mlmeOrphanResponse
C:\Users\sunhejie\AppData\Local\Temp/cc8wbaaa.s:4598   .text:00001856 mlmeOrphanIndication
C:\Users\sunhejie\AppData\Local\Temp/cc8wbaaa.s:4663   .text:000018a8 mlmeStartRequest
C:\Users\sunhejie\AppData\Local\Temp/cc8wbaaa.s:4820   .text:000019c4 orphan_notification_frame_send
C:\Users\sunhejie\AppData\Local\Temp/cc8wbaaa.s:4913   .text:00001a54 mac_timer_task
                            *COM*:00000004 scan_channel
                            *COM*:00000001 scan_channel_index
                            *COM*:00000002 scan_time_period
C:\Users\sunhejie\AppData\Local\Temp/cc8wbaaa.s:5320   .text:00001ce2 mlmeScanRequest
C:\Users\sunhejie\AppData\Local\Temp/cc8wbaaa.s:5668   .text:00001f0e scan_task
C:\Users\sunhejie\AppData\Local\Temp/cc8wbaaa.s:5691   .text:00001f20 panid_confilct_frame_send
C:\Users\sunhejie\AppData\Local\Temp/cc8wbaaa.s:5767   .text:00001f92 disassociate_notification_frame_send
C:\Users\sunhejie\AppData\Local\Temp/cc8wbaaa.s:5874   .text:00002042 mlmeDisassociateRequest
C:\Users\sunhejie\AppData\Local\Temp/cc8wbaaa.s:5995   .text:000020f8 associate_request_frame_send
C:\Users\sunhejie\AppData\Local\Temp/cc8wbaaa.s:6141   .text:000021ea mlmeAssociateRequest
C:\Users\sunhejie\AppData\Local\Temp/cc8wbaaa.s:6275   .text:000022aa data_frame_send
C:\Users\sunhejie\AppData\Local\Temp/cc8wbaaa.s:6462   .text:000023da pending_data_send
C:\Users\sunhejie\AppData\Local\Temp/cc8wbaaa.s:6737   .text:000025a8 mcpsDataRequest
C:\Users\sunhejie\AppData\Local\Temp/cc8wbaaa.s:7023   .text:0000278a data_request_frame_send
C:\Users\sunhejie\AppData\Local\Temp/cc8wbaaa.s:7150   .text:00002860 mlmeBeaconNotifyIndication
C:\Users\sunhejie\AppData\Local\Temp/cc8wbaaa.s:7381   .text:000029be mac_frame_rcvd
                            *COM*:00000066 beacon_info
                            *COM*:00000001 mac_current_state_saved
                            *COM*:00000084 mcps_data_indication_info
C:\Users\sunhejie\AppData\Local\Temp/cc8wbaaa.s:9004   .text:0000343e initial_pending_queue
C:\Users\sunhejie\AppData\Local\Temp/cc8wbaaa.s:9018   .text:00003440 random_generate
C:\Users\sunhejie\AppData\Local\Temp/cc8wbaaa.s:9041   .text:0000344c do_backoff
C:\Users\sunhejie\AppData\Local\Temp/cc8wbaaa.s:9305   .text:000035d2 CSMA_CA_DOING
                            *COM*:00000001 BE
C:\Users\sunhejie\AppData\Local\Temp/cc8wbaaa.s:9108   .text:000034a2 csma_initial
                            *COM*:00000001 NB
                            *COM*:00000001 CW
                            *COM*:00000004 MAC_CURRENT_TICKS
C:\Users\sunhejie\AppData\Local\Temp/cc8wbaaa.s:9268   .text:000035a6 failure_to_tx_with_csma
                            *COM*:00000002 temp_csma_ca_frame
                            *COM*:00000001 csma_state
                            *COM*:00000010 OS_queue
                            *COM*:00000001 OS_sched_full
                            *COM*:00000001 OS_sched_free
                            *COM*:00000002 currentTime
                            *COM*:00000002 timestamp_H
                            *COM*:00000004 mState
                            *COM*:00000001 setIntervalFlag
                            *COM*:00000001 mScale
                            *COM*:00000001 mInterval
                            *COM*:00000001 queue_head
                            *COM*:00000001 queue_tail
                            *COM*:00000001 queue_size
                            *COM*:00000003 queue
                            *COM*:00000021 mTimerList
                            *COM*:00000001 backoff_timer_Set
                            *COM*:00000002 backoff_call
                            *COM*:00000014 SENSOR_DATA_VALUE
                            *COM*:00000001 ADC_INTERRUPT_FLAG
                            *COM*:00000001 cc2420_bramspi
                            *COM*:00000002 cc2420_rambuf
                            *COM*:00000001 cc2420_ramlen
                            *COM*:00000002 cc2420_ramaddr
                            *COM*:00000001 cc2420fifo_bspi
                            *COM*:00000002 cc2420fifo_txbuf
                            *COM*:00000001 cc2420fifo_txlength
                            *COM*:00000004 cc2420_rxbuf
                            *COM*:00000001 cc2420_rxlength
                            *COM*:00000002 cc2420_rxbuf_now
                            *COM*:00000001 cc2420_rxlength_now
                            *COM*:00000001 cc2420_rxbufuse
                            *COM*:00000001 rfpackernum
                            *COM*:00000001 cc2420_rxflag
                            *COM*:0000001c cc2420_currentparameters
                            *COM*:00000004 receive_timestamp
                            *COM*:00000004 send_timestamp
                            *COM*:00000001 cc2420_stateRadio
                            *COM*:00000002 cc2420_LocalAddr
                            *COM*:00000008 ieee_address
                            *COM*:00000001 rxbuf_flag
                            *COM*:00000001 GTSDirectionMask
                            *COM*:00000001 mac_working_state
                            *COM*:00000001 Is_mac_associated_successful
                            *COM*:00000001 TRACKBEACON
                            *COM*:0000000b mlme_associate_indication_info
C:\Users\sunhejie\AppData\Local\Temp/cc8wbaaa.s:9766   .text:00003776 Letext

UNDEFINED SYMBOLS
__do_copy_data
__do_clear_bss
cc2420_set_ieee
cc2420_get_ieee
printf
PLME_SET_TRX_STATE_request
puts
cc2420_setshortaddress
cc2420_setpanid
PLME_SET_request
systimer_start_task
systime32
error
free
malloc
short_address_allocate_req
OS_post
PD_DATA_request
__divmodhi4
timer3queue_start
PLME_ED_request
cc2420_bcn_accept
timer3quere_cancel
systimer_stop_task
__udivmodsi4
PLME_CCA_request
Leds_redToggle
