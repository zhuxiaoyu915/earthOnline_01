   1               		.file	"mac.c"
   2               		.arch atmega128
   3               	__SREG__ = 0x3f
   4               	__SP_H__ = 0x3e
   5               	__SP_L__ = 0x3d
   6               	__tmp_reg__ = 0
   7               	__zero_reg__ = 1
   8               		.global __do_copy_data
   9               		.global __do_clear_bss
  11               		.text
  12               	.Ltext0:
 219               	.global	MAC_init
 221               	MAC_init:
   1:mac.c         **** #include "mac.h"
   2:mac.c         **** #include "timer_queue.h"
   3:mac.c         **** #include "project.h"
   4:mac.c         **** #include "router.h"
   5:mac.c         **** 
   6:mac.c         **** 
   7:mac.c         **** 
   8:mac.c         **** //uint8_t  test_variable;
   9:mac.c         **** extern systimer_queue_pointer head_of_systimer_queue;
  10:mac.c         **** 
  11:mac.c         **** 
  12:mac.c         **** //Ò»Ð©Æµ·±Ê¹ÓÃµÄÈ«¾Ö±äÁ¿
  13:mac.c         **** MAC_PIB  mac_pib_data;
  14:mac.c         **** phy_pib  ppib;
  15:mac.c         **** 
  16:mac.c         **** uint8_t  scan_channel_index;
  17:mac.c         **** uint32_t  scan_channel;
  18:mac.c         **** uint16_t  scan_time_period;  
  19:mac.c         **** 
  20:mac.c         **** BYTE     mac_working_state;
  21:mac.c         **** MAC_FRAME_FORMAT   mac_tx_current_frame;
  22:mac.c         **** MAC_FRAME_FORMAT    mac_rx_current_frame;
  23:mac.c         **** BEACON_FRAME_FORMAT  mac_tx_beacon;
  24:mac.c         **** 
  25:mac.c         **** MAC_STATE_TYPE     mac_current_state;
  26:mac.c         **** MAC_STATE_TYPE  mac_current_state_saved;
  27:mac.c         **** bool               Is_mac_associated_successful;
  28:mac.c         **** //PHY_CHANEL_STATE  phy_channel_state;
  29:mac.c         **** 
  30:mac.c         **** 
  31:mac.c         **** //¶¨Ê±Æ÷¶ÓÁÐ£¬Êµ¼ÊÉÏÒ»°ãÖ»ÓÐÒ»¸ö¶ÓÁÐÔªËØ£¬²»¿ÉÄÜÍ¬Ê±ÓÐ¶à¸öÈÎÎñ¡£
  32:mac.c         **** Timer_Queue_pointer  head_of_timer_queue;
  33:mac.c         **** Timer_Queue_pointer  current_timer_elem;	
  34:mac.c         **** 
  35:mac.c         **** //·¢ËÍ¶ÓÁÐ£¬ÀïÃæ´æ·Å×Å´ý·¢ËÍµÄ°ü
  36:mac.c         **** TX_BUFFER  *     head_of_tx_buffer;
  37:mac.c         **** TX_BUFFER  *     tail_of_tx_buffer;
  38:mac.c         **** parameter_tx_task  Parameter_list;
  39:mac.c         **** 
  40:mac.c         **** //½ÓÊÕ¶ÓÁÐ£¬ÀïÃæ´æ·Å×Å½ÓÊÕµÄ°ü
  41:mac.c         **** RX_BUFFER  *     head_of_rx_buffer;
  42:mac.c         **** RX_BUFFER  *     tail_of_rx_buffer;
  43:mac.c         **** 
  44:mac.c         **** //pending¶ÓÁÐ£¬ÀïÃæ´æ·Å×Å¼ä½ÓÍ¨ÐÅµÄ°ü
  45:mac.c         **** INDIRECT_TX_PENDING_QUEUE  * head_of_indirect_pending_buffer;
  46:mac.c         **** INDIRECT_TX_PENDING_QUEUE  * tail_of_indirect_pending_buffer;
  47:mac.c         **** uint8_t                                         current_pending_num;
  48:mac.c         **** 
  49:mac.c         **** bool TRACKBEACON;
  50:mac.c         **** bool IS_MAC_SYNING;
  51:mac.c         **** 
  52:mac.c         **** MLME_SCAN_CONFIRM  scan_result_info;
  53:mac.c         **** MCPS_DATA_INDICATION mcps_data_indication_info;
  54:mac.c         **** MLME_BEACON_NOTIFY_INDICATION  beacon_info;
  55:mac.c         **** MLME_ASSOCIATE_INDICATION   mlme_associate_indication_info;
  56:mac.c         **** 
  57:mac.c         **** SHORT_ADDR  default_short_addr;
  58:mac.c         **** SHORT_ADDR  no_short_addr;
  59:mac.c         **** LONG_ADDR    default_long_addr;
  60:mac.c         **** NODE_INFO      default_node;
  61:mac.c         **** 
  62:mac.c         **** //timing variable used to synchronize
  63:mac.c         **** uint32_t   MAC_SUPERFRAME_PERIOD;
  64:mac.c         **** uint32_t   last_beacon_tx_timestamp;
  65:mac.c         **** uint32_t   last_beacon_rx_timestamp;
  66:mac.c         **** uint32_t   MAC_CAP_PERIOD;
  67:mac.c         **** //Ô¤ÆÚµÄCAP½áÊøtickºÍ³¬Ö¡½áÊøtick
  68:mac.c         **** uint32_t   MAC_OBJECT_CAP_START_TICKS;
  69:mac.c         **** uint32_t   MAC_OBJECT_CAP_END_TICKS;
  70:mac.c         **** uint32_t   MAC_OBJECT_SUPERFRAME_TICKS;
  71:mac.c         **** uint32_t   MAC_CURRENT_TICKS;
  72:mac.c         **** 
  73:mac.c         **** bool         Is_received_beacon;
  74:mac.c         **** uint8_t     loss_sync_number;
  75:mac.c         **** 
  76:mac.c         **** bool         IS_NETWORK_FORMED;
  77:mac.c         **** 
  78:mac.c         **** 
  79:mac.c         **** //MAC³õÊ¼»¯º¯Êý£¬Ö÷ÒªÊÇ¶ÔÒ»Ð©Êý¾Ý½á¹¹µÄ³õÊ¼»¯£¬802.15.4ÖÐÃ»ÓÐ¶¨ÒåÏà¹Øº¯Êý
  80:mac.c         **** void MAC_init(void)
  81:mac.c         **** {
 223               	.LM1:
 224               	/* prologue: frame size=0 */
 225               	/* prologue end (size=0) */
  82:mac.c         **** 	//¶¨Ê±Æ÷¶ÓÁÐµÄ³õÊ¼»¯¡£µ÷ÓÃtimerqueue_initº¯Êý
  83:mac.c         **** 	uint8_t  index;
  84:mac.c         **** 	head_of_timer_queue=NULL;
 227               	.LM2:
 228 0000 1092 0000 		sts (head_of_timer_queue)+1,__zero_reg__
 229 0004 1092 0000 		sts head_of_timer_queue,__zero_reg__
  85:mac.c         **** 	//TRACKBEACONÖÃÎª¼Ù¡£
  86:mac.c         **** 
  87:mac.c         **** 	mac_current_state=MAC_STATE_UNSTARTED;
 231               	.LM3:
 232 0008 1092 0000 		sts mac_current_state,__zero_reg__
  88:mac.c         ****        phy_channel_state=PHY_IDLE;
 234               	.LM4:
 235 000c 1092 0000 		sts phy_channel_state,__zero_reg__
  89:mac.c         **** 	//·¢ËÍ¶ÓÁÐÎª¿Õ
  90:mac.c         **** 	head_of_tx_buffer=NULL;
 237               	.LM5:
 238 0010 1092 0000 		sts (head_of_tx_buffer)+1,__zero_reg__
 239 0014 1092 0000 		sts head_of_tx_buffer,__zero_reg__
  91:mac.c         **** 	tail_of_tx_buffer=NULL;
 241               	.LM6:
 242 0018 1092 0000 		sts (tail_of_tx_buffer)+1,__zero_reg__
 243 001c 1092 0000 		sts tail_of_tx_buffer,__zero_reg__
  92:mac.c         **** 	Parameter_list.top=0;
 245               	.LM7:
 246 0020 1092 0000 		sts Parameter_list+10,__zero_reg__
  93:mac.c         **** 	Parameter_list.tail=0;
 248               	.LM8:
 249 0024 1092 0000 		sts Parameter_list+11,__zero_reg__
  94:mac.c         **** 	//½ÓÊÕ¶ÓÁÐÎª¿Õ
  95:mac.c         **** 	head_of_rx_buffer=NULL;
 251               	.LM9:
 252 0028 1092 0000 		sts (head_of_rx_buffer)+1,__zero_reg__
 253 002c 1092 0000 		sts head_of_rx_buffer,__zero_reg__
  96:mac.c         **** 	tail_of_rx_buffer=NULL;
 255               	.LM10:
 256 0030 1092 0000 		sts (tail_of_rx_buffer)+1,__zero_reg__
 257 0034 1092 0000 		sts tail_of_rx_buffer,__zero_reg__
  97:mac.c         ****        //pending¶ÓÁÐÎª¿Õ
  98:mac.c         **** 	head_of_indirect_pending_buffer=NULL;
 259               	.LM11:
 260 0038 1092 0000 		sts (head_of_indirect_pending_buffer)+1,__zero_reg__
 261 003c 1092 0000 		sts head_of_indirect_pending_buffer,__zero_reg__
  99:mac.c         **** 	tail_of_indirect_pending_buffer=NULL;
 263               	.LM12:
 264 0040 1092 0000 		sts (tail_of_indirect_pending_buffer)+1,__zero_reg__
 265 0044 1092 0000 		sts tail_of_indirect_pending_buffer,__zero_reg__
 100:mac.c         **** 	current_pending_num=0;
 267               	.LM13:
 268 0048 1092 0000 		sts current_pending_num,__zero_reg__
 101:mac.c         ****        //mac_current_state=MAC_STATE_UNSTARTED;
 102:mac.c         **** 	IS_MAC_SYNING=FALSE;
 270               	.LM14:
 271 004c 1092 0000 		sts IS_MAC_SYNING,__zero_reg__
 103:mac.c         ****        default_short_addr.Val=0xffff;
 273               	.LM15:
 274 0050 8FEF      		ldi r24,lo8(-1)
 275 0052 9FEF      		ldi r25,hi8(-1)
 276 0054 9093 0000 		sts (default_short_addr)+1,r25
 277 0058 8093 0000 		sts default_short_addr,r24
 104:mac.c         **** 	default_long_addr.longaddr=0;
 279               	.LM16:
 280 005c 1092 0000 		sts default_long_addr,__zero_reg__
 281 0060 1092 0000 		sts default_long_addr+1,__zero_reg__
 282 0064 1092 0000 		sts default_long_addr+2,__zero_reg__
 283 0068 1092 0000 		sts default_long_addr+3,__zero_reg__
 284 006c 1092 0000 		sts default_long_addr+4,__zero_reg__
 285 0070 1092 0000 		sts default_long_addr+5,__zero_reg__
 286 0074 1092 0000 		sts default_long_addr+6,__zero_reg__
 287 0078 1092 0000 		sts default_long_addr+7,__zero_reg__
 105:mac.c         **** 	no_short_addr.Val=0xfffe;
 289               	.LM17:
 290 007c 8EEF      		ldi r24,lo8(-2)
 291 007e 9FEF      		ldi r25,hi8(-2)
 292 0080 9093 0000 		sts (no_short_addr)+1,r25
 293 0084 8093 0000 		sts no_short_addr,r24
 106:mac.c         **** 	default_node.addrMode=0x00;
 295               	.LM18:
 296 0088 1092 0000 		sts default_node,__zero_reg__
 107:mac.c         **** 	head_of_systimer_queue=NULL;
 298               	.LM19:
 299 008c 1092 0000 		sts (head_of_systimer_queue)+1,__zero_reg__
 300 0090 1092 0000 		sts head_of_systimer_queue,__zero_reg__
 108:mac.c         ****        //---------------------------------------------------------------
 109:mac.c         ****        //------------Ðèµ÷ÓÃÎïÀí²ãº¯ÊýµÃµ½¸ÃµØÖ·----------
 110:mac.c         ****        //-------------------------´ýÌí¼Ó----------------------------
 111:mac.c         **** 	mac_pib_data.macExtAddress.longaddr=0;
 302               	.LM20:
 303 0094 1092 0000 		sts mac_pib_data+34,__zero_reg__
 304 0098 1092 0000 		sts mac_pib_data+35,__zero_reg__
 305 009c 1092 0000 		sts mac_pib_data+36,__zero_reg__
 306 00a0 1092 0000 		sts mac_pib_data+37,__zero_reg__
 307 00a4 1092 0000 		sts mac_pib_data+38,__zero_reg__
 308 00a8 1092 0000 		sts mac_pib_data+39,__zero_reg__
 309 00ac 1092 0000 		sts mac_pib_data+40,__zero_reg__
 310 00b0 1092 0000 		sts mac_pib_data+41,__zero_reg__
 112:mac.c         ****        scan_result_info.resultListSize=0;
 312               	.LM21:
 313 00b4 1092 0000 		sts scan_result_info+6,__zero_reg__
 314 00b8 E0E0      		ldi r30,lo8(scan_result_info+7)
 315 00ba F0E0      		ldi r31,hi8(scan_result_info+7)
 316 00bc 8FE0      		ldi r24,lo8(15)
 317               	.L5:
 113:mac.c         ****        for(index=0;index<MAC_MAX_ED_MEASUREMENT;index++)
 114:mac.c         **** 	   	scan_result_info.pEnergyDetectList[index]=0;
 319               	.LM22:
 320 00be 1192      		st Z+,__zero_reg__
 322               	.LM23:
 323 00c0 8150      		subi r24,lo8(-(-1))
 324 00c2 87FF      		sbrs r24,7
 325 00c4 FCCF      		rjmp .L5
 115:mac.c         **** 
 116:mac.c         **** 	loss_sync_number=0;
 327               	.LM24:
 328 00c6 1092 0000 		sts loss_sync_number,__zero_reg__
 329               	/* epilogue: frame size=0 */
 330 00ca 0895      		ret
 331               	/* epilogue end (size=1) */
 332               	/* function MAC_init size 102 (101) */
 337               	.Lscope0:
 340               	.global	mlmeResetRequest
 342               	mlmeResetRequest:
 117:mac.c         **** 	//for(index=0;index<MAC_MAX_PAN_DESCRIPTORS;index++)
 118:mac.c         **** 	//	scan_result_info.pPANDescriptorList
 119:mac.c         **** }
 120:mac.c         **** 
 121:mac.c         **** //**************************// 
 122:mac.c         **** MAC_ENUM mlmeResetRequest(bool setDefaultPIB)
 123:mac.c         **** {
 344               	.LM25:
 345               	/* prologue: frame size=16 */
 346 00cc FF92      		push r15
 347 00ce 0F93      		push r16
 348 00d0 1F93      		push r17
 349 00d2 CF93      		push r28
 350 00d4 DF93      		push r29
 351 00d6 CDB7      		in r28,__SP_L__
 352 00d8 DEB7      		in r29,__SP_H__
 353 00da 6097      		sbiw r28,16
 354 00dc 0FB6      		in __tmp_reg__,__SREG__
 355 00de F894      		cli
 356 00e0 DEBF      		out __SP_H__,r29
 357 00e2 0FBE      		out __SREG__,__tmp_reg__
 358 00e4 CDBF      		out __SP_L__,r28
 359               	/* prologue end (size=13) */
 124:mac.c         ****    //·¢ËÍPLME_SET_TRX_STATE.requestÔ­Óï¡£ÖÃÉäÆµÊÕ·¢Æ÷ÎªTRX_OFF
 125:mac.c         ****    
 126:mac.c         ****    //uint8_t state;
 127:mac.c         ****    uint8_t return_state;
 128:mac.c         ****    
 129:mac.c         ****    //È»ºóÔÚresetMAC²ãÀïÃæµÄPIBµÄËùÓÐ½á¹¹Ìå³ÉÔ±ÔªËØÎª³õÊ¼Öµ
 130:mac.c         ****    mac_pib_data.macAckWaitDuration=54;
 361               	.LM26:
 362 00e6 86E3      		ldi r24,lo8(54)
 363 00e8 8093 0000 		sts mac_pib_data,r24
 131:mac.c         ****    //mac_pib_data.macAckWaitDuration=4;
 132:mac.c         ****    if(IS_COORDINATOR||IS_FFD)
 133:mac.c         ****        mac_pib_data.macAssociationPermit=TRUE;
 365               	.LM27:
 366 00ec 81E0      		ldi r24,lo8(1)
 367 00ee 8093 0000 		sts mac_pib_data+1,r24
 134:mac.c         ****    else
 135:mac.c         ****        mac_pib_data.macAssociationPermit=FALSE;
 136:mac.c         ****    //================================
 137:mac.c         ****    uint8_t buffer_addr[8];
 138:mac.c         ****    LONG_ADDR long_ieee_addr;
 139:mac.c         ****    long_ieee_addr.longaddr=MY_IEEE_ADDR;
 369               	.LM28:
 370 00f2 82E0      		ldi r24,lo8(2)
 371 00f4 8987      		std Y+9,r24
 372 00f6 1A86      		std Y+10,__zero_reg__
 373 00f8 1B86      		std Y+11,__zero_reg__
 374 00fa 1C86      		std Y+12,__zero_reg__
 375 00fc 1D86      		std Y+13,__zero_reg__
 376 00fe 1E86      		std Y+14,__zero_reg__
 377 0100 8FEF      		ldi r24,lo8(-1)
 378 0102 8F87      		std Y+15,r24
 379 0104 888B      		std Y+16,r24
 380 0106 FE01      		movw r30,r28
 381 0108 3196      		adiw r30,1
 382 010a 97E0      		ldi r25,lo8(7)
 383 010c F92E      		mov r15,r25
 384               	.L14:
 385               	.LBB2:
 140:mac.c         ****    //buffer_addr=(uint8_t )
 141:mac.c         ****    for(uint8_t i=0;i<8;i++)
 142:mac.c         ****    	{
 143:mac.c         ****    	buffer_addr[i]=long_ieee_addr.v[i];
 387               	.LM29:
 388 010e 8085      		ldd r24,Z+8
 389 0110 8193      		st Z+,r24
 391               	.LM30:
 392 0112 FA94      		dec r15
 393 0114 F7FE      		sbrs r15,7
 394 0116 FBCF      		rjmp .L14
 395 0118 88E0      		ldi r24,lo8(8)
 396 011a F82E      		mov r15,r24
 397               	.LBE2:
 144:mac.c         **** 	//printf("\n--ieee addr[%d] is %02x--\n",i,buffer_addr[i]);
 145:mac.c         ****    	}
 146:mac.c         ****    cc2420_set_ieee(buffer_addr);
 399               	.LM31:
 400 011c CE01      		movw r24,r28
 401 011e 0196      		adiw r24,1
 402 0120 0E94 0000 		call cc2420_set_ieee
 147:mac.c         ****    IS_NETWORK_FORMED=FALSE;
 404               	.LM32:
 405 0124 1092 0000 		sts IS_NETWORK_FORMED,__zero_reg__
 148:mac.c         ****    mac_pib_data.macAutoRequest=FALSE;
 407               	.LM33:
 408 0128 1092 0000 		sts mac_pib_data+2,__zero_reg__
 149:mac.c         ****    mac_pib_data.macBattLifeExt=FALSE;
 410               	.LM34:
 411 012c 1092 0000 		sts mac_pib_data+3,__zero_reg__
 150:mac.c         ****    mac_pib_data.macBattLifeExtPeriods=6;
 413               	.LM35:
 414 0130 86E0      		ldi r24,lo8(6)
 415 0132 8093 0000 		sts mac_pib_data+4,r24
 151:mac.c         ****    mac_pib_data.pMacBeaconPayload=NULL;
 417               	.LM36:
 418 0136 1092 0000 		sts (mac_pib_data+5)+1,__zero_reg__
 419 013a 1092 0000 		sts mac_pib_data+5,__zero_reg__
 152:mac.c         ****    mac_pib_data.macBeaconPayloadLength=0;
 421               	.LM37:
 422 013e 1092 0000 		sts mac_pib_data+7,__zero_reg__
 153:mac.c         ****    mac_pib_data.macBeaconOrder=6;
 424               	.LM38:
 425 0142 8093 0000 		sts mac_pib_data+8,r24
 154:mac.c         ****    mac_pib_data.macBeaconTxTime=0x00000000;
 427               	.LM39:
 428 0146 1092 0000 		sts mac_pib_data+9,__zero_reg__
 429 014a 1092 0000 		sts (mac_pib_data+9)+1,__zero_reg__
 430 014e 1092 0000 		sts (mac_pib_data+9)+2,__zero_reg__
 431 0152 1092 0000 		sts (mac_pib_data+9)+3,__zero_reg__
 155:mac.c         ****    //mac_pib_data.macBSN=0x00;  random value between 0x00-0xff;
 156:mac.c         ****    mac_pib_data.macCoordExtendedAddress=default_long_addr;
 433               	.LM40:
 434 0156 00E0      		ldi r16,lo8(mac_pib_data+14)
 435 0158 10E0      		ldi r17,hi8(mac_pib_data+14)
 436 015a E0E0      		ldi r30,lo8(default_long_addr)
 437 015c F0E0      		ldi r31,hi8(default_long_addr)
 438 015e D801      		movw r26,r16
 439 0160 8F2D      		mov r24,r15
 440 0162 0190      		ld __tmp_reg__,Z+
 441 0164 0D92      		st X+,__tmp_reg__
 442 0166 8A95      		dec r24
 443 0168 E1F7      		brne .-8
 157:mac.c         ****    mac_pib_data.macCoordShortAddress=default_short_addr;
 445               	.LM41:
 446 016a 2091 0000 		lds r18,default_short_addr
 447 016e 3091 0000 		lds r19,(default_short_addr)+1
 448 0172 3093 0000 		sts (mac_pib_data+22)+1,r19
 449 0176 2093 0000 		sts mac_pib_data+22,r18
 158:mac.c         ****    //mac_pib_data.macDSN=0x00;  random value between 0x00-0xff;
 159:mac.c         ****    mac_pib_data.macGTSPermit=FALSE;
 451               	.LM42:
 452 017a 1092 0000 		sts mac_pib_data+25,__zero_reg__
 160:mac.c         ****    mac_pib_data.macMaxCsmaBackoffs=2;
 454               	.LM43:
 455 017e 82E0      		ldi r24,lo8(2)
 456 0180 8093 0000 		sts mac_pib_data+26,r24
 161:mac.c         ****    mac_pib_data.macMinBE=3;
 458               	.LM44:
 459 0184 83E0      		ldi r24,lo8(3)
 460 0186 8093 0000 		sts mac_pib_data+27,r24
 162:mac.c         ****    mac_pib_data.macPANId=default_short_addr;
 462               	.LM45:
 463 018a 3093 0000 		sts (mac_pib_data+28)+1,r19
 464 018e 2093 0000 		sts mac_pib_data+28,r18
 163:mac.c         ****    mac_pib_data.macPromiscuousMode=FALSE;
 466               	.LM46:
 467 0192 1092 0000 		sts mac_pib_data+30,__zero_reg__
 164:mac.c         ****    //===============ÐÞ¸Ä
 165:mac.c         ****    mac_pib_data.macRxOnWhenIdle=TRUE;
 469               	.LM47:
 470 0196 81E0      		ldi r24,lo8(1)
 471 0198 8093 0000 		sts mac_pib_data+31,r24
 166:mac.c         ****    mac_pib_data.macShortAddress=default_short_addr;
 473               	.LM48:
 474 019c 3093 0000 		sts (mac_pib_data+32)+1,r19
 475 01a0 2093 0000 		sts mac_pib_data+32,r18
 167:mac.c         ****    mac_pib_data.macSuperframeOrder=5;
 477               	.LM49:
 478 01a4 85E0      		ldi r24,lo8(5)
 479 01a6 8093 0000 		sts mac_pib_data+42,r24
 168:mac.c         ****    mac_pib_data.macTransactionPersistenceTime=0x0005;
 481               	.LM50:
 482 01aa 85E0      		ldi r24,lo8(5)
 483 01ac 90E0      		ldi r25,hi8(5)
 484 01ae 9093 0000 		sts (mac_pib_data+43)+1,r25
 485 01b2 8093 0000 		sts mac_pib_data+43,r24
 169:mac.c         ****    cc2420_get_ieee(mac_pib_data.macExtAddress.v);
 487               	.LM51:
 488 01b6 C801      		movw r24,r16
 489 01b8 4496      		adiw r24,20
 490 01ba 0E94 0000 		call cc2420_get_ieee
 170:mac.c         ****    //for(uint8_t i=0;i<8;i++)
 171:mac.c         ****    //printf("\nmacExtaddr is %02x\n",mac_pib_data.macExtAddress.v[i]);
 172:mac.c         ****    if(IS_COORDINATOR)
 173:mac.c         ****    	{
 174:mac.c         ****    	     mac_pib_data.macCoordExtendedAddress=mac_pib_data.macExtAddress;
 492               	.LM52:
 493 01be F801      		movw r30,r16
 494 01c0 7496      		adiw r30,20
 495 01c2 D801      		movw r26,r16
 496 01c4 8F2D      		mov r24,r15
 497 01c6 0190      		ld __tmp_reg__,Z+
 498 01c8 0D92      		st X+,__tmp_reg__
 499 01ca 8A95      		dec r24
 500 01cc E1F7      		brne .-8
 175:mac.c         **** 	     mac_pib_data.macCoordShortAddress.Val=COOR_SHORT_ADDRESS;
 502               	.LM53:
 503 01ce 88E8      		ldi r24,lo8(136)
 504 01d0 90E0      		ldi r25,hi8(136)
 505 01d2 9093 0000 		sts (mac_pib_data+22)+1,r25
 506 01d6 8093 0000 		sts mac_pib_data+22,r24
 176:mac.c         **** 	     mac_pib_data.macShortAddress.Val=COOR_SHORT_ADDRESS;
 508               	.LM54:
 509 01da 9093 0000 		sts (mac_pib_data+32)+1,r25
 510 01de 8093 0000 		sts mac_pib_data+32,r24
 177:mac.c         **** 	     mac_pib_data.macPANId.Val=COOR_PAN_ID;
 512               	.LM55:
 513 01e2 86E6      		ldi r24,lo8(102)
 514 01e4 90E0      		ldi r25,hi8(102)
 515 01e6 9093 0000 		sts (mac_pib_data+28)+1,r25
 516 01ea 8093 0000 		sts mac_pib_data+28,r24
 178:mac.c         ****    	}
 179:mac.c         ****    else 
 180:mac.c         ****    	{
 181:mac.c         ****    	     mac_pib_data.macPANId=default_short_addr;
 182:mac.c         ****             mac_pib_data.macShortAddress=default_short_addr;
 183:mac.c         ****    	}
 184:mac.c         ****    //mac_pib_data.
 185:mac.c         ****    return_state=PLME_SET_TRX_STATE_request(TRX_OFF);
 518               	.LM56:
 519 01ee 8F2D      		mov r24,r15
 520 01f0 0E94 0000 		call PLME_SET_TRX_STATE_request
 186:mac.c         ****    if(return_state==SUCCESS)
 522               	.LM57:
 523 01f4 8823      		tst r24
 524 01f6 19F4      		brne .L17
 187:mac.c         ****    	return  SUCCESS;
 526               	.LM58:
 527 01f8 80E0      		ldi r24,lo8(0)
 528 01fa 90E0      		ldi r25,hi8(0)
 529 01fc 02C0      		rjmp .L8
 530               	.L17:
 188:mac.c         ****    else return DISABLE_TRX_FAILURE;
 532               	.LM59:
 533 01fe 83EE      		ldi r24,lo8(227)
 534 0200 90E0      		ldi r25,hi8(227)
 535               	.L8:
 536               	/* epilogue: frame size=16 */
 537 0202 6096      		adiw r28,16
 538 0204 0FB6      		in __tmp_reg__,__SREG__
 539 0206 F894      		cli
 540 0208 DEBF      		out __SP_H__,r29
 541 020a 0FBE      		out __SREG__,__tmp_reg__
 542 020c CDBF      		out __SP_L__,r28
 543 020e DF91      		pop r29
 544 0210 CF91      		pop r28
 545 0212 1F91      		pop r17
 546 0214 0F91      		pop r16
 547 0216 FF90      		pop r15
 548 0218 0895      		ret
 549               	/* epilogue end (size=12) */
 550               	/* function mlmeResetRequest size 167 (142) */
 559               	.Lscope1:
 563               	.global	mlmeSetRequest
 565               	mlmeSetRequest:
 189:mac.c         ****    //ÔÚÊÕµ½PLME_SET_TRX_STATE.confirm²¢ÇÒ½á¹ûÎª³É¹¦ºó£¬½«·¢ËÍMLME_RESET.confirmÔ­Óï²¢ÖÃÎª³É¹¦×´Ì¬
 190:mac.c         ****    //·ñÔòÖÃÎªDISABLE_TRX_FAILURE×´Ì¬£¬ÊµÏÖÉÏconfirmÔ­ÓïÊÇÍ¨¹ý·µ»ØÖµ·µ»ØµÄ¡£
 191:mac.c         ****    
 192:mac.c         **** } 
 193:mac.c         **** 
 194:mac.c         **** //**************************//
 195:mac.c         **** MAC_ENUM mlmeSetRequest(MAC_PIB_ATTR pibAttribute, void *pPibAttributeValue)
 196:mac.c         **** {
 567               	.LM60:
 568               	/* prologue: frame size=0 */
 569               	/* prologue end (size=0) */
 570               	/* epilogue: frame size=0 */
 571 021a 0895      		ret
 572               	/* epilogue end (size=1) */
 573               	/* function mlmeSetRequest size 1 (0) */
 575               	.Lscope2:
 578               	.global	mlmeScanConfirm
 580               	mlmeScanConfirm:
 197:mac.c         **** 	 //¸ù¾Ýº¯Êý´«µÝ¹ýÀ´µÄ²ÎÊýÐÞ¸ÄPIB½á¹¹ÖÐµÄ³ÉÔ±£¬²¢·µ»ØÏàÓ¦µÄ³É¹¦Ê§°Ü½á¹û(¼´confirmÔ­Óï)
 198:mac.c         **** }
 199:mac.c         ****  
 200:mac.c         **** //**************************//
 201:mac.c         **** //ÓÐ±ØÒª¶¨Òåmlmescanconfirmº¯Êý,scan request 
 202:mac.c         **** //×´Ì¬ÓÉscan request·µ»Ø£¬ÆäËûµÄ½á¹ûÓÉÈ«¾Ö½á¹¹MLME_SCAN_CONFIRM·µ»Ø; 
 203:mac.c         **** MAC_ENUM mlmeScanRequest(BYTE scanType, DWORD scanChannels, UINT8 scanDuration)
 204:mac.c         **** {
 205:mac.c         **** 
 206:mac.c         **** 	uint16_t  scantime_on_channel;
 207:mac.c         **** 	uint32_t  object_time;
 208:mac.c         **** 	uint8_t    index;
 209:mac.c         **** 	int8_t    temp_max_energy;
 210:mac.c         **** 	ED_STATE  temp_return_ED;
 211:mac.c         **** 	SET_STATE  temp_return_SET;
 212:mac.c         **** 	scantime_on_channel=((((uint16_t)aBaseSuperframeDuration)<<scanDuration)+((uint16_t)aBaseSuperfram
 213:mac.c         **** 	//printf("=====scan time is %08x",scantime_on_channel);
 214:mac.c         **** 	scan_result_info.resultListSize=0;
 215:mac.c         **** 	switch(scanType)
 216:mac.c         **** 		{
 217:mac.c         **** 		    case ED_SCAN:
 218:mac.c         **** 			   //printf("\n---START TO DO THE ENERGY SCAN----\n");	
 219:mac.c         **** 	                   mac_current_state=MAC_STATE_ENERGY_SCAN;
 220:mac.c         **** 			      phy_channel_state=INACTIVE_PERIOD;
 221:mac.c         **** 	                   for(index=0;index<16;index++)
 222:mac.c         **** 	                   {
 223:mac.c         **** 	                       if(((1<<index)&(scanChannels))!=0)
 224:mac.c         **** 	                       {
 225:mac.c         **** 	                           object_time=systime32()+(((uint32_t)scantime_on_channel)<<1);
 226:mac.c         **** 				    //printf("the object time is %08lx",object_time);			   
 227:mac.c         **** 				      //if(object_time>=0x3fffffff)
 228:mac.c         **** 				      //	  	object_time=object_time-0x3fffffff;
 229:mac.c         **** 				      temp_max_energy=-128;
 230:mac.c         **** 				      temp_return_SET=PLME_SET_request(phyCurrentChanel_id, index);	
 231:mac.c         **** 				      PLME_SET_TRX_STATE_request(RX_ON);  
 232:mac.c         **** 				      if(temp_return_SET.state==PHY_SUCCESS)
 233:mac.c         **** 				      	{
 234:mac.c         **** 			                  while(systime32()!=object_time)
 235:mac.c         **** 	                   	           {    
 236:mac.c         **** 	                   	               temp_return_ED=PLME_ED_request();
 237:mac.c         **** 						 if((temp_return_ED.energylevel>=temp_max_energy)&&(temp_return_ED.state=PHY_SUCCESS))
 238:mac.c         **** 						 	temp_max_energy=temp_return_ED.energylevel;
 239:mac.c         **** 	                   	           }
 240:mac.c         **** 					    scan_result_info.pEnergyDetectList[scan_result_info.resultListSize++]=temp_max_energy;
 241:mac.c         **** 				      	}					  
 242:mac.c         **** 	                       }
 243:mac.c         **** 				  if(scan_result_info.resultListSize>=MAC_MAX_ED_MEASUREMENT)
 244:mac.c         **** 				  	break;
 245:mac.c         **** 	                   }
 246:mac.c         **** 			     mac_current_state=MAC_STATE_ENERGY_SCAN_FINISHED;
 247:mac.c         **** 			     phy_channel_state=INACTIVE_PERIOD;
 248:mac.c         **** 			     PLME_SET_TRX_STATE_request(TRX_OFF);
 249:mac.c         **** 	                   break;         
 250:mac.c         **** 	           case ACTIVE_PASSIVE_SCAN:
 251:mac.c         ****                            scan_channel_index=0;
 252:mac.c         ****                            scan_channel=scanChannels;
 253:mac.c         ****                            scan_time_period=scantime_on_channel;   
 254:mac.c         **** 	                    cc2420_bcn_accept();
 255:mac.c         **** 	                    cc2420_setshortaddress(default_short_addr.Val);
 256:mac.c         ****                            cc2420_setpanid(default_short_addr.Val);
 257:mac.c         **** 	                    mac_current_state=MAC_STATE_ACTIVE_PASSIVE_SCAN;
 258:mac.c         ****                           
 259:mac.c         **** 			    while((scanChannels&((uint32_t)1<<scan_channel_index))==0)
 260:mac.c         **** 			    	{
 261:mac.c         **** 					scan_channel_index++;
 262:mac.c         **** 					if(scan_channel_index==16)
 263:mac.c         **** 						return;
 264:mac.c         **** 			    	}	
 265:mac.c         **** 			    	
 266:mac.c         **** 			    PLME_SET_request(phyCurrentChanel_id, scan_channel_index++); 
 267:mac.c         **** 			    head_of_timer_queue=timer3queue_start(head_of_timer_queue, TIMER_ONE_SHOT, 0, WAIT_SCAN, sca
 268:mac.c         **** 			    PLME_SET_TRX_STATE_request(RX_ON);			  
 269:mac.c         **** 			     phy_channel_state=WAITING_FOR_BEACON;		
 270:mac.c         **** 			   //printf("\nset the %d channel & waitting for beacon\n",scan_channel_index-1);	 
 271:mac.c         **** 	                   break;
 272:mac.c         **** 	          case ORPHAN_SCAN:
 273:mac.c         **** 	//ÈôÎªorphan SCAN£¬
 274:mac.c         **** 	//-----------------------------------***¿ÉÒÔ¿¼ÂÇ°ÑÏÂÃæµÄÊÂÇé×ö³ÉÒ»¸öº¯Êý(»òÈÎÎñ),¶¨Ê±ÖÐ¶Ï·þÎñ³ÌÐòÒ
 275:mac.c         **** 	//º¯ÊýÃûÎª      void orphan_ scan_done(void)
 276:mac.c         **** 	//Ê×ÏÈ¶ÔÓÚµÚÒ»¸öÐÅµÀ£¬µ÷ÓÃPLME_SET_requestÔ­ÓïÉèÖÃÎïÀíÐÅµÀ¡£È»ºó²ÉÓÃCSMA¿ªÊ¼·¢ËÍorphan notificatio
 277:mac.c         **** 	//È»ºóÆô¶¯¶¨Ê±Æ÷¶ÓÁÐ·þÎñ£¬¶¨Ê±Ô­ÒòÎªWAIT_FOR_RESPONSE£¬ÆäÖÐ¶¨Ê±³¤¶ÈÎªaResponseWaitTime¸ösymbol£¬Í¬
 278:mac.c         **** 	//ÍÆ³ö¸ÃÔ­Óï£¬ÆäËûµÄÐÅµÀµÄscanÈÎÎñÓÉ¶¨Ê±Æ÷µÄÖÐ¶Ï·þÎñ³ÌÐòÍê³É
 279:mac.c         **** 	//NOTE1:ÆäÖÐ¸ÃscanµÄconfirmÔ­Óï¿ÉÒÔÓÉmac²ãµÄÖ¡½ÓÊÕ½ø³Ì·¢³ö»òÖÐ¶Ï·þÎñ³ÌÐò·¢³ö¡£
 280:mac.c         **** 	//NOTE2£ºorphan scan²»Í¬ÓÚÇ°ÃæÈýÖÖscan£¬ËüÖ»ÒªÊÕµ½Ò»¸örealgnmentÃüÁîÖ¡ºóÁ¢¼´Í£Ö¹scan¡£
 281:mac.c         ****                            mac_current_state=MAC_STATE_ORPHAN_SCAN;
 282:mac.c         **** 	                    //=====================================================
 283:mac.c         **** 	                    //=========µ÷ÓÃÎïÀí²ãº¯ÊýÉèÖÃÎïÀíÐÅµÀ============
 284:mac.c         **** 	                   orphan_notification_frame_send();
 285:mac.c         **** 			     
 286:mac.c         **** 			     break;
 287:mac.c         **** 	     }
 288:mac.c         **** }
 289:mac.c         **** void mlmeScanConfirm(MLME_SCAN_CONFIRM  scan_result_info)
 290:mac.c         **** {
 582               	.LM61:
 583               	/* prologue: frame size=0 */
 584 021c CF93      		push r28
 585 021e DF93      		push r29
 586 0220 CDB7      		in r28,__SP_L__
 587 0222 DEB7      		in r29,__SP_H__
 588               	/* prologue end (size=4) */
 291:mac.c         ****        //¸ù¾Ýscan_result_infoÀ´ÐÞ¸Ä¶ÔÓ¦µÄmac²ãºÍPHY²ãµÄpibÐÅÏ¢
 292:mac.c         ****        //±¾À´ÓÐ¸ö¸´ÔÓµÄÑ¡ÔñËã·¨£¬ÕâÀï¼òµ¥´¦ÀíµÚÒ»¸ö
 293:mac.c         ****      //printf("\n-------it is in scan confirm---------\n");
 294:mac.c         **** 	if((scan_result_info.status==SUCCESS)&&(scan_result_info.scanType==ORPHAN_SCAN))
 590               	.LM62:
 591 0224 8D81      		ldd r24,Y+5
 592 0226 8823      		tst r24
 593 0228 09F0      		breq .+2
 594 022a 41C0      		rjmp .L29
 596               	.LM63:
 597 022c 8E81      		ldd r24,Y+6
 598 022e 8330      		cpi r24,lo8(3)
 599 0230 11F4      		brne .L31
 295:mac.c         **** 	{
 296:mac.c         **** 	   //printf("\n----SUCCESSFULL ORPHAN SCAN----\n");
 297:mac.c         **** 	     mac_current_state=MAC_STATE_IDLE;
 601               	.LM64:
 602 0232 80E1      		ldi r24,lo8(16)
 603 0234 3DC0      		rjmp .L32
 604               	.L31:
 298:mac.c         **** 	     return;	 
 299:mac.c         **** 	}
 300:mac.c         ****        if((scan_result_info.status==SUCCESS)&&(scan_result_info.scanType==ACTIVE_PASSIVE_SCAN))
 606               	.LM65:
 607 0236 8130      		cpi r24,lo8(1)
 608 0238 D1F5      		brne .L29
 301:mac.c         ****        {//printf("\n-------it is in scan confirm---------\n");
 302:mac.c         ****            mac_current_state=MAC_STATE_ACTIVE_PASSIVE_SCAN_FINISHED;
 610               	.LM66:
 611 023a 8AE0      		ldi r24,lo8(10)
 612 023c 8093 0000 		sts mac_current_state,r24
 303:mac.c         ****            //printf("\n-----the macbeacon is %02x\n",scan_result_info.pPANDescriptorList[0].superfr
 304:mac.c         **** 	    mac_pib_data.macBeaconOrder=((scan_result_info.pPANDescriptorList[0].superframeSpec.SF.bytes.L
 614               	.LM67:
 615 0240 8A8D      		ldd r24,Y+26
 616 0242 982F      		mov r25,r24
 617 0244 9F70      		andi r25,lo8(15)
 618 0246 9093 0000 		sts mac_pib_data+8,r25
 305:mac.c         **** 	    mac_pib_data.macSuperframeOrder=((scan_result_info.pPANDescriptorList[0].superframeSpec.SF.byt
 620               	.LM68:
 621 024a 8295      		swap r24
 622 024c 8F70      		andi r24,0x0f
 623 024e 8093 0000 		sts mac_pib_data+42,r24
 306:mac.c         **** 	    mac_pib_data.macPANId.Val=scan_result_info.pPANDescriptorList[0].coordinator.panID.Val; 		
 625               	.LM69:
 626 0252 888D      		ldd r24,Y+24
 627 0254 998D      		ldd r25,Y+25
 628 0256 9093 0000 		sts (mac_pib_data+28)+1,r25
 629 025a 8093 0000 		sts mac_pib_data+28,r24
 307:mac.c         **** 	    if(scan_result_info.pPANDescriptorList[0].coordinator.addrMode==0x02)	
 631               	.LM70:
 632 025e 8D85      		ldd r24,Y+13
 633 0260 8230      		cpi r24,lo8(2)
 634 0262 39F4      		brne .L25
 308:mac.c         **** 	    	{
 309:mac.c         **** 	           mac_pib_data.macCoordShortAddress.Val=scan_result_info.pPANDescriptorList[0].coordinato
 636               	.LM71:
 637 0264 8E89      		ldd r24,Y+22
 638 0266 9F89      		ldd r25,Y+23
 639 0268 9093 0000 		sts (mac_pib_data+22)+1,r25
 640 026c 8093 0000 		sts mac_pib_data+22,r24
 641 0270 1AC0      		rjmp .L26
 642               	.L25:
 310:mac.c         **** 	    	}
 311:mac.c         **** 	    else if(scan_result_info.pPANDescriptorList[0].coordinator.addrMode==0x03)	
 644               	.LM72:
 645 0272 8330      		cpi r24,lo8(3)
 646 0274 C1F4      		brne .L26
 312:mac.c         **** 	    	{
 313:mac.c         **** 	    	    mac_pib_data.macCoordExtendedAddress.longaddr=scan_result_info.pPANDescriptorList[0].coor
 648               	.LM73:
 649 0276 2E85      		ldd r18,Y+14
 650 0278 3F85      		ldd r19,Y+15
 651 027a 4889      		ldd r20,Y+16
 652 027c 5989      		ldd r21,Y+17
 653 027e 6A89      		ldd r22,Y+18
 654 0280 7B89      		ldd r23,Y+19
 655 0282 8C89      		ldd r24,Y+20
 656 0284 9D89      		ldd r25,Y+21
 657 0286 2093 0000 		sts mac_pib_data+14,r18
 658 028a 3093 0000 		sts mac_pib_data+15,r19
 659 028e 4093 0000 		sts mac_pib_data+16,r20
 660 0292 5093 0000 		sts mac_pib_data+17,r21
 661 0296 6093 0000 		sts mac_pib_data+18,r22
 662 029a 7093 0000 		sts mac_pib_data+19,r23
 663 029e 8093 0000 		sts mac_pib_data+20,r24
 664 02a2 9093 0000 		sts mac_pib_data+21,r25
 665               	.L26:
 314:mac.c         **** 	    	}
 315:mac.c         **** 	    ppib.phyCurrentChanel=scan_result_info.pPANDescriptorList[0].logicalChannel;
 667               	.LM74:
 668 02a6 8C85      		ldd r24,Y+12
 669 02a8 8093 0000 		sts ppib,r24
 670 02ac 03C0      		rjmp .L22
 671               	.L29:
 316:mac.c         **** 	    //PLME_SET_request(phyCurrentChanel_id, ppib.phyCurrentChanel);
 317:mac.c         **** 	    //OS_post(synrequest_task);
 318:mac.c         ****        }
 319:mac.c         ****  	else
 320:mac.c         ****  	{
 321:mac.c         ****  	   if(!IS_COORDINATOR)
 322:mac.c         ****  	   	{
 323:mac.c         ****  	   mac_current_state=MAC_STATE_UNSTARTED;
 324:mac.c         **** 	 //printf("\n--PASSIVE SCAN FAILURE-----\n");
 325:mac.c         ****  	   	}
 326:mac.c         **** 	   else
 327:mac.c         **** 	   	{
 328:mac.c         **** 	   mac_current_state=MAC_STATE_ACTIVE_PASSIVE_SCAN_FINISHED;
 673               	.LM75:
 674 02ae 8AE0      		ldi r24,lo8(10)
 675               	.L32:
 676 02b0 8093 0000 		sts mac_current_state,r24
 677               	.L22:
 678               	/* epilogue: frame size=0 */
 679 02b4 DF91      		pop r29
 680 02b6 CF91      		pop r28
 681 02b8 0895      		ret
 682               	/* epilogue end (size=3) */
 683               	/* function mlmeScanConfirm size 79 (72) */
 685               	.Lscope3:
 687               	.global	mlmeStartConfirm
 689               	mlmeStartConfirm:
 329:mac.c         **** 	 //printf("\n---doesn't exist any 802.15.4 network ----\n");
 330:mac.c         **** 	 //printf("---I will be the coordinator----");
 331:mac.c         **** 	   	}
 332:mac.c         **** 	   //OS_post(scan_task);	
 333:mac.c         ****  	} 
 334:mac.c         ****        
 335:mac.c         **** }
 336:mac.c         **** 
 337:mac.c         **** void scan_task(void)
 338:mac.c         **** {
 339:mac.c         ****     mlmeScanRequest(ACTIVE_PASSIVE_SCAN, 0x00000008, 6);
 340:mac.c         **** }
 341:mac.c         **** 
 342:mac.c         **** 
 343:mac.c         **** //**************************//
 344:mac.c         **** //¿ªÊ¼×éÖ¯Ò»¸öÐÂµÄÍøÂç,´«ËÍ³¬Ö¡(±ØÐëÊÇFFDÉè±¸²Å¿ÉÒÔµ÷ÓÃ¸ÃÔ­Óïº¯Êý)
 345:mac.c         **** //Èç¹ûÊÇÍøÂçÐ­µ÷Õß£¬½«ºöÂÔ¸Ãº¯ÊýµÄstarttime²ÎÊý
 346:mac.c         **** //NOTE:ÔÚµ÷ÓÃ¸Ãº¯ÊýÇ°£¬¶ÔÓÚÐ­µ÷ÕßÀ´Ëµ£¬Ó¦¸ÃÒÑ¾­ÉèÖÃºÃÁËËùÓÐÍøÂçµÄ²ÎÊý
 347:mac.c         **** //¶ÔÓÚ·ÇÐ­µ÷ÕßµÄFFD(Ïàµ±ÓÚ¶àÌøÍøÂçÖÐµÄ´Ø½Úµã)À´Ëµ£¬Ó¦¸ÃÒÑ¾­Í¬²½µ½Æä¸¸½Úµã(¼´ËüËù¹ØÁªµÄ½Úµã)µÄÐÅ±êÖ¡
 348:mac.c         **** //¶ÔÓÚ·ÇÐ­µ÷ÕßµÄFFD·¢ËÍÐÅ±êÖ¡Ê±ºò£¬Êµ¼ÊÉÏstarttimeÒ²½«×÷ÎªËüÐÅ±êÖ¡¸ºÔØµÄtxoffsetÓòµÄÖµ
 349:mac.c         **** //PIBÀïÃæÓÐ¸ö³ÉÔ±macBeaconTxtime¼ÇÂ¼×ÅÉÏÒ»´Î·¢ËÍÐÅ±êÖ¡µÄ·ûºÅÊýÄ¿ÊÇ¶àÉÙ¡£
 350:mac.c         **** void mlmeStartRequest(SHORT_ADDR panId, uint8_t  logicalChannel, uint8_t beaconOrder, uint8_t super
 351:mac.c         **** {
 352:mac.c         **** 
 353:mac.c         ****    SET_STATE  temp_return_SET;
 354:mac.c         ****    uint8_t return_state;
 355:mac.c         ****    mac_tx_beacon.beacon_payload_length=0;
 356:mac.c         ****    mac_tx_beacon.longpendingadd_length=0;
 357:mac.c         ****    mac_tx_beacon.shortpendingadd_length=0;
 358:mac.c         ****    //printf("\n*******the beacon order is %02x\n",beaconOrder);
 359:mac.c         ****    //printf("\n*******the super order is %02x\n",superframeOrder);
 360:mac.c         ****    mac_tx_beacon.superframe_field.SF.bytes.LSB=((superframeOrder<<4)|beaconOrder);
 361:mac.c         ****    //ÓÉÓÚÎÒÃÇ²»²ÉÓÃGTS´«Êä,ËùÒÔÕâÀïÉèÖÃfinalCAPSlotÎª15.
 362:mac.c         ****    if(panCoordinator)
 363:mac.c         ****    mac_tx_beacon.superframe_field.SF.bytes.MSB=(0x80)|(0x40)|(0x0f);
 364:mac.c         ****    else
 365:mac.c         ****    mac_tx_beacon.superframe_field.SF.bytes.MSB=(0x80)|(0x0f);
 366:mac.c         ****    //printf("\n*******the superframe_field is %02x\n",mac_tx_beacon.superframe_field.SF.bytes.LSB);
 367:mac.c         ****    //printf("\n*******the superframe_field is %02x\n",mac_tx_beacon.superframe_field.SF.bytes.MSB);
 368:mac.c         ****    mac_pib_data.macPANId=panId;
 369:mac.c         ****    mac_pib_data.macBeaconOrder=beaconOrder;
 370:mac.c         ****    mac_pib_data.macSuperframeOrder=superframeOrder;
 371:mac.c         ****    ppib.phyCurrentChanel=logicalChannel;
 372:mac.c         ****    //printf("\n====Base is %d   \n====macBeacon is %d   \n===superframeorder is %d",aBaseSuperframe
 373:mac.c         ****    MAC_SUPERFRAME_PERIOD=(uint32_t)(((uint32_t)aBaseSuperframeDuration)<<(mac_pib_data.macBeaconOrd
 374:mac.c         ****    MAC_CAP_PERIOD=(uint32_t)(((uint32_t)aBaseSuperframeDuration)<<(mac_pib_data.macSuperframeOrder)
 375:mac.c         ****    //printf("\n ---------cap   time is %08lx",MAC_CAP_PERIOD); 	
 376:mac.c         ****    //printf("\n ---------super time is %08lx",MAC_SUPERFRAME_PERIOD);	 
 377:mac.c         ****    temp_return_SET=PLME_SET_request(phyCurrentChanel_id, logicalChannel);
 378:mac.c         ****    /*return_state=PLME_SET_TRX_STATE_request(TX_ON);
 379:mac.c         ****    if(return_state!=PHY_SUCCESS)  
 380:mac.c         ****    	{
 381:mac.c         ****    	   error("\nopen the RF failure\n");
 382:mac.c         **** 	 //printf("%d",return_state);
 383:mac.c         **** 	   return;
 384:mac.c         ****    	}*/
 385:mac.c         ****    if(!coordRealignment)
 386:mac.c         ****    	beacon_frame_send(TRUE);
 387:mac.c         ****    else
 388:mac.c         ****    	coordinator_realignment_frame_send(FALSE, default_node, default_short_addr);
 389:mac.c         **** }
 390:mac.c         **** 
 391:mac.c         **** void mlmeStartConfirm(void)
 392:mac.c         **** {
 691               	.LM76:
 692               	/* prologue: frame size=0 */
 693               	/* prologue end (size=0) */
 694               	/* epilogue: frame size=0 */
 695 02ba 0895      		ret
 696               	/* epilogue end (size=1) */
 697               	/* function mlmeStartConfirm size 1 (0) */
 699               	.Lscope4:
 700               		.data
 701               	.LC0:
 702 0000 0A2D 2D2D 		.string	"\n----the association request frame is no acked-----"
 702      2D74 6865 
 702      2061 7373 
 702      6F63 6961 
 702      7469 6F6E 
 703               	.LC1:
 704 0034 0A2D 2D2D 		.string	"\n---didn't received the association response frame---"
 704      6469 646E 
 704      2774 2072 
 704      6563 6569 
 704      7665 6420 
 705               		.text
 709               	.global	mlmeAssociateConfirm
 711               	mlmeAssociateConfirm:
 393:mac.c         **** 	//Í¨Öª¸ß²ã·¢ËÍÍê±Ï¡£
 394:mac.c         **** 	//¿ÉÒÔÍ¨¹ýpost¸ß²ãÈÎÎñÀ´Íê³É¸ß²ãµÄº¯ÊýÈÎÎñ
 395:mac.c         **** 	//¿Õº¯Êý£¬¸ß²ãÊµÏÖ
 396:mac.c         **** }
 397:mac.c         **** 
 398:mac.c         **** //**************************//
 399:mac.c         **** void mlmeAssociateRequest(UINT8 logicalChannel, BYTE coordAddrMode, SHORT_ADDR coordPANId, ADDRESS 
 400:mac.c         **** {
 401:mac.c         **** 	//ÉèÖÃÏµÍ³µÄMAC×´Ì¬±äÁ¿ÎªMAC_STATE_ASSOC_STARTED
 402:mac.c         **** 	//µ÷ÓÃ·¢ËÍÈÎÎñ·¢ËÍassociate requestÖ¡¡£POST()
 403:mac.c         **** 	NODE_INFO dst;
 404:mac.c         **** 	SET_STATE  temp_return_SET;
 405:mac.c         **** 	dst.addrMode=coordAddrMode;
 406:mac.c         **** 	dst.panID=coordPANId;
 407:mac.c         **** 	if(coordAddrMode==0x03)
 408:mac.c         **** 		dst.longAddr=pCoordAddress.Extended;
 409:mac.c         **** 	else if(coordAddrMode==0x02)
 410:mac.c         **** 		dst.shortAddr=pCoordAddress.Short;
 411:mac.c         **** 	//mac_current_state=MAC_STATE_ASSOC_REQ_SENT;
 412:mac.c         **** 	if(!IS_COORDINATOR)
 413:mac.c         **** 	{  
 414:mac.c         ****           temp_return_SET=PLME_SET_request(phyCurrentChanel_id, logicalChannel);
 415:mac.c         **** 	   //if(phy_channel_state==PHY_IDLE)
 416:mac.c         **** 	   	//{
 417:mac.c         **** 	   	    mac_current_state=MAC_STATE_ASSOC_REQ_SENT;
 418:mac.c         **** 	   	    associate_request_frame_send(coordPANId, dst, capabilityInformation);
 419:mac.c         **** 	   	//}	  
 420:mac.c         **** 	   /*else
 421:mac.c         **** 	   	{
 422:mac.c         **** 	   	    mac_current_state=
 423:mac.c         **** 	   	}*/
 424:mac.c         **** 	} 
 425:mac.c         **** 	//else if(IS_FFD)............
 426:mac.c         **** }
 427:mac.c         **** void mlmeAssociateConfirm(SHORT_ADDR AssocShortAddress, BYTE status)
 428:mac.c         **** {
 713               	.LM77:
 714               	/* prologue: frame size=0 */
 715 02bc CF93      		push r28
 716 02be DF93      		push r29
 717               	/* prologue end (size=2) */
 718 02c0 EC01      		movw r28,r24
 429:mac.c         **** 	//printf("\n------success associate------ %d\n",status);
 430:mac.c         **** 	//printf("\nthe allocated short address is %04x\n",AssocShortAddress.Val);
 431:mac.c         **** 	if(status==NO_ACK)
 720               	.LM78:
 721 02c2 693E      		cpi r22,lo8(-23)
 722 02c4 19F4      		brne .L35
 432:mac.c         **** 		printf("\n----the association request frame is no acked-----\n");
 724               	.LM79:
 725 02c6 80E0      		ldi r24,lo8(.LC0)
 726 02c8 90E0      		ldi r25,hi8(.LC0)
 727 02ca 04C0      		rjmp .L39
 728               	.L35:
 433:mac.c         **** 	//Á½ÖÖÇé¿öÎªNO_DATA
 434:mac.c         **** 	if(status==NO_DATA)
 730               	.LM80:
 731 02cc 6B3E      		cpi r22,lo8(-21)
 732 02ce 29F4      		brne .L36
 435:mac.c         **** 		printf("\n---didn't received the association response frame---\n");
 734               	.LM81:
 735 02d0 80E0      		ldi r24,lo8(.LC1)
 736 02d2 90E0      		ldi r25,hi8(.LC1)
 737               	.L39:
 738 02d4 0E94 0000 		call puts
 739 02d8 18C0      		rjmp .L37
 740               	.L36:
 436:mac.c         **** 	if(status==SUCCESS)
 742               	.LM82:
 743 02da 6623      		tst r22
 744 02dc B1F4      		brne .L37
 437:mac.c         **** 	{
 438:mac.c         **** 	mac_current_state=MAC_STATE_ASSOC_FINISHED;
 746               	.LM83:
 747 02de 84E0      		ldi r24,lo8(4)
 748 02e0 8093 0000 		sts mac_current_state,r24
 439:mac.c         **** 	//mac_current_state=MAC_STATE_IDLE;
 440:mac.c         **** 	//mac_current_state_saved=MAC_STATE_IDLE;
 441:mac.c         **** 	phy_channel_state=PHY_IDLE;
 750               	.LM84:
 751 02e4 6093 0000 		sts phy_channel_state,r22
 442:mac.c         **** 	PLME_SET_TRX_STATE_request(RX_ON);
 753               	.LM85:
 754 02e8 86E0      		ldi r24,lo8(6)
 755 02ea 0E94 0000 		call PLME_SET_TRX_STATE_request
 443:mac.c         **** 	mac_pib_data.macShortAddress=AssocShortAddress;
 757               	.LM86:
 758 02ee D093 0000 		sts (mac_pib_data+32)+1,r29
 759 02f2 C093 0000 		sts mac_pib_data+32,r28
 444:mac.c         **** 	cc2420_setshortaddress((uint16_t)mac_pib_data.macShortAddress.Val);
 761               	.LM87:
 762 02f6 CE01      		movw r24,r28
 763 02f8 0E94 0000 		call cc2420_setshortaddress
 445:mac.c         ****        cc2420_setpanid((uint16_t)mac_pib_data.macPANId.Val);		
 765               	.LM88:
 766 02fc 8091 0000 		lds r24,mac_pib_data+28
 767 0300 9091 0000 		lds r25,(mac_pib_data+28)+1
 768 0304 0E94 0000 		call cc2420_setpanid
 769 0308 03C0      		rjmp .L34
 770               	.L37:
 446:mac.c         **** 	}
 447:mac.c         **** 	else 
 448:mac.c         **** 	{
 449:mac.c         **** 	   //Ö÷Òª¹¤×÷ÓÉÍøÂç²ã¾ö¶¨
 450:mac.c         **** 	   mac_current_state=MAC_STATE_SYNING_END;
 772               	.LM89:
 773 030a 8FE0      		ldi r24,lo8(15)
 774 030c 8093 0000 		sts mac_current_state,r24
 775               	.L34:
 776               	/* epilogue: frame size=0 */
 777 0310 DF91      		pop r29
 778 0312 CF91      		pop r28
 779 0314 0895      		ret
 780               	/* epilogue end (size=3) */
 781               	/* function mlmeAssociateConfirm size 45 (40) */
 783               	.Lscope5:
 784               		.data
 785               	.LC2:
 786 006a 0A2D 2D2D 		.string	"\n----the coordinator received the disassociation indication----"
 786      2D74 6865 
 786      2063 6F6F 
 786      7264 696E 
 786      6174 6F72 
 787               		.text
 793               	.global	mlmeDisassociateIndication
 795               	mlmeDisassociateIndication:
 451:mac.c         **** 	}
 452:mac.c         **** }
 453:mac.c         **** 
 454:mac.c         **** //**************************//
 455:mac.c         **** void mlmeAssociateIndication(MLME_ASSOCIATE_INDICATION   mlme_associate_indication_info)
 456:mac.c         **** {
 457:mac.c         **** 	//Ð­µ÷ÕßÔÚÊÕµ½associate requestÖ¡ºóÍ¨Öª¸ß²ã
 458:mac.c         **** 	//¿ÉÒÔpost¸ß²ãÈÎÎñ
 459:mac.c         **** 	BYTE status;
 460:mac.c         **** 	SHORT_ADDR  shortaddr_alloc;
 461:mac.c         **** 	//Ö÷ÒªÈÎÎñÊÇµ÷ÓÃmlmeassociateresponseÔ­Óï
 462:mac.c         **** 	//------------------------------------------------------
 463:mac.c         **** 	//---------------´ýÌí¼Ó------------------------------
 464:mac.c         **** 	//--------ÍøÂç²ãÊÇ·ñ¾ö¶¨¹ØÁª-------------------
 465:mac.c         **** 	//--------ÐÞ¸Ästatus,·ÖÅäshortaddr--------------------
 466:mac.c         ****      //printf("\n------success received an association request frame--------\n");
 467:mac.c         **** 	//for(uint8_t i=0;i<8;i++)
 468:mac.c         **** 	//	printf("\nthe addr is v[%d]=%d\n",i,mlme_associate_indication_info.Deviceaddr.v[i]);
 469:mac.c         **** 	//shortaddr_alloc.Val=RFD_SHORT_ADDRESS;
 470:mac.c         **** 	shortaddr_alloc=short_address_allocate_req(mlme_associate_indication_info.Deviceaddr);
 471:mac.c         **** 	printf("\n---allocated short addr is %04x---\n",shortaddr_alloc.Val);
 472:mac.c         **** 	status=0x00;
 473:mac.c         **** 	mlmeAssociateResponse(mlme_associate_indication_info.Deviceaddr, shortaddr_alloc,status, FALSE);
 474:mac.c         **** }
 475:mac.c         **** //**************************//
 476:mac.c         **** void mlmeAssociateResponse(LONG_ADDR deviceAddress, SHORT_ADDR assocShortAddress, BYTE status, bool
 477:mac.c         **** {
 478:mac.c         **** 	//Ð­µ÷ÕßµÄ¸ß²ãÔÚÊÕµ½associate indicationÔ­ÓïºóÏìÓ¦MAC²ãµÄÔ­Óï
 479:mac.c         **** 	//MAC²ãµ÷ÓÃ·¢ËÍÈÎÎñ·¢ËÍassociate responseÖ¡
 480:mac.c         **** 	FRAME_CONTROL framectl_field;
 481:mac.c         **** 	NODE_INFO dst; 
 482:mac.c         **** 	NODE_INFO src; 
 483:mac.c         **** 	//ÏÂÃæ²»ÓÃ×ö.
 484:mac.c         **** 	dst.addrMode=0x03;
 485:mac.c         **** 	src.addrMode=0x03;
 486:mac.c         **** 	dst.panID=mac_pib_data.macPANId;
 487:mac.c         **** 	src.panID=mac_pib_data.macPANId;
 488:mac.c         ****        src.longAddr=mac_pib_data.macExtAddress;	
 489:mac.c         **** 	dst.longAddr=deviceAddress;
 490:mac.c         **** 	framectl_field.v[0]=0x23;
 491:mac.c         **** 	framectl_field.v[1]=0xcc;
 492:mac.c         **** 	
 493:mac.c         **** 	//
 494:mac.c         **** 	if((IS_FFD!=0x00)&&(mac_current_state==MAC_STATE_IDLE)&&(current_pending_num<MAX_PENDING_LIST_SIZE
 495:mac.c         **** 		{
 496:mac.c         **** 		    add_pending_queue(0, framectl_field, dst,src,0, NULL, status, TRUE, deviceAddress,assocShortA
 497:mac.c         **** 		}
 498:mac.c         **** 	else if(current_pending_num>=MAX_PENDING_LIST_SIZE)	
 499:mac.c         **** 		{
 500:mac.c         **** 		   //printf("\npending full\n");
 501:mac.c         **** 		     //ÏòÉÏ²ã±¨¸æ
 502:mac.c         **** 		     //mlme_comm_status()
 503:mac.c         **** 		}
 504:mac.c         **** 	//--------------------------------------------------
 505:mac.c         ****        //In order to test the disassociation frame from the coordinator
 506:mac.c         ****        //LONG_ADDR  RFD_LONG_ADDR;
 507:mac.c         **** 
 508:mac.c         **** 	//test the coordinator want the RFD leave the network
 509:mac.c         ****        //mlmeDisassociateRequest(deviceAddress,0x01, FALSE);
 510:mac.c         **** 
 511:mac.c         ****       //---------------------------------------------------
 512:mac.c         **** 	
 513:mac.c         **** 		
 514:mac.c         **** }
 515:mac.c         **** 
 516:mac.c         **** 
 517:mac.c         **** //**************************//
 518:mac.c         **** void mlmeDisassociateRequest(LONG_ADDR pDeviceAddress, BYTE disassociateReason, bool securityEnable
 519:mac.c         **** {
 520:mac.c         **** 	//Ð­µ÷ÕßºÍÒ»°ãÉè±¸¶¼¿É·¢ËÍ¸ÃÇëÇó
 521:mac.c         **** 	//MAC²ãµ÷ÓÃ·¢ËÍÈÎÎñ·¢ËÍdisassociation notificationÖ¡
 522:mac.c         **** 	//Èç¹ûÊÇÐ­µ÷Õß½«²ÉÓÃ¼ä½Ó·¢ËÍ,½øÈëpending¶ÓÁÐ£¬ÆäÖÐÐèÒªÉèÖÃÏµÍ³MAC²ãµÄ×´Ì¬±äÁ¿
 523:mac.c         **** 	FRAME_CONTROL framectl_field;
 524:mac.c         **** 	NODE_INFO dst;
 525:mac.c         **** 	NODE_INFO src;
 526:mac.c         **** 	//ÏÂÃæÎªÖØ¸´ÐÔ¹¤×÷£¬¿ÉÒÔÉ¾³ý
 527:mac.c         **** 	dst.addrMode=0x03;
 528:mac.c         **** 	src.addrMode=0x03;
 529:mac.c         **** 	dst.panID=mac_pib_data.macPANId;
 530:mac.c         **** 	src.panID=mac_pib_data.macPANId;
 531:mac.c         **** 	src.longAddr=mac_pib_data.macExtAddress;
 532:mac.c         **** 	
 533:mac.c         **** 	//
 534:mac.c         **** 	framectl_field.v[0]=0x23;
 535:mac.c         **** 	if(!IS_COORDINATOR)
 536:mac.c         **** 	framectl_field.v[1]=0xc8;
 537:mac.c         **** 	else	
 538:mac.c         **** 	framectl_field.v[1]=0xcc;
 539:mac.c         ****        if((mac_current_state)==MAC_STATE_IDLE)
 540:mac.c         ****        {
 541:mac.c         ****           if((IS_FFD!=0x00)&&(current_pending_num<=MAX_PENDING_LIST_SIZE))
 542:mac.c         ****           	{
 543:mac.c         ****           	    dst.longAddr=pDeviceAddress;
 544:mac.c         **** 		    add_pending_queue(0, framectl_field, dst, src, 0, NULL,disassociateReason,FALSE,pDeviceAddres
 545:mac.c         **** 		
 546:mac.c         ****           	}
 547:mac.c         ****           else
 548:mac.c         ****           	{
 549:mac.c         ****           	    dst.longAddr=mac_pib_data.macCoordExtendedAddress;
 550:mac.c         **** 		    disassociate_notification_frame_send(disassociateReason, mac_pib_data.macCoordExtendedAddress
 551:mac.c         ****           	}	
 552:mac.c         ****        }
 553:mac.c         **** }
 554:mac.c         **** 
 555:mac.c         **** void mlmeDisassociateIndication(LONG_ADDR deviceAddress, BYTE disassociateReason, bool securityUse,
 556:mac.c         **** {
 797               	.LM90:
 798               	/* prologue: frame size=8 */
 799 0316 CF93      		push r28
 800 0318 DF93      		push r29
 801 031a CDB7      		in r28,__SP_L__
 802 031c DEB7      		in r29,__SP_H__
 803 031e 2897      		sbiw r28,8
 804 0320 0FB6      		in __tmp_reg__,__SREG__
 805 0322 F894      		cli
 806 0324 DEBF      		out __SP_H__,r29
 807 0326 0FBE      		out __SREG__,__tmp_reg__
 808 0328 CDBF      		out __SP_L__,r28
 809               	/* prologue end (size=10) */
 810 032a 2983      		std Y+1,r18
 811 032c 3A83      		std Y+2,r19
 812 032e 4B83      		std Y+3,r20
 813 0330 5C83      		std Y+4,r21
 814 0332 6D83      		std Y+5,r22
 815 0334 7E83      		std Y+6,r23
 816 0336 8F83      		std Y+7,r24
 817 0338 9887      		std Y+8,r25
 557:mac.c         **** 	//Ð­µ÷Õß»òÖÕ¶ËÉè±¸ÔÚÊÕµ½¶Ô·½·¢¹ýÀ´µÄdisassociation notificationÖ¡ºó
 558:mac.c         **** 	//Í¨Öª¸ß²ã¡£post¸ß²ãÈÎÎñ
 559:mac.c         **** 	//¿Õº¯Êý£¬¸ß²ãÊµÏÖ
 560:mac.c         **** 	//------------------------------------------------------
 561:mac.c         **** 	//---------------´ýÌí¼Ó------------------------------
 562:mac.c         **** 	//--------ÍøÂç²ãÉ¾³ý¶ÔÓ¦µÄassociate¼ÇÂ¼--------
 563:mac.c         **** 	//-------------------------------------------------------
 564:mac.c         ****        if(!IS_COORDINATOR)
 565:mac.c         ****        {
 566:mac.c         **** 	 //printf("\n--the RFD received the disassociation indiation----\n");
 567:mac.c         **** 	   mac_current_state=MAC_STATE_IDLE;
 568:mac.c         ****        }  
 569:mac.c         **** 	else
 570:mac.c         **** 	printf("\n----the coordinator received the disassociation indication----\n");	
 819               	.LM91:
 820 033a 80E0      		ldi r24,lo8(.LC2)
 821 033c 90E0      		ldi r25,hi8(.LC2)
 822 033e 0E94 0000 		call puts
 823               	/* epilogue: frame size=8 */
 824 0342 2896      		adiw r28,8
 825 0344 0FB6      		in __tmp_reg__,__SREG__
 826 0346 F894      		cli
 827 0348 DEBF      		out __SP_H__,r29
 828 034a 0FBE      		out __SREG__,__tmp_reg__
 829 034c CDBF      		out __SP_L__,r28
 830 034e DF91      		pop r29
 831 0350 CF91      		pop r28
 832 0352 0895      		ret
 833               	/* epilogue end (size=9) */
 834               	/* function mlmeDisassociateIndication size 31 (12) */
 836               	.Lscope6:
 837               		.data
 838               	.LC3:
 839 00aa 0A2D 2D2D 		.string	"\n---success disassociated the object RFD from the network------"
 839      7375 6363 
 839      6573 7320 
 839      6469 7361 
 839      7373 6F63 
 840               		.text
 843               	.global	mlmeDisassociateConfirm
 845               	mlmeDisassociateConfirm:
 571:mac.c         **** 	
 572:mac.c         **** }
 573:mac.c         **** void mlmeDisassociateConfirm(MAC_ENUM status)
 574:mac.c         **** {
 847               	.LM92:
 848               	/* prologue: frame size=0 */
 849               	/* prologue end (size=0) */
 575:mac.c         **** 	//ÔÚMAC²ã·¢ËÍÍê³É(ÎÞÂÛ³É¹¦ÓëÊ§°Ü)£¬½«µ÷ÓÃ¸ÃÔ­ÓïÍ¨Öª¸ß²ã
 576:mac.c         **** 	//»Ö¸´ÏµÍ³µÄMAC²ãµÄ×´Ì¬±äÁ¿
 577:mac.c         ****   //¿ÉÒÔpostÒ»¸ö¸ß²ãÈÎÎñ
 578:mac.c         ****   //¿Õº¯Êý£¬¸ß²ãÊµÏÖ
 579:mac.c         ****      if(status==SUCCESS)
 851               	.LM93:
 852 0354 8823      		tst r24
 853 0356 21F4      		brne .L43
 580:mac.c         ****      {
 581:mac.c         ****          if(!IS_COORDINATOR)
 582:mac.c         ****              printf("\n---success disassociated from the network-----\n");
 583:mac.c         ****          else
 584:mac.c         ****              printf("\n---success disassociated the object RFD from the network------\n");	 	
 855               	.LM94:
 856 0358 80E0      		ldi r24,lo8(.LC3)
 857 035a 90E0      		ldi r25,hi8(.LC3)
 858 035c 0E94 0000 		call puts
 859               	.L43:
 860 0360 0895      		ret
 861               	/* epilogue: frame size=0 */
 862 0362 0895      		ret
 863               	/* epilogue end (size=1) */
 864               	/* function mlmeDisassociateConfirm size 8 (7) */
 866               	.Lscope7:
 874               	.global	mlmeCommStatusIndication
 876               	mlmeCommStatusIndication:
 585:mac.c         ****      }		 
 586:mac.c         **** }
 587:mac.c         **** 
 588:mac.c         **** void mlmeBeaconNotifyIndication(MLME_BEACON_NOTIFY_INDICATION  beacon_info)
 589:mac.c         **** {
 590:mac.c         ****        bool Is_pending;
 591:mac.c         **** 	uint8_t  i;
 592:mac.c         **** 	Is_pending=FALSE;
 593:mac.c         **** 	//printf("\nmac_current state is %d--\n",mac_current_state);
 594:mac.c         **** 	if(mac_current_state==MAC_STATE_ACTIVE_PASSIVE_SCAN)
 595:mac.c         ****       	{
 596:mac.c         **** 	   scan_result_info.scanType=ACTIVE_PASSIVE_SCAN;
 597:mac.c         **** 	   scan_result_info.status=SUCCESS;
 598:mac.c         **** 	   //scan_result_info.resultListSize++;
 599:mac.c         **** 	   if(scan_result_info.resultListSize>MAC_MAX_PAN_DESCRIPTORS)
 600:mac.c         **** 	   	{
 601:mac.c         **** 	   	   head_of_timer_queue=timer3quere_cancel(head_of_timer_queue, 0,WAIT_SCAN);
 602:mac.c         **** 		   mlmeScanConfirm(scan_result_info);
 603:mac.c         **** 		   mac_current_state=MAC_STATE_ACTIVE_PASSIVE_SCAN_FINISHED;
 604:mac.c         **** 		   PLME_SET_TRX_STATE_request(TRX_OFF);
 605:mac.c         **** 		   phy_channel_state=INACTIVE_PERIOD;
 606:mac.c         ****                //printf("\n$$$$$$$$$$sccessed finish passive scan$$$$$$$$$$$\n");
 607:mac.c         **** 		   
 608:mac.c         **** 	   	}
 609:mac.c         **** 	   else
 610:mac.c         **** 	   	{
 611:mac.c         **** 	   	   scan_result_info.pPANDescriptorList[scan_result_info.resultListSize]=beacon_info.panDescrip
 612:mac.c         **** 		   scan_result_info.resultListSize++;  
 613:mac.c         **** 	   	}
 614:mac.c         ****       	}
 615:mac.c         **** 	/*else if()
 616:mac.c         **** 	{
 617:mac.c         **** 	     
 618:mac.c         **** 	}*/
 619:mac.c         **** 	else  
 620:mac.c         **** 	{     
 621:mac.c         **** 	       for(i=0;i<beacon_info.shortpendingadd_length;i++)
 622:mac.c         **** 	       	{
 623:mac.c         **** 	       	      if(beacon_info.shortaddrpending_list[i].Val==mac_pib_data.macShortAddress.Val)
 624:mac.c         **** 				  	Is_pending=TRUE;
 625:mac.c         **** 	       	}
 626:mac.c         **** 		for(i=0;i<beacon_info.longpendingadd_length;i++)
 627:mac.c         **** 			{
 628:mac.c         **** 			      if(beacon_info.longaddrpending_list[i].longaddr==mac_pib_data.macExtAddress.longaddr)
 629:mac.c         **** 				  	Is_pending=TRUE;
 630:mac.c         **** 			}
 631:mac.c         **** 	       /*if((Is_pending)&&(mac_current_state==MAC_STATE_ASSOC_WAIT_FOR_RESPONSE))
 632:mac.c         **** 		{
 633:mac.c         **** 		     //ÓÐµãÐ¡ÎÊÌâ£¬Èç¹ûÐ­µ÷Õß·¢ËÍÊý¾ÝÖ¡ÔõÃ´°ì?  
 634:mac.c         **** 		     //head_of_timer_queue=timer3quere_cancel(head_of_timer_queue,0, WAIT_FOR_RESPONSE);
 635:mac.c         **** 		}*/
 636:mac.c         **** 		if(Is_pending)
 637:mac.c         **** 			//·¢ËÍdata requestÖ¡
 638:mac.c         **** 			{
 639:mac.c         **** 			      //printf("\nbe told there is association response frame in the coordinator\n");
 640:mac.c         **** 			      data_request_frame_send();	   
 641:mac.c         **** 			}
 642:mac.c         **** 			//data_request_frame_send();
 643:mac.c         ****                 /*#ifdef  I_AM_RFD 			                                                             
 644:mac.c         ****                 else                                                                               
 645:mac.c         ****                 {                                                                                  
 646:mac.c         ****                 		    //test  beacon  received                                                     
 647:mac.c         ****                 		  //printf("\nsuccess received a beacon frame\n");                               
 648:mac.c         ****                 		  //printf("\n the logical channel is %d",beacon_info.panDescriptor.logicalChanne
 649:mac.c         ****                 		  //printf("\n the coord panid is %08x",beacon_info.panDescriptor.coordinator.pan
 650:mac.c         ****                 	         //printf("\n the coord address  is %08x",beacon_info.panDescriptor.coordi
 651:mac.c         ****                 }                                                                                  
 652:mac.c         ****                 #endif   */                                                                        
 653:mac.c         **** 	}       
 654:mac.c         **** }               
 655:mac.c         **** //*************************//
 656:mac.c         **** void mlmeOrphanIndication(LONG_ADDR orphanAddress, bool securityUse, BYTE aclEntry)
 657:mac.c         **** {               
 658:mac.c         **** 	//Ð­µ÷Õß»ò´ØÍ·½ÚµãÔÚÊÕµ½Ò»¸öÉè±¸·¢ËÍ¹ýÀ´µÄorphan nitificationÖ¡Ê±ºòÍ¨Öª¸ß²ãµÄÔ­Óï
 659:mac.c         **** 	//Íê³É¸ß²ãÈÎÎñ£¬¸ÃÈÎÎñÖ÷ÒªÊÇµ÷ÓÃorphan responseÔ­Óï¡£
 660:mac.c         **** 	SHORT_ADDR shortaddress;
 661:mac.c         **** 	//²éÕÒ¶ÔÓ¦orphanAddressµÄshortaddress.
 662:mac.c         **** 	//-------------------------------------------
 663:mac.c         **** 	//-------------------´ýÌí¼Ó--------------
 664:mac.c         **** 	//--------------ÍøÂç²ãµÄ´úÂë----------
 665:mac.c         **** 	//shortaddress.Val=0xfc8b;
 666:mac.c         ****        //shortaddress.Val=RFD_SHORT_ADDRESS;
 667:mac.c         **** 	printf("\nsuccess received a orphan notification frame\n");
 668:mac.c         **** 	shortaddress=short_address_allocate_req(orphanAddress);
 669:mac.c         **** 	mlmeOrphanResponse(orphanAddress, shortaddress, TRUE, FALSE);
 670:mac.c         **** }
 671:mac.c         **** //*************************//
 672:mac.c         **** void mlmeOrphanResponse(LONG_ADDR orphanAddress, SHORT_ADDR shortAddress, bool associatedMember, bo
 673:mac.c         **** {
 674:mac.c         **** 	//Ð­µ÷Õß»ò´ØÍ·½Úµã¸ß²ãÔÚÊÕµ½orphan indicationºó×÷Îª¶ÔMAC²ãµÄÒ»¸öÏìÓ¦
 675:mac.c         **** 	//MAC²ãµ÷ÓÃ·¢ËÍÈÎÎñ·¢ËÍcoordinator realignmentÖ¡
 676:mac.c         **** 	NODE_INFO  dst;
 677:mac.c         **** 	dst.addrMode=0x03;
 678:mac.c         **** 	dst.longAddr.longaddr=orphanAddress.longaddr;
 679:mac.c         **** 	//dst
 680:mac.c         ****        if((IS_FFD)&&(associatedMember)&&(mac_current_state==MAC_STATE_IDLE))
 681:mac.c         **** 	   	coordinator_realignment_frame_send(1, dst,shortAddress);
 682:mac.c         **** 	   	
 683:mac.c         **** 	   	
 684:mac.c         **** }
 685:mac.c         **** 
 686:mac.c         **** 
 687:mac.c         **** void mlmeCommStatusIndication(WORD panId, BYTE srcAddrMode, ADDRESS *pSrcAddr, BYTE dstAddrMode, AD
 688:mac.c         **** {
 878               	.LM95:
 879               	/* prologue: frame size=0 */
 880               	/* prologue end (size=0) */
 881               	/* epilogue: frame size=0 */
 882 0364 0895      		ret
 883               	/* epilogue end (size=1) */
 884               	/* function mlmeCommStatusIndication size 1 (0) */
 886               	.Lscope8:
 891               	.global	mlmeRxEnableRequest
 893               	mlmeRxEnableRequest:
 689:mac.c         **** 	//Í¨Öª¸ß²ãÏÔÊ¾responseÖ¡µÄ´«ÊäÇé¿ö
 690:mac.c         **** 	//¿Õº¯Êý
 691:mac.c         **** }
 692:mac.c         **** 
 693:mac.c         **** 
 694:mac.c         **** void mlmeRxEnableRequest(bool deferPermit, uint32_t rxOnTime, uint32_t rxOnDuration)
 695:mac.c         **** {
 895               	.LM96:
 896               	/* prologue: frame size=0 */
 897               	/* prologue end (size=0) */
 898               	/* epilogue: frame size=0 */
 899 0366 0895      		ret
 900               	/* epilogue end (size=1) */
 901               	/* function mlmeRxEnableRequest size 1 (0) */
 903               	.Lscope9:
 906               	.global	mlmeRxEnableConfirm
 908               	mlmeRxEnableConfirm:
 696:mac.c         **** 	//¿Õº¯Êý
 697:mac.c         **** }
 698:mac.c         **** void mlmeRxEnableConfirm(MAC_ENUM status)
 699:mac.c         **** {
 910               	.LM97:
 911               	/* prologue: frame size=0 */
 912               	/* prologue end (size=0) */
 913               	/* epilogue: frame size=0 */
 914 0368 0895      		ret
 915               	/* epilogue end (size=1) */
 916               	/* function mlmeRxEnableConfirm size 1 (0) */
 918               	.Lscope10:
 922               	.global	mlmeSyncRequest
 924               	mlmeSyncRequest:
 700:mac.c         **** 	//¿Õº¯Êý
 701:mac.c         **** }
 702:mac.c         **** 
 703:mac.c         **** void  synrequest_task(void)
 704:mac.c         **** {
 705:mac.c         ****     mlmeSyncRequest(ppib.phyCurrentChanel,TRUE);
 706:mac.c         **** }
 707:mac.c         **** 
 708:mac.c         **** //*************************//
 709:mac.c         **** //¸ß²ãÔÚÏµÍ³µÄMACÕý³£¹¤×÷×´Ì¬(ÍøÂçÒÑ¾­½¨ºÃ)ÏÂ·¢ËÍsynÍ¬²½ÇëÇó
 710:mac.c         **** void mlmeSyncRequest(UINT8 logicalChannel, bool trackBeacon)
 711:mac.c         **** {
 926               	.LM98:
 927               	/* prologue: frame size=0 */
 928 036a 1F93      		push r17
 929               	/* prologue end (size=1) */
 930 036c 182F      		mov r17,r24
 712:mac.c         **** 
 713:mac.c         ****         mac_current_state=MAC_STATE_SYNING;
 932               	.LM99:
 933 036e 8EE0      		ldi r24,lo8(14)
 934 0370 8093 0000 		sts mac_current_state,r24
 714:mac.c         **** 	 PLME_SET_TRX_STATE_request(RX_ON);	
 936               	.LM100:
 937 0374 86E0      		ldi r24,lo8(6)
 938 0376 0E94 0000 		call PLME_SET_TRX_STATE_request
 715:mac.c         **** 	 PLME_SET_request(phyCurrentChanel_id, logicalChannel);
 940               	.LM101:
 941 037a 612F      		mov r22,r17
 942 037c 80E0      		ldi r24,lo8(0)
 943 037e 0E94 0000 		call PLME_SET_request
 716:mac.c         **** 	  if(!IS_NETWORK_FORMED)
 945               	.LM102:
 946 0382 8091 0000 		lds r24,IS_NETWORK_FORMED
 947 0386 8823      		tst r24
 948 0388 61F4      		brne .L51
 717:mac.c         **** 	  {
 718:mac.c         **** 	     cc2420_setshortaddress((uint16_t)default_short_addr.Val);
 950               	.LM103:
 951 038a 8091 0000 		lds r24,default_short_addr
 952 038e 9091 0000 		lds r25,(default_short_addr)+1
 953 0392 0E94 0000 		call cc2420_setshortaddress
 719:mac.c         **** 	     cc2420_setpanid((uint16_t)mac_pib_data.macPANId.Val);
 955               	.LM104:
 956 0396 8091 0000 		lds r24,mac_pib_data+28
 957 039a 9091 0000 		lds r25,(mac_pib_data+28)+1
 958 039e 0E94 0000 		call cc2420_setpanid
 959               	.L51:
 720:mac.c         **** 	  }	 
 721:mac.c         **** 	 //printf("\n-----the channelID is %d\n",ppib.phyCurrentChanel);
 722:mac.c         **** 	 phy_channel_state=WAITING_FOR_BEACON;
 961               	.LM105:
 962 03a2 64E0      		ldi r22,lo8(4)
 963 03a4 6093 0000 		sts phy_channel_state,r22
 723:mac.c         **** 	 IS_MAC_SYNING=TRUE;
 965               	.LM106:
 966 03a8 81E0      		ldi r24,lo8(1)
 967 03aa 8093 0000 		sts IS_MAC_SYNING,r24
 724:mac.c         **** 	 //MAC_SUPERFRAME_PERIOD=aBaseSuperframeDuration*(2<<mac_pib_data.macBeaconOrder);
 725:mac.c         **** 	 //printf("\n&&&&&&&the macbeaconorder is %04x\n",mac_pib_data.macBeaconOrder);
 726:mac.c         **** 	 MAC_SUPERFRAME_PERIOD=(uint32_t)(((uint32_t)aBaseSuperframeDuration)<<(mac_pib_data.macBeaconOrde
 969               	.LM107:
 970 03ae 80EA      		ldi r24,lo8(160)
 971 03b0 90E0      		ldi r25,hi8(160)
 972 03b2 A0E0      		ldi r26,hlo8(160)
 973 03b4 B0E0      		ldi r27,hhi8(160)
 974 03b6 9C01      		movw r18,r24
 975 03b8 AD01      		movw r20,r26
 976 03ba 0090 0000 		lds r0,mac_pib_data+8
 977 03be 04C0      		rjmp 2f
 978 03c0 220F      	1:	lsl r18
 979 03c2 331F      		rol r19
 980 03c4 441F      		rol r20
 981 03c6 551F      		rol r21
 982 03c8 0A94      	2:	dec r0
 983 03ca D2F7      		brpl 1b
 984 03cc 2093 0000 		sts MAC_SUPERFRAME_PERIOD,r18
 985 03d0 3093 0000 		sts (MAC_SUPERFRAME_PERIOD)+1,r19
 986 03d4 4093 0000 		sts (MAC_SUPERFRAME_PERIOD)+2,r20
 987 03d8 5093 0000 		sts (MAC_SUPERFRAME_PERIOD)+3,r21
 727:mac.c         **** 	 //printf("\n&&&&&&&the MAC_SUPERFRAME PERIOD is %08lx\n",MAC_SUPERFRAME_PERIOD);
 728:mac.c         ****         MAC_CAP_PERIOD=(uint32_t)(((uint32_t)aBaseSuperframeDuration)<<(mac_pib_data.macSuperframeO
 989               	.LM108:
 990 03dc 0090 0000 		lds r0,mac_pib_data+42
 991 03e0 04C0      		rjmp 2f
 992 03e2 880F      	1:	lsl r24
 993 03e4 991F      		rol r25
 994 03e6 AA1F      		rol r26
 995 03e8 BB1F      		rol r27
 996 03ea 0A94      	2:	dec r0
 997 03ec D2F7      		brpl 1b
 998 03ee 8093 0000 		sts MAC_CAP_PERIOD,r24
 999 03f2 9093 0000 		sts (MAC_CAP_PERIOD)+1,r25
 1000 03f6 A093 0000 		sts (MAC_CAP_PERIOD)+2,r26
 1001 03fa B093 0000 		sts (MAC_CAP_PERIOD)+3,r27
 729:mac.c         **** 	 //head_of_timer_queue=timer3queue_start(head_of_timer_queue, TIMER_ONE_SHOT, 0, WAIT_FOR_BEACON, 
 730:mac.c         **** 	 head_of_systimer_queue=systimer_start_task(head_of_systimer_queue, SYN_WAITTING_FOR_BEACON, MAC_S
 1003               	.LM109:
 1004 03fe 8091 0000 		lds r24,head_of_systimer_queue
 1005 0402 9091 0000 		lds r25,(head_of_systimer_queue)+1
 1006 0406 0E94 0000 		call systimer_start_task
 1007 040a 9093 0000 		sts (head_of_systimer_queue)+1,r25
 1008 040e 8093 0000 		sts head_of_systimer_queue,r24
 731:mac.c         **** 	 Is_received_beacon=FALSE;
 1010               	.LM110:
 1011 0412 1092 0000 		sts Is_received_beacon,__zero_reg__
 1012               	/* epilogue: frame size=0 */
 1013 0416 1F91      		pop r17
 1014 0418 0895      		ret
 1015               	/* epilogue end (size=2) */
 1016               	/* function mlmeSyncRequest size 88 (85) */
 1018               	.Lscope11:
 1020               	.global	synrequest_task
 1022               	synrequest_task:
 1024               	.LM111:
 1025               	/* prologue: frame size=0 */
 1026               	/* prologue end (size=0) */
 1028               	.LM112:
 1029 041a 61E0      		ldi r22,lo8(1)
 1030 041c 8091 0000 		lds r24,ppib
 1031 0420 0E94 0000 		call mlmeSyncRequest
 1032               	/* epilogue: frame size=0 */
 1033 0424 0895      		ret
 1034               	/* epilogue end (size=1) */
 1035               	/* function synrequest_task size 6 (5) */
 1037               	.Lscope12:
 1039               	.global	mlmesyn_finished
 1041               	mlmesyn_finished:
 732:mac.c         **** 	 //if()
 733:mac.c         **** 	 
 734:mac.c         **** }
 735:mac.c         **** void mlmesyn_finished(void)
 736:mac.c         **** {
 1043               	.LM113:
 1044               	/* prologue: frame size=0 */
 1045 0426 6F92      		push r6
 1046 0428 7F92      		push r7
 1047 042a 8F92      		push r8
 1048 042c 9F92      		push r9
 1049 042e AF92      		push r10
 1050 0430 BF92      		push r11
 1051 0432 CF92      		push r12
 1052 0434 DF92      		push r13
 1053 0436 EF92      		push r14
 1054 0438 FF92      		push r15
 1055 043a 0F93      		push r16
 1056 043c 1F93      		push r17
 1057               	/* prologue end (size=12) */
 737:mac.c         ****      uint32_t  deltatime;
 738:mac.c         ****      uint32_t truetime; 
 739:mac.c         ****      uint32_t  margintime;
 740:mac.c         ****      margintime=0;	 
 741:mac.c         ****      //if((mac_current_state==MAC_STATE_SYNING_END)||(mac_current_state==MAC_STATE_IDLE))
 742:mac.c         ****      {
 743:mac.c         ****           truetime=systime32();
 1059               	.LM114:
 1060 043e 0E94 0000 		call systime32
 1061 0442 3B01      		movw r6,r22
 1062 0444 4C01      		movw r8,r24
 744:mac.c         ****           deltatime=(truetime>=last_beacon_rx_timestamp) ? truetime-last_beacon_rx_timestamp:(0x3ff
 1064               	.LM115:
 1065 0446 8091 0000 		lds r24,last_beacon_rx_timestamp
 1066 044a 9091 0000 		lds r25,(last_beacon_rx_timestamp)+1
 1067 044e A091 0000 		lds r26,(last_beacon_rx_timestamp)+2
 1068 0452 B091 0000 		lds r27,(last_beacon_rx_timestamp)+3
 1069 0456 6401      		movw r12,r8
 1070 0458 5301      		movw r10,r6
 1071 045a A81A      		sub r10,r24
 1072 045c B90A      		sbc r11,r25
 1073 045e CA0A      		sbc r12,r26
 1074 0460 DB0A      		sbc r13,r27
 1075 0462 6816      		cp r6,r24
 1076 0464 7906      		cpc r7,r25
 1077 0466 8A06      		cpc r8,r26
 1078 0468 9B06      		cpc r9,r27
 1079 046a 40F4      		brsh .L54
 1081               	.LM116:
 1082 046c 8FEF      		ldi r24,lo8(1073741823)
 1083 046e 9FEF      		ldi r25,hi8(1073741823)
 1084 0470 AFEF      		ldi r26,hlo8(1073741823)
 1085 0472 BFE3      		ldi r27,hhi8(1073741823)
 1086 0474 A80E      		add r10,r24
 1087 0476 B91E      		adc r11,r25
 1088 0478 CA1E      		adc r12,r26
 1089 047a DB1E      		adc r13,r27
 1090               	.L54:
 745:mac.c         ****           head_of_systimer_queue=systimer_start_task(head_of_systimer_queue, CAP_OVER, (MAC_CAP_PER
 1092               	.LM117:
 1093 047c 8601      		movw r16,r12
 1094 047e 7501      		movw r14,r10
 1095 0480 1695      		lsr r17
 1096 0482 0795      		ror r16
 1097 0484 F794      		ror r15
 1098 0486 E794      		ror r14
 1099 0488 8091 0000 		lds r24,MAC_CAP_PERIOD
 1100 048c 9091 0000 		lds r25,(MAC_CAP_PERIOD)+1
 1101 0490 A091 0000 		lds r26,(MAC_CAP_PERIOD)+2
 1102 0494 B091 0000 		lds r27,(MAC_CAP_PERIOD)+3
 1103 0498 8E19      		sub r24,r14
 1104 049a 9F09      		sbc r25,r15
 1105 049c A00B      		sbc r26,r16
 1106 049e B10B      		sbc r27,r17
 1107 04a0 9C01      		movw r18,r24
 1108 04a2 AD01      		movw r20,r26
 1109 04a4 62E0      		ldi r22,lo8(2)
 1110 04a6 8091 0000 		lds r24,head_of_systimer_queue
 1111 04aa 9091 0000 		lds r25,(head_of_systimer_queue)+1
 1112 04ae 0E94 0000 		call systimer_start_task
 1113 04b2 FC01      		movw r30,r24
 1114 04b4 9093 0000 		sts (head_of_systimer_queue)+1,r25
 1115 04b8 8093 0000 		sts head_of_systimer_queue,r24
 746:mac.c         ****           head_of_systimer_queue=systimer_start_task(head_of_systimer_queue, RECEIVE_BEACON, (MAC_S
 1117               	.LM118:
 1118 04bc 8091 0000 		lds r24,MAC_SUPERFRAME_PERIOD
 1119 04c0 9091 0000 		lds r25,(MAC_SUPERFRAME_PERIOD)+1
 1120 04c4 A091 0000 		lds r26,(MAC_SUPERFRAME_PERIOD)+2
 1121 04c8 B091 0000 		lds r27,(MAC_SUPERFRAME_PERIOD)+3
 1122 04cc 8E19      		sub r24,r14
 1123 04ce 9F09      		sbc r25,r15
 1124 04d0 A00B      		sbc r26,r16
 1125 04d2 B10B      		sbc r27,r17
 1126 04d4 9C01      		movw r18,r24
 1127 04d6 AD01      		movw r20,r26
 1128 04d8 61E0      		ldi r22,lo8(1)
 1129 04da CF01      		movw r24,r30
 1130 04dc 0E94 0000 		call systimer_start_task
 1131 04e0 9093 0000 		sts (head_of_systimer_queue)+1,r25
 1132 04e4 8093 0000 		sts head_of_systimer_queue,r24
 747:mac.c         ****           //printf("\n ---------beacon rx time is %08lx\n",last_beacon_rx_timestamp);
 748:mac.c         **** 	   //printf("\n----------true time is  %08lx\n",truetime);	  
 749:mac.c         ****           //printf("\n ---------cap   time is %08lx\n",MAC_CAP_PERIOD); 	
 750:mac.c         ****           //printf("\n ---------super time is %08lx\n",MAC_SUPERFRAME_PERIOD);
 751:mac.c         ****           //Leds_yellowToggle();
 752:mac.c         **** 	   	  
 753:mac.c         ****           MAC_OBJECT_CAP_START_TICKS=last_beacon_rx_timestamp;
 1134               	.LM119:
 1135 04e8 8091 0000 		lds r24,last_beacon_rx_timestamp
 1136 04ec 9091 0000 		lds r25,(last_beacon_rx_timestamp)+1
 1137 04f0 A091 0000 		lds r26,(last_beacon_rx_timestamp)+2
 1138 04f4 B091 0000 		lds r27,(last_beacon_rx_timestamp)+3
 1139 04f8 8093 0000 		sts MAC_OBJECT_CAP_START_TICKS,r24
 1140 04fc 9093 0000 		sts (MAC_OBJECT_CAP_START_TICKS)+1,r25
 1141 0500 A093 0000 		sts (MAC_OBJECT_CAP_START_TICKS)+2,r26
 1142 0504 B093 0000 		sts (MAC_OBJECT_CAP_START_TICKS)+3,r27
 754:mac.c         ****           MAC_OBJECT_CAP_END_TICKS=truetime+((MAC_CAP_PERIOD<<1)-deltatime-margintime);
 1144               	.LM120:
 1145 0508 8091 0000 		lds r24,MAC_CAP_PERIOD
 1146 050c 9091 0000 		lds r25,(MAC_CAP_PERIOD)+1
 1147 0510 A091 0000 		lds r26,(MAC_CAP_PERIOD)+2
 1148 0514 B091 0000 		lds r27,(MAC_CAP_PERIOD)+3
 1149 0518 880F      		lsl r24
 1150 051a 991F      		rol r25
 1151 051c AA1F      		rol r26
 1152 051e BB1F      		rol r27
 1153 0520 8A19      		sub r24,r10
 1154 0522 9B09      		sbc r25,r11
 1155 0524 AC09      		sbc r26,r12
 1156 0526 BD09      		sbc r27,r13
 1157 0528 860D      		add r24,r6
 1158 052a 971D      		adc r25,r7
 1159 052c A81D      		adc r26,r8
 1160 052e B91D      		adc r27,r9
 1161 0530 8093 0000 		sts MAC_OBJECT_CAP_END_TICKS,r24
 1162 0534 9093 0000 		sts (MAC_OBJECT_CAP_END_TICKS)+1,r25
 1163 0538 A093 0000 		sts (MAC_OBJECT_CAP_END_TICKS)+2,r26
 1164 053c B093 0000 		sts (MAC_OBJECT_CAP_END_TICKS)+3,r27
 755:mac.c         ****           MAC_OBJECT_SUPERFRAME_TICKS=truetime+((MAC_SUPERFRAME_PERIOD<<1)-deltatime-margintime);
 1166               	.LM121:
 1167 0540 8091 0000 		lds r24,MAC_SUPERFRAME_PERIOD
 1168 0544 9091 0000 		lds r25,(MAC_SUPERFRAME_PERIOD)+1
 1169 0548 A091 0000 		lds r26,(MAC_SUPERFRAME_PERIOD)+2
 1170 054c B091 0000 		lds r27,(MAC_SUPERFRAME_PERIOD)+3
 1171 0550 880F      		lsl r24
 1172 0552 991F      		rol r25
 1173 0554 AA1F      		rol r26
 1174 0556 BB1F      		rol r27
 1175 0558 8A19      		sub r24,r10
 1176 055a 9B09      		sbc r25,r11
 1177 055c AC09      		sbc r26,r12
 1178 055e BD09      		sbc r27,r13
 1179 0560 860D      		add r24,r6
 1180 0562 971D      		adc r25,r7
 1181 0564 A81D      		adc r26,r8
 1182 0566 B91D      		adc r27,r9
 1183 0568 8093 0000 		sts MAC_OBJECT_SUPERFRAME_TICKS,r24
 1184 056c 9093 0000 		sts (MAC_OBJECT_SUPERFRAME_TICKS)+1,r25
 1185 0570 A093 0000 		sts (MAC_OBJECT_SUPERFRAME_TICKS)+2,r26
 1186 0574 B093 0000 		sts (MAC_OBJECT_SUPERFRAME_TICKS)+3,r27
 1187               	/* epilogue: frame size=0 */
 1188 0578 1F91      		pop r17
 1189 057a 0F91      		pop r16
 1190 057c FF90      		pop r15
 1191 057e EF90      		pop r14
 1192 0580 DF90      		pop r13
 1193 0582 CF90      		pop r12
 1194 0584 BF90      		pop r11
 1195 0586 AF90      		pop r10
 1196 0588 9F90      		pop r9
 1197 058a 8F90      		pop r8
 1198 058c 7F90      		pop r7
 1199 058e 6F90      		pop r6
 1200 0590 0895      		ret
 1201               	/* epilogue end (size=13) */
 1202               	/* function mlmesyn_finished size 182 (157) */
 1208               	.Lscope13:
 1209               		.data
 1210               	.LC4:
 1211 00ea 0A2D 2D2D 		.string	"\n----sensor data is sent successfull-----"
 1211      2D73 656E 
 1211      736F 7220 
 1211      6461 7461 
 1211      2069 7320 
 1212               		.text
 1216               	.global	mcpsDataConfirm
 1218               	mcpsDataConfirm:
 756:mac.c         **** 	   //mac_current_state=MAC_STATE_IDLE;
 757:mac.c         ****      }
 758:mac.c         **** }
 759:mac.c         **** 
 760:mac.c         **** void mlmeSyncLossIndication(MAC_ENUM lossReason)
 761:mac.c         **** {
 762:mac.c         **** 	//ÈýÖÖÔ­Òòµ¼ÖÂMAC²ã·¢ËÍ¸ÃÔ­ÓïÍ¨Öª¸ß²ã¡£
 763:mac.c         **** 	//¿ÉÍ¨¹ýpostÒ»¸ö¸ß²ãÈÎÎñ¡£¸ß²ã¶Ô¶ªÊ§Í¬²½¿ÉÄÜÒªÖØÐÂ×ö³ö´¦Àí¡£
 764:mac.c         **** 	//¿Õº¯Êý£¬¸ß²ãÊµÏÖ
 765:mac.c         **** 	NODE_INFO dst;
 766:mac.c         **** 	//printf("\n--- a PAN ID conlict ----\n");
 767:mac.c         **** 	if(IS_COORDINATOR)
 768:mac.c         **** 	{
 769:mac.c         **** 	//¿ÉÄÜÐèÒªÖØÐÂÉèÖÃÒ»ÏÂmac²ãÍøÂç²ÎÊý
 770:mac.c         **** 	coordinator_realignment_frame_send(0, dst, default_short_addr);
 771:mac.c         **** 	mac_current_state=MAC_STATE_IDLE;
 772:mac.c         **** 	}
 773:mac.c         **** 	else
 774:mac.c         **** 	{
 775:mac.c         **** 	   if(lossReason==BEACON_LOSS)
 776:mac.c         **** 	   	//ÍøÂçÖØÆô¶¯
 777:mac.c         **** 	   	mac_current_state=MAC_STATE_UNSTARTED;
 778:mac.c         **** 	      //»òÕß
 779:mac.c         **** 	      //mac_current_state=MAC_STATE_ENERGY_SCAN_FINISHED;
 780:mac.c         **** 	}
 781:mac.c         **** }
 782:mac.c         **** 
 783:mac.c         **** //*************************//
 784:mac.c         **** void mcpsDataRequest(NODE_INFO dst, NODE_INFO src, UINT8 msduLength, BYTE *pMsdu, BYTE msduHandle, 
 785:mac.c         **** {
 786:mac.c         **** 	//MAC²ãÔÚÊÕµ½Ô­Óïºó£¬¸ù¾ÝtxOptionµÄ²ÎÊý
 787:mac.c         **** 	//ÈôÎªÖ±½ÓÍ¨ÐÅ£¬Ôòµ÷ÓÃ·¢ËÍÈÎÎñ·¢ËÍ¸ÃÊý¾ÝÖ¡
 788:mac.c         **** 	//ÈôÎª¼ä½ÓÍ¨ÐÅ,Ôò°ÑËü·Åµ½pending¶ÓÁÐÖÐ,²¢·µ»Ø¡£
 789:mac.c         **** 	FRAME_CONTROL  framectl_field;
 790:mac.c         **** 	if((txOptions&0x04)==0)
 791:mac.c         **** 		//Ö±½ÓÍ¨ÐÅ
 792:mac.c         **** 		{
 793:mac.c         **** 		data_frame_send(pMsdu, msduLength,dst,src,msduHandle);
 794:mac.c         **** 		mac_current_state=MAC_STATE_IDLE;
 795:mac.c         **** 		}
 796:mac.c         **** 	else if((dst.addrMode!=0x00)&&(dst.addrMode!=0x01))
 797:mac.c         **** 	       //¼ä½ÓÍ¨ÐÅ
 798:mac.c         **** 		{
 799:mac.c         **** 		   if((txOptions&0x01)==0)
 800:mac.c         **** 		       framectl_field.v[0]=0x01;
 801:mac.c         **** 		   else
 802:mac.c         **** 		   	framectl_field.v[0]=0x21;
 803:mac.c         **** 		   framectl_field.v[1]=0xcc&(dst.addrMode<<2)&(src.addrMode<<6);	
 804:mac.c         **** 		   if(current_pending_num<=MAX_PENDING_LIST_SIZE)
 805:mac.c         **** 	            {
 806:mac.c         **** 	                add_pending_queue(msduHandle, framectl_field, dst,src, msduLength, pMsdu,0x00,FALS
 807:mac.c         ****                        //¼ÓÈëµ½ÐÅ±êÖ¡µÄpendingÓòÖÐ
 808:mac.c         ****                        /*if(dst.addrMode==0x02)
 809:mac.c         **** 			     mac_tx_beacon.shortaddrpending_list[mac_tx_beacon.shortpendingadd_length++]=dst.shortAddr;
 810:mac.c         **** 			  else 
 811:mac.c         **** 			     mac_tx_beacon.longaddrpending_list[mac_tx_beacon.longpendingadd_length++]=dst.longAddr;
 812:mac.c         **** 			     */
 813:mac.c         **** 		     }
 814:mac.c         ****                  else
 815:mac.c         **** 			   mcpsDataConfirm(TRANSACTION_OVERFLOW, msduHandle);
 816:mac.c         **** 		   }
 817:mac.c         **** 	else   mcpsDataConfirm(INVALID_PARAMETER, msduHandle);
 818:mac.c         **** }
 819:mac.c         **** 
 820:mac.c         **** void mcpsDataConfirm(MAC_ENUM status, BYTE msduHandle)
 821:mac.c         **** {
 1220               	.LM122:
 1221               	/* prologue: frame size=0 */
 1222               	/* prologue end (size=0) */
 822:mac.c         **** 	//×÷ÎªMAC²ã¶ÔmcpsdatarequestµÄÒ»¸öÏìÓ¦£¬Í¨Öª¸ß²ã
 823:mac.c         **** 	//¿Õº¯Êý£¬¸ß²ãÊµÏÖ
 824:mac.c         **** 	printf("\n----sensor data is sent successfull-----\n");
 1224               	.LM123:
 1225 0592 80E0      		ldi r24,lo8(.LC4)
 1226 0594 90E0      		ldi r25,hi8(.LC4)
 1227 0596 0E94 0000 		call puts
 825:mac.c         **** 	mac_current_state=MAC_STATE_START_TO_SLEEP;
 1229               	.LM124:
 1230 059a 82E1      		ldi r24,lo8(18)
 1231 059c 8093 0000 		sts mac_current_state,r24
 1232               	/* epilogue: frame size=0 */
 1233 05a0 0895      		ret
 1234               	/* epilogue end (size=1) */
 1235               	/* function mcpsDataConfirm size 8 (7) */
 1237               	.Lscope14:
 1238               		.data
 1239               	.LC5:
 1240 0114 0A2D 2D2D 		.string	"\n-----success received the sensor data-------"
 1240      2D2D 7375 
 1240      6363 6573 
 1240      7320 7265 
 1240      6365 6976 
 1241               		.text
 1244               	.global	mcpsDataIndication
 1246               	mcpsDataIndication:
 826:mac.c         **** 	
 827:mac.c         **** }
 828:mac.c         **** void mcpsDataIndication(MCPS_DATA_INDICATION mcps_data_indication_info)
 829:mac.c         **** {
 1248               	.LM125:
 1249               	/* prologue: frame size=0 */
 1250 05a2 CF93      		push r28
 1251 05a4 DF93      		push r29
 1252 05a6 CDB7      		in r28,__SP_L__
 1253 05a8 DEB7      		in r29,__SP_H__
 1254               	/* prologue end (size=4) */
 830:mac.c         **** 	//MAC½ÓÊÕµ½Ò»¸öÊý¾ÝÖ¡ºó£¬Í¨Öª¸ß²ã£¬¿ÉpostÒ»¸ö¸ß²ãÈÎÎñ
 831:mac.c         **** 	//¿Õº¯Êý£¬¸ß²ãÊµÏÖ
 832:mac.c         **** 	printf("\n-----success received the sensor data-------\n");
 1256               	.LM126:
 1257 05aa 80E0      		ldi r24,lo8(.LC5)
 1258 05ac 90E0      		ldi r25,hi8(.LC5)
 1259 05ae 0E94 0000 		call puts
 833:mac.c         **** 	if(IS_COORDINATOR)
 834:mac.c         **** 	sensor_data_tx_to_pc(mcps_data_indication_info);
 1261               	.LM127:
 1262 05b2 8DB7      		in r24,__SP_L__
 1263 05b4 9EB7      		in r25,__SP_H__
 1264 05b6 8458      		subi r24,lo8(-(-132))
 1265 05b8 9040      		sbci r25,hi8(-(-132))
 1266 05ba 0FB6      		in __tmp_reg__,__SREG__
 1267 05bc F894      		cli
 1268 05be 9EBF      		out __SP_H__,r25
 1269 05c0 0FBE      		out __SREG__,__tmp_reg__
 1270 05c2 8DBF      		out __SP_L__,r24
 1271 05c4 EDB7      		in r30,__SP_L__
 1272 05c6 FEB7      		in r31,__SP_H__
 1273 05c8 3196      		adiw r30,1
 1274 05ca 84E8      		ldi r24,lo8(-124)
 1275 05cc A5E0      		ldi r26,lo8(5)
 1276 05ce B0E0      		ldi r27,hi8(5)
 1277 05d0 AC0F      		add r26,r28
 1278 05d2 BD1F      		adc r27,r29
 1279 05d4 0D90      		ld __tmp_reg__,X+
 1280 05d6 0192      		st Z+,__tmp_reg__
 1281 05d8 8A95      		dec r24
 1282 05da E1F7      		brne .-8
 1283 05dc 0E94 0000 		call sensor_data_tx_to_pc
 1284 05e0 8DB7      		in r24,__SP_L__
 1285 05e2 9EB7      		in r25,__SP_H__
 1286 05e4 8C57      		subi r24,lo8(-(132))
 1287 05e6 9F4F      		sbci r25,hi8(-(132))
 1288 05e8 0FB6      		in __tmp_reg__,__SREG__
 1289 05ea F894      		cli
 1290 05ec 9EBF      		out __SP_H__,r25
 1291 05ee 0FBE      		out __SREG__,__tmp_reg__
 1292 05f0 8DBF      		out __SP_L__,r24
 1293               	/* epilogue: frame size=0 */
 1294 05f2 DF91      		pop r29
 1295 05f4 CF91      		pop r28
 1296 05f6 0895      		ret
 1297               	/* epilogue end (size=3) */
 1298               	/* function mcpsDataIndication size 43 (36) */
 1300               	.Lscope15:
 1303               	.global	get_frame_pointer
 1305               	get_frame_pointer:
 835:mac.c         **** }
 836:mac.c         **** 
 837:mac.c         **** uint8_t  PD_DATA_indication(uint8_t psdulength,uint8_t * psdu,uint8_t ppdulinkquality,uint32_t  tim
 838:mac.c         **** {
 839:mac.c         ****     head_of_rx_buffer=add_to_rx_buffer(psdulength, psdu, ppdulinkquality,timestamp);
 840:mac.c         **** 	//printf("\nfinished add the beacon frame to the buffer\n");
 841:mac.c         ****    //printf("\npsdu->payload is %d\n",psdu[0]);	
 842:mac.c         ****     //printf("\nthe head->payload is %d",*(head_of_rx_buffer->payload));  	
 843:mac.c         ****     OS_post(mac_get_received_frame);
 844:mac.c         ****     //for(uint8_t i=0;i<psdulength;i++)
 845:mac.c         ****     //		printf("\npsdu-> [%d]--is--%02x\n",i,psdu[i]);
 846:mac.c         **** }
 847:mac.c         **** 
 848:mac.c         **** //¸ÃÈÎÎñ¸ºÔðÊÇ´ÓÎïÀí²ãÈ¡Ò»¸öÖ¡²¢½øÐÐ½âÎö
 849:mac.c         **** void  mac_get_received_frame(void)
 850:mac.c         **** {
 851:mac.c         ****       	  RX_BUFFER * current;
 852:mac.c         **** 	  uint8_t      index;
 853:mac.c         **** 	  uint8_t     i;
 854:mac.c         **** 	  index=0;
 855:mac.c         **** 	  current=head_of_rx_buffer;
 856:mac.c         **** 	  //printf("\nthe head->payload is %d",*(head_of_rx_buffer->payload));       
 857:mac.c         ****          if(tail_of_rx_buffer==head_of_rx_buffer)
 858:mac.c         **** 		 	tail_of_rx_buffer=head_of_rx_buffer->next;
 859:mac.c         ****   	  head_of_rx_buffer=head_of_rx_buffer->next;	 
 860:mac.c         ****          //¿ªÊ¼½âÎö½ÓÊÕµ½µÄÖ¡£¬°ÑËüÌîÐ´µ½mac_rx_current_frameÖÐ
 861:mac.c         ****          //È»ºóµ÷ÓÃmac_frame_rcvd½øÐÐ´¦Àí¡£
 862:mac.c         ****          mac_rx_current_frame.frameLength=(current->framelength)-2;
 863:mac.c         ****          mac_rx_current_frame.lqi=current->lqi;
 864:mac.c         ****          mac_rx_current_frame.timestamp=current->timestamp;
 865:mac.c         ****          //index++;
 866:mac.c         ****          //printf("\nthe processing received frame's current->timestamp is %08lx",current->timestam
 867:mac.c         ****          //for(index=0;index<mac_rx_current_frame.frameLength;index++)
 868:mac.c         ****          //    //printf("\nthe current->payload is %02x",*(current->payload+index));               
 869:mac.c         **** 	 //if(current->framelength==current->payload[0])                    
 870:mac.c         **** 	  	//printf("\nreceived a mac bracon frame correctly");      
 871:mac.c         **** 	  printf("\nthe received frame length  is %d\n",mac_rx_current_frame.frameLength);	
 872:mac.c         **** 	  index=1;	
 873:mac.c         **** 	  mac_rx_current_frame.frame_control_field.v[0]=current->payload[index++];
 874:mac.c         **** 	  mac_rx_current_frame.frame_control_field.v[1]=current->payload[index++];
 875:mac.c         **** 	  //printf("\nthe frame_ctl is v[0]=%02x\n",mac_rx_current_frame.frame_control_field.v[0]);
 876:mac.c         **** 	  //printf("\nthe frame_ctl is v[1]=%02x\n",mac_rx_current_frame.frame_control_field.v[1]);
 877:mac.c         **** 	  mac_rx_current_frame.macDSN=current->payload[index++];
 878:mac.c         ****          mac_rx_current_frame.logicalchannel_field=ppib.phyCurrentChanel;
 879:mac.c         **** 	  switch(mac_rx_current_frame.frame_control_field.v[1]&0x0c)
 880:mac.c         **** 	  	{
 881:mac.c         ****    	          case  MAC_DST_LONG_ADDR:
 882:mac.c         **** 			mac_rx_current_frame.dst.addrMode=0x03;
 883:mac.c         **** 		 	//Ç°Á½¸ö×Ö½Ú·ÅÄ¿µÄPANID
 884:mac.c         **** 		 	mac_rx_current_frame.dst.panID.v[0]=current->payload[index++];
 885:mac.c         **** 			mac_rx_current_frame.dst.panID.v[1]=current->payload[index++];
 886:mac.c         **** 			//ºó°Ë¸ö×Ö½Ú·Å³¤Ä¿µÄµØÖ·		 	
 887:mac.c         **** 		 	mac_rx_current_frame.dst.longAddr.v[0]=current->payload[index++];
 888:mac.c         **** 			mac_rx_current_frame.dst.longAddr.v[1]=current->payload[index++];
 889:mac.c         **** 			mac_rx_current_frame.dst.longAddr.v[2]=current->payload[index++];
 890:mac.c         **** 			mac_rx_current_frame.dst.longAddr.v[3]=current->payload[index++];
 891:mac.c         **** 			mac_rx_current_frame.dst.longAddr.v[4]=current->payload[index++];
 892:mac.c         **** 			mac_rx_current_frame.dst.longAddr.v[5]=current->payload[index++];
 893:mac.c         **** 			mac_rx_current_frame.dst.longAddr.v[6]=current->payload[index++];
 894:mac.c         **** 			mac_rx_current_frame.dst.longAddr.v[7]=current->payload[index++];
 895:mac.c         **** 		 	break;
 896:mac.c         **** 	         case  MAC_DST_SHORT_ADDR:
 897:mac.c         **** 			mac_rx_current_frame.dst.addrMode=0x02;
 898:mac.c         **** 		 	//Ç°Á½¸ö×Ö½Ú·ÅÄ¿µÄPANID
 899:mac.c         **** 		 	mac_rx_current_frame.dst.panID.v[0]=current->payload[index++];
 900:mac.c         **** 			mac_rx_current_frame.dst.panID.v[1]=current->payload[index++];
 901:mac.c         **** 			//ºóÁ½¸ö×Ö½Ú·Å¶ÌÄ¿µÄµØÖ·
 902:mac.c         **** 		 	mac_rx_current_frame.dst.shortAddr.v[0]=current->payload[index++];
 903:mac.c         **** 			mac_rx_current_frame.dst.shortAddr.v[1]=current->payload[index++];
 904:mac.c         **** 		 	break;
 905:mac.c         **** 	        case  MAC_DST_NO_ADDR:
 906:mac.c         ****                      mac_rx_current_frame.dst.addrMode=MAC_DST_NO_ADDR;		
 907:mac.c         ****  		 	break;
 908:mac.c         **** 	        case  MAC_DST_ADDR_RESERVED:
 909:mac.c         **** 		 	error("\nreserved dst address mode is used!\n");
 910:mac.c         **** 		 	break;			
 911:mac.c         **** 	  	}
 912:mac.c         **** 	  switch(mac_rx_current_frame.frame_control_field.v[1]&0xc0)
 913:mac.c         **** 	  	{
 914:mac.c         ****    	          case  MAC_SRC_LONG_ADDR:
 915:mac.c         **** 			mac_rx_current_frame.src.addrMode=0x03;
 916:mac.c         **** 		 	//Ç°Á½¸ö×Ö½Ú·ÅÄ¿µÄPANID
 917:mac.c         **** 		 	mac_rx_current_frame.src.panID.v[0]=current->payload[index++];
 918:mac.c         **** 			mac_rx_current_frame.src.panID.v[1]=current->payload[index++];
 919:mac.c         **** 			//ºó°Ë¸ö×Ö½Ú·Å³¤Ä¿µÄµØÖ·		 	
 920:mac.c         **** 		 	mac_rx_current_frame.src.longAddr.v[0]=current->payload[index++];
 921:mac.c         **** 			mac_rx_current_frame.src.longAddr.v[1]=current->payload[index++];
 922:mac.c         **** 			mac_rx_current_frame.src.longAddr.v[2]=current->payload[index++];
 923:mac.c         **** 			mac_rx_current_frame.src.longAddr.v[3]=current->payload[index++];
 924:mac.c         **** 			mac_rx_current_frame.src.longAddr.v[4]=current->payload[index++];
 925:mac.c         **** 			mac_rx_current_frame.src.longAddr.v[5]=current->payload[index++];
 926:mac.c         **** 			mac_rx_current_frame.src.longAddr.v[6]=current->payload[index++];
 927:mac.c         **** 			mac_rx_current_frame.src.longAddr.v[7]=current->payload[index++];
 928:mac.c         **** 		 	break;
 929:mac.c         **** 	         case  MAC_SRC_SHORT_ADDR:
 930:mac.c         **** 			mac_rx_current_frame.src.addrMode=0x02;
 931:mac.c         **** 		 	//Ç°Á½¸ö×Ö½Ú·ÅÄ¿µÄPANID
 932:mac.c         **** 		 	mac_rx_current_frame.src.panID.v[0]=current->payload[index++];
 933:mac.c         **** 			mac_rx_current_frame.src.panID.v[1]=current->payload[index++];
 934:mac.c         **** 			//ºóÁ½¸ö×Ö½Ú·Å¶ÌÄ¿µÄµØÖ·
 935:mac.c         **** 		 	mac_rx_current_frame.src.shortAddr.v[0]=current->payload[index++];
 936:mac.c         **** 			mac_rx_current_frame.src.shortAddr.v[1]=current->payload[index++];
 937:mac.c         **** 		 	break;
 938:mac.c         **** 	        case  MAC_SRC_NO_ADDR:
 939:mac.c         **** 			mac_rx_current_frame.src.addrMode=0x00;
 940:mac.c         **** 		 	break;
 941:mac.c         **** 	        case  MAC_SRC_ADDR_RESERVED:
 942:mac.c         **** 		 	error("\nreserved dst address mode is used!\n");
 943:mac.c         **** 		 	break;			
 944:mac.c         **** 	  	}	 
 945:mac.c         **** 	  //MHRÒÑ¾­´¦ÀíÍê±Ï
 946:mac.c         **** 	  mac_rx_current_frame.type=mac_rx_current_frame.frame_control_field.v[0]&0x07;
 947:mac.c         **** 	  switch(mac_rx_current_frame.type)
 948:mac.c         **** 	  	{
 949:mac.c         **** 	  	   case MAC_FRAME_BEACON:
 950:mac.c         **** 		   	  mac_rx_current_frame.superframe_field.SF.bytes.LSB=current->payload[index++];
 951:mac.c         **** 			  mac_rx_current_frame.superframe_field.SF.bytes.MSB=current->payload[index++];
 952:mac.c         **** 			  //GTSÓòÎª0x00
 953:mac.c         **** 			  mac_rx_current_frame.gts_char_field.bytes=current->payload[index++];
 954:mac.c         **** 			  //pending address field
 955:mac.c         **** 			  mac_rx_current_frame.pendaddress_field.bytes=current->payload[index++];
 956:mac.c         **** 			  mac_rx_current_frame.shortpendingadd_length=(mac_rx_current_frame.pendaddress_field.bytes&0x07
 957:mac.c         **** 			  mac_rx_current_frame.longpendingadd_length=(((uint8_t)((mac_rx_current_frame.pendaddress_field
 958:mac.c         **** 			  //printf("\nreceived long  pending address bytes is%d\n",mac_rx_current_frame.longpendingadd_l
 959:mac.c         **** 			  for(i=0;i<mac_rx_current_frame.shortpendingadd_length;i++)
 960:mac.c         **** 			  	{
 961:mac.c         **** 		                    mac_rx_current_frame.shortaddrpending_list[i].v[0]=current->payload[index++];
 962:mac.c         **** 				      mac_rx_current_frame.shortaddrpending_list[i].v[1]=current->payload[index++];
 963:mac.c         **** 			  	}
 964:mac.c         **** 			  for(i=0;i<mac_rx_current_frame.longpendingadd_length;i++)
 965:mac.c         **** 			  	{
 966:mac.c         **** 			  	     mac_rx_current_frame.longaddrpending_list[i].v[0]=current->payload[index++];
 967:mac.c         **** 				     mac_rx_current_frame.longaddrpending_list[i].v[1]=current->payload[index++];
 968:mac.c         **** 				     mac_rx_current_frame.longaddrpending_list[i].v[2]=current->payload[index++];
 969:mac.c         **** 				     mac_rx_current_frame.longaddrpending_list[i].v[3]=current->payload[index++];
 970:mac.c         **** 				     mac_rx_current_frame.longaddrpending_list[i].v[4]=current->payload[index++];
 971:mac.c         **** 				     mac_rx_current_frame.longaddrpending_list[i].v[5]=current->payload[index++];
 972:mac.c         **** 				     mac_rx_current_frame.longaddrpending_list[i].v[6]=current->payload[index++];
 973:mac.c         **** 				     mac_rx_current_frame.longaddrpending_list[i].v[7]=current->payload[index++];		 
 974:mac.c         **** 			  	}
 975:mac.c         **** 			  mac_rx_current_frame.beacon_payload_length=current->payload[index++];
 976:mac.c         **** 			  for(i=0;i<mac_rx_current_frame.beacon_payload_length;i++)
 977:mac.c         **** 			   	     mac_rx_current_frame.beacon_payload[i]=current->payload[index++];		 
 978:mac.c         **** 			  break;
 979:mac.c         **** 		   case MAC_FRAME_DATA:
 980:mac.c         **** 	                mac_rx_current_frame.nwk_data_length=current->payload[index++];
 981:mac.c         **** 			  for(i=0;i<mac_rx_current_frame.nwk_data_length;i++)
 982:mac.c         **** 			            mac_rx_current_frame.nwk_data_payload[i]=current->payload[index++];
 983:mac.c         **** 		         break;
 984:mac.c         **** 		   case MAC_FRAME_ACK:
 985:mac.c         **** 		   	  //no payload
 986:mac.c         **** 		   	  
 987:mac.c         **** 		         break;
 988:mac.c         **** 		   case MAC_FRAME_CMD:
 989:mac.c         **** 		   	  mac_rx_current_frame.cmd=current->payload[index++];
 990:mac.c         **** 			  switch(mac_rx_current_frame.cmd)
 991:mac.c         **** 			  	{
 992:mac.c         **** 			  	    case  MAC_CMD_ASSOCIATE_REQ:
 993:mac.c         **** 					   //printf("\nindex is %d\n",index);	
 994:mac.c         **** 					   mac_rx_current_frame.node_capinfo_field.bytes=current->payload[index++];
 995:mac.c         **** 					   break;
 996:mac.c         **** 				    case  MAC_CMD_ASSOCIATE_RPLY:
 997:mac.c         **** 					   mac_rx_current_frame.shortaddralloc.v[0]=current->payload[index++];
 998:mac.c         **** 					   mac_rx_current_frame.shortaddralloc.v[1]=current->payload[index++];
 999:mac.c         **** 					   mac_rx_current_frame.association_status=current->payload[index++];
1000:mac.c         **** 					   //printf("\n----the short alloc addr is %04x---\n",mac_rx_current_frame.shortaddralloc.Val)
1001:mac.c         **** 					   //printf("\nthe associate status is %02x\n",mac_rx_current_frame.association_status);
1002:mac.c         **** 					   break;
1003:mac.c         **** 				    case  MAC_CMD_BEACON_REQ:
1004:mac.c         **** 					   break;
1005:mac.c         **** 				    case  MAC_CMD_COORD_REALIGNMENT:
1006:mac.c         **** 					   mac_rx_current_frame.PAN_ID_field.v[0]=current->payload[index++];
1007:mac.c         **** 					   mac_rx_current_frame.PAN_ID_field.v[1]=current->payload[index++];
1008:mac.c         **** 					   mac_rx_current_frame.coordshortaddr_field.v[0]=current->payload[index++];
1009:mac.c         **** 					   mac_rx_current_frame.coordshortaddr_field.v[1]=current->payload[index++];
1010:mac.c         **** 					   mac_rx_current_frame.logicalchannel_field=current->payload[index++];
1011:mac.c         **** 					   mac_rx_current_frame.shortaddrallocted.v[0]=current->payload[index++];
1012:mac.c         **** 					   mac_rx_current_frame.shortaddrallocted.v[1]=current->payload[index++];
1013:mac.c         **** 					   break;
1014:mac.c         **** 				    case  MAC_CMD_DATA_REQ:
1015:mac.c         **** 					   break;
1016:mac.c         **** 				    case  MAC_CMD_DISASSOCIATE_NOTICE:
1017:mac.c         **** 					   mac_rx_current_frame.disassociation_reason=current->payload[index++];
1018:mac.c         **** 					   break;
1019:mac.c         **** 				    case  MAC_CMD_GTS_REQ:
1020:mac.c         **** 					   break;
1021:mac.c         **** 				    case  MAC_CMD_ORPHAN_NOTICE:
1022:mac.c         **** 					   break;	
1023:mac.c         **** 				    case  MAC_CMD_PAN_ID_CONFLICT:
1024:mac.c         **** 					   break;	
1025:mac.c         **** 			  	}
1026:mac.c         **** 		         break;	
1027:mac.c         **** 	  	}
1028:mac.c         ****         if((index-1)!=mac_rx_current_frame.frameLength)
1029:mac.c         ****    	  {
1030:mac.c         ****    	    //printf("\nthe received frame length  is %d\n",mac_rx_current_frame.frameLength);
1031:mac.c         **** 	    //printf("\nthe index is %d\n",index-1);	  
1032:mac.c         **** 	      error("\n!!!received frame length error\n");	  
1033:mac.c         **** 	      return;
1034:mac.c         ****          }
1035:mac.c         **** 	  remove_from_rx_buffer(current);
1036:mac.c         **** 	  //¿ªÊ¼½øÐÐÖ¡´¦Àí
1037:mac.c         **** 	  mac_frame_rcvd();
1038:mac.c         **** }
1039:mac.c         **** 
1040:mac.c         **** //MAC²ãÔÚÊÕµ½Ò»¸öÖ¡ºóÈçºÎ´¦Àí¸ÃÖ¡º¯Êý
1041:mac.c         **** //ÒÀ¾Ýmac_rx_current_frameÖÐµÄ½á¹¹³ÉÔ±½øÐÐ´¦Àí
1042:mac.c         **** void mac_frame_rcvd(void)
1043:mac.c         **** {
1044:mac.c         ****        //ackÖ¡µÄ·¢ËÍÒÑ¾­°´ÕÕÒªÇóÍê³ÉºóÔÙµ÷ÓÃ¸Ãº¯Êý
1045:mac.c         **** 	//--------------------------------------------------------
1046:mac.c         **** 	//--------------------------------------------------------
1047:mac.c         **** 	//--------------------------------------------------------
1048:mac.c         **** 	TX_BUFFER  * p_frame;
1049:mac.c         **** 	uint8_t  i;
1050:mac.c         ****        switch(mac_rx_current_frame.type)
1051:mac.c         ****        	{
1052:mac.c         ****        	     case MAC_FRAME_ACK:
1053:mac.c         **** 	                 //printf("\ncurrent ack frame dsn is %d\n",mac_rx_current_frame.macDSN);
1054:mac.c         **** 	                 //head_of_timer_queue=timer3quere_cancel(head_of_timer_queue, mac_rx_current_fram
1055:mac.c         **** 			   p_frame=get_frame_pointer(mac_rx_current_frame.macDSN);
1056:mac.c         **** 			   if(p_frame==NULL) 
1057:mac.c         **** 			   	break;
1058:mac.c         **** 	                 switch(p_frame->cmd_type)
1059:mac.c         **** 	                	{
1060:mac.c         **** 	                	       case  MAC_CMD_ASSOCIATE_REQ:
1061:mac.c         **** 	                               printf("\nsuccess receive a association req ack frame\n");
1062:mac.c         **** 					   //printf("---receive ack time is  %08lx---",mac_rx_current_frame.timestamp); 				 
1063:mac.c         ****                                         if(mac_current_state==MAC_STATE_ASSOC_REQ_SENT)
1064:mac.c         ****                                         {
1065:mac.c         **** 		                              mac_current_state=MAC_STATE_ASSOC_WAIT_FOR_RESPONSE;
1066:mac.c         **** 		                              //head_of_timer_queue=timer3queue_start(head_of_timer_queue, TIMER_
1067:mac.c         **** 						  //printf("\ntimer3 is start\n");			  
1068:mac.c         ****                                         }				  
1069:mac.c         **** 					     //ÊÇ·ñÐèÒªÖÃÎïÀíÉäÆµÐÅµÀÎª½ÓÊÕ×´Ì¬??
1070:mac.c         **** 					     break;
1071:mac.c         ****                                    case MAC_CMD_DATA_REQ:
1072:mac.c         **** 	                                 printf("\nsuccess received the data request ack\n");
1073:mac.c         **** 	                                 head_of_timer_queue=timer3queue_start(head_of_timer_queue, TIMER_
1074:mac.c         **** 				            phy_channel_state=PHY_IDLE;
1075:mac.c         **** 					     mac_current_state=MAC_STATE_ASSOC_WAIT_FOR_RESPONSE;
1076:mac.c         **** 					     PLME_SET_TRX_STATE_request(RX_ON);
1077:mac.c         **** 	                                 break;
1078:mac.c         **** 	      //-----//ÏÂÃæÎåÖÖÇéÐÎÖ»ÐèÅÐ¶ÏÏµÍ³MAC²ã×´Ì¬²»ÎªÉÏÃæµÄ×´Ì¬¼´¿É¡£     
1079:mac.c         **** 	                           case  0x00://²»ÊÇÃüÁîÖ¡
1080:mac.c         **** 	      //Èç¹ûÎªdata frameµÄackÖ¡,ÔÚÍê³ÉÉÏÃæµÄÈÎÎñºó
1081:mac.c         **** 	           //ÏòÉÏ²ã·¢ËÍmcps-data.comfirmÔ­Óï£¬ÏÔÊ¾³É¹¦·¢ËÍÊý¾ÝÖ¡  
1082:mac.c         **** 	                                 mcpsDataConfirm(SUCCESS, p_frame->FrameHandle);
1083:mac.c         **** 	                                 break; 
1084:mac.c         **** 	                           case  MAC_CMD_PAN_ID_CONFLICT:
1085:mac.c         **** 	      //Èç¹ûÎªPANID confilict notificationµÄackÖ¡£¬ÔÚÍê³ÉÉÏÃæµÄÈÎÎñºó
1086:mac.c         **** 	           //È·¶¨Ð­µ÷ÕßÒÑ¾­ÊÕµ½¸ÃÖ¡¡£ÕýÈ··µ»Ø.
1087:mac.c         **** 	                                 //ÎÞÊÂ¿É×ö  
1088:mac.c         **** 	                                 break;
1089:mac.c         **** 	                           case  MAC_CMD_DISASSOCIATE_NOTICE:
1090:mac.c         **** 	      //Èç¹ûÎªdisassociation notificationµÄackÖ¡£¬ÔÚÍê³ÉÉÏÃæµÄÈÎÎñºó
1091:mac.c         **** 	           //ÏòÉÏ²ã·¢ËÍmlme-disassociation.confirmÔ­Óï,·µ»Ø×´Ì¬³É¹¦
1092:mac.c         **** 	                                 mlmeDisassociateConfirm(SUCCESS);
1093:mac.c         **** 	                                 break;
1094:mac.c         **** 	                           case MAC_CMD_ASSOCIATE_RPLY:
1095:mac.c         **** 	      //Èç¹ûÎªassociate responseµÄackÖ¡£¬ÔÚÍê³ÉÉÏÃæµÄÈÎÎñºó
1096:mac.c         **** 	           //ÏòÉÏ²ã·¢ËÍmlme-comm-statusÔ­Óï£¬ÏÔÊ¾ÏìÓ¦Ö¡·¢ËÍ³É¹¦
1097:mac.c         **** 	                                 //mlmeCommStatusIndication(WORD panId, BYTE srcAddrMode, ADDRESS 
1098:mac.c         **** 	                                 //
1099:mac.c         **** 	                                 break;
1100:mac.c         **** 	                           case MAC_CMD_COORD_REALIGNMENT:
1101:mac.c         **** 	      //Èç¹ûÎªcoordinator realignmentµÄackÖ¡(×¢Òâ:Èç¹û·¢ËÍ¸ÃÖ¡Ê±ºò²»ÊÇ¹ã²¥£¬²Å¿ÉÄÜÒªÇóack)£¬ÔÚÍê³É
1102:mac.c         **** 	           //NOTE:¸ÃÖ¡¿Ï¶¨ÊÇÐ­µ÷ÕßÊÕµ½orphanÇëÇóºó·¢³öµÄ¡£(mlme-start.request·¢³öµÄrealignmentÖ¡ÊÇ
1103:mac.c         **** 	           //ÏòÉÏ²ã·¢ËÍmlme-comm-statusÔ­Óï£¬ÏÔÊ¾¸ÃÖ¡·¢ËÍ³É¹¦(pg87)
1104:mac.c         **** 	                                 //mlmeCommStatusIndication(WORD panId, BYTE srcAddrMode, ADDRESS 
1105:mac.c         **** 	                                 break; 
1106:mac.c         **** 	      //ÉÏÊöÇé¿ö´¦ÀíÍê±Ï£¬ÊÍ·Å·¢ËÍÖ¡Õ¼ÓÃµÄ´æ´¢¿Õ¼ä
1107:mac.c         **** 	                	}
1108:mac.c         **** 	                     remove_tx_queue(mac_rx_current_frame.macDSN);
1109:mac.c         **** 	                     break;
1110:mac.c         ****                        case MAC_FRAME_BEACON:
1111:mac.c         **** 	                      if(IS_FFD!=0x00)
1112:mac.c         **** 				      mlmeSyncLossIndication(PAN_ID_CONFLICT);
1113:mac.c         **** 			        else 
1114:mac.c         **** 			        	{   
1115:mac.c         **** 			                   last_beacon_rx_timestamp=mac_rx_current_frame.timestamp;
1116:mac.c         **** 					     if(IS_MAC_SYNING)
1117:mac.c         **** 					     	{
1118:mac.c         **** 						 	//head_of_timer_queue=timer3quere_cancel(head_of_timer_queue,0, WAIT_FOR_BEACON);
1119:mac.c         **** 						 	head_of_systimer_queue=systimer_stop_task(head_of_systimer_queue, SYN_WAITTING_FOR_BEACON);
1120:mac.c         ****                                                  //Í¬²½Íê±Ï
1121:mac.c         ****                                                  mac_current_state=MAC_STATE_SYNING_END;
1122:mac.c         **** 							IS_MAC_SYNING=FALSE;
1123:mac.c         **** 							last_beacon_rx_timestamp=mac_rx_current_frame.timestamp;
1124:mac.c         **** 							mlmesyn_finished();
1125:mac.c         **** 							phy_channel_state=PHY_IDLE;
1126:mac.c         **** 							PLME_SET_TRX_STATE_request(RX_ON);
1127:mac.c         **** 							Is_received_beacon=TRUE;
1128:mac.c         **** 							loss_sync_number=0;
1129:mac.c         **** 							printf("\n------synchronizing success------ \n");
1130:mac.c         **** 							
1131:mac.c         **** 							//mlme
1132:mac.c         **** 			        	       }
1133:mac.c         **** 			        	     else if((mac_rx_current_frame.beacon_payload_length!=0)||(!mac_pib_data.macAutoReq
1134:mac.c         **** 			        	     	{
1135:mac.c         **** 			        	     	    mac_pib_data.macCoordShortAddress=mac_rx_current_frame.src.shortAddr;
1136:mac.c         **** 			        	     	    beacon_info.bsn=mac_rx_current_frame.macDSN;
1137:mac.c         **** 						    beacon_info.sduLength=mac_rx_current_frame.beacon_payload_length;
1138:mac.c         **** 						    beacon_info.pendAddrSpec=mac_rx_current_frame.pendaddress_field.bytes;
1139:mac.c         **** 						    beacon_info.shortpendingadd_length=mac_rx_current_frame.shortpendingadd_length;
1140:mac.c         **** 						    beacon_info.longpendingadd_length=mac_rx_current_frame.longpendingadd_length;
1141:mac.c         **** 						    for(i=0;i<beacon_info.shortpendingadd_length;i++)
1142:mac.c         **** 								beacon_info.shortaddrpending_list[i]=mac_rx_current_frame.shortaddrpending_list[i];
1143:mac.c         **** 						    for(i=0;i<beacon_info.longpendingadd_length;i++)
1144:mac.c         **** 								beacon_info.longaddrpending_list[i]=mac_rx_current_frame.longaddrpending_list[i];
1145:mac.c         **** 						    for(i=0;i<beacon_info.sduLength;i++)
1146:mac.c         **** 								beacon_info.pSdu[i]=mac_rx_current_frame.beacon_payload[i];
1147:mac.c         **** 						    beacon_info.panDescriptor.coordinator=mac_rx_current_frame.src;
1148:mac.c         **** 						    beacon_info.panDescriptor.timeStamp=mac_rx_current_frame.timestamp;
1149:mac.c         **** 						    beacon_info.panDescriptor.linkQuality=mac_rx_current_frame.lqi;
1150:mac.c         **** 						    beacon_info.panDescriptor.superframeSpec=mac_rx_current_frame.superframe_field;
1151:mac.c         **** 					           //printf("\n-----the superframe field is %04x\n",mac_rx_current_frame.superframe_fi
1152:mac.c         **** 						    beacon_info.panDescriptor.logicalChannel=mac_rx_current_frame.logicalchannel_field;
1153:mac.c         **** 						    //ÆäËûÓò±¾°æ±¾²»Ìá¹©Ö§³Ö¡£	
1154:mac.c         **** 						    //Leds_greenToggle();                                 						    
1155:mac.c         **** 						    //printf("\nfinished function mac_frame_rcvd()\n");
1156:mac.c         **** 						    //printf("\nbeacon frame received\n");
1157:mac.c         **** 						    if((mac_current_state_saved==MAC_STATE_ASSOC_WAIT_FOR_RESPONSE)||(mac_current_state_saved
1158:mac.c         **** 						       {mac_current_state=mac_current_state_saved;}
1159:mac.c         **** 						    mlmeBeaconNotifyIndication(beacon_info); 
1160:mac.c         **** 						   if(mac_current_state!=MAC_STATE_ACTIVE_PASSIVE_SCAN)	
1161:mac.c         **** 						    	{
1162:mac.c         **** 						            Is_received_beacon=TRUE;
1163:mac.c         **** 						            mlmesyn_finished();
1164:mac.c         **** 							     //printf("mac_current_state_saved is %d",mac_current_state_saved);		
1165:mac.c         **** 							     //mac_current_state=mac_current_state_saved;
1166:mac.c         **** 						            phy_channel_state=PHY_IDLE;	
1167:mac.c         **** 						            PLME_SET_TRX_STATE_request(RX_ON);	 
1168:mac.c         **** 						            //Is_received_beacon=TRUE;	 
1169:mac.c         **** 							     //-------------------------------------		
1170:mac.c         **** 							     //mac_current_state=MAC_STATE_SYNING_END;		
1171:mac.c         **** 						            //printf("\n------synchronizing success------ \n");	 
1172:mac.c         **** 						    	}
1173:mac.c         **** 						     
1174:mac.c         **** 			        	            }
1175:mac.c         **** 			        	}
1176:mac.c         **** 	                      break;
1177:mac.c         **** 	                case   MAC_FRAME_DATA: 
1178:mac.c         **** 	  //Èç¹ûÊÕµ½µÄÎªdata frame
1179:mac.c         **** 	  	  //È·¶¨ÏµÍ³ÎªÕý³£¹¤×÷×´Ì¬ºó£¬ÊÕÏÂ¸ÃÖ¡£¬²¢Í¨¹ýÔ­ÓïmcpsDataIndicationÏò¸ß²ã±¨¸æ¡£
1180:mac.c         **** 	  	  //²¢²é¿´Êý¾ÝÖ¡ÖÐµÄpendingÓò£¬Èç¹û»¹ÓÐÊý¾ÝÖ¡£¬Ôò¼ÌÐøÆô¶¯·¢ËÍdata request½ø³Ì.
1181:mac.c         ****                                   //printf("\n---received the data frame1----\n");
1182:mac.c         **** 	                           
1183:mac.c         **** 				       if(mac_current_state==MAC_STATE_IDLE)
1184:mac.c         ****                              	{
1185:mac.c         ****                              	  //printf("\n---received the data frame2----\n");
1186:mac.c         ****                              	    mcps_data_indication_info.src=mac_rx_current_frame.src;
1187:mac.c         **** 								  //printf("\nthe src mode is %02x\n",mcps_data_indication_info.src.addrMode);
1188:mac.c         **** 					   					    //for(uint8_t i=0;i<8;i++)
1189:mac.c         **** 							//printf("\nthe src addr[%d] is %x\n",i,mcps_data_indication_info.src.longAddr.v[i]);			  
1190:mac.c         **** 					    mcps_data_indication_info.dst=mac_rx_current_frame.dst;
1191:mac.c         **** 					    mcps_data_indication_info.mpduLinkQuality=mac_rx_current_frame.lqi;
1192:mac.c         **** 					   mcps_data_indication_info.msduLength=mac_rx_current_frame.nwk_data_length;
1193:mac.c         **** 					    for(i=0;i<mcps_data_indication_info.msduLength;i++)
1194:mac.c         **** 							mcps_data_indication_info.pMsdu[i]=mac_rx_current_frame.nwk_data_payload[i];
1195:mac.c         ****                              	    mcpsDataIndication(mcps_data_indication_info);
1196:mac.c         **** 									
1197:mac.c         ****                              	}
1198:mac.c         **** 	                      break;
1199:mac.c         ****                        case   MAC_FRAME_CMD:
1200:mac.c         **** 			       switch(mac_rx_current_frame.cmd)
1201:mac.c         **** 			       	{
1202:mac.c         **** 			       	        case  MAC_CMD_ASSOCIATE_REQ:
1203:mac.c         **** 	  //Èç¹ûÊÕµ½µÄÎªassociation requestÖ¡(Ö»ÓÐÐ­µ÷ÕßµÄ´úÂë²Å²Î¼Ó±àÒë)
1204:mac.c         **** 	      //È·¶¨ÏµÍ³ÎªÕý³£¹¤×÷×´Ì¬ºó(ÍøÂçÒÑ¾­½¨ºÃ)£¬ÊÕÏÂ¸ÃÖ¡ºó,Í¨¹ýmlmeAssociateIndicationÔ­ÓïÍ¨Öª¸ß²ã
1205:mac.c         ****                                                  //printf("\n----------------sucess received a asso
1206:mac.c         **** 							if((mac_current_state==MAC_STATE_IDLE)&&(IS_FFD!=0x00))
1207:mac.c         **** 	                                         	{
1208:mac.c         **** 	                                         	    //printf("\n----------------sucess received a associ
1209:mac.c         **** 	                                              mlme_associate_indication_info.cap_info=mac_rx_curre
1210:mac.c         **** 	                                              mlme_associate_indication_info.Deviceaddr=mac_rx_cur
1211:mac.c         **** 	                                              mlmeAssociateIndication(mlme_associate_indication_in
1212:mac.c         **** 	                                         	}
1213:mac.c         ****                                                 break;
1214:mac.c         **** 						 case  MAC_CMD_ASSOCIATE_RPLY:
1215:mac.c         **** 	   //Èç¹ûÊÕµ½µÄÎªassociation responseÖ¡
1216:mac.c         **** 	      //È·¶¨ÏµÍ³MAC¹¤×÷×´Ì¬Îªwaittingforresponse×´Ì¬(ÒÑ¾­·¢ËÍdata request²¢ÊÕµ½ack),È¡Ïû¶¨Ê±¶ÓÁÐÖÐ
1217:mac.c         **** 	      //¿ªÊ¼´¦Àí¾ßÌå¹¤×÷¡£±£´æÊÕµ½µÄÐ­µ÷Õß¶ÔÓ¦µÄ²ÎÊý£¬ÉèÖÃ¶ÔÓ¦µÄPIB±äÁ¿
1218:mac.c         **** 	      //Èç¹û³É¹¦¹ØÁª£¬Ôò¸Ä±äÏµÍ³MAC×´Ì¬ÎªÕý³£¹¤×÷×´Ì¬
1219:mac.c         **** 	      //·¢ËÍmlme-associate.confirmÔ­ÓïÏÔÊ¾×´Ì¬
1220:mac.c         **** 	                                         //printf("\n-------success received a association reply f
1221:mac.c         **** 	                                         if((mac_current_state==MAC_STATE_ASSOC_WAIT_FOR_RESPONSE)
1222:mac.c         **** 	                                         	{
1223:mac.c         **** 	                                         	   printf("\n-------success received a association reply
1224:mac.c         **** 	                                         	   head_of_timer_queue=timer3quere_cancel(head_of_timer_
1225:mac.c         **** 							   mac_current_state=MAC_STATE_IDLE;
1226:mac.c         **** 							   mlmeAssociateConfirm(mac_rx_current_frame.shortaddralloc, mac_rx_current_frame.associatio
1227:mac.c         **** 	                                         	}
1228:mac.c         **** 	                                         break;
1229:mac.c         ****                                            case  MAC_CMD_DISASSOCIATE_NOTICE:
1230:mac.c         **** 	   //Èç¹ûÊÕµ½µÄÎªdisassociation notificationÖ¡(Ð­µ÷ÕßºÍenddevice¶¼ÓÐ¿ÉÄÜÊÕµ½¸ÃÖ¡):
1231:mac.c         **** 	      //ÈôÎªÐ­µ÷ÕßÊÕµ½¸ÃÖ¡£¬ÔòÐèÒªÍ¨¹ýmlmeDisassociateIndicationÔ­Óï±¨¸æ¸ø¸ß²ã£¬²¢É¾³ýÏàÓ¦µÄenddev
1232:mac.c         **** 	      //ÈôÎªÖÕ¶ËÉè±¸ÊÕµ½¸ÃÖ¡£¬ÔòÍ¬ÑùÐèÒªÍ¨¹ýmlmeDisassociateIndicationÔ­Óï±¨¸æ¸ø¸ß²ã,²¢É¾³ýÏàÓ¦µÄP
1233:mac.c         **** 	      //ÐÞ¸ÄÏµÍ³µÄMAC²ãµÄ×´Ì¬±äÁ¿ÎªÎ´¹ØÁª×´Ì¬
1234:mac.c         **** 	                                         if((IS_FFD!=0x00))
1235:mac.c         **** 	                                         	{
1236:mac.c         **** 	                                         	    
1237:mac.c         **** 	                                         	    mlmeDisassociateIndication(mac_rx_current_frame.src.
1238:mac.c         **** 	                                         	}
1239:mac.c         **** 						      else
1240:mac.c         **** 						      	{
1241:mac.c         **** 						      	  //printf("\n--received a disassociation notice frame---\n");
1242:mac.c         **** 	                                         	    //if(mac_current_state==MAC_STATE_IDLE)
1243:mac.c         **** 	                                         	    {
1244:mac.c         **** 	                                         	         head_of_timer_queue=timer3quere_cancel(head_of_
1245:mac.c         **** 								  mac_current_state=MAC_STATE_DISASSOCIATED;
1246:mac.c         **** 	                                         	         mlmeDisassociateIndication(mac_rx_current_frame
1247:mac.c         **** 							         
1248:mac.c         **** 	                                         	     };
1249:mac.c         **** 						      	}
1250:mac.c         **** 	                                         break;
1251:mac.c         ****                                            case MAC_CMD_DATA_REQ:
1252:mac.c         **** 	   //Èç¹ûÊÕµ½µÄÎªdata requestÖ¡(Ö»ÓÐÐ­µ÷ÕßµÄ´úÂë²Å²Î¼Ó±àÒë)
1253:mac.c         **** 	      //Æô¶¯Ò»¸öÊý¾Ý·¢ËÍÈÎÎñ:¸ù¾Ýdata requestÖ¡ÖÐµÄÔ´µØÖ·£¬´Ópending¶ÓÁÐÖÐÑ¡ÔñÊý¾Ý½øÐÐ·¢ËÍ,Èç¹ûÃ»Ó
1254:mac.c         **** 	      //½ø³ÌÖ±½Ó·µ»Ø¡£
1255:mac.c         **** 	                                         if(IS_FFD!=0x00)
1256:mac.c         **** 	                                         	{
1257:mac.c         **** 	                                         	   //printf("\ndata request frame received\n");
1258:mac.c         **** 	                                             pending_data_send(mac_rx_current_frame.src);
1259:mac.c         **** 	                                         	}
1260:mac.c         **** 	                                         break;
1261:mac.c         **** 	                                    case MAC_CMD_PAN_ID_CONFLICT:
1262:mac.c         **** 	  //Èç¹ûÊÕµ½µÄÎªPANID confilictÖ¡(Ö»ÓÐÐ­µ÷ÕßµÄ´úÂë²Å²Î¼Ó±àÒë)
1263:mac.c         **** 	      //Ð­µ÷ÕßÕý´¦ÓÚÕý³£µÄ¹¤×÷×´Ì¬(ÍøÂçÒÑ¾­½¨ºÃ)£¬ÔòÐèÒªÍ¨¹ýmlmeSyncLossIndicationÔ­ÓïÍ¨Öª¸ß²ã,ÆäÖ
1264:mac.c         **** 	                                         	{
1265:mac.c         **** 	                                         	    mlmeSyncLossIndication(PAN_ID_CONFLICT);
1266:mac.c         **** 							    
1267:mac.c         **** 							    //mac_current_state=MAC_STATE_ID_CONFLICT;
1268:mac.c         **** 	                                         	}
1269:mac.c         **** 	                                         break;
1270:mac.c         ****                                            case MAC_CMD_ORPHAN_NOTICE:
1271:mac.c         **** 	  //Èç¹ûÊÕµ½µÄÎªOrphan notificationÖ¡(Ö»ÓÐÐ­µ÷ÕßµÄ´úÂë²Å²Î¼Ó±àÒë)
1272:mac.c         **** 	      //Ñ°ÕÒ¶ÔÓ¦ÖÕ¶ËÉè±¸µÄ¹ØÁª¼ÇÂ¼,Èç¹ûÕÒµ½£¬Ôòµ÷ÓÃ·¢ËÍ½ø³Ì£¬·¢ËÍrealignmentÖ¡¸ø¶ÔÓ¦Éè±¸¡£
1273:mac.c         **** 	      //Èç¹ûÃ»ÓÐÕÒµ½¶ÔÓ¦¼ÇÂ¼£¬Ôòdiscard¸ÃÖ¡
1274:mac.c         **** 	                                         if((mac_current_state==MAC_STATE_IDLE)&&(IS_FFD!=0x00))
1275:mac.c         **** 	                                         {
1276:mac.c         **** 	                                         	    mlmeOrphanIndication(mac_rx_current_frame.src.longAd
1277:mac.c         **** 	                                         	    //coordinator_realignment_frame_send();ÓÉmlme-orphan
1278:mac.c         **** 	                                         }
1279:mac.c         **** 	                                         break;
1280:mac.c         ****                                            case MAC_CMD_BEACON_REQ:
1281:mac.c         **** 	  //Èç¹ûÊÕµ½µÄÎªBeacon requestÖ¡(Ö»ÓÐFFDµÄ´úÂë²Å²Î¼Ó±àÒë)
1282:mac.c         **** 	      //ÓÉÓÚÎÒÃÇÊµÏÖµÄÊÇÐÅ±êÊ¹ÄÜÍøÂç£¬ËùÒÔºöÂÔµô¸ÃÖ¡£¬°´ÖÜÆÚ·¢ËÍÐÅ±êÖ¡¾ÍOK¡£
1283:mac.c         **** 	                                        break;
1284:mac.c         ****                                            case MAC_CMD_COORD_REALIGNMENT:
1285:mac.c         **** 	  //Èç¹ûÊÕµ½µÄÎªCoordinator realignmentÖ¡
1286:mac.c         **** 	      //ÈôÏµÍ³MAC²ãÒÑ¾­´¦ÓÚÕý³£¹¤×÷×´Ì¬(ÍøÂçÒÑ¾­½¨ºÃ)£¬Ôòµ÷ÓÃmlmeSyncLossIndicationÍ¨Öª¸ß²ã£¬ÆäÖÐl
1287:mac.c         **** 	      //ÈôÏµÍ³MAC²ãÕý´¦ÓÚORPHAN SCAN×´Ì¬£¬ÔòÈ¡Ïû¶¨Ê±¶ÓÁÐÖÐ¶ÔÓ¦µÄµÈ´ýÈÎÎñ£¬²¢¼ÇÂ¼¸ÃÖ¡ÖÐµÄ²ÎÊý£¬È»ºó
1288:mac.c         **** 	                                        if(!IS_COORDINATOR)
1289:mac.c         **** 	                                        {
1290:mac.c         **** 	                                            if(mac_current_state==MAC_STATE_ORPHAN_SCAN)
1291:mac.c         **** 	                                            {
1292:mac.c         **** 
1293:mac.c         **** 								printf("\n---success received the coordinator realignment frame----\n");					 
1294:mac.c         **** 	                                                 
1295:mac.c         **** 	                                                 //NOTE:×öorphanscanÊ±ºòÉèÖÃµÄÊÇwait_for_response.
1296:mac.c         **** 								head_of_timer_queue=timer3quere_cancel(head_of_timer_queue, 0, WAIT_FOR_RESPONSE);
1297:mac.c         ****                                                         mac_pib_data.macCoordShortAddress=mac_rx_cu
1298:mac.c         **** 							       mac_pib_data.macPANId=mac_rx_current_frame.PAN_ID_field;
1299:mac.c         **** 								//---------------------------------------------
1300:mac.c         **** 								//------------´ýÌí¼Ó-----------------------
1301:mac.c         **** 								//ÉèÖÃÎïÀíÂß¼­ÐÅµÀ--------------------
1302:mac.c         **** 								//---------------------------------------------
1303:mac.c         **** 								mac_pib_data.macShortAddress=mac_rx_current_frame.shortaddrallocted;
1304:mac.c         **** 								mac_pib_data.macCoordExtendedAddress=mac_rx_current_frame.src.longAddr;
1305:mac.c         **** 	                                         	       scan_result_info.status=SUCCESS;
1306:mac.c         **** 	                                         	       scan_result_info.scanType=ORPHAN_SCAN;
1307:mac.c         **** 								mac_current_state=MAC_STATE_IDLE;
1308:mac.c         **** 	                                         	       mlmeScanConfirm(scan_result_info);
1309:mac.c         **** 	                                         	       
1310:mac.c         **** 	                                            }	
1311:mac.c         **** 							  else
1312:mac.c         **** 							  {
1313:mac.c         **** 							       //
1314:mac.c         **** 							     //printf("\n---success received a broadcast realignment frame----\n");
1315:mac.c         ****                                                         /*mac_pib_data.macCoordShortAddress=mac_rx_
1316:mac.c         **** 							       mac_pib_data.macPANId=mac_rx_current_frame.PAN_ID_field;
1317:mac.c         **** 								mac_pib_data.macCoordExtendedAddress=mac_rx_current_frame.src.longAddr;
1318:mac.c         **** 								mac_current_state=MAC_STATE_REALIGNMENT;
1319:mac.c         ****                                                         mlmeSyncLossIndication(REALIGNMENT);
1320:mac.c         ****                                                         */
1321:mac.c         **** 							  }
1322:mac.c         **** 	                                        }
1323:mac.c         ****                                                break;
1324:mac.c         **** 				   }
1325:mac.c         **** 	  //ÆäËûÇéÐÎ£¬discardÊÕµ½µÄÖ¡¡£
1326:mac.c         **** 	                   break;
1327:mac.c         ****        	}
1328:mac.c         **** 	   
1329:mac.c         **** }
1330:mac.c         **** 
1331:mac.c         **** 
1332:mac.c         **** 
1333:mac.c         **** 
1334:mac.c         **** //ÒÔÏÂÎª¸÷Ö¡µÄ·¢ËÍº¯Êý£¬
1335:mac.c         **** //¾ßÌåÍê³É¹¦ÄÜ¾ÍÊÇÌîÐ´mac_tx_current_frameÖÐ¸÷¸öÓò
1336:mac.c         **** void data_request_frame_send(void)
1337:mac.c         **** {
1338:mac.c         ****        mac_tx_current_frame.cmd=MAC_CMD_DATA_REQ;
1339:mac.c         ****        mac_tx_current_frame.type=MAC_FRAME_CMD;
1340:mac.c         **** 	mac_tx_current_frame.macDSN=mac_pib_data.macDSN++;
1341:mac.c         ****        //ÔÝÊ±×÷¼ò»¯´¦Àí
1342:mac.c         **** 	mac_tx_current_frame.src.panID=mac_pib_data.macPANId;
1343:mac.c         **** 	if(mac_current_state==MAC_STATE_ASSOC_WAIT_FOR_RESPONSE)
1344:mac.c         **** 	{
1345:mac.c         **** 	     //Ã»ÓÐÍøÂçºÍÐ­µ÷ÕßµÄÈÎºÎÐÅÏ¢
1346:mac.c         **** 	     //printf("\nno addr mode\n");
1347:mac.c         **** 	      mac_tx_current_frame.dst.addrMode=0x00;
1348:mac.c         **** 	      //mac_tx_current_frame.dst.shortAddr=mac_pib_data.macCoordShortAddress;
1349:mac.c         **** 	      //mac_tx_current_frame.dst.panID=mac_pib_data.macPANId;	 
1350:mac.c         **** 	}
1351:mac.c         **** 	else
1352:mac.c         **** 	{
1353:mac.c         **** 	    //printf("\nlong addr mode\n");
1354:mac.c         **** 	      mac_tx_current_frame.dst.addrMode=0x02;
1355:mac.c         **** 	      mac_tx_current_frame.dst.shortAddr=mac_pib_data.macCoordShortAddress;
1356:mac.c         **** 	      mac_tx_current_frame.dst.panID=mac_pib_data.macPANId;
1357:mac.c         **** 	}
1358:mac.c         **** 	if((mac_pib_data.macShortAddress.Val==default_short_addr.Val)||(mac_pib_data.macShortAddress.Val==
1359:mac.c         **** 	{
1360:mac.c         ****        	mac_tx_current_frame.src.addrMode=0x03;
1361:mac.c         **** 		mac_tx_current_frame.src.longAddr=mac_pib_data.macExtAddress;
1362:mac.c         **** 		
1363:mac.c         **** 	}
1364:mac.c         **** 	else
1365:mac.c         **** 	{
1366:mac.c         **** 	       mac_tx_current_frame.src.addrMode=0x02;
1367:mac.c         **** 		mac_tx_current_frame.src.shortAddr=mac_pib_data.macShortAddress;
1368:mac.c         **** 	}
1369:mac.c         **** 	mac_tx_current_frame.frame_control_field.v[0]=0x23;
1370:mac.c         **** 	mac_tx_current_frame.frame_control_field.v[1]=(mac_tx_current_frame.dst.addrMode<<2)|(mac_tx_curre
1371:mac.c         **** 	mac_frame_send();	 
1372:mac.c         **** }
1373:mac.c         **** 
1374:mac.c         **** void pending_data_send(NODE_INFO dst)
1375:mac.c         **** {
1376:mac.c         ****       INDIRECT_TX_PENDING_QUEUE * p_temp;
1377:mac.c         ****       //NODE_INFO src;
1378:mac.c         ****       p_temp=get_pending_frame(dst);
1379:mac.c         ****       if(Is_data_pending(dst))
1380:mac.c         ****       	{
1381:mac.c         ****       	    while(p_temp!=NULL)
1382:mac.c         ****       	    	{
1383:mac.c         ****       	    	     if((p_temp->dst.panID.Val==dst.panID.Val)&&((p_temp->dst.longAddr.longaddr==dst.lo
1384:mac.c         **** 			 break;		 	
1385:mac.c         ****       	    	}
1386:mac.c         **** 	     if(((p_temp->framectl_field.v[0])&0x07)==MAC_FRAME_DATA)
1387:mac.c         **** 	     	{
1388:mac.c         **** 	     	     data_frame_send(p_temp->high_level_payload,p_temp->frameLength,p_temp->dst,p_temp->src,
1389:mac.c         **** 	     	}
1390:mac.c         ****             else if(p_temp->associate_or_disassociate)
1391:mac.c         ****             	{
1392:mac.c         ****             	     //·¢ËÍassociateÏìÓ¦Ö¡ 
1393:mac.c         ****             	     associate_response_frame_send(mac_pib_data.macCoordShortAddress, p_temp->associat
1394:mac.c         ****             	}
1395:mac.c         **** 	      else
1396:mac.c         **** 	      	{
1397:mac.c         **** 	      	     //·¢ËÍdisassociate notificationÖ¡
1398:mac.c         **** 	      	     disassociate_notification_frame_send(p_temp->disassociation_reason, p_temp->end_device
1399:mac.c         **** 	      	}
1400:mac.c         **** 		remove_pending_queue(p_temp);
1401:mac.c         ****       	} 
1402:mac.c         **** 	else 
1403:mac.c         ****          
1404:mac.c         **** 	 return;
1405:mac.c         **** }
1406:mac.c         **** 
1407:mac.c         **** void  data_frame_send(BYTE * nwkpayload, BYTE nwkpayloadlength, NODE_INFO dst,NODE_INFO src,BYTE fr
1408:mac.c         **** {
1409:mac.c         ****       int i;
1410:mac.c         ****       mac_tx_current_frame.cmd=0x00;
1411:mac.c         ****       mac_tx_current_frame.type=MAC_FRAME_DATA;
1412:mac.c         ****       mac_tx_current_frame.macDSN=mac_pib_data.macDSN++;
1413:mac.c         ****       mac_tx_current_frame.dst=dst;
1414:mac.c         ****       mac_tx_current_frame.src=src;
1415:mac.c         ****       mac_tx_current_frame.nwk_data_length=nwkpayloadlength;
1416:mac.c         ****       mac_tx_current_frame.framehandle=frameHandle;
1417:mac.c         ****       for(i=0;i<nwkpayloadlength;i++)
1418:mac.c         ****           mac_tx_current_frame.nwk_data_payload[i]=*nwkpayload++;
1419:mac.c         ****       if((Is_data_pending(dst))&&(IS_COORDINATOR))
1420:mac.c         ****          mac_tx_current_frame.frame_control_field.v[0]=0x31;
1421:mac.c         ****       else
1422:mac.c         ****          mac_tx_current_frame.frame_control_field.v[0]=0x21;
1423:mac.c         ****       
1424:mac.c         ****       mac_tx_current_frame.frame_control_field.v[1]=(mac_tx_current_frame.dst.addrMode<<2)|(mac_tx_
1425:mac.c         ****       	  
1426:mac.c         ****       mac_frame_send();
1427:mac.c         **** }
1428:mac.c         **** 
1429:mac.c         **** bool  Is_data_pending(NODE_INFO dst)
1430:mac.c         **** {
1431:mac.c         ****        INDIRECT_TX_PENDING_QUEUE * p_temp;
1432:mac.c         **** 	p_temp=head_of_indirect_pending_buffer;
1433:mac.c         **** 	while(p_temp!=NULL)
1434:mac.c         **** 		{
1435:mac.c         **** 		     if((p_temp->dst.longAddr.longaddr==dst.longAddr.longaddr)||(p_temp->dst.shortAddr.Val==dst.s
1436:mac.c         **** 			 return TRUE;
1437:mac.c         **** 		       p_temp=p_temp->next;
1438:mac.c         **** 		}
1439:mac.c         **** 	return FALSE;
1440:mac.c         **** }
1441:mac.c         **** 
1442:mac.c         **** void  associate_request_frame_send(SHORT_ADDR panid,NODE_INFO dst, Node_Capability node_capinfo)
1443:mac.c         **** {
1444:mac.c         ****       mac_tx_current_frame.cmd=MAC_CMD_ASSOCIATE_REQ;
1445:mac.c         ****       mac_tx_current_frame.type=MAC_FRAME_CMD;
1446:mac.c         ****       mac_tx_current_frame.macDSN=mac_pib_data.macDSN++;
1447:mac.c         ****       mac_tx_current_frame.src.addrMode=0x03;
1448:mac.c         ****       mac_tx_current_frame.dst=dst;
1449:mac.c         ****       mac_tx_current_frame.src.panID=default_short_addr;
1450:mac.c         ****       mac_tx_current_frame.src.longAddr=mac_pib_data.macExtAddress;
1451:mac.c         ****       mac_tx_current_frame.node_capinfo_field=node_capinfo;
1452:mac.c         ****       mac_tx_current_frame.frame_control_field.v[0]=0x23;
1453:mac.c         ****       //printf("\nthe dst.addrmode is %02x",mac_tx_current_frame.dst.addrMode);	
1454:mac.c         ****       //printf("\nthe src.addrmode is %02x",mac_tx_current_frame.src.addrMode);	  
1455:mac.c         ****       mac_tx_current_frame.frame_control_field.v[1]=(((uint8_t)mac_tx_current_frame.dst.addrMode)<<
1456:mac.c         ****       //printf("\nthe control field isMSB %02x",mac_tx_current_frame.frame_control_field.v[1]);	  
1457:mac.c         ****       mac_frame_send();	  
1458:mac.c         **** }
1459:mac.c         **** 
1460:mac.c         **** 
1461:mac.c         **** 
1462:mac.c         **** void disassociate_notification_frame_send(BYTE disassociation_reason,LONG_ADDR end_device_addr)
1463:mac.c         **** {    mac_tx_current_frame.cmd=MAC_CMD_DISASSOCIATE_NOTICE;
1464:mac.c         ****     mac_tx_current_frame.type=MAC_FRAME_CMD;  
1465:mac.c         ****     mac_tx_current_frame.macDSN=mac_pib_data.macDSN++;
1466:mac.c         ****     mac_tx_current_frame.src.addrMode=0x03;
1467:mac.c         ****    if(!IS_FFD)	
1468:mac.c         ****     mac_tx_current_frame.dst.addrMode=0x02;
1469:mac.c         ****    else
1470:mac.c         ****     mac_tx_current_frame.dst.addrMode=0x03;	
1471:mac.c         ****     mac_tx_current_frame.src.panID=mac_pib_data.macPANId;
1472:mac.c         ****     mac_tx_current_frame.dst.panID=mac_pib_data.macPANId;	
1473:mac.c         ****     mac_tx_current_frame.src.longAddr=mac_pib_data.macExtAddress;
1474:mac.c         ****     if(IS_FFD!=0x00)
1475:mac.c         ****        mac_tx_current_frame.dst.longAddr=end_device_addr;
1476:mac.c         ****     else
1477:mac.c         ****        mac_tx_current_frame.dst.shortAddr=mac_pib_data.macCoordShortAddress;
1478:mac.c         ****     mac_tx_current_frame.disassociation_reason=disassociation_reason;
1479:mac.c         ****     mac_tx_current_frame.frame_control_field.v[0]=0x23;
1480:mac.c         ****     if(!IS_FFD)	
1481:mac.c         ****     mac_tx_current_frame.frame_control_field.v[1]=0xc8;
1482:mac.c         ****     else
1483:mac.c         ****     mac_tx_current_frame.frame_control_field.v[1]=0xcc;		
1484:mac.c         ****     mac_frame_send();
1485:mac.c         **** } 
1486:mac.c         **** 
1487:mac.c         **** void panid_confilct_frame_send(void)
1488:mac.c         **** {
1489:mac.c         ****      mac_tx_current_frame.cmd=MAC_CMD_PAN_ID_CONFLICT;
1490:mac.c         ****      mac_tx_current_frame.type=MAC_FRAME_CMD;
1491:mac.c         ****      mac_tx_current_frame.macDSN=mac_pib_data.macDSN++;
1492:mac.c         ****      mac_tx_current_frame.src.addrMode=0x03;
1493:mac.c         ****      mac_tx_current_frame.dst.addrMode=0x02;
1494:mac.c         ****      mac_tx_current_frame.src.panID=mac_pib_data.macPANId;
1495:mac.c         ****      mac_tx_current_frame.dst.panID=mac_pib_data.macPANId;
1496:mac.c         ****      mac_tx_current_frame.src.longAddr=mac_pib_data.macExtAddress;
1497:mac.c         ****      //mac_tx_current_frame.dst.longAddr=mac_pib_data.macCoordExtendedAddress;
1498:mac.c         ****      mac_tx_current_frame.dst.shortAddr=mac_pib_data.macCoordShortAddress;
1499:mac.c         ****      mac_tx_current_frame.frame_control_field.v[0]=0x23;
1500:mac.c         ****      mac_tx_current_frame.frame_control_field.v[1]=0xc8;
1501:mac.c         ****      mac_frame_send();	 
1502:mac.c         **** }
1503:mac.c         **** 
1504:mac.c         **** void orphan_notification_frame_send(void)
1505:mac.c         **** {
1506:mac.c         ****       mac_tx_current_frame.cmd=MAC_CMD_ORPHAN_NOTICE;
1507:mac.c         ****       mac_tx_current_frame.type=MAC_FRAME_CMD;
1508:mac.c         ****       mac_tx_current_frame.macDSN=mac_pib_data.macDSN++;
1509:mac.c         ****       mac_tx_current_frame.src.addrMode=0x03;
1510:mac.c         ****       mac_tx_current_frame.dst.addrMode=0x02;
1511:mac.c         ****       mac_tx_current_frame.src.panID=default_short_addr;
1512:mac.c         ****       mac_tx_current_frame.src.longAddr=mac_pib_data.macExtAddress;
1513:mac.c         ****       mac_tx_current_frame.dst.panID=default_short_addr;
1514:mac.c         ****       mac_tx_current_frame.dst.shortAddr=default_short_addr;
1515:mac.c         ****       mac_tx_current_frame.frame_control_field.v[0]=0x03;
1516:mac.c         ****       mac_tx_current_frame.frame_control_field.v[1]=0xc8;
1517:mac.c         ****       mac_frame_send();
1518:mac.c         ****       head_of_timer_queue=timer3queue_start(head_of_timer_queue,TIMER_ONE_SHOT, mac_tx_current_fram
1519:mac.c         **** }
1520:mac.c         **** 
1521:mac.c         **** void beacon_request_frame_send(void)
1522:mac.c         **** {
1523:mac.c         ****        
1524:mac.c         **** }
1525:mac.c         **** 
1526:mac.c         **** 
1527:mac.c         **** //#ifdef I_AM_COORDINATOR
1528:mac.c         **** void coordinator_realignment_frame_send(bool Isunicast,  NODE_INFO  dst, SHORT_ADDR allocated_addr)
1529:mac.c         **** {
1530:mac.c         ****        mac_tx_current_frame.cmd=MAC_CMD_COORD_REALIGNMENT;
1531:mac.c         ****        mac_tx_current_frame.type=MAC_FRAME_CMD;
1532:mac.c         **** 	mac_tx_current_frame.macDSN=mac_pib_data.macDSN++;
1533:mac.c         **** 	mac_tx_current_frame.src.addrMode=0x03;
1534:mac.c         **** 	mac_tx_current_frame.src.longAddr=mac_pib_data.macExtAddress;
1535:mac.c         **** 	mac_tx_current_frame.src.panID=mac_pib_data.macPANId;
1536:mac.c         **** 	mac_tx_current_frame.dst.panID=default_short_addr;
1537:mac.c         ****        //mac_tx_current_frame.dst.addrMode=0x03;
1538:mac.c         **** 	if(Isunicast)
1539:mac.c         **** 		{  
1540:mac.c         **** 		    //µ¥²¥
1541:mac.c         **** 		    mac_tx_current_frame.dst.addrMode=0x03;
1542:mac.c         **** 		    mac_tx_current_frame.dst.longAddr=dst.longAddr;
1543:mac.c         **** 		    mac_tx_current_frame.shortaddrallocted=allocated_addr;
1544:mac.c         **** 	           mac_tx_current_frame.frame_control_field.v[0]=0x23;
1545:mac.c         **** 	           mac_tx_current_frame.frame_control_field.v[1]=0xcc;
1546:mac.c         **** 		}
1547:mac.c         **** 	else 
1548:mac.c         **** 		{  
1549:mac.c         **** 		    //¹ã²¥
1550:mac.c         **** 		    mac_tx_current_frame.dst.addrMode=0x02;
1551:mac.c         **** 	           mac_tx_current_frame.dst.shortAddr=default_short_addr;
1552:mac.c         **** 		    mac_tx_current_frame.shortaddrallocted=default_short_addr;
1553:mac.c         **** 		    mac_tx_current_frame.frame_control_field.v[0]=0x03;
1554:mac.c         ****                   mac_tx_current_frame.frame_control_field.v[1]=0xc8;	
1555:mac.c         **** 		}		
1556:mac.c         **** 	mac_tx_current_frame.PAN_ID_field=mac_pib_data.macPANId;
1557:mac.c         **** 	mac_tx_current_frame.coordshortaddr_field=mac_pib_data.macShortAddress;
1558:mac.c         **** 	mac_tx_current_frame.logicalchannel_field=ppib.phyCurrentChanel;
1559:mac.c         **** 	mac_frame_send();
1560:mac.c         **** 
1561:mac.c         **** }
1562:mac.c         **** void associate_response_frame_send(SHORT_ADDR coor_short_addr, BYTE associate_status,LONG_ADDR asso
1563:mac.c         **** {
1564:mac.c         ****      mac_tx_current_frame.cmd=MAC_CMD_ASSOCIATE_RPLY;
1565:mac.c         ****      mac_tx_current_frame.type=MAC_FRAME_CMD;
1566:mac.c         ****      mac_tx_current_frame.macDSN=mac_pib_data.macDSN++;
1567:mac.c         ****      mac_tx_current_frame.src.addrMode=0x03;
1568:mac.c         ****      mac_tx_current_frame.dst.addrMode=0x03;
1569:mac.c         ****      mac_tx_current_frame.src.panID=mac_pib_data.macPANId;
1570:mac.c         ****      mac_tx_current_frame.dst.panID=mac_pib_data.macPANId;
1571:mac.c         ****      mac_tx_current_frame.src.longAddr=mac_pib_data.macExtAddress;
1572:mac.c         ****      mac_tx_current_frame.dst.longAddr=associate_device_addr;
1573:mac.c         ****      mac_tx_current_frame.shortaddralloc=shortaddralloc;
1574:mac.c         ****      mac_tx_current_frame.association_status=associate_status;
1575:mac.c         ****      mac_tx_current_frame.frame_control_field.v[0]=0x23;
1576:mac.c         ****      mac_tx_current_frame.frame_control_field.v[1]=0xcc;
1577:mac.c         ****      //printf("\nassociate response frame send\n");	 
1578:mac.c         ****      mac_frame_send();
1579:mac.c         **** }
1580:mac.c         **** 
1581:mac.c         **** //´¦ÀíÐÅ±êÖ¡¶¨Ê±ÎÊÌâµÄÈÎÎñ
1582:mac.c         **** void beacon_frame_tx_timing(void)
1583:mac.c         **** {
1584:mac.c         ****      uint32_t  deltatime;
1585:mac.c         ****      uint32_t truetime;
1586:mac.c         ****      truetime=systime32();
1587:mac.c         ****      deltatime=(truetime>=last_beacon_tx_timestamp) ? truetime-last_beacon_tx_timestamp:(0x3fffffff
1588:mac.c         ****      //deltatime=deltatime>>1;
1589:mac.c         ****      head_of_systimer_queue=systimer_start_task(head_of_systimer_queue, CAP_OVER, (MAC_CAP_PERIOD-(
1590:mac.c         ****      head_of_systimer_queue=systimer_start_task(head_of_systimer_queue, BEACON_SEND, (MAC_SUPERFRAM
1591:mac.c         ****      //printf("\n ---------delta time is %08lx\n",deltatime);	 
1592:mac.c         ****      //printf("\n ---------cap   time is %08lx\n",MAC_CAP_PERIOD);
1593:mac.c         ****      //printf("\n ---------super time is %08lx\n",MAC_SUPERFRAME_PERIOD);	
1594:mac.c         ****      MAC_OBJECT_CAP_START_TICKS=last_beacon_tx_timestamp;
1595:mac.c         ****      MAC_OBJECT_CAP_END_TICKS=truetime+((MAC_CAP_PERIOD<<1)-deltatime);
1596:mac.c         ****      MAC_OBJECT_SUPERFRAME_TICKS=truetime+((MAC_SUPERFRAME_PERIOD<<1)-deltatime);    	 
1597:mac.c         **** }
1598:mac.c         **** 
1599:mac.c         **** //·¢ËÍÖ®Ç°Òª°Ñmac_tx_beaconÌîºÃ
1600:mac.c         **** void  beacon_frame_send(bool short_or_long)
1601:mac.c         **** {
1602:mac.c         ****       uint8_t  i;
1603:mac.c         ****       
1604:mac.c         ****         
1605:mac.c         ****       mac_tx_current_frame.type=MAC_FRAME_BEACON;
1606:mac.c         ****       mac_tx_current_frame.macBSN=mac_pib_data.macBSN++;
1607:mac.c         ****       mac_tx_current_frame.dst.addrMode=0x00;
1608:mac.c         ****       mac_tx_current_frame.src.panID=mac_pib_data.macPANId;
1609:mac.c         ****       if(short_or_long)	  
1610:mac.c         ****       {
1611:mac.c         ****           mac_tx_current_frame.src.addrMode=0x02;
1612:mac.c         **** 	   mac_tx_current_frame.src.shortAddr=mac_pib_data.macShortAddress;
1613:mac.c         ****       } 
1614:mac.c         ****       else
1615:mac.c         ****       {
1616:mac.c         ****           mac_tx_current_frame.src.addrMode=0x03;
1617:mac.c         ****           mac_tx_current_frame.src.longAddr=mac_pib_data.macExtAddress;
1618:mac.c         ****       }
1619:mac.c         ****       mac_tx_current_frame.superframe_field=mac_tx_beacon.superframe_field;
1620:mac.c         ****       mac_tx_current_frame.pendaddress_field=mac_tx_beacon.pendaddress_field;
1621:mac.c         ****       mac_tx_current_frame.shortpendingadd_length=mac_tx_beacon.shortpendingadd_length;
1622:mac.c         ****       for(i=0;i<mac_tx_beacon.shortpendingadd_length;i++)
1623:mac.c         **** 	  	mac_tx_current_frame.shortaddrpending_list[i]=mac_tx_beacon.shortaddrpending_list[i];
1624:mac.c         ****       mac_tx_current_frame.longpendingadd_length=mac_tx_beacon.longpendingadd_length;
1625:mac.c         ****       //printf("\nthe longpending addr length is %d\n",mac_tx_beacon.longpendingadd_length);	  
1626:mac.c         ****       for(i=0;i<mac_tx_beacon.longpendingadd_length;i++)
1627:mac.c         ****       	{
1628:mac.c         ****       	      // printf("\nthere is a long address\n");
1629:mac.c         **** 	  	mac_tx_current_frame.longaddrpending_list[i]=mac_tx_beacon.longaddrpending_list[i];
1630:mac.c         ****       	}	
1631:mac.c         ****      mac_tx_current_frame.beacon_payload_length=mac_tx_beacon.beacon_payload_length;
1632:mac.c         ****      for(i=0;i<mac_tx_beacon.beacon_payload_length;i++)
1633:mac.c         **** 	 	mac_tx_current_frame.beacon_payload[i]=mac_tx_beacon.beacon_payload[i];
1634:mac.c         ****      mac_tx_current_frame.frame_control_field.v[0]=0x00;
1635:mac.c         ****      mac_tx_current_frame.frame_control_field.v[1]=0xc0&(mac_tx_current_frame.src.addrMode<<6);
1636:mac.c         ****      //printf("\nframe_ctl field is %02x--\n",mac_tx_current_frame.frame_control_field.v[1]);	 
1637:mac.c         **** 
1638:mac.c         ****      //postÒ»¸öÈÎÎñ´¦Àípending¶ÓÁÐÖÐµÄÔªËØ³¬Ê±ÇéÐÎ
1639:mac.c         ****      OS_post(pending_frame_handle);
1640:mac.c         **** 	 
1641:mac.c         ****      mac_frame_send();        
1642:mac.c         **** }
1643:mac.c         **** 
1644:mac.c         **** void pending_frame_handle(void)
1645:mac.c         **** {
1646:mac.c         ****       INDIRECT_TX_PENDING_QUEUE *p_temp;
1647:mac.c         ****       p_temp=head_of_indirect_pending_buffer;
1648:mac.c         ****       while(p_temp!=NULL)
1649:mac.c         ****       	{
1650:mac.c         ****       	     //printf("\nindirect buffer is not NULL\n");
1651:mac.c         **** 	  	p_temp->MacTranPersistCounter--;
1652:mac.c         **** 		//p_temp=p_temp->next;
1653:mac.c         **** 		if((p_temp->MacTranPersistCounter)==0)
1654:mac.c         **** 		{
1655:mac.c         **** 		     if((p_temp->framectl_field.v[0]&0x07)==0x01)
1656:mac.c         **** 			 mcpsDataConfirm(TRANSACTION_EXPIRED, p_temp->FrameHandle);
1657:mac.c         **** 		     //else   //¶ÔÓÚassociation responseÖ¡µÄ·¢ËÍÇéÐÎ
1658:mac.c         **** 		     //mlmeCommStatusIndication(WORD panId, BYTE srcAddrMode, ADDRESS * pSrcAddr, BYTE dstAddrMod
1659:mac.c         **** 		     remove_pending_queue(p_temp);
1660:mac.c         **** 			 
1661:mac.c         **** 		     	 
1662:mac.c         **** 		}
1663:mac.c         **** 		p_temp=p_temp->next;
1664:mac.c         ****       	}	
1665:mac.c         **** }
1666:mac.c         **** //#endif
1667:mac.c         **** //Ê±¼ä¶ÓÁÐµ÷Õûº¯Êý
1668:mac.c         **** void  timerqueue_adjust(void)
1669:mac.c         **** {
1670:mac.c         ****      current_timer_elem=head_of_timer_queue;
1671:mac.c         ****      current_timer_elem->next=NULL;
1672:mac.c         ****      head_of_timer_queue=head_of_timer_queue->next;
1673:mac.c         ****      //return  current_timer_elem;
1674:mac.c         **** }
1675:mac.c         **** 
1676:mac.c         **** void mac_timer_task(void)
1677:mac.c         **** {
1678:mac.c         **** 	 //Ö÷Òª¸ù¾ÝÊÇÄÄÖÖÀàÐÍµÄ¶¨Ê±ºÍÏµÍ³µÄµ±Ç°×´Ì¬×÷³öÒ»Ð©ÐÐÎª£º¼´post¶ÔÓ¦µÄÈÎÎñ
1679:mac.c         **** 	 //Î¬»¤Ê±¼ä¶ÓÁÐ
1680:mac.c         **** 	TX_BUFFER * p_temp;
1681:mac.c         **** 	//timerqueue_adjust();
1682:mac.c         **** 	 
1683:mac.c         **** 	//--------------------------------------------------------
1684:mac.c         **** 	//--------------------------------------------------------
1685:mac.c         **** 	//--------------------------------------------------------
1686:mac.c         **** 	switch(current_timer_elem->timer_reason)
1687:mac.c         **** 		{
1688:mac.c         **** 		     case  WAIT_FOR_ACK:
1689:mac.c         **** 			 	p_temp=get_frame_pointer(current_timer_elem->framedsn);
1690:mac.c         **** 				if(p_temp==NULL)
1691:mac.c         **** 					break;				    
1692:mac.c         **** 	 //Èç¹û¶ÔÓ¦µÄ¶¨Ê±ÈÎÎñÔ­ÒòÎªack³¬Ê±µÄÇéÐÎ
1693:mac.c         **** 	    //Èç¹û¸ÃÖ¡ÖÐµÄFrameRetriesCounterÎª0£¬ÔòÐèÒªÍ¨¹ý¶ÔÓ¦µÄÔ­Óï(Èç£ºconfirm,mlme-comm-status)Ïò¸ß²ã
1694:mac.c         **** 	    //¾ßÌå²Ù×÷ÈçÏÂ£º
1695:mac.c         **** 	                     if(p_temp->FrameRetriesCounter!=0)
1696:mac.c         **** 	                     {
1697:mac.c         **** 	                     	    //ÖØ·¢;
1698:mac.c         **** 	                     	     //printf("\n---Retransmit---\n");
1699:mac.c         **** 	                     	       if(Parameter_list.top==((Parameter_list.tail+1)%MAX_TX_BUFFER_SIZE))
1700:mac.c         ****    	                                       error("\ntx buffer is full\n");
1701:mac.c         ****                                           else
1702:mac.c         ****                                             {
1703:mac.c         ****                                                Parameter_list.parameter_tx_task[Parameter_list.tail
1704:mac.c         **** 						     Parameter_list.tail=((Parameter_list.tail+1)%MAX_TX_BUFFER_SIZE);					   
1705:mac.c         ****                                                OS_post(transmit_with_csmaca); 
1706:mac.c         **** 	                     	         } 
1707:mac.c         **** 					      //ACK¶¨Ê±Æ÷µÄÆô¶¯ÊÇÔÚµ×²ã·¢ËÍÍê³ÉÊ±ºòÉèÖÃµÄ.
1708:mac.c         **** 						p_temp->FrameRetriesCounter--;
1709:mac.c         **** 	                     }
1710:mac.c         **** 				else  
1711:mac.c         **** 				{
1712:mac.c         **** 	                     switch(p_temp->cmd_type)
1713:mac.c         **** 	                     	{
1714:mac.c         **** 				          case MAC_CMD_DATA_REQ:
1715:mac.c         **** 	        //ÈôÎªdata requestÖ¡£¬ *************Ð­ÒéÖÐÃ»ÓÐ¿É¿¿ÐÔ±£Ö¤(Ò²²»Ì«¿ÉÄÜ·¢ÉúÏÂÃæÇéÐÎ)**********
1716:mac.c         **** 	              //¶ÔÓÚassociateÖÐµÄdatarequest:¿ÉÒÔÒÔmlme-association.confirm NO_data·µ»Ø¸ø¸ß²ã
1717:mac.c         **** 	                                       //if(mac_current_state==MAC_STATE_ASSOC_WAIT_FOR_RESPONSE) 
1718:mac.c         **** 	              //¶ÔÓÚdisassociationÖÐµÄdata request:¿ÉÒÔ²ÉÓÃmlme-disassociation.confirmÔ­Óï£¬×´Ì¬Îª
1719:mac.c         **** 	              //¶ÔÓÚdataµÄdata request:¿ÉÒÔ²ÉÓÃ***********(Ã»ÓÐÕâÑùµÄÔ­Óï£¬ÔòÖ±½Ó·µ»Ø£¬²»´¦Àí)****
1720:mac.c         **** 	                                       break;
1721:mac.c         ****                                       case MAC_CMD_ASSOCIATE_REQ:
1722:mac.c         **** 						     if(mac_current_state==MAC_STATE_ASSOC_WAIT_FOR_RESPONSE) 
1723:mac.c         **** 							 mlmeAssociateConfirm(default_short_addr, NO_ACK);
1724:mac.c         **** 	        //ÈôÎªassociation requestÖ¡,²ÉÓÃmlme-association.confirm£¬×´Ì¬ÎªNO_ack
1725:mac.c         **** 	                                        break;
1726:mac.c         **** 	                               case 0x00:
1727:mac.c         **** 						     mcpsDataConfirm(NO_ACK, p_temp->FrameHandle);
1728:mac.c         **** 						     break;
1729:mac.c         **** 	        //ÈôÎªdataÖ¡,²ÉÓÃmlme-data.confirm,×´Ì¬ÎªNO_ack
1730:mac.c         **** 	                               case MAC_CMD_DISASSOCIATE_NOTICE:
1731:mac.c         **** 						     mlmeDisassociateConfirm(NO_ACK);
1732:mac.c         **** 						     break;
1733:mac.c         **** 	        //ÈôÎªdisassociation notificationÖ¡,ÔòÍ¨¹ýmlme-disassociate.confirm£¬×´Ì¬ÎªNO_ack
1734:mac.c         **** 	                               case MAC_CMD_PAN_ID_CONFLICT:
1735:mac.c         **** 						     break;
1736:mac.c         **** 	        //ÈôÎªPANID confilict notificationÖ¡,  *************Ð­ÒéÖÐÃ»ÓÐ¿É¿¿ÐÔ±£Ö¤****************
1737:mac.c         **** 	                               case MAC_CMD_ASSOCIATE_RPLY:
1738:mac.c         **** 						     break;
1739:mac.c         **** 	        //ÈôÎªassociate responseÖ¡,²ÉÓÃmlme-comm-statusÔ­Óï£¬×´Ì¬Îªno_ack.
1740:mac.c         **** 	                               case MAC_CMD_COORD_REALIGNMENT:
1741:mac.c         **** 						     break;
1742:mac.c         **** 	        //ÈôÎªcoordinator realignmentÖ¡,²ÉÓÃmlme-comm-statusÔ­Óï£¬×´Ì¬Îªno_ack.
1743:mac.c         **** 
1744:mac.c         **** 	                     	}
1745:mac.c         **** 				 remove_tx_queue(p_temp->FrameSeq);
1746:mac.c         **** 				}
1747:mac.c         **** 				 break;		 
1748:mac.c         **** 	           case  WAIT_FOR_RESPONSE:
1749:mac.c         **** 	 //Èç¹û¶ÔÓ¦µÄ¶¨Ê±ÈÎÎñÔ­ÒòÎªresponse³¬Ê±µÄÇéÐÎ
1750:mac.c         **** 	                     if((mac_current_state==MAC_STATE_ASSOC_WAIT_FOR_RESPONSE)||(mac_current_state
1751:mac.c         **** 						 	mlmeAssociateConfirm(default_short_addr, NO_DATA);
1752:mac.c         **** 	    //Èç¹ûÊÇµÈ´ýassociation responseÖ¡£¬²¢ÇÒtrackbeaconÎªÕæ£¬Ôòµ÷ÓÃMLME-ASSOCIATE.confirmÔ­ÓïÍ¨Öª¸
1753:mac.c         **** 	        //Èç¹ûtrackbeaconÎª¼Ù£¬ÔòÖ±½Óµ÷ÓÃ·¢ËÍÈÎÎñ·¢ËÍdata requestÖ¡¡£
1754:mac.c         **** 	    //Èç¹ûÊÇÔÚ×öorphanscan£¬µÈ´ýcoordinator realignmentÃüÁîÖ¡£¬ÔòÈÏÎª¸ÃÐÅµÀÉÏÃ»ÓÐPAN,¹ØµôÉäÆµ½ÓÊÕ£
1755:mac.c         **** 	                     else if(mac_current_state==MAC_STATE_ORPHAN_SCAN)
1756:mac.c         **** 	                     	{
1757:mac.c         **** 	                     	    //ÇÐ»»µ½ÏÂÒ»¸öÐÅµÀÉÏ½øÐÐscan
1758:mac.c         **** 	                     	    //-------------------------------------------------------
1759:mac.c         **** 	                     	    //---------------´ýÌí¼Ó-------------------------------
1760:mac.c         **** 	                     	    //----------ÉèÖÃÎïÀíÐÅµÀÎªÏÂÒ»¸öÐÅµÀ-------
1761:mac.c         ****                                        //Èç¹ûËùÓÐµÄÐÅµÀ¶¼ÒÑ¾­scan¹ý£¬ÔòÉÏ±¨´íÎóÐÅÏ¢.
1762:mac.c         **** 					    //·¢ËÍorphan_notificationÖ¡
1763:mac.c         **** 	                     	    orphan_notification_frame_send();
1764:mac.c         **** 					    			
1765:mac.c         **** 	                     	}
1766:mac.c         **** 				break;
1767:mac.c         **** 	    //Ä¿Ç°¾ÍÏëµ½ÕâÁ½ÖÖ???????????????
1768:mac.c         **** 	           case WAIT_SCAN:
1769:mac.c         **** 	                    if(mac_current_state==MAC_STATE_ACTIVE_PASSIVE_SCAN)
1770:mac.c         **** 	                    	{
1771:mac.c         **** 			               while((scan_channel&((uint32_t)1<<scan_channel_index))==0)
1772:mac.c         **** 			               	{
1773:mac.c         **** 					              scan_channel_index++;
1774:mac.c         **** 						       if(scan_channel_index>=16)
1775:mac.c         **** 						       	{
1776:mac.c         **** 						       	   //mac_current_state=MAC_STATE_ACTIVE_PASSIVE_SCAN_FINISHED;
1777:mac.c         **** 								   phy_channel_state=INACTIVE_PERIOD;
1778:mac.c         **** 								   PLME_SET_TRX_STATE_request(TRX_OFF);
1779:mac.c         **** 								   mlmeScanConfirm(scan_result_info);
1780:mac.c         **** 							   	   return;
1781:mac.c         **** 						       	}
1782:mac.c         **** 			               	}
1783:mac.c         **** 			               PLME_SET_request(phyCurrentChanel_id, scan_channel_index++);  			  
1784:mac.c         **** 			               PLME_SET_TRX_STATE_request(RX_ON);			  
1785:mac.c         **** 			               phy_channel_state=WAITING_FOR_BEACON;	
1786:mac.c         **** 				        head_of_timer_queue=timer3queue_start(head_of_timer_queue, TIMER_ONE_SHOT, 0, WAIT_SCAN
1787:mac.c         **** 	                     	 printf("\nset the %d channel & waitting for beacon\n",scan_channel_index-1)
1788:mac.c         **** 	                    	}
1789:mac.c         **** 	                    break;
1790:mac.c         **** 	           case WAIT_FOR_DATA:
1791:mac.c         **** 	 //Èç¹û¶ÔÓ¦µÄ¶¨Ê±ÈÎÎñÔ­ÒòÎªÊý¾Ýdata request³¬Ê±µÄÇéÐÎ(¼´·¢ËÍÁËdata request²¢ÊÕµ½ackºóµÈ´ý¶Ô·½Êý¾Ý)
1792:mac.c         **** 	    //Èç¹ûÊÇÊý¾ÝÖ¡µÄdata request,******************Ã»ÓÐ¶ÔÓ¦µÄ´ëÊ©À´±£Ö¤************************Ö±½
1793:mac.c         **** 	    //Èç¹ûÊÇassociate responseÖ¡µÄdata request,Ôò ·¢ËÍmlme-associate-confirm,ÖÃ×´Ì¬ÎªNO-DATA
1794:mac.c         ****                            mlmeAssociateConfirm(default_short_addr, NO_DATA);
1795:mac.c         **** 	                    break;
1796:mac.c         **** 	    //Èç¹ûÊÇdisassociation notification£¬*********************Ã»ÓÐ¶ÔÓ¦µÄ´ëÊ©À´±£Ö¤*************Ö±½
1797:mac.c         **** 	           case WAIT_FOR_BEACON:
1798:mac.c         **** 	 //Èç¹û¶ÔÓ¦µÄ¶¨Ê±ÈÎÎñÔ­ÒòÎªµÈ´ýÐÅ±êÖ¡³¬Ê±µÄÇéÐÎ
1799:mac.c         **** 	    //È·¶¨ÏµÍ³µÄMAC¹¤×÷×´Ì¬ÎªÍ¬²½ing×´Ì¬
1800:mac.c         **** 	                   //NOTE:¼òµ¥Æð¼û£¬Ö»µÈ´ýÒ»´Î.
1801:mac.c         **** 	                   if(IS_MAC_SYNING)
1802:mac.c         **** 				mlmeSyncLossIndication(BEACON_LOSS);
1803:mac.c         **** 			     break;
1804:mac.c         **** 	        //Èç¹ûÎª¼Ù£¬Ôòµ÷ÓÃmlmeSyncLossIndicationÍ¨Öª¸ß²ã£¬ÒÑÊ§È¥Í¬²½
1805:mac.c         **** 	        //Èç¹ûÎªÕæ£¬Ôò°ÑaMaxLostBeaconsµÝ¼õ1,Èç¹ûÒÑ¾­¼õµ½0£¬Ôòµ÷ÓÃmlmeSyncLossIndicationÍ¨Öª¸ß²ã£¬
1806:mac.c         **** 	        //Èç¹ûÃ»ÓÐ¼õµ½Áã£¬ÐèÒªÖØÐÂÆô¶¯¶¨Ê±¶ÓÁÐÈÎÎñ¡£
1807:mac.c         **** 		}
1808:mac.c         ****        //É¾³ý¶¨Ê±ÈÎÎñ
1809:mac.c         **** 	free(current_timer_elem); 
1810:mac.c         ****  
1811:mac.c         **** }
1812:mac.c         **** 
1813:mac.c         **** 
1814:mac.c         **** uint16_t mac_timer3queue_getnextinterval(void)
1815:mac.c         **** {
1816:mac.c         ****      //·µ»Ø¶¨Ê±Æ÷ÏÂÒ»¸ö¶¨Ê±Öµ
1817:mac.c         ****      //Èç¹ûÃ»ÓÐ£¬Ôò·µ»ØÁã
1818:mac.c         ****      Timer_Queue_pointer  temp;
1819:mac.c         ****      temp=head_of_timer_queue->next;
1820:mac.c         ****      if(temp!=NULL) 
1821:mac.c         **** 	 return (temp->ticks);
1822:mac.c         ****      else
1823:mac.c         **** 	 return 0;
1824:mac.c         **** }
1825:mac.c         **** 
1826:mac.c         **** void initial_tx_queue(void)
1827:mac.c         **** {
1828:mac.c         **** 
1829:mac.c         **** }
1830:mac.c         **** 
1831:mac.c         **** TX_BUFFER * add_tx_queue(BYTE framelength, BYTE * payload, BYTE framehandle, bool is_need_ack, BYTE
1832:mac.c         **** {
1833:mac.c         ****        TX_BUFFER  * current;
1834:mac.c         **** 	current=(TX_BUFFER *)malloc(sizeof(TX_BUFFER));
1835:mac.c         **** 	if(current==NULL)
1836:mac.c         **** 	{
1837:mac.c         **** 		error("\nmemory allocated failure\n");
1838:mac.c         **** 		return NULL;
1839:mac.c         **** 	}	
1840:mac.c         **** 	current->payload=payload;
1841:mac.c         **** 	current->FrameHandle=framehandle;
1842:mac.c         **** 	current->FrameRetriesCounter=aMaxFrameRetries;
1843:mac.c         **** 	current->frameLength=framelength;
1844:mac.c         **** 	current->FrameSeq=frameseq;
1845:mac.c         **** 	current->next=NULL;
1846:mac.c         **** 	current->IsNeedAcked=is_need_ack;
1847:mac.c         **** 	current->IsTxed=0;
1848:mac.c         **** 	current->cmd_type=cmd_type;
1849:mac.c         ****        if(tail_of_tx_buffer==NULL)
1850:mac.c         ****         {
1851:mac.c         ****               //printf("\nadd to the head\n");
1852:mac.c         **** 	   	head_of_tx_buffer=current;
1853:mac.c         **** 		tail_of_tx_buffer=current;
1854:mac.c         ****         }
1855:mac.c         **** 	 else
1856:mac.c         **** 	 {
1857:mac.c         **** 	 	tail_of_tx_buffer->next=current;
1858:mac.c         **** 	       tail_of_tx_buffer=current;
1859:mac.c         **** 	 }	   
1860:mac.c         **** 	 return  current;
1861:mac.c         **** }
1862:mac.c         **** void remove_tx_queue(BYTE frameseq)
1863:mac.c         **** {
1864:mac.c         ****        TX_BUFFER  * p_temp1;
1865:mac.c         **** 	TX_BUFFER  * p_temp2;
1866:mac.c         **** 	p_temp1=head_of_tx_buffer;
1867:mac.c         **** 	p_temp2=head_of_tx_buffer;
1868:mac.c         **** 	while((p_temp2->FrameSeq!=frameseq)&&(p_temp2!=NULL))
1869:mac.c         **** 	{
1870:mac.c         **** 		      p_temp1=p_temp2;
1871:mac.c         **** 		      p_temp2=p_temp2->next;
1872:mac.c         **** 	}
1873:mac.c         **** 	if(p_temp2==NULL)
1874:mac.c         **** 		error("\n cannot find the corresponding frame in the tx buffer\n");
1875:mac.c         **** 	else
1876:mac.c         **** 	{
1877:mac.c         **** 	       if(p_temp1==p_temp2)
1878:mac.c         **** 	       	{
1879:mac.c         **** 		   	  head_of_tx_buffer=p_temp1->next;
1880:mac.c         **** 			  tail_of_tx_buffer=p_temp1->next;
1881:mac.c         **** 	       	}
1882:mac.c         **** 		else
1883:mac.c         **** 		{
1884:mac.c         **** 		       p_temp1->next=p_temp2->next;
1885:mac.c         **** 		       p_temp2->next=NULL;
1886:mac.c         **** 		}
1887:mac.c         **** 		//printf("\nsuccess free the tx ram,the frameseq is %d\n",p_temp2->FrameSeq);
1888:mac.c         **** 		free(p_temp2->payload);
1889:mac.c         **** 		free(p_temp2);
1890:mac.c         **** 		
1891:mac.c         **** 	}
1892:mac.c         **** 	 
1893:mac.c         **** }
1894:mac.c         **** TX_BUFFER * get_frame_pointer(BYTE frameseq)
1895:mac.c         **** {
 1307               	.LM128:
 1308               	/* prologue: frame size=0 */
 1309               	/* prologue end (size=0) */
 1310 05f8 982F      		mov r25,r24
1896:mac.c         ****        TX_BUFFER  * temp;
1897:mac.c         **** 	   temp=head_of_tx_buffer;
 1312               	.LM129:
 1313 05fa E091 0000 		lds r30,head_of_tx_buffer
 1314 05fe F091 0000 		lds r31,(head_of_tx_buffer)+1
 1315               	.L64:
1898:mac.c         **** 	while(temp->FrameSeq!=frameseq)
1899:mac.c         **** 		temp=temp->next;
 1317               	.LM130:
 1318 0602 8381      		ldd r24,Z+3
 1319 0604 8917      		cp r24,r25
 1320 0606 21F0      		breq .L63
 1321 0608 0184      		ldd __tmp_reg__,Z+9
 1322 060a F285      		ldd r31,Z+10
 1323 060c E02D      		mov r30,__tmp_reg__
 1324 060e F9CF      		rjmp .L64
 1325               	.L63:
1900:mac.c         **** 	return temp;
1901:mac.c         **** }
 1327               	.LM131:
 1328 0610 CF01      		movw r24,r30
 1329               	/* epilogue: frame size=0 */
 1330 0612 0895      		ret
 1331               	/* epilogue end (size=1) */
 1332               	/* function get_frame_pointer size 14 (13) */
 1337               	.Lscope16:
 1338               		.data
 1339               	.LC6:
 1340 0142 0A63 616E 		.string	"\ncannot find a pending frame in the queue\n"
 1340      6E6F 7420 
 1340      6669 6E64 
 1340      2061 2070 
 1340      656E 6469 
 1341               		.text
 1344               	.global	get_pending_frame
 1346               	get_pending_frame:
1902:mac.c         **** 
1903:mac.c         **** RX_BUFFER * add_to_rx_buffer(BYTE framelength, BYTE *payload,BYTE lqi,uint32_t timestamp)
1904:mac.c         **** {
1905:mac.c         ****        RX_BUFFER  * temp;
1906:mac.c         **** 	temp=(RX_BUFFER *)malloc(sizeof(RX_BUFFER));
1907:mac.c         **** 	if(temp==NULL)
1908:mac.c         **** 	{
1909:mac.c         **** 		error("\nmemory allocated failure\n");
1910:mac.c         **** 		return NULL;
1911:mac.c         **** 	}
1912:mac.c         **** 	temp->framelength=framelength;
1913:mac.c         **** 	temp->payload=payload;
1914:mac.c         **** 	temp->lqi=lqi;   
1915:mac.c         **** 	temp->timestamp=timestamp;
1916:mac.c         **** 	temp->next=NULL;
1917:mac.c         **** 	if(tail_of_rx_buffer==NULL)
1918:mac.c         **** 	{
1919:mac.c         **** 	     head_of_rx_buffer=temp;
1920:mac.c         **** 	     tail_of_rx_buffer=temp;
1921:mac.c         **** 	}
1922:mac.c         **** 	else
1923:mac.c         **** 	{
1924:mac.c         **** 	    tail_of_rx_buffer->next=temp;
1925:mac.c         **** 	    tail_of_rx_buffer=temp;
1926:mac.c         **** 	}
1927:mac.c         **** 	return   temp;
1928:mac.c         **** }
1929:mac.c         **** void  remove_from_rx_buffer(RX_BUFFER  * framepointer)
1930:mac.c         **** {
1931:mac.c         ****        /*
1932:mac.c         ****         RX_BUFFER * p_temp1;
1933:mac.c         **** 	RX_BUFFER * p_temp2;
1934:mac.c         **** 	p_temp1=head_of_rx_buffer;
1935:mac.c         **** 	p_temp2=tail_of_rx_buffer;
1936:mac.c         **** 	while((p_temp2!=framepointer)&&(p_temp2!=NULL))
1937:mac.c         **** 	{
1938:mac.c         **** 		    p_temp1=p_temp2;
1939:mac.c         **** 		    p_temp2=p_temp2->next;
1940:mac.c         **** 	}
1941:mac.c         **** 	if(p_temp2==NULL)
1942:mac.c         **** 	{
1943:mac.c         **** 	        error("\nthe frame is not in the rx buffer\n");
1944:mac.c         **** 		 return;
1945:mac.c         **** 	}
1946:mac.c         **** 	else
1947:mac.c         **** 	{
1948:mac.c         **** 	       if(p_temp1==p_temp2)
1949:mac.c         **** 		   	head_of_rx_buffer=p_temp2->next;
1950:mac.c         **** 		else 
1951:mac.c         **** 		{
1952:mac.c         **** 		       p_temp1->next=p_temp2->next;
1953:mac.c         **** 		       p_temp2->next=NULL;
1954:mac.c         **** 		}
1955:mac.c         **** 	}
1956:mac.c         **** 	*/
1957:mac.c         **** 	free(framepointer->payload);
1958:mac.c         ****        free(framepointer);   
1959:mac.c         ****        //printf("\n***************succeed free a physical packet*********************\n");  
1960:mac.c         **** }
1961:mac.c         **** 
1962:mac.c         **** //×é°üº¯Êý£¬¸ù¾Ýµ÷ÓÃÕßÌá¹©µÄ²ÎÊýÐÅÏ¢£¬×é³ÉºÏ·¨µÄMACÖ¡½øÐÐ·¢ËÍ¡£
1963:mac.c         **** //¶ÔÓÚÐÅ±êÖ¡ºÍackÖ¡£¬²»Ðèµ÷ÓÃ¸Ãº¯Êý¡£
1964:mac.c         **** //
1965:mac.c         ****  //¸ù¾ÝÖ¡ÀàÐÍµÈ²ÎÊýÐÅÏ¢×éÖ¯³ÉºÏ·¨µÄMACÖ¡
1966:mac.c         ****    //¼ì²âÎïÀíÐÅµÀÊÇ·ñºÏ·¨
1967:mac.c         ****    //Èç¹ûÐèÒª²ÉÓÃÁ¢¼´·¢ËÍµÄ£¬¼´²ÉÓÃµ÷ÓÃº¯Êýdirect_transmitµÄÐÎÊ½(ÊµÊ±ÐÔ¸ß)
1968:mac.c         ****    //Èç¹ûÐèÒª²ÉÓÃcsma_caËã·¨·¢ËÍµÄ£¬¼´²ÉÓÃpostÒ»¸öÐÂÈÎÎñtransmit_with_csmaca(ÊµÊ±ÐÔµÍ)
1969:mac.c         **** void mac_frame_send(void)
1970:mac.c         **** {
1971:mac.c         ****    TX_BUFFER  * temp;
1972:mac.c         ****    //MAC²ãËùÓÐÓò³¤¶ÈÖ®ºÍ£¬µ«²»°üÀ¨FCSÓò
1973:mac.c         ****    BYTE framelength;
1974:mac.c         ****    BYTE * payload;
1975:mac.c         ****    BYTE framehandle;
1976:mac.c         ****    bool is_need_ack;
1977:mac.c         ****    BYTE frameseq;
1978:mac.c         ****    uint8_t  index;
1979:mac.c         ****    BYTE  cmd_type;
1980:mac.c         ****    uint8_t  i;
1981:mac.c         ****    index=0;
1982:mac.c         ****    uint32_t  return_send_timestamp;
1983:mac.c         ****    //framelength=mac_tx_current_frame.frameLength;
1984:mac.c         ****    payload=(BYTE *)malloc(aMaxMACFrameSize*sizeof(BYTE));
1985:mac.c         ****    payload[index++]=mac_tx_current_frame.frame_control_field.v[0];
1986:mac.c         ****    payload[index++]=mac_tx_current_frame.frame_control_field.v[1];
1987:mac.c         ****    //printf("\nframe_ctl field is %02x--\n",payload[1]);
1988:mac.c         ****    payload[index++]=mac_tx_current_frame.macDSN;
1989:mac.c         ****    frameseq=mac_tx_current_frame.macDSN;
1990:mac.c         ****    is_need_ack=mac_tx_current_frame.frame_control_field.bits.AckReq;
1991:mac.c         ****    cmd_type=0x00;//²»ÊÇÃüÁîÖ¡
1992:mac.c         ****    framehandle=mac_rx_current_frame.framehandle;//¶ÔÊý¾ÝÖ¡ÓÐÓÃµÄÓò
1993:mac.c         ****    //printf("the transmitted beacon frame length is %d", index);
1994:mac.c         ****    
1995:mac.c         ****    switch(mac_tx_current_frame.frame_control_field.v[1]&0x0c)
1996:mac.c         ****    	{
1997:mac.c         ****    	     case  MAC_DST_LONG_ADDR:
1998:mac.c         **** 		 	//Ç°Á½¸ö×Ö½Ú·ÅÄ¿µÄPANID
1999:mac.c         **** 		 	payload[index++]=mac_tx_current_frame.dst.panID.v[0];
2000:mac.c         **** 			payload[index++]=mac_tx_current_frame.dst.panID.v[1];
2001:mac.c         **** 			//ºó°Ë¸ö×Ö½Ú·Å³¤Ä¿µÄµØÖ·		 	
2002:mac.c         **** 		 	payload[index++]=mac_tx_current_frame.dst.longAddr.v[0];
2003:mac.c         **** 			payload[index++]=mac_tx_current_frame.dst.longAddr.v[1];
2004:mac.c         **** 			payload[index++]=mac_tx_current_frame.dst.longAddr.v[2];
2005:mac.c         **** 			payload[index++]=mac_tx_current_frame.dst.longAddr.v[3];
2006:mac.c         **** 			payload[index++]=mac_tx_current_frame.dst.longAddr.v[4];
2007:mac.c         **** 			payload[index++]=mac_tx_current_frame.dst.longAddr.v[5];
2008:mac.c         **** 			payload[index++]=mac_tx_current_frame.dst.longAddr.v[6];
2009:mac.c         **** 			payload[index++]=mac_tx_current_frame.dst.longAddr.v[7];
2010:mac.c         **** 		 	break;
2011:mac.c         **** 	     case  MAC_DST_SHORT_ADDR:
2012:mac.c         **** 		 	//Ç°Á½¸ö×Ö½Ú·ÅÄ¿µÄPANID
2013:mac.c         **** 		 	payload[index++]=mac_tx_current_frame.dst.panID.v[0];
2014:mac.c         **** 			payload[index++]=mac_tx_current_frame.dst.panID.v[1];
2015:mac.c         **** 			//ºóÁ½¸ö×Ö½Ú·Å¶ÌÄ¿µÄµØÖ·
2016:mac.c         **** 		 	payload[index++]=mac_tx_current_frame.dst.shortAddr.v[0];
2017:mac.c         **** 			payload[index++]=mac_tx_current_frame.dst.shortAddr.v[1];
2018:mac.c         **** 		 	break;
2019:mac.c         **** 	     case  MAC_DST_NO_ADDR:
2020:mac.c         **** 		 	break;
2021:mac.c         **** 	     case  MAC_DST_ADDR_RESERVED:
2022:mac.c         **** 		 	error("\nreserved dst address mode is used!\n");
2023:mac.c         **** 		 	break;
2024:mac.c         ****    	}
2025:mac.c         ****    switch(mac_tx_current_frame.frame_control_field.v[1]&0xc0)
2026:mac.c         ****    	{
2027:mac.c         ****    	     case  MAC_SRC_LONG_ADDR:
2028:mac.c         **** 		 	//Ç°Á½¸ö×Ö½Ú·ÅÔ´PANID
2029:mac.c         **** 		 	payload[index++]=mac_tx_current_frame.src.panID.v[0];
2030:mac.c         **** 			payload[index++]=mac_tx_current_frame.src.panID.v[1];
2031:mac.c         **** 			//ºó°Ë¸ö×Ö½Ú·Å³¤Ô´µØÖ·		 	
2032:mac.c         **** 		 	payload[index++]=mac_tx_current_frame.src.longAddr.v[0];
2033:mac.c         **** 			payload[index++]=mac_tx_current_frame.src.longAddr.v[1];
2034:mac.c         **** 			payload[index++]=mac_tx_current_frame.src.longAddr.v[2];
2035:mac.c         **** 			payload[index++]=mac_tx_current_frame.src.longAddr.v[3];
2036:mac.c         **** 			payload[index++]=mac_tx_current_frame.src.longAddr.v[4];
2037:mac.c         **** 			payload[index++]=mac_tx_current_frame.src.longAddr.v[5];
2038:mac.c         **** 			payload[index++]=mac_tx_current_frame.src.longAddr.v[6];
2039:mac.c         **** 			payload[index++]=mac_tx_current_frame.src.longAddr.v[7];
2040:mac.c         **** 		 	break;
2041:mac.c         **** 	     case  MAC_SRC_SHORT_ADDR:
2042:mac.c         **** 		 	//Ç°Á½¸ö×Ö½Ú·ÅÔ´PANID
2043:mac.c         **** 		 	payload[index++]=mac_tx_current_frame.src.panID.v[0];
2044:mac.c         **** 			payload[index++]=mac_tx_current_frame.src.panID.v[1];
2045:mac.c         **** 			//ºóÁ½¸ö×Ö½Ú·Å¶ÌÔ´µØÖ·
2046:mac.c         **** 		 	payload[index++]=mac_tx_current_frame.src.shortAddr.v[0];
2047:mac.c         **** 			payload[index++]=mac_tx_current_frame.src.shortAddr.v[1];
2048:mac.c         **** 		 	break;
2049:mac.c         **** 	     case  MAC_SRC_NO_ADDR:
2050:mac.c         **** 		 	break;
2051:mac.c         **** 	     case  MAC_SRC_ADDR_RESERVED:
2052:mac.c         **** 		 	error("\nreserved src address mode is used!\n");
2053:mac.c         **** 		 	break;   	     
2054:mac.c         ****    	}
2055:mac.c         ****        
2056:mac.c         ****    switch(mac_tx_current_frame.type)
2057:mac.c         ****    	{
2058:mac.c         ****    	     case  MAC_FRAME_BEACON:
2059:mac.c         **** 		 	//³¬Ö¡½á¹¹
2060:mac.c         **** 		 	//printf("the transmitted beacon frame length is %d", index);
2061:mac.c         **** 		 	payload[index++]=mac_tx_current_frame.superframe_field.SF.bytes.LSB;
2062:mac.c         **** 			payload[index++]=mac_tx_current_frame.superframe_field.SF.bytes.MSB;
2063:mac.c         ****                      //GTSÐÅÏ¢±¾°æ±¾Ã»ÓÐÊµÏÖgtsµÄÏà¹ØÐ­Òé
2064:mac.c         **** 			payload[index++]=0x00;
2065:mac.c         **** 			//pendingÐÅÏ¢
2066:mac.c         **** 			payload[index++]=mac_tx_current_frame.pendaddress_field.bytes;
2067:mac.c         **** 			for(i=0;i<mac_tx_current_frame.shortpendingadd_length;i++)
2068:mac.c         **** 			{
2069:mac.c         **** 			     payload[index++]=mac_tx_current_frame.shortaddrpending_list[i].v[0];
2070:mac.c         **** 			     payload[index++]=mac_tx_current_frame.shortaddrpending_list[i].v[1];
2071:mac.c         **** 			}
2072:mac.c         **** 			for(i=0;i<mac_tx_current_frame.longpendingadd_length;i++)
2073:mac.c         **** 			{
2074:mac.c         **** 			     payload[index++]=mac_tx_current_frame.longaddrpending_list[i].v[0];
2075:mac.c         **** 			     payload[index++]=mac_tx_current_frame.longaddrpending_list[i].v[1];
2076:mac.c         **** 			     payload[index++]=mac_tx_current_frame.longaddrpending_list[i].v[2];
2077:mac.c         **** 			     payload[index++]=mac_tx_current_frame.longaddrpending_list[i].v[3];
2078:mac.c         **** 			     payload[index++]=mac_tx_current_frame.longaddrpending_list[i].v[4];
2079:mac.c         **** 			     payload[index++]=mac_tx_current_frame.longaddrpending_list[i].v[5];
2080:mac.c         **** 			     payload[index++]=mac_tx_current_frame.longaddrpending_list[i].v[6];
2081:mac.c         **** 			     payload[index++]=mac_tx_current_frame.longaddrpending_list[i].v[7];
2082:mac.c         **** 			}
2083:mac.c         **** 			//ÐÅ±êÖ¡¸ºÔØ
2084:mac.c         **** 			payload[index++]=mac_tx_current_frame.beacon_payload_length;
2085:mac.c         **** 			for(i=0;i<mac_tx_current_frame.beacon_payload_length;i++)
2086:mac.c         **** 				payload[index++]=mac_tx_current_frame.beacon_payload[i];
2087:mac.c         **** 			//printf("\nthe transmitted beacon frame length is %d", index);
2088:mac.c         **** 			//for(uint8_t i=0;i<index;i++)
2089:mac.c         **** 			//	printf("\nthe beacon frame payload[%d] is %02x\n",i,payload[i]);
2090:mac.c         **** 			last_beacon_tx_timestamp=direct_transmit(index, payload);
2091:mac.c         **** 			//printf("\nthe transmitted beacon frame time is %08lx", last_beacon_tx_timestamp);
2092:mac.c         **** 			//Leds_yellowToggle();
2093:mac.c         **** 			phy_channel_state=PHY_IDLE;
2094:mac.c         **** 			mac_current_state=MAC_STATE_IDLE;
2095:mac.c         **** 			PLME_SET_TRX_STATE_request(RX_ON);
2096:mac.c         **** 			OS_post(beacon_frame_tx_timing);
2097:mac.c         **** 			//for(uint8_t i=0;i<index;i++)
2098:mac.c         **** 			//	printf("\nthe beacon frame payload[%d] is %02x\n",i,payload[i]);
2099:mac.c         **** 			return;
2100:mac.c         **** 		 	break;
2101:mac.c         **** 	     case  MAC_FRAME_DATA:
2102:mac.c         **** 		 	//¿½±´ÍøÂ·²ãÊý¾Ý
2103:mac.c         **** 		 	payload[index++]=mac_tx_current_frame.nwk_data_length;
2104:mac.c         **** 		 	for( i=0;i<mac_tx_current_frame.nwk_data_length;i++)
2105:mac.c         **** 				payload[index++]=mac_tx_current_frame.nwk_data_payload[i];
2106:mac.c         **** 			break;
2107:mac.c         **** 	     case  MAC_FRAME_ACK:
2108:mac.c         **** 		 	//ÒÑ¾­ÓÉµ×²ã·¢ËÍ,ÕâÀï²»½øÐÐ×éÖ¡
2109:mac.c         **** 		 	break;
2110:mac.c         **** 	     case  MAC_FRAME_CMD:
2111:mac.c         **** 		 	{
2112:mac.c         **** 				payload[index++]=mac_tx_current_frame.cmd;
2113:mac.c         **** 				cmd_type=mac_tx_current_frame.cmd;
2114:mac.c         **** 				switch(mac_tx_current_frame.cmd)
2115:mac.c         **** 					{
2116:mac.c         **** 					    case MAC_CMD_ASSOCIATE_REQ:
2117:mac.c         **** 							payload[index++]=mac_tx_current_frame.node_capinfo_field.bytes;
2118:mac.c         **** 							break;
2119:mac.c         **** 					    case MAC_CMD_ASSOCIATE_RPLY:
2120:mac.c         **** 							payload[index++]=mac_tx_current_frame.shortaddralloc.v[0];
2121:mac.c         **** 							payload[index++]=mac_tx_current_frame.shortaddralloc.v[1];
2122:mac.c         **** 							payload[index++]=mac_tx_current_frame.association_status;
2123:mac.c         **** 							//printf("---****index is %d***---\n",index);
2124:mac.c         **** 							//return;
2125:mac.c         **** 							break;
2126:mac.c         **** 				           case MAC_CMD_DISASSOCIATE_NOTICE:
2127:mac.c         **** 						   	payload[index++]=mac_tx_current_frame.disassociation_reason;
2128:mac.c         **** 						   	break;
2129:mac.c         **** 					    case MAC_CMD_DATA_REQ:
2130:mac.c         **** 							break;
2131:mac.c         **** 					    case MAC_CMD_PAN_ID_CONFLICT:
2132:mac.c         **** 							//printf("\n---the panID conflict frame length is %d---\n",index);
2133:mac.c         **** 							break;
2134:mac.c         **** 					    case MAC_CMD_ORPHAN_NOTICE:
2135:mac.c         **** 							break;
2136:mac.c         **** 					    case MAC_CMD_BEACON_REQ:
2137:mac.c         **** 							break;
2138:mac.c         **** 					    case MAC_CMD_COORD_REALIGNMENT:
2139:mac.c         **** 							payload[index++]=mac_tx_current_frame.PAN_ID_field.v[0];
2140:mac.c         **** 							payload[index++]=mac_tx_current_frame.PAN_ID_field.v[1];
2141:mac.c         **** 							payload[index++]=mac_tx_current_frame.coordshortaddr_field.v[0];
2142:mac.c         **** 							payload[index++]=mac_tx_current_frame.coordshortaddr_field.v[1];
2143:mac.c         **** 							payload[index++]=mac_tx_current_frame.logicalchannel_field;
2144:mac.c         **** 							payload[index++]=mac_tx_current_frame.shortaddrallocted.v[0];
2145:mac.c         **** 							payload[index++]=mac_tx_current_frame.shortaddrallocted.v[1];
2146:mac.c         **** 							//printf("--the realignment frame length is %d--",index);
2147:mac.c         **** 							
2148:mac.c         **** 							break;
2149:mac.c         **** 					    case MAC_CMD_GTS_REQ:
2150:mac.c         **** 							//±¾°æ±¾Ã»ÓÐÊµÏÖGTSÏà¹ØÐ­Òé
2151:mac.c         **** 							break;				
2152:mac.c         **** 					}
2153:mac.c         **** 	     	       }
2154:mac.c         **** 		 	break;
2155:mac.c         ****    	}
2156:mac.c         ****    //if(index!=framelength)
2157:mac.c         ****    //	error("\nthe frame length's computing error\n");
2158:mac.c         ****    framelength=index;
2159:mac.c         ****    //printf("the transmitted  frame length is %d", framelength);
2160:mac.c         ****    temp=add_tx_queue(framelength,payload,framehandle,is_need_ack,frameseq,cmd_type);
2161:mac.c         ****    head_of_tx_buffer=temp;
2162:mac.c         ****    //ÖÐ¼ä¿ÕÒ»¸öÔªËØ
2163:mac.c         ****    if(Parameter_list.top==((Parameter_list.tail+1)%MAX_TX_BUFFER_SIZE))
2164:mac.c         ****    	error("\ntx buffer is full\n");
2165:mac.c         ****    else
2166:mac.c         ****    {
2167:mac.c         ****       Parameter_list.parameter_tx_task[Parameter_list.tail]=temp;
2168:mac.c         ****       Parameter_list.tail=((Parameter_list.tail+1)%MAX_TX_BUFFER_SIZE);
2169:mac.c         ****       //printf("the transmitted  frame length is %d", framelength);	  
2170:mac.c         ****       OS_post(transmit_with_csmaca); 
2171:mac.c         ****    }
2172:mac.c         **** }
2173:mac.c         **** 
2174:mac.c         **** 
2175:mac.c         **** uint32_t direct_transmit(uint8_t psdulength,uint8_t * psdu)
2176:mac.c         **** {
2177:mac.c         **** 	//Ö±½Ó·¢ËÍÖ¡£¬²»²ÉÓÃcsma_ca
2178:mac.c         ****   //µ÷ÓÃÎïÀí²ãPD_data_request·¢ËÍ
2179:mac.c         ****   uint32_t  send_timestamp;
2180:mac.c         ****   send_timestamp=PD_DATA_request(psdulength,psdu);
2181:mac.c         ****   free(psdu);
2182:mac.c         ****   //printf("\ntransmit beacon finished");
2183:mac.c         ****   return send_timestamp;
2184:mac.c         **** }
2185:mac.c         **** 
2186:mac.c         **** 
2187:mac.c         **** void initial_pending_queue(void)
2188:mac.c         **** {
2189:mac.c         ****     
2190:mac.c         **** }
2191:mac.c         **** 
2192:mac.c         **** //Ìí¼ÓÒ»¸öÊý¾Ý°üµ½pending¶ÓÁÐÖÐ
2193:mac.c         **** void add_pending_queue(BYTE framehandle, FRAME_CONTROL framectl, NODE_INFO dst, NODE_INFO src, BYTE
2194:mac.c         **** {
2195:mac.c         ****       INDIRECT_TX_PENDING_QUEUE * temp;
2196:mac.c         ****       //bool   is_added_before;	  
2197:mac.c         ****       temp=(INDIRECT_TX_PENDING_QUEUE *)malloc(sizeof(INDIRECT_TX_PENDING_QUEUE));
2198:mac.c         ****       temp->framectl_field=framectl;
2199:mac.c         ****       //¶ÔÓÚ·ÇÊý¾ÝÖ¡µÄÇéÐÎ£¬ÔòÖ±½ÓÖÃframehandleÎª0
2200:mac.c         ****       temp->FrameHandle=framehandle;
2201:mac.c         ****       temp->frameLength=framelength;
2202:mac.c         ****       temp->high_level_payload=payload;
2203:mac.c         ****       temp->MacTranPersistCounter=mac_pib_data.macTransactionPersistenceTime;
2204:mac.c         ****       temp->associate_or_disassociate=associate_or_disassociate;
2205:mac.c         ****       if((temp->framectl_field.v[0]&0x07)!=0x01)
2206:mac.c         ****       	{
2207:mac.c         ****       	     if(associate_or_disassociate)
2208:mac.c         ****       	     	{
2209:mac.c         ****       	     	  
2210:mac.c         **** 	         temp->associate_status=associate_status_or_disassociate_reason;
2211:mac.c         **** 	         temp->associate_device_addr=addr;
2212:mac.c         **** 	         temp->shortaddralloc=shortaddralloc;
2213:mac.c         ****       	     	}	 
2214:mac.c         **** 	      else
2215:mac.c         **** 	      	{
2216:mac.c         **** 		  temp->disassociation_reason=associate_status_or_disassociate_reason;
2217:mac.c         **** 		  temp->end_device_addr=addr;
2218:mac.c         **** 	      	}  
2219:mac.c         ****       	}
2220:mac.c         ****       temp->dst=dst;
2221:mac.c         ****       temp->src=src;
2222:mac.c         ****       temp->IsValid=1;
2223:mac.c         ****       temp->next=NULL;
2224:mac.c         **** 	if(tail_of_indirect_pending_buffer==NULL)
2225:mac.c         **** 	{
2226:mac.c         **** 	     head_of_indirect_pending_buffer=temp;
2227:mac.c         **** 	     tail_of_indirect_pending_buffer=temp;
2228:mac.c         **** 	}
2229:mac.c         **** 	else
2230:mac.c         **** 	{
2231:mac.c         **** 	    tail_of_indirect_pending_buffer->next=temp;
2232:mac.c         **** 	    tail_of_indirect_pending_buffer=temp;
2233:mac.c         **** 	}
2234:mac.c         **** 	if(dst.addrMode==0x02)
2235:mac.c         **** 		{
2236:mac.c         **** 	            /*for(uint8_t i=0;i<mac_tx_beacon.shortpendingadd_length;i++)	
2237:mac.c         **** 	            	{
2238:mac.c         **** 			  if(dst.shortAddr.Val==mac_tx_beacon.shortaddrpending_list[i].Val)
2239:mac.c         **** 			  	
2240:mac.c         **** 	            	}*/ 	
2241:mac.c         **** 	    mac_tx_beacon.shortaddrpending_list[mac_tx_beacon.shortpendingadd_length++]=dst.shortAddr;
2242:mac.c         ****            mac_tx_beacon.pendaddress_field.bytes=(mac_tx_beacon.pendaddress_field.bytes)+1;	
2243:mac.c         **** 		}
2244:mac.c         ****        else 
2245:mac.c         ****        	{
2246:mac.c         **** 	    mac_tx_beacon.longaddrpending_list[mac_tx_beacon.longpendingadd_length++]=dst.longAddr;
2247:mac.c         **** 	    mac_tx_beacon.pendaddress_field.bytes=(mac_tx_beacon.pendaddress_field.bytes)+16;	
2248:mac.c         **** 	    //printf("\nadd the long addr to the pending list\n");	
2249:mac.c         ****        	}
2250:mac.c         **** 	//printf("\nthe longpending addr length is %d\n",mac_tx_beacon.longpendingadd_length);
2251:mac.c         **** 	current_pending_num++;
2252:mac.c         **** }
2253:mac.c         **** 
2254:mac.c         **** //´Ópending¶ÓÁÐÖÐÉ¾³ýÒ»¸öÔªËØ
2255:mac.c         **** void remove_pending_queue(INDIRECT_TX_PENDING_QUEUE  * current)
2256:mac.c         **** {
2257:mac.c         ****        uint8_t  index;
2258:mac.c         ****        INDIRECT_TX_PENDING_QUEUE * p_temp1;
2259:mac.c         **** 	INDIRECT_TX_PENDING_QUEUE * p_temp2;
2260:mac.c         **** 	p_temp1=head_of_indirect_pending_buffer;
2261:mac.c         **** 	p_temp2=head_of_indirect_pending_buffer;
2262:mac.c         **** 	while((p_temp2!=current)&&(p_temp2!=NULL))
2263:mac.c         **** 	{
2264:mac.c         **** 		    p_temp1=p_temp2;
2265:mac.c         **** 		    p_temp2=p_temp2->next;
2266:mac.c         **** 	}
2267:mac.c         **** 	if(p_temp2==NULL)
2268:mac.c         **** 	{
2269:mac.c         **** 	        error("\nthe frame is not in the pending queue\n");
2270:mac.c         **** 		 return;
2271:mac.c         **** 	}
2272:mac.c         **** 	else
2273:mac.c         **** 	{
2274:mac.c         **** 	       if(head_of_indirect_pending_buffer==tail_of_indirect_pending_buffer)
2275:mac.c         **** 	       {
2276:mac.c         **** 		   	head_of_indirect_pending_buffer=NULL;
2277:mac.c         **** 			tail_of_indirect_pending_buffer=NULL;
2278:mac.c         **** 	       }	
2279:mac.c         **** 		else if(p_temp2==head_of_indirect_pending_buffer)
2280:mac.c         **** 			{
2281:mac.c         **** 			     head_of_indirect_pending_buffer=p_temp2->next;
2282:mac.c         **** 			     p_temp2->next==NULL;
2283:mac.c         **** 			}
2284:mac.c         **** 		else
2285:mac.c         **** 		{
2286:mac.c         **** 		       p_temp1->next=p_temp2->next;
2287:mac.c         **** 			if(p_temp2->next!=NULL)   
2288:mac.c         **** 			tail_of_indirect_pending_buffer=p_temp2->next;   
2289:mac.c         **** 			else
2290:mac.c         **** 			tail_of_indirect_pending_buffer=p_temp1;
2291:mac.c         **** 		       p_temp2->next=NULL;
2292:mac.c         **** 			
2293:mac.c         **** 		}
2294:mac.c         **** 	}
2295:mac.c         **** 	//É¾³ýÐÅ±êÖ¡ÖÐµÄ¶ÔÓ¦µØÖ·ÁÐ±í
2296:mac.c         **** 	if(current->dst.addrMode==0x02)
2297:mac.c         **** 	{    
2298:mac.c         **** 	     index=0;
2299:mac.c         **** 	     while((current->dst.shortAddr.Val!=mac_tx_beacon.shortaddrpending_list[index].Val)&&(index<=m
2300:mac.c         **** 	     	     index++;
2301:mac.c         **** 	     if(current->dst.shortAddr.Val==mac_tx_beacon.shortaddrpending_list[index].Val)	 
2302:mac.c         **** 	     	{
2303:mac.c         **** 	     	     //¿ªÊ¼É¾³ýÐÅ±êÖ¡ÖÐµÄpendingµØÖ·
2304:mac.c         **** 	     	     
2305:mac.c         **** 	     	     for(;index<=mac_tx_beacon.shortpendingadd_length-1;index++)
2306:mac.c         **** 			    mac_tx_beacon.shortaddrpending_list[index]=mac_tx_beacon.shortaddrpending_list[index+1];
2307:mac.c         **** 		     mac_tx_beacon.shortpendingadd_length--;
2308:mac.c         **** 		     mac_tx_beacon.pendaddress_field.bytes=mac_tx_beacon.pendaddress_field.bytes-1;
2309:mac.c         **** 	     	}
2310:mac.c         **** 	     else
2311:mac.c         **** 	       error("\nIt is not in the pending queue\n");	 	
2312:mac.c         **** 	}
2313:mac.c         **** 	else if(current->dst.addrMode==0x03)
2314:mac.c         **** 	{
2315:mac.c         **** 	     index=0;
2316:mac.c         **** 	     while((current->dst.longAddr.longaddr!=mac_tx_beacon.longaddrpending_list[index].longaddr)&&(
2317:mac.c         **** 	             index++;
2318:mac.c         **** 	     if(current->dst.longAddr.longaddr==mac_tx_beacon.longaddrpending_list[index].longaddr)
2319:mac.c         **** 	     	{
2320:mac.c         **** 	     	       for(;index<=mac_tx_beacon.longpendingadd_length-1;index++)
2321:mac.c         **** 			     mac_tx_beacon.longaddrpending_list[index]=mac_tx_beacon.longaddrpending_list[index+1];
2322:mac.c         **** 			mac_tx_beacon.longpendingadd_length--;
2323:mac.c         **** 			mac_tx_beacon.pendaddress_field.bytes=mac_tx_beacon.pendaddress_field.bytes-16;
2324:mac.c         **** 	     	}
2325:mac.c         **** 	}
2326:mac.c         **** 	
2327:mac.c         ****        free(current);      
2328:mac.c         **** 	current_pending_num--;
2329:mac.c         **** }
2330:mac.c         **** //¸ù¾ÝÄ¿µÄ½ÚµãµØÖ·ÐÅÏ¢»ñÈ¡pendingÖÐµÄÖ¸Õë
2331:mac.c         **** INDIRECT_TX_PENDING_QUEUE * get_pending_frame(NODE_INFO dst)
2332:mac.c         **** {
 1348               	.LM132:
 1349               	/* prologue: frame size=13 */
 1350 0614 CF92      		push r12
 1351 0616 DF92      		push r13
 1352 0618 EF92      		push r14
 1353 061a FF92      		push r15
 1354 061c 0F93      		push r16
 1355 061e 1F93      		push r17
 1356 0620 CF93      		push r28
 1357 0622 DF93      		push r29
 1358 0624 CDB7      		in r28,__SP_L__
 1359 0626 DEB7      		in r29,__SP_H__
 1360 0628 2D97      		sbiw r28,13
 1361 062a 0FB6      		in __tmp_reg__,__SREG__
 1362 062c F894      		cli
 1363 062e DEBF      		out __SP_H__,r29
 1364 0630 0FBE      		out __SREG__,__tmp_reg__
 1365 0632 CDBF      		out __SP_L__,r28
 1366               	/* prologue end (size=16) */
 1367 0634 C982      		std Y+1,r12
 1368 0636 DA82      		std Y+2,r13
 1369 0638 EB82      		std Y+3,r14
 1370 063a FC82      		std Y+4,r15
 1371 063c 0D83      		std Y+5,r16
 1372 063e 1E83      		std Y+6,r17
 1373 0640 2F83      		std Y+7,r18
 1374 0642 3887      		std Y+8,r19
 1375 0644 4987      		std Y+9,r20
 1376 0646 5A87      		std Y+10,r21
 1377 0648 6B87      		std Y+11,r22
 1378 064a 7C87      		std Y+12,r23
 1379 064c 8D87      		std Y+13,r24
2333:mac.c         ****      INDIRECT_TX_PENDING_QUEUE  *p_temp;
2334:mac.c         ****      p_temp=head_of_indirect_pending_buffer; 
 1381               	.LM133:
 1382 064e 0091 0000 		lds r16,head_of_indirect_pending_buffer
 1383 0652 1091 0000 		lds r17,(head_of_indirect_pending_buffer)+1
 1384 0656 4C85      		ldd r20,Y+12
 1385 0658 5D85      		ldd r21,Y+13
 1386 065a 2A85      		ldd r18,Y+10
 1387 065c 3B85      		ldd r19,Y+11
 1388 065e ED2C      		mov r14,r13
 1389 0660 FB80      		ldd r15,Y+3
 1390 0662 BC81      		ldd r27,Y+4
 1391 0664 AD81      		ldd r26,Y+5
 1392 0666 DE80      		ldd r13,Y+6
 1393 0668 CF80      		ldd r12,Y+7
 1394 066a 7885      		ldd r23,Y+8
 1395 066c 6985      		ldd r22,Y+9
2335:mac.c         ****      while((p_temp!=NULL)&&!((p_temp->dst.panID.Val==dst.panID.Val)&&((p_temp->dst.shortAddr.Val==d
 1397               	.LM134:
 1398 066e 03C0      		rjmp .L66
 1399               	.L69:
2336:mac.c         ****      	 p_temp=p_temp->next;     if(p_temp==NULL)
 1401               	.LM135:
 1402 0670 F801      		movw r30,r16
 1403 0672 00A9      		ldd r16,Z+48
 1404 0674 11A9      		ldd r17,Z+49
 1405               	.L66:
 1406 0676 0115      		cp r16,__zero_reg__
 1407 0678 1105      		cpc r17,__zero_reg__
 1408 067a 19F1      		breq .L67
 1409 067c F801      		movw r30,r16
 1410 067e 868D      		ldd r24,Z+30
 1411 0680 978D      		ldd r25,Z+31
 1412 0682 8417      		cp r24,r20
 1413 0684 9507      		cpc r25,r21
 1414 0686 A1F7      		brne .L69
 1415 0688 848D      		ldd r24,Z+28
 1416 068a 958D      		ldd r25,Z+29
 1417 068c 8217      		cp r24,r18
 1418 068e 9307      		cpc r25,r19
 1419 0690 C1F0      		breq .L67
 1420 0692 8489      		ldd r24,Z+20
 1421 0694 8E15      		cp r24,r14
 1422 0696 61F7      		brne .L69
 1423 0698 8589      		ldd r24,Z+21
 1424 069a 8F15      		cp r24,r15
 1425 069c 49F7      		brne .L69
 1426 069e 8689      		ldd r24,Z+22
 1427 06a0 8B17      		cp r24,r27
 1428 06a2 31F7      		brne .L69
 1429 06a4 8789      		ldd r24,Z+23
 1430 06a6 8A17      		cp r24,r26
 1431 06a8 19F7      		brne .L69
 1432 06aa 808D      		ldd r24,Z+24
 1433 06ac 8D15      		cp r24,r13
 1434 06ae 01F7      		brne .L69
 1435 06b0 818D      		ldd r24,Z+25
 1436 06b2 8C15      		cp r24,r12
 1437 06b4 E9F6      		brne .L69
 1438 06b6 828D      		ldd r24,Z+26
 1439 06b8 8717      		cp r24,r23
 1440 06ba D1F6      		brne .L69
 1441 06bc 838D      		ldd r24,Z+27
 1442 06be 8617      		cp r24,r22
 1443 06c0 B9F6      		brne .L69
 1444               	.L67:
 1445 06c2 0115      		cp r16,__zero_reg__
 1446 06c4 1105      		cpc r17,__zero_reg__
 1447 06c6 21F4      		brne .L70
2337:mac.c         **** 	 	error("\ncannot find a pending frame in the queue\n");
 1449               	.LM136:
 1450 06c8 80E0      		ldi r24,lo8(.LC6)
 1451 06ca 90E0      		ldi r25,hi8(.LC6)
 1452 06cc 0E94 0000 		call error
 1453               	.L70:
2338:mac.c         ****      return p_temp;
2339:mac.c         **** }
 1455               	.LM137:
 1456 06d0 C801      		movw r24,r16
 1457               	/* epilogue: frame size=13 */
 1458 06d2 2D96      		adiw r28,13
 1459 06d4 0FB6      		in __tmp_reg__,__SREG__
 1460 06d6 F894      		cli
 1461 06d8 DEBF      		out __SP_H__,r29
 1462 06da 0FBE      		out __SREG__,__tmp_reg__
 1463 06dc CDBF      		out __SP_L__,r28
 1464 06de DF91      		pop r29
 1465 06e0 CF91      		pop r28
 1466 06e2 1F91      		pop r17
 1467 06e4 0F91      		pop r16
 1468 06e6 FF90      		pop r15
 1469 06e8 EF90      		pop r14
 1470 06ea DF90      		pop r13
 1471 06ec CF90      		pop r12
 1472 06ee 0895      		ret
 1473               	/* epilogue end (size=15) */
 1474               	/* function get_pending_frame size 110 (79) */
 1479               	.Lscope17:
 1482               	.global	Is_data_pending
 1484               	Is_data_pending:
 1486               	.LM138:
 1487               	/* prologue: frame size=13 */
 1488 06f0 CF92      		push r12
 1489 06f2 DF92      		push r13
 1490 06f4 EF92      		push r14
 1491 06f6 FF92      		push r15
 1492 06f8 0F93      		push r16
 1493 06fa 1F93      		push r17
 1494 06fc CF93      		push r28
 1495 06fe DF93      		push r29
 1496 0700 CDB7      		in r28,__SP_L__
 1497 0702 DEB7      		in r29,__SP_H__
 1498 0704 2D97      		sbiw r28,13
 1499 0706 0FB6      		in __tmp_reg__,__SREG__
 1500 0708 F894      		cli
 1501 070a DEBF      		out __SP_H__,r29
 1502 070c 0FBE      		out __SREG__,__tmp_reg__
 1503 070e CDBF      		out __SP_L__,r28
 1504               	/* prologue end (size=16) */
 1505 0710 C982      		std Y+1,r12
 1506 0712 DA82      		std Y+2,r13
 1507 0714 EB82      		std Y+3,r14
 1508 0716 FC82      		std Y+4,r15
 1509 0718 0D83      		std Y+5,r16
 1510 071a 1E83      		std Y+6,r17
 1511 071c 2F83      		std Y+7,r18
 1512 071e 3887      		std Y+8,r19
 1513 0720 4987      		std Y+9,r20
 1514 0722 5A87      		std Y+10,r21
 1515 0724 6B87      		std Y+11,r22
 1516 0726 7C87      		std Y+12,r23
 1517 0728 8D87      		std Y+13,r24
 1519               	.LM139:
 1520 072a E091 0000 		lds r30,head_of_indirect_pending_buffer
 1521 072e F091 0000 		lds r31,(head_of_indirect_pending_buffer)+1
 1523               	.LM140:
 1524 0732 3097      		sbiw r30,0
 1525 0734 71F1      		breq .L79
 1526 0736 0D2D      		mov r16,r13
 1527 0738 1E2D      		mov r17,r14
 1528 073a BF2D      		mov r27,r15
 1529 073c AD81      		ldd r26,Y+5
 1530 073e 7E81      		ldd r23,Y+6
 1531 0740 622F      		mov r22,r18
 1532 0742 532F      		mov r21,r19
 1533 0744 2A85      		ldd r18,Y+10
 1534 0746 3B85      		ldd r19,Y+11
 1535               	.L77:
 1537               	.LM141:
 1538 0748 8489      		ldd r24,Z+20
 1539 074a 8017      		cp r24,r16
 1540 074c A9F4      		brne .L76
 1541 074e 8589      		ldd r24,Z+21
 1542 0750 8117      		cp r24,r17
 1543 0752 91F4      		brne .L76
 1544 0754 8689      		ldd r24,Z+22
 1545 0756 8B17      		cp r24,r27
 1546 0758 79F4      		brne .L76
 1547 075a 8789      		ldd r24,Z+23
 1548 075c 8A17      		cp r24,r26
 1549 075e 61F4      		brne .L76
 1550 0760 808D      		ldd r24,Z+24
 1551 0762 8717      		cp r24,r23
 1552 0764 49F4      		brne .L76
 1553 0766 818D      		ldd r24,Z+25
 1554 0768 8617      		cp r24,r22
 1555 076a 31F4      		brne .L76
 1556 076c 828D      		ldd r24,Z+26
 1557 076e 8517      		cp r24,r21
 1558 0770 19F4      		brne .L76
 1559 0772 838D      		ldd r24,Z+27
 1560 0774 8417      		cp r24,r20
 1561 0776 29F0      		breq .L75
 1562               	.L76:
 1563 0778 848D      		ldd r24,Z+28
 1564 077a 958D      		ldd r25,Z+29
 1565 077c 8217      		cp r24,r18
 1566 077e 9307      		cpc r25,r19
 1567 0780 19F4      		brne .L74
 1568               	.L75:
 1570               	.LM142:
 1571 0782 81E0      		ldi r24,lo8(1)
 1572 0784 90E0      		ldi r25,hi8(1)
 1573 0786 07C0      		rjmp .L71
 1574               	.L74:
 1576               	.LM143:
 1577 0788 00A8      		ldd __tmp_reg__,Z+48
 1578 078a F1A9      		ldd r31,Z+49
 1579 078c E02D      		mov r30,__tmp_reg__
 1580 078e 3097      		sbiw r30,0
 1581 0790 D9F6      		brne .L77
 1582               	.L79:
 1584               	.LM144:
 1585 0792 80E0      		ldi r24,lo8(0)
 1586 0794 90E0      		ldi r25,hi8(0)
 1587               	.L71:
 1588               	/* epilogue: frame size=13 */
 1589 0796 2D96      		adiw r28,13
 1590 0798 0FB6      		in __tmp_reg__,__SREG__
 1591 079a F894      		cli
 1592 079c DEBF      		out __SP_H__,r29
 1593 079e 0FBE      		out __SREG__,__tmp_reg__
 1594 07a0 CDBF      		out __SP_L__,r28
 1595 07a2 DF91      		pop r29
 1596 07a4 CF91      		pop r28
 1597 07a6 1F91      		pop r17
 1598 07a8 0F91      		pop r16
 1599 07aa FF90      		pop r15
 1600 07ac EF90      		pop r14
 1601 07ae DF90      		pop r13
 1602 07b0 CF90      		pop r12
 1603 07b2 0895      		ret
 1604               	/* epilogue end (size=15) */
 1605               	/* function Is_data_pending size 98 (67) */
 1610               	.Lscope18:
 1612               	.global	beacon_request_frame_send
 1614               	beacon_request_frame_send:
 1616               	.LM145:
 1617               	/* prologue: frame size=0 */
 1618               	/* prologue end (size=0) */
 1619               	/* epilogue: frame size=0 */
 1620 07b4 0895      		ret
 1621               	/* epilogue end (size=1) */
 1622               	/* function beacon_request_frame_send size 1 (0) */
 1624               	.Lscope19:
 1626               	.global	beacon_frame_tx_timing
 1628               	beacon_frame_tx_timing:
 1630               	.LM146:
 1631               	/* prologue: frame size=0 */
 1632 07b6 6F92      		push r6
 1633 07b8 7F92      		push r7
 1634 07ba 8F92      		push r8
 1635 07bc 9F92      		push r9
 1636 07be AF92      		push r10
 1637 07c0 BF92      		push r11
 1638 07c2 CF92      		push r12
 1639 07c4 DF92      		push r13
 1640 07c6 EF92      		push r14
 1641 07c8 FF92      		push r15
 1642 07ca 0F93      		push r16
 1643 07cc 1F93      		push r17
 1644               	/* prologue end (size=12) */
 1646               	.LM147:
 1647 07ce 0E94 0000 		call systime32
 1648 07d2 3B01      		movw r6,r22
 1649 07d4 4C01      		movw r8,r24
 1651               	.LM148:
 1652 07d6 8091 0000 		lds r24,last_beacon_tx_timestamp
 1653 07da 9091 0000 		lds r25,(last_beacon_tx_timestamp)+1
 1654 07de A091 0000 		lds r26,(last_beacon_tx_timestamp)+2
 1655 07e2 B091 0000 		lds r27,(last_beacon_tx_timestamp)+3
 1656 07e6 6401      		movw r12,r8
 1657 07e8 5301      		movw r10,r6
 1658 07ea A81A      		sub r10,r24
 1659 07ec B90A      		sbc r11,r25
 1660 07ee CA0A      		sbc r12,r26
 1661 07f0 DB0A      		sbc r13,r27
 1662 07f2 6816      		cp r6,r24
 1663 07f4 7906      		cpc r7,r25
 1664 07f6 8A06      		cpc r8,r26
 1665 07f8 9B06      		cpc r9,r27
 1666 07fa 40F4      		brsh .L82
 1668               	.LM149:
 1669 07fc 8FEF      		ldi r24,lo8(1073741823)
 1670 07fe 9FEF      		ldi r25,hi8(1073741823)
 1671 0800 AFEF      		ldi r26,hlo8(1073741823)
 1672 0802 BFE3      		ldi r27,hhi8(1073741823)
 1673 0804 A80E      		add r10,r24
 1674 0806 B91E      		adc r11,r25
 1675 0808 CA1E      		adc r12,r26
 1676 080a DB1E      		adc r13,r27
 1677               	.L82:
 1679               	.LM150:
 1680 080c 8601      		movw r16,r12
 1681 080e 7501      		movw r14,r10
 1682 0810 1695      		lsr r17
 1683 0812 0795      		ror r16
 1684 0814 F794      		ror r15
 1685 0816 E794      		ror r14
 1686 0818 8091 0000 		lds r24,MAC_CAP_PERIOD
 1687 081c 9091 0000 		lds r25,(MAC_CAP_PERIOD)+1
 1688 0820 A091 0000 		lds r26,(MAC_CAP_PERIOD)+2
 1689 0824 B091 0000 		lds r27,(MAC_CAP_PERIOD)+3
 1690 0828 8E19      		sub r24,r14
 1691 082a 9F09      		sbc r25,r15
 1692 082c A00B      		sbc r26,r16
 1693 082e B10B      		sbc r27,r17
 1694 0830 9C01      		movw r18,r24
 1695 0832 AD01      		movw r20,r26
 1696 0834 62E0      		ldi r22,lo8(2)
 1697 0836 8091 0000 		lds r24,head_of_systimer_queue
 1698 083a 9091 0000 		lds r25,(head_of_systimer_queue)+1
 1699 083e 0E94 0000 		call systimer_start_task
 1700 0842 FC01      		movw r30,r24
 1701 0844 9093 0000 		sts (head_of_systimer_queue)+1,r25
 1702 0848 8093 0000 		sts head_of_systimer_queue,r24
 1704               	.LM151:
 1705 084c 8091 0000 		lds r24,MAC_SUPERFRAME_PERIOD
 1706 0850 9091 0000 		lds r25,(MAC_SUPERFRAME_PERIOD)+1
 1707 0854 A091 0000 		lds r26,(MAC_SUPERFRAME_PERIOD)+2
 1708 0858 B091 0000 		lds r27,(MAC_SUPERFRAME_PERIOD)+3
 1709 085c 8E19      		sub r24,r14
 1710 085e 9F09      		sbc r25,r15
 1711 0860 A00B      		sbc r26,r16
 1712 0862 B10B      		sbc r27,r17
 1713 0864 9C01      		movw r18,r24
 1714 0866 AD01      		movw r20,r26
 1715 0868 60E0      		ldi r22,lo8(0)
 1716 086a CF01      		movw r24,r30
 1717 086c 0E94 0000 		call systimer_start_task
 1718 0870 9093 0000 		sts (head_of_systimer_queue)+1,r25
 1719 0874 8093 0000 		sts head_of_systimer_queue,r24
 1721               	.LM152:
 1722 0878 8091 0000 		lds r24,last_beacon_tx_timestamp
 1723 087c 9091 0000 		lds r25,(last_beacon_tx_timestamp)+1
 1724 0880 A091 0000 		lds r26,(last_beacon_tx_timestamp)+2
 1725 0884 B091 0000 		lds r27,(last_beacon_tx_timestamp)+3
 1726 0888 8093 0000 		sts MAC_OBJECT_CAP_START_TICKS,r24
 1727 088c 9093 0000 		sts (MAC_OBJECT_CAP_START_TICKS)+1,r25
 1728 0890 A093 0000 		sts (MAC_OBJECT_CAP_START_TICKS)+2,r26
 1729 0894 B093 0000 		sts (MAC_OBJECT_CAP_START_TICKS)+3,r27
 1731               	.LM153:
 1732 0898 8091 0000 		lds r24,MAC_CAP_PERIOD
 1733 089c 9091 0000 		lds r25,(MAC_CAP_PERIOD)+1
 1734 08a0 A091 0000 		lds r26,(MAC_CAP_PERIOD)+2
 1735 08a4 B091 0000 		lds r27,(MAC_CAP_PERIOD)+3
 1736 08a8 880F      		lsl r24
 1737 08aa 991F      		rol r25
 1738 08ac AA1F      		rol r26
 1739 08ae BB1F      		rol r27
 1740 08b0 8A19      		sub r24,r10
 1741 08b2 9B09      		sbc r25,r11
 1742 08b4 AC09      		sbc r26,r12
 1743 08b6 BD09      		sbc r27,r13
 1744 08b8 860D      		add r24,r6
 1745 08ba 971D      		adc r25,r7
 1746 08bc A81D      		adc r26,r8
 1747 08be B91D      		adc r27,r9
 1748 08c0 8093 0000 		sts MAC_OBJECT_CAP_END_TICKS,r24
 1749 08c4 9093 0000 		sts (MAC_OBJECT_CAP_END_TICKS)+1,r25
 1750 08c8 A093 0000 		sts (MAC_OBJECT_CAP_END_TICKS)+2,r26
 1751 08cc B093 0000 		sts (MAC_OBJECT_CAP_END_TICKS)+3,r27
 1753               	.LM154:
 1754 08d0 8091 0000 		lds r24,MAC_SUPERFRAME_PERIOD
 1755 08d4 9091 0000 		lds r25,(MAC_SUPERFRAME_PERIOD)+1
 1756 08d8 A091 0000 		lds r26,(MAC_SUPERFRAME_PERIOD)+2
 1757 08dc B091 0000 		lds r27,(MAC_SUPERFRAME_PERIOD)+3
 1758 08e0 880F      		lsl r24
 1759 08e2 991F      		rol r25
 1760 08e4 AA1F      		rol r26
 1761 08e6 BB1F      		rol r27
 1762 08e8 8A19      		sub r24,r10
 1763 08ea 9B09      		sbc r25,r11
 1764 08ec AC09      		sbc r26,r12
 1765 08ee BD09      		sbc r27,r13
 1766 08f0 860D      		add r24,r6
 1767 08f2 971D      		adc r25,r7
 1768 08f4 A81D      		adc r26,r8
 1769 08f6 B91D      		adc r27,r9
 1770 08f8 8093 0000 		sts MAC_OBJECT_SUPERFRAME_TICKS,r24
 1771 08fc 9093 0000 		sts (MAC_OBJECT_SUPERFRAME_TICKS)+1,r25
 1772 0900 A093 0000 		sts (MAC_OBJECT_SUPERFRAME_TICKS)+2,r26
 1773 0904 B093 0000 		sts (MAC_OBJECT_SUPERFRAME_TICKS)+3,r27
 1774               	/* epilogue: frame size=0 */
 1775 0908 1F91      		pop r17
 1776 090a 0F91      		pop r16
 1777 090c FF90      		pop r15
 1778 090e EF90      		pop r14
 1779 0910 DF90      		pop r13
 1780 0912 CF90      		pop r12
 1781 0914 BF90      		pop r11
 1782 0916 AF90      		pop r10
 1783 0918 9F90      		pop r9
 1784 091a 8F90      		pop r8
 1785 091c 7F90      		pop r7
 1786 091e 6F90      		pop r6
 1787 0920 0895      		ret
 1788               	/* epilogue end (size=13) */
 1789               	/* function beacon_frame_tx_timing size 182 (157) */
 1795               	.Lscope20:
 1797               	.global	timerqueue_adjust
 1799               	timerqueue_adjust:
 1801               	.LM155:
 1802               	/* prologue: frame size=0 */
 1803               	/* prologue end (size=0) */
 1805               	.LM156:
 1806 0922 E091 0000 		lds r30,head_of_timer_queue
 1807 0926 F091 0000 		lds r31,(head_of_timer_queue)+1
 1808 092a F093 0000 		sts (current_timer_elem)+1,r31
 1809 092e E093 0000 		sts current_timer_elem,r30
 1811               	.LM157:
 1812 0932 1186      		std Z+9,__zero_reg__
 1813 0934 1286      		std Z+10,__zero_reg__
 1815               	.LM158:
 1816 0936 1092 0000 		sts (head_of_timer_queue)+1,__zero_reg__
 1817 093a 1092 0000 		sts head_of_timer_queue,__zero_reg__
 1818               	/* epilogue: frame size=0 */
 1819 093e 0895      		ret
 1820               	/* epilogue end (size=1) */
 1821               	/* function timerqueue_adjust size 15 (14) */
 1823               	.Lscope21:
 1824               		.data
 1825               	.LC7:
 1826 016d 0A74 6865 		.string	"\nthe frame is not in the pending queue\n"
 1826      2066 7261 
 1826      6D65 2069 
 1826      7320 6E6F 
 1826      7420 696E 
 1827               	.LC8:
 1828 0195 0A49 7420 		.string	"\nIt is not in the pending queue\n"
 1828      6973 206E 
 1828      6F74 2069 
 1828      6E20 7468 
 1828      6520 7065 
 1829               		.text
 1832               	.global	remove_pending_queue
 1834               	remove_pending_queue:
 1836               	.LM159:
 1837               	/* prologue: frame size=0 */
 1838 0940 CF93      		push r28
 1839 0942 DF93      		push r29
 1840               	/* prologue end (size=2) */
 1841 0944 EC01      		movw r28,r24
 1843               	.LM160:
 1844 0946 4091 0000 		lds r20,head_of_indirect_pending_buffer
 1845 094a 5091 0000 		lds r21,(head_of_indirect_pending_buffer)+1
 1846 094e 9A01      		movw r18,r20
 1848               	.LM161:
 1849 0950 DA01      		movw r26,r20
 1850 0952 07C0      		rjmp .L124
 1851               	.L123:
 1853               	.LM162:
 1854 0954 4115      		cp r20,__zero_reg__
 1855 0956 5105      		cpc r21,__zero_reg__
 1856 0958 39F0      		breq .L86
 1858               	.LM163:
 1859 095a DA01      		movw r26,r20
 1861               	.LM164:
 1862 095c FA01      		movw r30,r20
 1863 095e 40A9      		ldd r20,Z+48
 1864 0960 51A9      		ldd r21,Z+49
 1865               	.L124:
 1866 0962 4C17      		cp r20,r28
 1867 0964 5D07      		cpc r21,r29
 1868 0966 B1F7      		brne .L123
 1869               	.L86:
 1871               	.LM165:
 1872 0968 4115      		cp r20,__zero_reg__
 1873 096a 5105      		cpc r21,__zero_reg__
 1874 096c 29F4      		brne .L88
 1876               	.LM166:
 1877 096e 80E0      		ldi r24,lo8(.LC7)
 1878 0970 90E0      		ldi r25,hi8(.LC7)
 1879 0972 0E94 0000 		call error
 1881               	.LM167:
 1882 0976 13C1      		rjmp .L84
 1883               	.L88:
 1885               	.LM168:
 1886 0978 8091 0000 		lds r24,tail_of_indirect_pending_buffer
 1887 097c 9091 0000 		lds r25,(tail_of_indirect_pending_buffer)+1
 1888 0980 2817      		cp r18,r24
 1889 0982 3907      		cpc r19,r25
 1890 0984 49F4      		brne .L90
 1892               	.LM169:
 1893 0986 1092 0000 		sts (head_of_indirect_pending_buffer)+1,__zero_reg__
 1894 098a 1092 0000 		sts head_of_indirect_pending_buffer,__zero_reg__
 1896               	.LM170:
 1897 098e 1092 0000 		sts (tail_of_indirect_pending_buffer)+1,__zero_reg__
 1898 0992 1092 0000 		sts tail_of_indirect_pending_buffer,__zero_reg__
 1899 0996 1FC0      		rjmp .L89
 1900               	.L90:
 1901 0998 FA01      		movw r30,r20
 1902 099a 80A9      		ldd r24,Z+48
 1903 099c 91A9      		ldd r25,Z+49
 1905               	.LM171:
 1906 099e 4217      		cp r20,r18
 1907 09a0 5307      		cpc r21,r19
 1908 09a2 29F4      		brne .L92
 1910               	.LM172:
 1911 09a4 9093 0000 		sts (head_of_indirect_pending_buffer)+1,r25
 1912 09a8 8093 0000 		sts head_of_indirect_pending_buffer,r24
 1914               	.LM173:
 1915 09ac 14C0      		rjmp .L89
 1916               	.L92:
 1918               	.LM174:
 1919 09ae FD01      		movw r30,r26
 1920 09b0 80AB      		std Z+48,r24
 1921 09b2 91AB      		std Z+49,r25
 1923               	.LM175:
 1924 09b4 FA01      		movw r30,r20
 1925 09b6 80A9      		ldd r24,Z+48
 1926 09b8 91A9      		ldd r25,Z+49
 1927 09ba 0097      		sbiw r24,0
 1928 09bc 29F0      		breq .L94
 1930               	.LM176:
 1931 09be 9093 0000 		sts (tail_of_indirect_pending_buffer)+1,r25
 1932 09c2 8093 0000 		sts tail_of_indirect_pending_buffer,r24
 1933 09c6 04C0      		rjmp .L95
 1934               	.L94:
 1936               	.LM177:
 1937 09c8 B093 0000 		sts (tail_of_indirect_pending_buffer)+1,r27
 1938 09cc A093 0000 		sts tail_of_indirect_pending_buffer,r26
 1939               	.L95:
 1941               	.LM178:
 1942 09d0 FA01      		movw r30,r20
 1943 09d2 10AA      		std Z+48,__zero_reg__
 1944 09d4 11AA      		std Z+49,__zero_reg__
 1945               	.L89:
 1947               	.LM179:
 1948 09d6 8B89      		ldd r24,Y+19
 1949 09d8 8230      		cpi r24,lo8(2)
 1950 09da 09F0      		breq .+2
 1951 09dc 48C0      		rjmp .L96
 1953               	.LM180:
 1954 09de 70E0      		ldi r23,lo8(0)
 1956               	.LM181:
 1957 09e0 4C8D      		ldd r20,Y+28
 1958 09e2 5D8D      		ldd r21,Y+29
 1959 09e4 8091 0000 		lds r24,mac_tx_beacon+5
 1960 09e8 9091 0000 		lds r25,(mac_tx_beacon+5)+1
 1961 09ec 4817      		cp r20,r24
 1962 09ee 5907      		cpc r21,r25
 1963 09f0 81F0      		breq .L98
 1964 09f2 2091 0000 		lds r18,mac_tx_beacon+3
 1965               	.L99:
 1966 09f6 7F5F      		subi r23,lo8(-(1))
 1967 09f8 E72F      		mov r30,r23
 1968 09fa FF27      		clr r31
 1969 09fc EE0F      		add r30,r30
 1970 09fe FF1F      		adc r31,r31
 1971 0a00 E050      		subi r30,lo8(-(mac_tx_beacon))
 1972 0a02 F040      		sbci r31,hi8(-(mac_tx_beacon))
 1973 0a04 8581      		ldd r24,Z+5
 1974 0a06 9681      		ldd r25,Z+6
 1975 0a08 4817      		cp r20,r24
 1976 0a0a 5907      		cpc r21,r25
 1977 0a0c 11F0      		breq .L98
 1978 0a0e 2717      		cp r18,r23
 1979 0a10 90F7      		brsh .L99
 1980               	.L98:
 1982               	.LM182:
 1983 0a12 272F      		mov r18,r23
 1984 0a14 3327      		clr r19
 1985 0a16 F901      		movw r30,r18
 1986 0a18 E20F      		add r30,r18
 1987 0a1a F31F      		adc r31,r19
 1988 0a1c E050      		subi r30,lo8(-(mac_tx_beacon))
 1989 0a1e F040      		sbci r31,hi8(-(mac_tx_beacon))
 1990 0a20 8581      		ldd r24,Z+5
 1991 0a22 9681      		ldd r25,Z+6
 1992 0a24 4817      		cp r20,r24
 1993 0a26 5907      		cpc r21,r25
 1994 0a28 E9F4      		brne .L100
 1996               	.LM183:
 1997 0a2a 6091 0000 		lds r22,mac_tx_beacon+3
 1998 0a2e 462F      		mov r20,r22
 1999 0a30 5527      		clr r21
 2000 0a32 4150      		subi r20,lo8(-(-1))
 2001 0a34 5040      		sbci r21,hi8(-(-1))
 2002               	.L125:
 2003 0a36 4217      		cp r20,r18
 2004 0a38 5307      		cpc r21,r19
 2005 0a3a 6CF0      		brlt .L120
 2007               	.LM184:
 2008 0a3c F901      		movw r30,r18
 2009 0a3e E20F      		add r30,r18
 2010 0a40 F31F      		adc r31,r19
 2011 0a42 E050      		subi r30,lo8(-(mac_tx_beacon))
 2012 0a44 F040      		sbci r31,hi8(-(mac_tx_beacon))
 2013 0a46 8781      		ldd r24,Z+7
 2014 0a48 9085      		ldd r25,Z+8
 2015 0a4a 8583      		std Z+5,r24
 2016 0a4c 9683      		std Z+6,r25
 2018               	.LM185:
 2019 0a4e 7F5F      		subi r23,lo8(-(1))
 2020 0a50 272F      		mov r18,r23
 2021 0a52 3327      		clr r19
 2022 0a54 F0CF      		rjmp .L125
 2023               	.L120:
 2025               	.LM186:
 2026 0a56 6150      		subi r22,lo8(-(-1))
 2027 0a58 6093 0000 		sts mac_tx_beacon+3,r22
 2029               	.LM187:
 2030 0a5c 8091 0000 		lds r24,mac_tx_beacon+2
 2031 0a60 8150      		subi r24,lo8(-(-1))
 2032 0a62 93C0      		rjmp .L126
 2033               	.L100:
 2035               	.LM188:
 2036 0a64 80E0      		ldi r24,lo8(.LC8)
 2037 0a66 90E0      		ldi r25,hi8(.LC8)
 2038 0a68 0E94 0000 		call error
 2039 0a6c 90C0      		rjmp .L106
 2040               	.L96:
 2042               	.LM189:
 2043 0a6e 8330      		cpi r24,lo8(3)
 2044 0a70 09F0      		breq .+2
 2045 0a72 8DC0      		rjmp .L106
 2047               	.LM190:
 2048 0a74 70E0      		ldi r23,lo8(0)
 2049 0a76 4C89      		ldd r20,Y+20
 2050 0a78 5091 0000 		lds r21,mac_tx_beacon+4
 2052               	.LM191:
 2053 0a7c 01C0      		rjmp .L108
 2054               	.L111:
 2056               	.LM192:
 2057 0a7e 7F5F      		subi r23,lo8(-(1))
 2058               	.L108:
 2059 0a80 272F      		mov r18,r23
 2060 0a82 3327      		clr r19
 2061 0a84 F901      		movw r30,r18
 2062 0a86 83E0      		ldi r24,3
 2063 0a88 EE0F      	1:	lsl r30
 2064 0a8a FF1F      		rol r31
 2065 0a8c 8A95      		dec r24
 2066 0a8e E1F7      		brne 1b
 2067 0a90 E050      		subi r30,lo8(-(mac_tx_beacon))
 2068 0a92 F040      		sbci r31,hi8(-(mac_tx_beacon))
 2069 0a94 DF01      		movw r26,r30
 2070 0a96 1996      		adiw r26,9
 2071 0a98 8185      		ldd r24,Z+9
 2072 0a9a 4817      		cp r20,r24
 2073 0a9c E9F4      		brne .L110
 2074 0a9e 9D89      		ldd r25,Y+21
 2075 0aa0 FD01      		movw r30,r26
 2076 0aa2 8181      		ldd r24,Z+1
 2077 0aa4 9817      		cp r25,r24
 2078 0aa6 C1F4      		brne .L110
 2079 0aa8 9E89      		ldd r25,Y+22
 2080 0aaa 8281      		ldd r24,Z+2
 2081 0aac 9817      		cp r25,r24
 2082 0aae A1F4      		brne .L110
 2083 0ab0 9F89      		ldd r25,Y+23
 2084 0ab2 8381      		ldd r24,Z+3
 2085 0ab4 9817      		cp r25,r24
 2086 0ab6 81F4      		brne .L110
 2087 0ab8 988D      		ldd r25,Y+24
 2088 0aba 8481      		ldd r24,Z+4
 2089 0abc 9817      		cp r25,r24
 2090 0abe 61F4      		brne .L110
 2091 0ac0 998D      		ldd r25,Y+25
 2092 0ac2 8581      		ldd r24,Z+5
 2093 0ac4 9817      		cp r25,r24
 2094 0ac6 41F4      		brne .L110
 2095 0ac8 9A8D      		ldd r25,Y+26
 2096 0aca 8681      		ldd r24,Z+6
 2097 0acc 9817      		cp r25,r24
 2098 0ace 21F4      		brne .L110
 2099 0ad0 9B8D      		ldd r25,Y+27
 2100 0ad2 8781      		ldd r24,Z+7
 2101 0ad4 9817      		cp r25,r24
 2102 0ad6 11F0      		breq .L109
 2103               	.L110:
 2104 0ad8 5717      		cp r21,r23
 2105 0ada 88F6      		brsh .L111
 2106               	.L109:
 2108               	.LM193:
 2109 0adc F901      		movw r30,r18
 2110 0ade B3E0      		ldi r27,3
 2111 0ae0 EE0F      	1:	lsl r30
 2112 0ae2 FF1F      		rol r31
 2113 0ae4 BA95      		dec r27
 2114 0ae6 E1F7      		brne 1b
 2115 0ae8 E050      		subi r30,lo8(-(mac_tx_beacon))
 2116 0aea F040      		sbci r31,hi8(-(mac_tx_beacon))
 2117 0aec DF01      		movw r26,r30
 2118 0aee 1996      		adiw r26,9
 2119 0af0 8185      		ldd r24,Z+9
 2120 0af2 4817      		cp r20,r24
 2121 0af4 09F0      		breq .+2
 2122 0af6 4BC0      		rjmp .L106
 2123 0af8 9D89      		ldd r25,Y+21
 2124 0afa FD01      		movw r30,r26
 2125 0afc 8181      		ldd r24,Z+1
 2126 0afe 9817      		cp r25,r24
 2127 0b00 09F0      		breq .+2
 2128 0b02 45C0      		rjmp .L106
 2129 0b04 9E89      		ldd r25,Y+22
 2130 0b06 8281      		ldd r24,Z+2
 2131 0b08 9817      		cp r25,r24
 2132 0b0a 09F0      		breq .+2
 2133 0b0c 40C0      		rjmp .L106
 2134 0b0e 9F89      		ldd r25,Y+23
 2135 0b10 8381      		ldd r24,Z+3
 2136 0b12 9817      		cp r25,r24
 2137 0b14 E1F5      		brne .L106
 2138 0b16 988D      		ldd r25,Y+24
 2139 0b18 8481      		ldd r24,Z+4
 2140 0b1a 9817      		cp r25,r24
 2141 0b1c C1F5      		brne .L106
 2142 0b1e 998D      		ldd r25,Y+25
 2143 0b20 8581      		ldd r24,Z+5
 2144 0b22 9817      		cp r25,r24
 2145 0b24 A1F5      		brne .L106
 2146 0b26 9A8D      		ldd r25,Y+26
 2147 0b28 8681      		ldd r24,Z+6
 2148 0b2a 9817      		cp r25,r24
 2149 0b2c 81F5      		brne .L106
 2150 0b2e 9B8D      		ldd r25,Y+27
 2151 0b30 8781      		ldd r24,Z+7
 2152 0b32 9817      		cp r25,r24
 2153 0b34 61F5      		brne .L106
 2155               	.LM194:
 2156 0b36 8091 0000 		lds r24,mac_tx_beacon+4
 2157 0b3a 9927      		clr r25
 2158 0b3c 0197      		sbiw r24,1
 2159 0b3e 8217      		cp r24,r18
 2160 0b40 9307      		cpc r25,r19
 2161 0b42 DCF0      		brlt .L122
 2162 0b44 48E0      		ldi r20,lo8(8)
 2163               	.L116:
 2165               	.LM195:
 2166 0b46 F901      		movw r30,r18
 2167 0b48 A3E0      		ldi r26,3
 2168 0b4a EE0F      	1:	lsl r30
 2169 0b4c FF1F      		rol r31
 2170 0b4e AA95      		dec r26
 2171 0b50 E1F7      		brne 1b
 2172 0b52 DF01      		movw r26,r30
 2173 0b54 A050      		subi r26,lo8(-(mac_tx_beacon+17))
 2174 0b56 B040      		sbci r27,hi8(-(mac_tx_beacon+17))
 2175 0b58 E050      		subi r30,lo8(-(mac_tx_beacon+9))
 2176 0b5a F040      		sbci r31,hi8(-(mac_tx_beacon+9))
 2177 0b5c 842F      		mov r24,r20
 2178 0b5e 0D90      		ld __tmp_reg__,X+
 2179 0b60 0192      		st Z+,__tmp_reg__
 2180 0b62 8A95      		dec r24
 2181 0b64 E1F7      		brne .-8
 2183               	.LM196:
 2184 0b66 7F5F      		subi r23,lo8(-(1))
 2185 0b68 272F      		mov r18,r23
 2186 0b6a 3327      		clr r19
 2187 0b6c 8091 0000 		lds r24,mac_tx_beacon+4
 2188 0b70 9927      		clr r25
 2189 0b72 0197      		sbiw r24,1
 2190 0b74 8217      		cp r24,r18
 2191 0b76 9307      		cpc r25,r19
 2192 0b78 34F7      		brge .L116
 2193               	.L122:
 2195               	.LM197:
 2196 0b7a 8091 0000 		lds r24,mac_tx_beacon+4
 2197 0b7e 8150      		subi r24,lo8(-(-1))
 2198 0b80 8093 0000 		sts mac_tx_beacon+4,r24
 2200               	.LM198:
 2201 0b84 8091 0000 		lds r24,mac_tx_beacon+2
 2202 0b88 8051      		subi r24,lo8(-(-16))
 2203               	.L126:
 2204 0b8a 8093 0000 		sts mac_tx_beacon+2,r24
 2205               	.L106:
 2207               	.LM199:
 2208 0b8e CE01      		movw r24,r28
 2209 0b90 0E94 0000 		call free
 2211               	.LM200:
 2212 0b94 8091 0000 		lds r24,current_pending_num
 2213 0b98 8150      		subi r24,lo8(-(-1))
 2214 0b9a 8093 0000 		sts current_pending_num,r24
 2215               	.L84:
 2216               	/* epilogue: frame size=0 */
 2217 0b9e DF91      		pop r29
 2218 0ba0 CF91      		pop r28
 2219 0ba2 0895      		ret
 2220               	/* epilogue end (size=3) */
 2221               	/* function remove_pending_queue size 306 (301) */
 2228               	.Lscope22:
 2230               	.global	pending_frame_handle
 2232               	pending_frame_handle:
 2234               	.LM201:
 2235               	/* prologue: frame size=0 */
 2236 0ba4 CF93      		push r28
 2237 0ba6 DF93      		push r29
 2238               	/* prologue end (size=2) */
 2240               	.LM202:
 2241 0ba8 C091 0000 		lds r28,head_of_indirect_pending_buffer
 2242 0bac D091 0000 		lds r29,(head_of_indirect_pending_buffer)+1
 2244               	.LM203:
 2245 0bb0 2097      		sbiw r28,0
 2246 0bb2 C9F0      		breq .L134
 2247               	.L132:
 2249               	.LM204:
 2250 0bb4 8981      		ldd r24,Y+1
 2251 0bb6 9A81      		ldd r25,Y+2
 2252 0bb8 0197      		sbiw r24,1
 2253 0bba 8983      		std Y+1,r24
 2254 0bbc 9A83      		std Y+2,r25
 2256               	.LM205:
 2257 0bbe 892B      		or r24,r25
 2258 0bc0 69F4      		brne .L130
 2260               	.LM206:
 2261 0bc2 8C81      		ldd r24,Y+4
 2262 0bc4 9927      		clr r25
 2263 0bc6 8770      		andi r24,lo8(7)
 2264 0bc8 9070      		andi r25,hi8(7)
 2265 0bca 0197      		sbiw r24,1
 2266 0bcc 21F4      		brne .L131
 2268               	.LM207:
 2269 0bce 6B81      		ldd r22,Y+3
 2270 0bd0 80EF      		ldi r24,lo8(-16)
 2271 0bd2 0E94 0000 		call mcpsDataConfirm
 2272               	.L131:
 2274               	.LM208:
 2275 0bd6 CE01      		movw r24,r28
 2276 0bd8 0E94 0000 		call remove_pending_queue
 2277               	.L130:
 2279               	.LM209:
 2280 0bdc 08A8      		ldd __tmp_reg__,Y+48
 2281 0bde D9A9      		ldd r29,Y+49
 2282 0be0 C02D      		mov r28,__tmp_reg__
 2283 0be2 2097      		sbiw r28,0
 2284 0be4 39F7      		brne .L132
 2285               	.L134:
 2286               	/* epilogue: frame size=0 */
 2287 0be6 DF91      		pop r29
 2288 0be8 CF91      		pop r28
 2289 0bea 0895      		ret
 2290               	/* epilogue end (size=3) */
 2291               	/* function pending_frame_handle size 37 (32) */
 2296               	.Lscope23:
 2299               	.global	remove_from_rx_buffer
 2301               	remove_from_rx_buffer:
 2303               	.LM210:
 2304               	/* prologue: frame size=0 */
 2305 0bec 0F93      		push r16
 2306 0bee 1F93      		push r17
 2307               	/* prologue end (size=2) */
 2308 0bf0 8C01      		movw r16,r24
 2310               	.LM211:
 2311 0bf2 FC01      		movw r30,r24
 2312 0bf4 8181      		ldd r24,Z+1
 2313 0bf6 9281      		ldd r25,Z+2
 2314 0bf8 0E94 0000 		call free
 2316               	.LM212:
 2317 0bfc C801      		movw r24,r16
 2318 0bfe 0E94 0000 		call free
 2319               	/* epilogue: frame size=0 */
 2320 0c02 1F91      		pop r17
 2321 0c04 0F91      		pop r16
 2322 0c06 0895      		ret
 2323               	/* epilogue end (size=3) */
 2324               	/* function remove_from_rx_buffer size 14 (9) */
 2326               	.Lscope24:
 2327               		.data
 2328               	.LC9:
 2329 01b6 0A20 6361 		.string	"\n cannot find the corresponding frame in the tx buffer\n"
 2329      6E6E 6F74 
 2329      2066 696E 
 2329      6420 7468 
 2329      6520 636F 
 2330               		.text
 2333               	.global	remove_tx_queue
 2335               	remove_tx_queue:
 2337               	.LM213:
 2338               	/* prologue: frame size=0 */
 2339 0c08 CF93      		push r28
 2340 0c0a DF93      		push r29
 2341               	/* prologue end (size=2) */
 2342 0c0c 982F      		mov r25,r24
 2344               	.LM214:
 2345 0c0e C091 0000 		lds r28,head_of_tx_buffer
 2346 0c12 D091 0000 		lds r29,(head_of_tx_buffer)+1
 2348               	.LM215:
 2349 0c16 FE01      		movw r30,r28
 2350 0c18 06C0      		rjmp .L146
 2351               	.L145:
 2353               	.LM216:
 2354 0c1a 2097      		sbiw r28,0
 2355 0c1c 39F0      		breq .L138
 2357               	.LM217:
 2358 0c1e FE01      		movw r30,r28
 2360               	.LM218:
 2361 0c20 0984      		ldd __tmp_reg__,Y+9
 2362 0c22 DA85      		ldd r29,Y+10
 2363 0c24 C02D      		mov r28,__tmp_reg__
 2364               	.L146:
 2365 0c26 8B81      		ldd r24,Y+3
 2366 0c28 8917      		cp r24,r25
 2367 0c2a B9F7      		brne .L145
 2368               	.L138:
 2370               	.LM219:
 2371 0c2c 2097      		sbiw r28,0
 2372 0c2e 29F4      		brne .L140
 2374               	.LM220:
 2375 0c30 80E0      		ldi r24,lo8(.LC9)
 2376 0c32 90E0      		ldi r25,hi8(.LC9)
 2377 0c34 0E94 0000 		call error
 2378 0c38 19C0      		rjmp .L136
 2379               	.L140:
 2380 0c3a 8985      		ldd r24,Y+9
 2381 0c3c 9A85      		ldd r25,Y+10
 2383               	.LM221:
 2384 0c3e EC17      		cp r30,r28
 2385 0c40 FD07      		cpc r31,r29
 2386 0c42 49F4      		brne .L142
 2388               	.LM222:
 2389 0c44 9093 0000 		sts (head_of_tx_buffer)+1,r25
 2390 0c48 8093 0000 		sts head_of_tx_buffer,r24
 2392               	.LM223:
 2393 0c4c 9093 0000 		sts (tail_of_tx_buffer)+1,r25
 2394 0c50 8093 0000 		sts tail_of_tx_buffer,r24
 2395 0c54 04C0      		rjmp .L143
 2396               	.L142:
 2398               	.LM224:
 2399 0c56 8187      		std Z+9,r24
 2400 0c58 9287      		std Z+10,r25
 2402               	.LM225:
 2403 0c5a 1986      		std Y+9,__zero_reg__
 2404 0c5c 1A86      		std Y+10,__zero_reg__
 2405               	.L143:
 2407               	.LM226:
 2408 0c5e 8F81      		ldd r24,Y+7
 2409 0c60 9885      		ldd r25,Y+8
 2410 0c62 0E94 0000 		call free
 2412               	.LM227:
 2413 0c66 CE01      		movw r24,r28
 2414 0c68 0E94 0000 		call free
 2415               	.L136:
 2416               	/* epilogue: frame size=0 */
 2417 0c6c DF91      		pop r29
 2418 0c6e CF91      		pop r28
 2419 0c70 0895      		ret
 2420               	/* epilogue end (size=3) */
 2421               	/* function remove_tx_queue size 53 (48) */
 2427               	.Lscope25:
 2429               	.global	mac_timer3queue_getnextinterval
 2431               	mac_timer3queue_getnextinterval:
 2433               	.LM228:
 2434               	/* prologue: frame size=0 */
 2435               	/* prologue end (size=0) */
 2437               	.LM229:
 2438 0c72 E091 0000 		lds r30,head_of_timer_queue
 2439 0c76 F091 0000 		lds r31,(head_of_timer_queue)+1
 2440 0c7a 0184      		ldd __tmp_reg__,Z+9
 2441 0c7c F285      		ldd r31,Z+10
 2442 0c7e E02D      		mov r30,__tmp_reg__
 2444               	.LM230:
 2445 0c80 3097      		sbiw r30,0
 2446 0c82 19F0      		breq .L148
 2448               	.LM231:
 2449 0c84 8381      		ldd r24,Z+3
 2450 0c86 9481      		ldd r25,Z+4
 2451 0c88 0895      		ret
 2452               	.L148:
 2454               	.LM232:
 2455 0c8a CF01      		movw r24,r30
 2457               	.LM233:
 2458 0c8c 0895      		ret
 2459               	/* epilogue: frame size=0 */
 2460 0c8e 0895      		ret
 2461               	/* epilogue end (size=1) */
 2462               	/* function mac_timer3queue_getnextinterval size 15 (14) */
 2467               	.Lscope26:
 2469               	.global	initial_tx_queue
 2471               	initial_tx_queue:
 2473               	.LM234:
 2474               	/* prologue: frame size=0 */
 2475               	/* prologue end (size=0) */
 2476               	/* epilogue: frame size=0 */
 2477 0c90 0895      		ret
 2478               	/* epilogue end (size=1) */
 2479               	/* function initial_tx_queue size 1 (0) */
 2481               	.Lscope27:
 2493               	.global	add_pending_queue
 2495               	add_pending_queue:
 2497               	.LM235:
 2498               	/* prologue: frame size=3 */
 2499 0c92 AF92      		push r10
 2500 0c94 BF92      		push r11
 2501 0c96 CF92      		push r12
 2502 0c98 DF92      		push r13
 2503 0c9a EF92      		push r14
 2504 0c9c FF92      		push r15
 2505 0c9e 0F93      		push r16
 2506 0ca0 1F93      		push r17
 2507 0ca2 CF93      		push r28
 2508 0ca4 DF93      		push r29
 2509 0ca6 CDB7      		in r28,__SP_L__
 2510 0ca8 DEB7      		in r29,__SP_H__
 2511 0caa 2397      		sbiw r28,3
 2512 0cac 0FB6      		in __tmp_reg__,__SREG__
 2513 0cae F894      		cli
 2514 0cb0 DEBF      		out __SP_H__,r29
 2515 0cb2 0FBE      		out __SREG__,__tmp_reg__
 2516 0cb4 CDBF      		out __SP_L__,r28
 2517               	/* prologue end (size=18) */
 2518 0cb6 E82E      		mov r14,r24
 2519 0cb8 4983      		std Y+1,r20
 2520 0cba 5A83      		std Y+2,r21
 2521 0cbc 6B83      		std Y+3,r22
 2522 0cbe FAA4      		ldd r15,Y+42
 2523 0cc0 0BA5      		ldd r16,Y+43
 2524 0cc2 1CA5      		ldd r17,Y+44
 2525 0cc4 ADA4      		ldd r10,Y+45
 2526 0cc6 BEA4      		ldd r11,Y+46
 2527 0cc8 CFA8      		ldd r12,Y+55
 2528 0cca D8AC      		ldd r13,Y+56
 2530               	.LM236:
 2531 0ccc 82E3      		ldi r24,lo8(50)
 2532 0cce 90E0      		ldi r25,hi8(50)
 2533 0cd0 0E94 0000 		call malloc
 2534 0cd4 AC01      		movw r20,r24
 2536               	.LM237:
 2537 0cd6 4C5F      		subi r20,lo8(-(4))
 2538 0cd8 5F4F      		sbci r21,hi8(-(4))
 2539 0cda 83E0      		ldi r24,lo8(3)
 2540 0cdc 9E01      		movw r18,r28
 2541 0cde 2F5F      		subi r18,lo8(-(1))
 2542 0ce0 3F4F      		sbci r19,hi8(-(1))
 2543 0ce2 DA01      		movw r26,r20
 2544 0ce4 F901      		movw r30,r18
 2545 0ce6 0190      		ld __tmp_reg__,Z+
 2546 0ce8 0D92      		st X+,__tmp_reg__
 2547 0cea 8A95      		dec r24
 2548 0cec E1F7      		brne .-8
 2549 0cee 4450      		subi r20,lo8(-(-4))
 2550 0cf0 5040      		sbci r21,hi8(-(-4))
 2552               	.LM238:
 2553 0cf2 FA01      		movw r30,r20
 2554 0cf4 E382      		std Z+3,r14
 2556               	.LM239:
 2557 0cf6 F5A6      		std Z+45,r15
 2559               	.LM240:
 2560 0cf8 06A7      		std Z+46,r16
 2561 0cfa 17A7      		std Z+47,r17
 2563               	.LM241:
 2564 0cfc 8091 0000 		lds r24,mac_pib_data+43
 2565 0d00 9091 0000 		lds r25,(mac_pib_data+43)+1
 2566 0d04 8183      		std Z+1,r24
 2567 0d06 9283      		std Z+2,r25
 2569               	.LM242:
 2570 0d08 B782      		std Z+7,r11
 2572               	.LM243:
 2573 0d0a 8481      		ldd r24,Z+4
 2574 0d0c 9927      		clr r25
 2575 0d0e 8770      		andi r24,lo8(7)
 2576 0d10 9070      		andi r25,hi8(7)
 2577 0d12 0197      		sbiw r24,1
 2578 0d14 E9F0      		breq .L152
 2579 0d16 BA01      		movw r22,r20
 2580 0d18 655F      		subi r22,lo8(-(11))
 2581 0d1a 7F4F      		sbci r23,hi8(-(11))
 2582 0d1c 9E01      		movw r18,r28
 2583 0d1e 215D      		subi r18,lo8(-(47))
 2584 0d20 3F4F      		sbci r19,hi8(-(47))
 2586               	.LM244:
 2587 0d22 BB20      		tst r11
 2588 0d24 61F0      		breq .L153
 2590               	.LM245:
 2591 0d26 A286      		std Z+10,r10
 2593               	.LM246:
 2594 0d28 88E0      		ldi r24,lo8(8)
 2595 0d2a DB01      		movw r26,r22
 2596 0d2c F901      		movw r30,r18
 2597 0d2e 0190      		ld __tmp_reg__,Z+
 2598 0d30 0D92      		st X+,__tmp_reg__
 2599 0d32 8A95      		dec r24
 2600 0d34 E1F7      		brne .-8
 2602               	.LM247:
 2603 0d36 FA01      		movw r30,r20
 2604 0d38 C086      		std Z+8,r12
 2605 0d3a D186      		std Z+9,r13
 2606 0d3c 09C0      		rjmp .L152
 2607               	.L153:
 2609               	.LM248:
 2610 0d3e FA01      		movw r30,r20
 2611 0d40 A286      		std Z+10,r10
 2613               	.LM249:
 2614 0d42 88E0      		ldi r24,lo8(8)
 2615 0d44 DB01      		movw r26,r22
 2616 0d46 F901      		movw r30,r18
 2617 0d48 0190      		ld __tmp_reg__,Z+
 2618 0d4a 0D92      		st X+,__tmp_reg__
 2619 0d4c 8A95      		dec r24
 2620 0d4e E1F7      		brne .-8
 2621               	.L152:
 2623               	.LM250:
 2624 0d50 8DE0      		ldi r24,lo8(13)
 2625 0d52 4D5E      		subi r20,lo8(-(19))
 2626 0d54 5F4F      		sbci r21,hi8(-(19))
 2627 0d56 DA01      		movw r26,r20
 2628 0d58 E0E1      		ldi r30,lo8(16)
 2629 0d5a F0E0      		ldi r31,hi8(16)
 2630 0d5c EC0F      		add r30,r28
 2631 0d5e FD1F      		adc r31,r29
 2632 0d60 982F      		mov r25,r24
 2633 0d62 0190      		ld __tmp_reg__,Z+
 2634 0d64 0D92      		st X+,__tmp_reg__
 2635 0d66 9A95      		dec r25
 2636 0d68 E1F7      		brne .-8
 2638               	.LM251:
 2639 0d6a 435F      		subi r20,lo8(-(13))
 2640 0d6c 5F4F      		sbci r21,hi8(-(13))
 2641 0d6e FE01      		movw r30,r28
 2642 0d70 7D96      		adiw r30,29
 2643 0d72 DA01      		movw r26,r20
 2644 0d74 0190      		ld __tmp_reg__,Z+
 2645 0d76 0D92      		st X+,__tmp_reg__
 2646 0d78 8A95      		dec r24
 2647 0d7a E1F7      		brne .-8
 2648 0d7c 4052      		subi r20,lo8(-(-32))
 2649 0d7e 5040      		sbci r21,hi8(-(-32))
 2651               	.LM252:
 2652 0d80 81E0      		ldi r24,lo8(1)
 2653 0d82 FA01      		movw r30,r20
 2654 0d84 8083      		st Z,r24
 2656               	.LM253:
 2657 0d86 10AA      		std Z+48,__zero_reg__
 2658 0d88 11AA      		std Z+49,__zero_reg__
 2660               	.LM254:
 2661 0d8a E091 0000 		lds r30,tail_of_indirect_pending_buffer
 2662 0d8e F091 0000 		lds r31,(tail_of_indirect_pending_buffer)+1
 2663 0d92 3097      		sbiw r30,0
 2664 0d94 29F4      		brne .L155
 2666               	.LM255:
 2667 0d96 5093 0000 		sts (head_of_indirect_pending_buffer)+1,r21
 2668 0d9a 4093 0000 		sts head_of_indirect_pending_buffer,r20
 2669 0d9e 02C0      		rjmp .L159
 2670               	.L155:
 2672               	.LM256:
 2673 0da0 40AB      		std Z+48,r20
 2674 0da2 51AB      		std Z+49,r21
 2675               	.L159:
 2677               	.LM257:
 2678 0da4 5093 0000 		sts (tail_of_indirect_pending_buffer)+1,r21
 2679 0da8 4093 0000 		sts tail_of_indirect_pending_buffer,r20
 2681               	.LM258:
 2682 0dac 8889      		ldd r24,Y+16
 2683 0dae 8230      		cpi r24,lo8(2)
 2684 0db0 99F4      		brne .L157
 2686               	.LM259:
 2687 0db2 2091 0000 		lds r18,mac_tx_beacon+3
 2688 0db6 E22F      		mov r30,r18
 2689 0db8 FF27      		clr r31
 2690 0dba EE0F      		add r30,r30
 2691 0dbc FF1F      		adc r31,r31
 2692 0dbe E050      		subi r30,lo8(-(mac_tx_beacon))
 2693 0dc0 F040      		sbci r31,hi8(-(mac_tx_beacon))
 2694 0dc2 898D      		ldd r24,Y+25
 2695 0dc4 9A8D      		ldd r25,Y+26
 2696 0dc6 8583      		std Z+5,r24
 2697 0dc8 9683      		std Z+6,r25
 2698 0dca 2F5F      		subi r18,lo8(-(1))
 2699 0dcc 2093 0000 		sts mac_tx_beacon+3,r18
 2701               	.LM260:
 2702 0dd0 8091 0000 		lds r24,mac_tx_beacon+2
 2703 0dd4 8F5F      		subi r24,lo8(-(1))
 2704 0dd6 18C0      		rjmp .L160
 2705               	.L157:
 2707               	.LM261:
 2708 0dd8 8091 0000 		lds r24,mac_tx_beacon+4
 2709 0ddc E82F      		mov r30,r24
 2710 0dde FF27      		clr r31
 2711 0de0 93E0      		ldi r25,3
 2712 0de2 EE0F      	1:	lsl r30
 2713 0de4 FF1F      		rol r31
 2714 0de6 9A95      		dec r25
 2715 0de8 E1F7      		brne 1b
 2716 0dea E050      		subi r30,lo8(-(mac_tx_beacon+9))
 2717 0dec F040      		sbci r31,hi8(-(mac_tx_beacon+9))
 2718 0dee 98E0      		ldi r25,lo8(8)
 2719 0df0 DE01      		movw r26,r28
 2720 0df2 5196      		adiw r26,17
 2721 0df4 0D90      		ld __tmp_reg__,X+
 2722 0df6 0192      		st Z+,__tmp_reg__
 2723 0df8 9A95      		dec r25
 2724 0dfa E1F7      		brne .-8
 2725 0dfc 8F5F      		subi r24,lo8(-(1))
 2726 0dfe 8093 0000 		sts mac_tx_beacon+4,r24
 2728               	.LM262:
 2729 0e02 8091 0000 		lds r24,mac_tx_beacon+2
 2730 0e06 805F      		subi r24,lo8(-(16))
 2731               	.L160:
 2732 0e08 8093 0000 		sts mac_tx_beacon+2,r24
 2734               	.LM263:
 2735 0e0c 8091 0000 		lds r24,current_pending_num
 2736 0e10 8F5F      		subi r24,lo8(-(1))
 2737 0e12 8093 0000 		sts current_pending_num,r24
 2738               	/* epilogue: frame size=3 */
 2739 0e16 2396      		adiw r28,3
 2740 0e18 0FB6      		in __tmp_reg__,__SREG__
 2741 0e1a F894      		cli
 2742 0e1c DEBF      		out __SP_H__,r29
 2743 0e1e 0FBE      		out __SREG__,__tmp_reg__
 2744 0e20 CDBF      		out __SP_L__,r28
 2745 0e22 DF91      		pop r29
 2746 0e24 CF91      		pop r28
 2747 0e26 1F91      		pop r17
 2748 0e28 0F91      		pop r16
 2749 0e2a FF90      		pop r15
 2750 0e2c EF90      		pop r14
 2751 0e2e DF90      		pop r13
 2752 0e30 CF90      		pop r12
 2753 0e32 BF90      		pop r11
 2754 0e34 AF90      		pop r10
 2755 0e36 0895      		ret
 2756               	/* epilogue end (size=17) */
 2757               	/* function add_pending_queue size 212 (177) */
 2767               	.Lscope28:
 2773               	.global	mlmeAssociateResponse
 2775               	mlmeAssociateResponse:
 2777               	.LM264:
 2778               	/* prologue: frame size=37 */
 2779 0e38 EF92      		push r14
 2780 0e3a 0F93      		push r16
 2781 0e3c 1F93      		push r17
 2782 0e3e CF93      		push r28
 2783 0e40 DF93      		push r29
 2784 0e42 CDB7      		in r28,__SP_L__
 2785 0e44 DEB7      		in r29,__SP_H__
 2786 0e46 A597      		sbiw r28,37
 2787 0e48 0FB6      		in __tmp_reg__,__SREG__
 2788 0e4a F894      		cli
 2789 0e4c DEBF      		out __SP_H__,r29
 2790 0e4e 0FBE      		out __SREG__,__tmp_reg__
 2791 0e50 CDBF      		out __SP_L__,r28
 2792               	/* prologue end (size=13) */
 2793 0e52 2983      		std Y+1,r18
 2794 0e54 3A83      		std Y+2,r19
 2795 0e56 4B83      		std Y+3,r20
 2796 0e58 5C83      		std Y+4,r21
 2797 0e5a 6D83      		std Y+5,r22
 2798 0e5c 7E83      		std Y+6,r23
 2799 0e5e 8F83      		std Y+7,r24
 2800 0e60 9887      		std Y+8,r25
 2802               	.LM265:
 2803 0e62 83E0      		ldi r24,lo8(3)
 2804 0e64 8C87      		std Y+12,r24
 2806               	.LM266:
 2807 0e66 898F      		std Y+25,r24
 2809               	.LM267:
 2810 0e68 8091 0000 		lds r24,mac_pib_data+28
 2811 0e6c 9091 0000 		lds r25,(mac_pib_data+28)+1
 2812 0e70 8F8B      		std Y+23,r24
 2813 0e72 988F      		std Y+24,r25
 2815               	.LM268:
 2816 0e74 8CA3      		std Y+36,r24
 2817 0e76 9DA3      		std Y+37,r25
 2819               	.LM269:
 2820 0e78 98E0      		ldi r25,lo8(8)
 2821 0e7a A0E0      		ldi r26,lo8(mac_pib_data+34)
 2822 0e7c B0E0      		ldi r27,hi8(mac_pib_data+34)
 2823 0e7e FE01      		movw r30,r28
 2824 0e80 7A96      		adiw r30,26
 2825 0e82 292F      		mov r18,r25
 2826 0e84 0D90      		ld __tmp_reg__,X+
 2827 0e86 0192      		st Z+,__tmp_reg__
 2828 0e88 2A95      		dec r18
 2829 0e8a E1F7      		brne .-8
 2831               	.LM270:
 2832 0e8c AE01      		movw r20,r28
 2833 0e8e 4F5F      		subi r20,lo8(-(1))
 2834 0e90 5F4F      		sbci r21,hi8(-(1))
 2835 0e92 FE01      		movw r30,r28
 2836 0e94 3D96      		adiw r30,13
 2837 0e96 DA01      		movw r26,r20
 2838 0e98 292F      		mov r18,r25
 2839 0e9a 0D90      		ld __tmp_reg__,X+
 2840 0e9c 0192      		st Z+,__tmp_reg__
 2841 0e9e 2A95      		dec r18
 2842 0ea0 E1F7      		brne .-8
 2844               	.LM271:
 2845 0ea2 83E2      		ldi r24,lo8(35)
 2846 0ea4 8987      		std Y+9,r24
 2848               	.LM272:
 2849 0ea6 8CEC      		ldi r24,lo8(-52)
 2850 0ea8 8A87      		std Y+10,r24
 2852               	.LM273:
 2853 0eaa 8091 0000 		lds r24,mac_current_state
 2854 0eae 8031      		cpi r24,lo8(16)
 2855 0eb0 09F0      		breq .+2
 2856 0eb2 4FC0      		rjmp .L161
 2858               	.LM274:
 2859 0eb4 8091 0000 		lds r24,current_pending_num
 2860 0eb8 8230      		cpi r24,lo8(2)
 2861 0eba 08F0      		brlo .+2
 2862 0ebc 4AC0      		rjmp .L161
 2864               	.LM275:
 2865 0ebe 1F93      		push r17
 2866 0ec0 0F93      		push r16
 2867 0ec2 ADB7      		in r26,__SP_L__
 2868 0ec4 BEB7      		in r27,__SP_H__
 2869 0ec6 1897      		sbiw r26,8
 2870 0ec8 0FB6      		in __tmp_reg__,__SREG__
 2871 0eca F894      		cli
 2872 0ecc BEBF      		out __SP_H__,r27
 2873 0ece 0FBE      		out __SREG__,__tmp_reg__
 2874 0ed0 ADBF      		out __SP_L__,r26
 2875 0ed2 EDB7      		in r30,__SP_L__
 2876 0ed4 FEB7      		in r31,__SP_H__
 2877 0ed6 3196      		adiw r30,1
 2878 0ed8 DA01      		movw r26,r20
 2879 0eda 0D90      		ld __tmp_reg__,X+
 2880 0edc 0192      		st Z+,__tmp_reg__
 2881 0ede 9A95      		dec r25
 2882 0ee0 E1F7      		brne .-8
 2883 0ee2 81E0      		ldi r24,lo8(1)
 2884 0ee4 8F93      		push r24
 2885 0ee6 EF92      		push r14
 2886 0ee8 1F92      		push __zero_reg__
 2887 0eea 1F92      		push __zero_reg__
 2888 0eec 1F92      		push __zero_reg__
 2889 0eee 2DB7      		in r18,__SP_L__
 2890 0ef0 3EB7      		in r19,__SP_H__
 2891 0ef2 2D50      		subi r18,lo8(-(-13))
 2892 0ef4 3040      		sbci r19,hi8(-(-13))
 2893 0ef6 0FB6      		in __tmp_reg__,__SREG__
 2894 0ef8 F894      		cli
 2895 0efa 3EBF      		out __SP_H__,r19
 2896 0efc 0FBE      		out __SREG__,__tmp_reg__
 2897 0efe 2DBF      		out __SP_L__,r18
 2898 0f00 ADB7      		in r26,__SP_L__
 2899 0f02 BEB7      		in r27,__SP_H__
 2900 0f04 1196      		adiw r26,1
 2901 0f06 8DE0      		ldi r24,lo8(13)
 2902 0f08 FE01      		movw r30,r28
 2903 0f0a 7996      		adiw r30,25
 2904 0f0c 382F      		mov r19,r24
 2905 0f0e 0190      		ld __tmp_reg__,Z+
 2906 0f10 0D92      		st X+,__tmp_reg__
 2907 0f12 3A95      		dec r19
 2908 0f14 E1F7      		brne .-8
 2909 0f16 ADB7      		in r26,__SP_L__
 2910 0f18 BEB7      		in r27,__SP_H__
 2911 0f1a 1D97      		sbiw r26,13
 2912 0f1c 0FB6      		in __tmp_reg__,__SREG__
 2913 0f1e F894      		cli
 2914 0f20 BEBF      		out __SP_H__,r27
 2915 0f22 0FBE      		out __SREG__,__tmp_reg__
 2916 0f24 ADBF      		out __SP_L__,r26
 2917 0f26 1196      		adiw r26,1
 2918 0f28 FE01      		movw r30,r28
 2919 0f2a 3C96      		adiw r30,12
 2920 0f2c 0190      		ld __tmp_reg__,Z+
 2921 0f2e 0D92      		st X+,__tmp_reg__
 2922 0f30 8A95      		dec r24
 2923 0f32 E1F7      		brne .-8
 2924 0f34 4985      		ldd r20,Y+9
 2925 0f36 5A85      		ldd r21,Y+10
 2926 0f38 6B85      		ldd r22,Y+11
 2927 0f3a 80E0      		ldi r24,lo8(0)
 2928 0f3c 0E94 0000 		call add_pending_queue
 2929 0f40 2DB7      		in r18,__SP_L__
 2930 0f42 3EB7      		in r19,__SP_H__
 2931 0f44 275D      		subi r18,lo8(-(41))
 2932 0f46 3F4F      		sbci r19,hi8(-(41))
 2933 0f48 0FB6      		in __tmp_reg__,__SREG__
 2934 0f4a F894      		cli
 2935 0f4c 3EBF      		out __SP_H__,r19
 2936 0f4e 0FBE      		out __SREG__,__tmp_reg__
 2937 0f50 2DBF      		out __SP_L__,r18
 2938               	.L161:
 2939               	/* epilogue: frame size=37 */
 2940 0f52 A596      		adiw r28,37
 2941 0f54 0FB6      		in __tmp_reg__,__SREG__
 2942 0f56 F894      		cli
 2943 0f58 DEBF      		out __SP_H__,r29
 2944 0f5a 0FBE      		out __SREG__,__tmp_reg__
 2945 0f5c CDBF      		out __SP_L__,r28
 2946 0f5e DF91      		pop r29
 2947 0f60 CF91      		pop r28
 2948 0f62 1F91      		pop r17
 2949 0f64 0F91      		pop r16
 2950 0f66 EF90      		pop r14
 2951 0f68 0895      		ret
 2952               	/* epilogue end (size=12) */
 2953               	/* function mlmeAssociateResponse size 153 (128) */
 2960               	.Lscope29:
 2961               		.data
 2962               	.LC10:
 2963 01ee 0A2D 2D2D 		.string	"\n---allocated short addr is %04x---\n"
 2963      616C 6C6F 
 2963      6361 7465 
 2963      6420 7368 
 2963      6F72 7420 
 2964               		.text
 2967               	.global	mlmeAssociateIndication
 2969               	mlmeAssociateIndication:
 2971               	.LM276:
 2972               	/* prologue: frame size=11 */
 2973 0f6a CF92      		push r12
 2974 0f6c EF92      		push r14
 2975 0f6e FF92      		push r15
 2976 0f70 0F93      		push r16
 2977 0f72 1F93      		push r17
 2978 0f74 CF93      		push r28
 2979 0f76 DF93      		push r29
 2980 0f78 CDB7      		in r28,__SP_L__
 2981 0f7a DEB7      		in r29,__SP_H__
 2982 0f7c 2B97      		sbiw r28,11
 2983 0f7e 0FB6      		in __tmp_reg__,__SREG__
 2984 0f80 F894      		cli
 2985 0f82 DEBF      		out __SP_H__,r29
 2986 0f84 0FBE      		out __SREG__,__tmp_reg__
 2987 0f86 CDBF      		out __SP_L__,r28
 2988               	/* prologue end (size=15) */
 2989 0f88 E982      		std Y+1,r14
 2990 0f8a FA82      		std Y+2,r15
 2991 0f8c 0B83      		std Y+3,r16
 2992 0f8e 1C83      		std Y+4,r17
 2993 0f90 2D83      		std Y+5,r18
 2994 0f92 3E83      		std Y+6,r19
 2995 0f94 4F83      		std Y+7,r20
 2996 0f96 5887      		std Y+8,r21
 2997 0f98 6987      		std Y+9,r22
 2998 0f9a 7A87      		std Y+10,r23
 2999 0f9c 8B87      		std Y+11,r24
 3001               	.LM277:
 3002 0f9e 2E2D      		mov r18,r14
 3003 0fa0 3F2D      		mov r19,r15
 3004 0fa2 402F      		mov r20,r16
 3005 0fa4 512F      		mov r21,r17
 3006 0fa6 6D81      		ldd r22,Y+5
 3007 0fa8 7E81      		ldd r23,Y+6
 3008 0faa 8F81      		ldd r24,Y+7
 3009 0fac 9885      		ldd r25,Y+8
 3010 0fae 0E94 0000 		call short_address_allocate_req
 3011 0fb2 8C01      		movw r16,r24
 3013               	.LM278:
 3014 0fb4 9F93      		push r25
 3015 0fb6 8F93      		push r24
 3016 0fb8 80E0      		ldi r24,lo8(.LC10)
 3017 0fba 90E0      		ldi r25,hi8(.LC10)
 3018 0fbc 9F93      		push r25
 3019 0fbe 8F93      		push r24
 3020 0fc0 0E94 0000 		call printf
 3022               	.LM279:
 3023 0fc4 80E0      		ldi r24,lo8(0)
 3025               	.LM280:
 3026 0fc6 C82E      		mov r12,r24
 3027 0fc8 E82E      		mov r14,r24
 3028 0fca 2981      		ldd r18,Y+1
 3029 0fcc 3A81      		ldd r19,Y+2
 3030 0fce 4B81      		ldd r20,Y+3
 3031 0fd0 5C81      		ldd r21,Y+4
 3032 0fd2 6D81      		ldd r22,Y+5
 3033 0fd4 7E81      		ldd r23,Y+6
 3034 0fd6 8F81      		ldd r24,Y+7
 3035 0fd8 9885      		ldd r25,Y+8
 3036 0fda 0E94 0000 		call mlmeAssociateResponse
 3037 0fde 0F90      		pop __tmp_reg__
 3038 0fe0 0F90      		pop __tmp_reg__
 3039 0fe2 0F90      		pop __tmp_reg__
 3040 0fe4 0F90      		pop __tmp_reg__
 3041               	/* epilogue: frame size=11 */
 3042 0fe6 2B96      		adiw r28,11
 3043 0fe8 0FB6      		in __tmp_reg__,__SREG__
 3044 0fea F894      		cli
 3045 0fec DEBF      		out __SP_H__,r29
 3046 0fee 0FBE      		out __SREG__,__tmp_reg__
 3047 0ff0 CDBF      		out __SP_L__,r28
 3048 0ff2 DF91      		pop r29
 3049 0ff4 CF91      		pop r28
 3050 0ff6 1F91      		pop r17
 3051 0ff8 0F91      		pop r16
 3052 0ffa FF90      		pop r15
 3053 0ffc EF90      		pop r14
 3054 0ffe CF90      		pop r12
 3055 1000 0895      		ret
 3056               	/* epilogue end (size=14) */
 3057               	/* function mlmeAssociateIndication size 76 (47) */
 3063               	.Lscope30:
 3064               		.data
 3065               	.LC11:
 3066 0213 0A6D 656D 		.string	"\nmemory allocated failure\n"
 3066      6F72 7920 
 3066      616C 6C6F 
 3066      6361 7465 
 3066      6420 6661 
 3067               		.text
 3073               	.global	add_to_rx_buffer
 3075               	add_to_rx_buffer:
 3077               	.LM281:
 3078               	/* prologue: frame size=0 */
 3079 1002 AF92      		push r10
 3080 1004 BF92      		push r11
 3081 1006 CF92      		push r12
 3082 1008 DF92      		push r13
 3083 100a EF92      		push r14
 3084 100c FF92      		push r15
 3085 100e 0F93      		push r16
 3086 1010 1F93      		push r17
 3087 1012 CF93      		push r28
 3088 1014 DF93      		push r29
 3089               	/* prologue end (size=10) */
 3090 1016 B82E      		mov r11,r24
 3091 1018 6B01      		movw r12,r22
 3092 101a A42E      		mov r10,r20
 3093 101c 7801      		movw r14,r16
 3094 101e 8901      		movw r16,r18
 3096               	.LM282:
 3097 1020 8AE0      		ldi r24,lo8(10)
 3098 1022 90E0      		ldi r25,hi8(10)
 3099 1024 0E94 0000 		call malloc
 3100 1028 EC01      		movw r28,r24
 3102               	.LM283:
 3103 102a 0097      		sbiw r24,0
 3104 102c 29F4      		brne .L167
 3106               	.LM284:
 3107 102e 80E0      		ldi r24,lo8(.LC11)
 3108 1030 90E0      		ldi r25,hi8(.LC11)
 3109 1032 0E94 0000 		call error
 3110 1036 1BC0      		rjmp .L171
 3111               	.L167:
 3113               	.LM285:
 3114 1038 B882      		st Y,r11
 3116               	.LM286:
 3117 103a C982      		std Y+1,r12
 3118 103c DA82      		std Y+2,r13
 3120               	.LM287:
 3121 103e AB82      		std Y+3,r10
 3123               	.LM288:
 3124 1040 EC82      		std Y+4,r14
 3125 1042 FD82      		std Y+5,r15
 3126 1044 0E83      		std Y+6,r16
 3127 1046 1F83      		std Y+7,r17
 3129               	.LM289:
 3130 1048 1886      		std Y+8,__zero_reg__
 3131 104a 1986      		std Y+9,__zero_reg__
 3133               	.LM290:
 3134 104c E091 0000 		lds r30,tail_of_rx_buffer
 3135 1050 F091 0000 		lds r31,(tail_of_rx_buffer)+1
 3136 1054 3097      		sbiw r30,0
 3137 1056 29F4      		brne .L168
 3139               	.LM291:
 3140 1058 9093 0000 		sts (head_of_rx_buffer)+1,r25
 3141 105c 8093 0000 		sts head_of_rx_buffer,r24
 3142 1060 02C0      		rjmp .L170
 3143               	.L168:
 3145               	.LM292:
 3146 1062 8087      		std Z+8,r24
 3147 1064 9187      		std Z+9,r25
 3148               	.L170:
 3150               	.LM293:
 3151 1066 D093 0000 		sts (tail_of_rx_buffer)+1,r29
 3152 106a C093 0000 		sts tail_of_rx_buffer,r28
 3153               	.L171:
 3155               	.LM294:
 3156 106e CE01      		movw r24,r28
 3157               	/* epilogue: frame size=0 */
 3158 1070 DF91      		pop r29
 3159 1072 CF91      		pop r28
 3160 1074 1F91      		pop r17
 3161 1076 0F91      		pop r16
 3162 1078 FF90      		pop r15
 3163 107a EF90      		pop r14
 3164 107c DF90      		pop r13
 3165 107e CF90      		pop r12
 3166 1080 BF90      		pop r11
 3167 1082 AF90      		pop r10
 3168 1084 0895      		ret
 3169               	/* epilogue end (size=11) */
 3170               	/* function add_to_rx_buffer size 66 (45) */
 3175               	.Lscope31:
 3181               	.global	PD_DATA_indication
 3183               	PD_DATA_indication:
 3185               	.LM295:
 3186               	/* prologue: frame size=0 */
 3187 1086 0F93      		push r16
 3188 1088 1F93      		push r17
 3189               	/* prologue end (size=2) */
 3190 108a 942F      		mov r25,r20
 3191 108c A901      		movw r20,r18
 3192 108e 9801      		movw r18,r16
 3194               	.LM296:
 3195 1090 8901      		movw r16,r18
 3196 1092 9A01      		movw r18,r20
 3197 1094 492F      		mov r20,r25
 3198 1096 0E94 0000 		call add_to_rx_buffer
 3199 109a 9093 0000 		sts (head_of_rx_buffer)+1,r25
 3200 109e 8093 0000 		sts head_of_rx_buffer,r24
 3202               	.LM297:
 3203 10a2 80E0      		ldi r24,lo8(pm(mac_get_received_frame))
 3204 10a4 90E0      		ldi r25,hi8(pm(mac_get_received_frame))
 3205 10a6 0E94 0000 		call OS_post
 3206               	/* epilogue: frame size=0 */
 3207 10aa 1F91      		pop r17
 3208 10ac 0F91      		pop r16
 3209 10ae 0895      		ret
 3210               	/* epilogue end (size=3) */
 3211               	/* function PD_DATA_indication size 21 (16) */
 3213               	.Lscope32:
 3221               	.global	add_tx_queue
 3223               	add_tx_queue:
 3225               	.LM298:
 3226               	/* prologue: frame size=0 */
 3227 10b0 BF92      		push r11
 3228 10b2 CF92      		push r12
 3229 10b4 DF92      		push r13
 3230 10b6 EF92      		push r14
 3231 10b8 FF92      		push r15
 3232 10ba 0F93      		push r16
 3233 10bc 1F93      		push r17
 3234 10be CF93      		push r28
 3235 10c0 DF93      		push r29
 3236               	/* prologue end (size=9) */
 3237 10c2 F82E      		mov r15,r24
 3238 10c4 6B01      		movw r12,r22
 3239 10c6 142F      		mov r17,r20
 3240 10c8 B22E      		mov r11,r18
 3242               	.LM299:
 3243 10ca 8BE0      		ldi r24,lo8(11)
 3244 10cc 90E0      		ldi r25,hi8(11)
 3245 10ce 0E94 0000 		call malloc
 3246 10d2 EC01      		movw r28,r24
 3248               	.LM300:
 3249 10d4 892B      		or r24,r25
 3250 10d6 29F4      		brne .L174
 3252               	.LM301:
 3253 10d8 80E0      		ldi r24,lo8(.LC11)
 3254 10da 90E0      		ldi r25,hi8(.LC11)
 3255 10dc 0E94 0000 		call error
 3256 10e0 1DC0      		rjmp .L178
 3257               	.L174:
 3259               	.LM302:
 3260 10e2 CF82      		std Y+7,r12
 3261 10e4 D886      		std Y+8,r13
 3263               	.LM303:
 3264 10e6 1983      		std Y+1,r17
 3266               	.LM304:
 3267 10e8 82E0      		ldi r24,lo8(2)
 3268 10ea 8C83      		std Y+4,r24
 3270               	.LM305:
 3271 10ec FD82      		std Y+5,r15
 3273               	.LM306:
 3274 10ee 0B83      		std Y+3,r16
 3276               	.LM307:
 3277 10f0 1986      		std Y+9,__zero_reg__
 3278 10f2 1A86      		std Y+10,__zero_reg__
 3280               	.LM308:
 3281 10f4 B882      		st Y,r11
 3283               	.LM309:
 3284 10f6 1A82      		std Y+2,__zero_reg__
 3286               	.LM310:
 3287 10f8 EE82      		std Y+6,r14
 3289               	.LM311:
 3290 10fa E091 0000 		lds r30,tail_of_tx_buffer
 3291 10fe F091 0000 		lds r31,(tail_of_tx_buffer)+1
 3292 1102 3097      		sbiw r30,0
 3293 1104 29F4      		brne .L175
 3295               	.LM312:
 3296 1106 D093 0000 		sts (head_of_tx_buffer)+1,r29
 3297 110a C093 0000 		sts head_of_tx_buffer,r28
 3298 110e 02C0      		rjmp .L177
 3299               	.L175:
 3301               	.LM313:
 3302 1110 C187      		std Z+9,r28
 3303 1112 D287      		std Z+10,r29
 3304               	.L177:
 3306               	.LM314:
 3307 1114 D093 0000 		sts (tail_of_tx_buffer)+1,r29
 3308 1118 C093 0000 		sts tail_of_tx_buffer,r28
 3309               	.L178:
 3311               	.LM315:
 3312 111c CE01      		movw r24,r28
 3313               	/* epilogue: frame size=0 */
 3314 111e DF91      		pop r29
 3315 1120 CF91      		pop r28
 3316 1122 1F91      		pop r17
 3317 1124 0F91      		pop r16
 3318 1126 FF90      		pop r15
 3319 1128 EF90      		pop r14
 3320 112a DF90      		pop r13
 3321 112c CF90      		pop r12
 3322 112e BF90      		pop r11
 3323 1130 0895      		ret
 3324               	/* epilogue end (size=10) */
 3325               	/* function add_tx_queue size 65 (46) */
 3330               	.Lscope33:
 3334               	.global	direct_transmit
 3336               	direct_transmit:
 3338               	.LM316:
 3339               	/* prologue: frame size=0 */
 3340 1132 CF92      		push r12
 3341 1134 DF92      		push r13
 3342 1136 EF92      		push r14
 3343 1138 FF92      		push r15
 3344 113a 0F93      		push r16
 3345 113c 1F93      		push r17
 3346               	/* prologue end (size=6) */
 3347 113e 6B01      		movw r12,r22
 3349               	.LM317:
 3350 1140 0E94 0000 		call PD_DATA_request
 3351 1144 7B01      		movw r14,r22
 3352 1146 8C01      		movw r16,r24
 3354               	.LM318:
 3355 1148 C601      		movw r24,r12
 3356 114a 0E94 0000 		call free
 3358               	.LM319:
 3359 114e C801      		movw r24,r16
 3360 1150 B701      		movw r22,r14
 3361               	/* epilogue: frame size=0 */
 3362 1152 1F91      		pop r17
 3363 1154 0F91      		pop r16
 3364 1156 FF90      		pop r15
 3365 1158 EF90      		pop r14
 3366 115a DF90      		pop r13
 3367 115c CF90      		pop r12
 3368 115e 0895      		ret
 3369               	/* epilogue end (size=7) */
 3370               	/* function direct_transmit size 23 (10) */
 3375               	.Lscope34:
 3376               		.data
 3377               	.LC12:
 3378 022e 0A72 6573 		.string	"\nreserved dst address mode is used!\n"
 3378      6572 7665 
 3378      6420 6473 
 3378      7420 6164 
 3378      6472 6573 
 3379               	.LC13:
 3380 0253 0A72 6573 		.string	"\nreserved src address mode is used!\n"
 3380      6572 7665 
 3380      6420 7372 
 3380      6320 6164 
 3380      6472 6573 
 3381               	.LC14:
 3382 0278 0A74 7820 		.string	"\ntx buffer is full\n"
 3382      6275 6666 
 3382      6572 2069 
 3382      7320 6675 
 3382      6C6C 0A00 
 3383               		.text
 3385               	.global	mac_frame_send
 3387               	mac_frame_send:
 3389               	.LM320:
 3390               	/* prologue: frame size=0 */
 3391 1160 CF92      		push r12
 3392 1162 DF92      		push r13
 3393 1164 EF92      		push r14
 3394 1166 FF92      		push r15
 3395 1168 0F93      		push r16
 3396 116a 1F93      		push r17
 3397 116c CF93      		push r28
 3398 116e DF93      		push r29
 3399               	/* prologue end (size=8) */
 3401               	.LM321:
 3402 1170 86E6      		ldi r24,lo8(102)
 3403 1172 90E0      		ldi r25,hi8(102)
 3404 1174 0E94 0000 		call malloc
 3405 1178 EC01      		movw r28,r24
 3407               	.LM322:
 3408 117a 8091 0000 		lds r24,mac_tx_current_frame+36
 3409 117e 8883      		st Y,r24
 3411               	.LM323:
 3412 1180 9091 0000 		lds r25,mac_tx_current_frame+37
 3413 1184 9983      		std Y+1,r25
 3415               	.LM324:
 3416 1186 D090 0000 		lds r13,mac_tx_current_frame+28
 3417 118a DA82      		std Y+2,r13
 3418 118c 13E0      		ldi r17,lo8(3)
 3420               	.LM325:
 3421 118e F82E      		mov r15,r24
 3422 1190 F694      		lsr r15
 3423 1192 F694      		lsr r15
 3424 1194 F694      		lsr r15
 3425 1196 F694      		lsr r15
 3426 1198 F694      		lsr r15
 3427 119a 81E0      		ldi r24,lo8(1)
 3428 119c F822      		and r15,r24
 3430               	.LM326:
 3431 119e 00E0      		ldi r16,lo8(0)
 3433               	.LM327:
 3434 11a0 C090 0000 		lds r12,mac_rx_current_frame+30
 3436               	.LM328:
 3437 11a4 E92F      		mov r30,r25
 3438 11a6 FF27      		clr r31
 3439 11a8 EC70      		andi r30,lo8(12)
 3440 11aa F070      		andi r31,hi8(12)
 3441 11ac E830      		cpi r30,8
 3442 11ae F105      		cpc r31,__zero_reg__
 3443 11b0 59F1      		breq .L183
 3445               	.LM329:
 3446 11b2 E930      		cpi r30,9
 3447 11b4 F105      		cpc r31,__zero_reg__
 3448 11b6 1CF4      		brge .L186
 3449 11b8 3497      		sbiw r30,4
 3450 11ba A1F1      		breq .L185
 3451 11bc 37C0      		rjmp .L181
 3452               	.L186:
 3453 11be EC30      		cpi r30,12
 3454 11c0 F105      		cpc r31,__zero_reg__
 3455 11c2 A1F5      		brne .L181
 3457               	.LM330:
 3458 11c4 8091 0000 		lds r24,mac_tx_current_frame+11
 3459 11c8 8B83      		std Y+3,r24
 3461               	.LM331:
 3462 11ca 8091 0000 		lds r24,mac_tx_current_frame+12
 3463 11ce 8C83      		std Y+4,r24
 3465               	.LM332:
 3466 11d0 8091 0000 		lds r24,mac_tx_current_frame+1
 3467 11d4 8D83      		std Y+5,r24
 3469               	.LM333:
 3470 11d6 8091 0000 		lds r24,mac_tx_current_frame+2
 3471 11da 8E83      		std Y+6,r24
 3473               	.LM334:
 3474 11dc 8091 0000 		lds r24,mac_tx_current_frame+3
 3475 11e0 8F83      		std Y+7,r24
 3477               	.LM335:
 3478 11e2 8091 0000 		lds r24,mac_tx_current_frame+4
 3479 11e6 8887      		std Y+8,r24
 3481               	.LM336:
 3482 11e8 8091 0000 		lds r24,mac_tx_current_frame+5
 3483 11ec 8987      		std Y+9,r24
 3485               	.LM337:
 3486 11ee 8091 0000 		lds r24,mac_tx_current_frame+6
 3487 11f2 8A87      		std Y+10,r24
 3489               	.LM338:
 3490 11f4 8091 0000 		lds r24,mac_tx_current_frame+7
 3491 11f8 8B87      		std Y+11,r24
 3493               	.LM339:
 3494 11fa EC0F      		add r30,r28
 3495 11fc FD1F      		adc r31,r29
 3496 11fe 8091 0000 		lds r24,mac_tx_current_frame+8
 3497 1202 8083      		st Z,r24
 3498 1204 1DE0      		ldi r17,lo8(13)
 3500               	.LM340:
 3501 1206 12C0      		rjmp .L181
 3502               	.L183:
 3504               	.LM341:
 3505 1208 8091 0000 		lds r24,mac_tx_current_frame+11
 3506 120c 8B83      		std Y+3,r24
 3508               	.LM342:
 3509 120e 8091 0000 		lds r24,mac_tx_current_frame+12
 3510 1212 8C83      		std Y+4,r24
 3512               	.LM343:
 3513 1214 8091 0000 		lds r24,mac_tx_current_frame+9
 3514 1218 8D83      		std Y+5,r24
 3516               	.LM344:
 3517 121a 8091 0000 		lds r24,mac_tx_current_frame+10
 3518 121e 8E83      		std Y+6,r24
 3519 1220 17E0      		ldi r17,lo8(7)
 3521               	.LM345:
 3522 1222 04C0      		rjmp .L181
 3523               	.L185:
 3525               	.LM346:
 3526 1224 80E0      		ldi r24,lo8(.LC12)
 3527 1226 90E0      		ldi r25,hi8(.LC12)
 3528 1228 0E94 0000 		call error
 3529               	.L181:
 3531               	.LM347:
 3532 122c 8091 0000 		lds r24,mac_tx_current_frame+37
 3533 1230 9927      		clr r25
 3534 1232 807C      		andi r24,lo8(192)
 3535 1234 9070      		andi r25,hi8(192)
 3536 1236 8038      		cpi r24,128
 3537 1238 9105      		cpc r25,__zero_reg__
 3538 123a 09F4      		brne .+2
 3539 123c 51C0      		rjmp .L189
 3540 123e 8138      		cpi r24,129
 3541 1240 9105      		cpc r25,__zero_reg__
 3542 1242 2CF4      		brge .L192
 3543 1244 8034      		cpi r24,64
 3544 1246 9105      		cpc r25,__zero_reg__
 3545 1248 09F4      		brne .+2
 3546 124a 67C0      		rjmp .L191
 3547 124c 6AC0      		rjmp .L187
 3548               	.L192:
 3549 124e 803C      		cpi r24,192
 3550 1250 9105      		cpc r25,__zero_reg__
 3551 1252 09F0      		breq .+2
 3552 1254 66C0      		rjmp .L187
 3554               	.LM348:
 3555 1256 FE01      		movw r30,r28
 3556 1258 E10F      		add r30,r17
 3557 125a F11D      		adc r31,__zero_reg__
 3558 125c 8091 0000 		lds r24,mac_tx_current_frame+24
 3559 1260 8083      		st Z,r24
 3560 1262 1F5F      		subi r17,lo8(-(1))
 3562               	.LM349:
 3563 1264 FE01      		movw r30,r28
 3564 1266 E10F      		add r30,r17
 3565 1268 F11D      		adc r31,__zero_reg__
 3566 126a 8091 0000 		lds r24,mac_tx_current_frame+25
 3567 126e 8083      		st Z,r24
 3568 1270 1F5F      		subi r17,lo8(-(1))
 3570               	.LM350:
 3571 1272 FE01      		movw r30,r28
 3572 1274 E10F      		add r30,r17
 3573 1276 F11D      		adc r31,__zero_reg__
 3574 1278 8091 0000 		lds r24,mac_tx_current_frame+14
 3575 127c 8083      		st Z,r24
 3576 127e 1F5F      		subi r17,lo8(-(1))
 3578               	.LM351:
 3579 1280 FE01      		movw r30,r28
 3580 1282 E10F      		add r30,r17
 3581 1284 F11D      		adc r31,__zero_reg__
 3582 1286 8091 0000 		lds r24,mac_tx_current_frame+15
 3583 128a 8083      		st Z,r24
 3584 128c 1F5F      		subi r17,lo8(-(1))
 3586               	.LM352:
 3587 128e FE01      		movw r30,r28
 3588 1290 E10F      		add r30,r17
 3589 1292 F11D      		adc r31,__zero_reg__
 3590 1294 8091 0000 		lds r24,mac_tx_current_frame+16
 3591 1298 8083      		st Z,r24
 3592 129a 1F5F      		subi r17,lo8(-(1))
 3594               	.LM353:
 3595 129c FE01      		movw r30,r28
 3596 129e E10F      		add r30,r17
 3597 12a0 F11D      		adc r31,__zero_reg__
 3598 12a2 8091 0000 		lds r24,mac_tx_current_frame+17
 3599 12a6 8083      		st Z,r24
 3600 12a8 1F5F      		subi r17,lo8(-(1))
 3602               	.LM354:
 3603 12aa FE01      		movw r30,r28
 3604 12ac E10F      		add r30,r17
 3605 12ae F11D      		adc r31,__zero_reg__
 3606 12b0 8091 0000 		lds r24,mac_tx_current_frame+18
 3607 12b4 8083      		st Z,r24
 3608 12b6 1F5F      		subi r17,lo8(-(1))
 3610               	.LM355:
 3611 12b8 FE01      		movw r30,r28
 3612 12ba E10F      		add r30,r17
 3613 12bc F11D      		adc r31,__zero_reg__
 3614 12be 8091 0000 		lds r24,mac_tx_current_frame+19
 3615 12c2 8083      		st Z,r24
 3616 12c4 1F5F      		subi r17,lo8(-(1))
 3618               	.LM356:
 3619 12c6 FE01      		movw r30,r28
 3620 12c8 E10F      		add r30,r17
 3621 12ca F11D      		adc r31,__zero_reg__
 3622 12cc 8091 0000 		lds r24,mac_tx_current_frame+20
 3623 12d0 8083      		st Z,r24
 3624 12d2 1F5F      		subi r17,lo8(-(1))
 3626               	.LM357:
 3627 12d4 FE01      		movw r30,r28
 3628 12d6 E10F      		add r30,r17
 3629 12d8 F11D      		adc r31,__zero_reg__
 3630 12da 8091 0000 		lds r24,mac_tx_current_frame+21
 3631 12de 1AC0      		rjmp .L236
 3632               	.L189:
 3634               	.LM358:
 3635 12e0 FE01      		movw r30,r28
 3636 12e2 E10F      		add r30,r17
 3637 12e4 F11D      		adc r31,__zero_reg__
 3638 12e6 8091 0000 		lds r24,mac_tx_current_frame+24
 3639 12ea 8083      		st Z,r24
 3640 12ec 1F5F      		subi r17,lo8(-(1))
 3642               	.LM359:
 3643 12ee FE01      		movw r30,r28
 3644 12f0 E10F      		add r30,r17
 3645 12f2 F11D      		adc r31,__zero_reg__
 3646 12f4 8091 0000 		lds r24,mac_tx_current_frame+25
 3647 12f8 8083      		st Z,r24
 3648 12fa 1F5F      		subi r17,lo8(-(1))
 3650               	.LM360:
 3651 12fc FE01      		movw r30,r28
 3652 12fe E10F      		add r30,r17
 3653 1300 F11D      		adc r31,__zero_reg__
 3654 1302 8091 0000 		lds r24,mac_tx_current_frame+22
 3655 1306 8083      		st Z,r24
 3656 1308 1F5F      		subi r17,lo8(-(1))
 3658               	.LM361:
 3659 130a FE01      		movw r30,r28
 3660 130c E10F      		add r30,r17
 3661 130e F11D      		adc r31,__zero_reg__
 3662 1310 8091 0000 		lds r24,mac_tx_current_frame+23
 3663               	.L236:
 3664 1314 8083      		st Z,r24
 3665 1316 1F5F      		subi r17,lo8(-(1))
 3667               	.LM362:
 3668 1318 04C0      		rjmp .L187
 3669               	.L191:
 3671               	.LM363:
 3672 131a 80E0      		ldi r24,lo8(.LC13)
 3673 131c 90E0      		ldi r25,hi8(.LC13)
 3674 131e 0E94 0000 		call error
 3675               	.L187:
 3677               	.LM364:
 3678 1322 8091 0000 		lds r24,mac_tx_current_frame+26
 3679 1326 9927      		clr r25
 3680 1328 8130      		cpi r24,1
 3681 132a 9105      		cpc r25,__zero_reg__
 3682 132c 09F4      		brne .+2
 3683 132e B5C0      		rjmp .L207
 3684 1330 8230      		cpi r24,2
 3685 1332 9105      		cpc r25,__zero_reg__
 3686 1334 1CF4      		brge .L225
 3687 1336 892B      		or r24,r25
 3688 1338 29F0      		breq .L194
 3689 133a 2EC1      		rjmp .L193
 3690               	.L225:
 3691 133c 0397      		sbiw r24,3
 3692 133e 09F4      		brne .+2
 3693 1340 C2C0      		rjmp .L213
 3694 1342 2AC1      		rjmp .L193
 3695               	.L194:
 3697               	.LM365:
 3698 1344 FE01      		movw r30,r28
 3699 1346 E10F      		add r30,r17
 3700 1348 F11D      		adc r31,__zero_reg__
 3701 134a 8091 0000 		lds r24,mac_tx_current_frame+144
 3702 134e 8083      		st Z,r24
 3703 1350 1F5F      		subi r17,lo8(-(1))
 3705               	.LM366:
 3706 1352 FE01      		movw r30,r28
 3707 1354 E10F      		add r30,r17
 3708 1356 F11D      		adc r31,__zero_reg__
 3709 1358 8091 0000 		lds r24,mac_tx_current_frame+145
 3710 135c 8083      		st Z,r24
 3711 135e 1F5F      		subi r17,lo8(-(1))
 3713               	.LM367:
 3714 1360 FE01      		movw r30,r28
 3715 1362 E10F      		add r30,r17
 3716 1364 F11D      		adc r31,__zero_reg__
 3717 1366 1082      		st Z,__zero_reg__
 3718 1368 1F5F      		subi r17,lo8(-(1))
 3720               	.LM368:
 3721 136a FE01      		movw r30,r28
 3722 136c E10F      		add r30,r17
 3723 136e F11D      		adc r31,__zero_reg__
 3724 1370 8091 0000 		lds r24,mac_tx_current_frame+146
 3725 1374 8083      		st Z,r24
 3726 1376 1F5F      		subi r17,lo8(-(1))
 3728               	.LM369:
 3729 1378 8091 0000 		lds r24,mac_tx_current_frame+147
 3730 137c 8823      		tst r24
 3731 137e A9F0      		breq .L229
 3732 1380 982F      		mov r25,r24
 3733 1382 A0E0      		ldi r26,lo8(mac_tx_current_frame+149)
 3734 1384 B0E0      		ldi r27,hi8(mac_tx_current_frame+149)
 3735               	.L198:
 3737               	.LM370:
 3738 1386 FE01      		movw r30,r28
 3739 1388 E10F      		add r30,r17
 3740 138a F11D      		adc r31,__zero_reg__
 3741 138c 8C91      		ld r24,X
 3742 138e 8083      		st Z,r24
 3743 1390 1F5F      		subi r17,lo8(-(1))
 3745               	.LM371:
 3746 1392 9E01      		movw r18,r28
 3747 1394 210F      		add r18,r17
 3748 1396 311D      		adc r19,__zero_reg__
 3749 1398 FD01      		movw r30,r26
 3750 139a 8181      		ldd r24,Z+1
 3751 139c F901      		movw r30,r18
 3752 139e 8083      		st Z,r24
 3753 13a0 1F5F      		subi r17,lo8(-(1))
 3755               	.LM372:
 3756 13a2 9150      		subi r25,lo8(-(-1))
 3757 13a4 1296      		adiw r26,2
 3758 13a6 9923      		tst r25
 3759 13a8 71F7      		brne .L198
 3760               	.L229:
 3762               	.LM373:
 3763 13aa 8091 0000 		lds r24,mac_tx_current_frame+148
 3764 13ae 8823      		tst r24
 3765 13b0 09F4      		brne .+2
 3766 13b2 46C0      		rjmp .L231
 3767 13b4 A0E0      		ldi r26,lo8(mac_tx_current_frame+153)
 3768 13b6 B0E0      		ldi r27,hi8(mac_tx_current_frame+153)
 3769 13b8 982F      		mov r25,r24
 3770               	.L202:
 3772               	.LM374:
 3773 13ba FE01      		movw r30,r28
 3774 13bc E10F      		add r30,r17
 3775 13be F11D      		adc r31,__zero_reg__
 3776 13c0 8C91      		ld r24,X
 3777 13c2 8083      		st Z,r24
 3778 13c4 1F5F      		subi r17,lo8(-(1))
 3780               	.LM375:
 3781 13c6 9E01      		movw r18,r28
 3782 13c8 210F      		add r18,r17
 3783 13ca 311D      		adc r19,__zero_reg__
 3784 13cc FD01      		movw r30,r26
 3785 13ce 8181      		ldd r24,Z+1
 3786 13d0 F901      		movw r30,r18
 3787 13d2 8083      		st Z,r24
 3788 13d4 1F5F      		subi r17,lo8(-(1))
 3790               	.LM376:
 3791 13d6 9E01      		movw r18,r28
 3792 13d8 210F      		add r18,r17
 3793 13da 311D      		adc r19,__zero_reg__
 3794 13dc FD01      		movw r30,r26
 3795 13de 8281      		ldd r24,Z+2
 3796 13e0 F901      		movw r30,r18
 3797 13e2 8083      		st Z,r24
 3798 13e4 1F5F      		subi r17,lo8(-(1))
 3800               	.LM377:
 3801 13e6 9E01      		movw r18,r28
 3802 13e8 210F      		add r18,r17
 3803 13ea 311D      		adc r19,__zero_reg__
 3804 13ec FD01      		movw r30,r26
 3805 13ee 8381      		ldd r24,Z+3
 3806 13f0 F901      		movw r30,r18
 3807 13f2 8083      		st Z,r24
 3808 13f4 1F5F      		subi r17,lo8(-(1))
 3810               	.LM378:
 3811 13f6 9E01      		movw r18,r28
 3812 13f8 210F      		add r18,r17
 3813 13fa 311D      		adc r19,__zero_reg__
 3814 13fc FD01      		movw r30,r26
 3815 13fe 8481      		ldd r24,Z+4
 3816 1400 F901      		movw r30,r18
 3817 1402 8083      		st Z,r24
 3818 1404 1F5F      		subi r17,lo8(-(1))
 3820               	.LM379:
 3821 1406 9E01      		movw r18,r28
 3822 1408 210F      		add r18,r17
 3823 140a 311D      		adc r19,__zero_reg__
 3824 140c FD01      		movw r30,r26
 3825 140e 8581      		ldd r24,Z+5
 3826 1410 F901      		movw r30,r18
 3827 1412 8083      		st Z,r24
 3828 1414 1F5F      		subi r17,lo8(-(1))
 3830               	.LM380:
 3831 1416 9E01      		movw r18,r28
 3832 1418 210F      		add r18,r17
 3833 141a 311D      		adc r19,__zero_reg__
 3834 141c FD01      		movw r30,r26
 3835 141e 8681      		ldd r24,Z+6
 3836 1420 F901      		movw r30,r18
 3837 1422 8083      		st Z,r24
 3838 1424 1F5F      		subi r17,lo8(-(1))
 3840               	.LM381:
 3841 1426 9E01      		movw r18,r28
 3842 1428 210F      		add r18,r17
 3843 142a 311D      		adc r19,__zero_reg__
 3844 142c FD01      		movw r30,r26
 3845 142e 8781      		ldd r24,Z+7
 3846 1430 F901      		movw r30,r18
 3847 1432 8083      		st Z,r24
 3848 1434 1F5F      		subi r17,lo8(-(1))
 3850               	.LM382:
 3851 1436 9150      		subi r25,lo8(-(-1))
 3852 1438 1896      		adiw r26,8
 3853 143a 9923      		tst r25
 3854 143c 09F0      		breq .+2
 3855 143e BDCF      		rjmp .L202
 3856               	.L231:
 3858               	.LM383:
 3859 1440 FE01      		movw r30,r28
 3860 1442 E10F      		add r30,r17
 3861 1444 F11D      		adc r31,__zero_reg__
 3862 1446 8091 0000 		lds r24,mac_tx_current_frame+40
 3863 144a 8083      		st Z,r24
 3864 144c 1F5F      		subi r17,lo8(-(1))
 3866               	.LM384:
 3867 144e 8823      		tst r24
 3868 1450 59F0      		breq .L233
 3869 1452 A0E0      		ldi r26,lo8(mac_tx_current_frame+41)
 3870 1454 B0E0      		ldi r27,hi8(mac_tx_current_frame+41)
 3871 1456 982F      		mov r25,r24
 3872               	.L206:
 3874               	.LM385:
 3875 1458 FE01      		movw r30,r28
 3876 145a E10F      		add r30,r17
 3877 145c F11D      		adc r31,__zero_reg__
 3878 145e 8D91      		ld r24,X+
 3879 1460 8083      		st Z,r24
 3880 1462 1F5F      		subi r17,lo8(-(1))
 3882               	.LM386:
 3883 1464 9150      		subi r25,lo8(-(-1))
 3884 1466 C1F7      		brne .L206
 3885               	.L233:
 3887               	.LM387:
 3888 1468 BE01      		movw r22,r28
 3889 146a 812F      		mov r24,r17
 3890 146c 0E94 0000 		call direct_transmit
 3891 1470 DC01      		movw r26,r24
 3892 1472 CB01      		movw r24,r22
 3893 1474 8093 0000 		sts last_beacon_tx_timestamp,r24
 3894 1478 9093 0000 		sts (last_beacon_tx_timestamp)+1,r25
 3895 147c A093 0000 		sts (last_beacon_tx_timestamp)+2,r26
 3896 1480 B093 0000 		sts (last_beacon_tx_timestamp)+3,r27
 3898               	.LM388:
 3899 1484 1092 0000 		sts phy_channel_state,__zero_reg__
 3901               	.LM389:
 3902 1488 80E1      		ldi r24,lo8(16)
 3903 148a 8093 0000 		sts mac_current_state,r24
 3905               	.LM390:
 3906 148e 86E0      		ldi r24,lo8(6)
 3907 1490 0E94 0000 		call PLME_SET_TRX_STATE_request
 3909               	.LM391:
 3910 1494 80E0      		ldi r24,lo8(pm(beacon_frame_tx_timing))
 3911 1496 90E0      		ldi r25,hi8(pm(beacon_frame_tx_timing))
 3912 1498 B2C0      		rjmp .L238
 3913               	.L207:
 3915               	.LM392:
 3916 149a FE01      		movw r30,r28
 3917 149c E10F      		add r30,r17
 3918 149e F11D      		adc r31,__zero_reg__
 3919 14a0 8091 0000 		lds r24,mac_tx_current_frame+39
 3920 14a4 8083      		st Z,r24
 3921 14a6 1F5F      		subi r17,lo8(-(1))
 3923               	.LM393:
 3924 14a8 8823      		tst r24
 3925 14aa 09F4      		brne .+2
 3926 14ac 75C0      		rjmp .L193
 3927 14ae A0E0      		ldi r26,lo8(mac_tx_current_frame+41)
 3928 14b0 B0E0      		ldi r27,hi8(mac_tx_current_frame+41)
 3929 14b2 982F      		mov r25,r24
 3930               	.L211:
 3932               	.LM394:
 3933 14b4 FE01      		movw r30,r28
 3934 14b6 E10F      		add r30,r17
 3935 14b8 F11D      		adc r31,__zero_reg__
 3936 14ba 8D91      		ld r24,X+
 3937 14bc 8083      		st Z,r24
 3938 14be 1F5F      		subi r17,lo8(-(1))
 3940               	.LM395:
 3941 14c0 9150      		subi r25,lo8(-(-1))
 3942 14c2 C1F7      		brne .L211
 3944               	.LM396:
 3945 14c4 69C0      		rjmp .L193
 3946               	.L213:
 3948               	.LM397:
 3949 14c6 FE01      		movw r30,r28
 3950 14c8 E10F      		add r30,r17
 3951 14ca F11D      		adc r31,__zero_reg__
 3952 14cc 8091 0000 		lds r24,mac_tx_current_frame+27
 3953 14d0 8083      		st Z,r24
 3954 14d2 1F5F      		subi r17,lo8(-(1))
 3956               	.LM398:
 3957 14d4 082F      		mov r16,r24
 3959               	.LM399:
 3960 14d6 9927      		clr r25
 3961 14d8 8230      		cpi r24,2
 3962 14da 9105      		cpc r25,__zero_reg__
 3963 14dc 91F0      		breq .L216
 3964 14de 8330      		cpi r24,3
 3965 14e0 9105      		cpc r25,__zero_reg__
 3966 14e2 1CF4      		brge .L224
 3967 14e4 0197      		sbiw r24,1
 3968 14e6 39F0      		breq .L215
 3969 14e8 57C0      		rjmp .L193
 3970               	.L224:
 3971 14ea 8330      		cpi r24,3
 3972 14ec 9105      		cpc r25,__zero_reg__
 3973 14ee E9F0      		breq .L217
 3974 14f0 0897      		sbiw r24,8
 3975 14f2 09F1      		breq .L222
 3976 14f4 51C0      		rjmp .L193
 3977               	.L215:
 3979               	.LM400:
 3980 14f6 FE01      		movw r30,r28
 3981 14f8 E10F      		add r30,r17
 3982 14fa F11D      		adc r31,__zero_reg__
 3983 14fc 8091 0000 		lds r24,mac_tx_current_frame+143
 3984 1500 49C0      		rjmp .L237
 3985               	.L216:
 3987               	.LM401:
 3988 1502 FE01      		movw r30,r28
 3989 1504 E10F      		add r30,r17
 3990 1506 F11D      		adc r31,__zero_reg__
 3991 1508 8091 0000 		lds r24,mac_tx_current_frame+169
 3992 150c 8083      		st Z,r24
 3993 150e 1F5F      		subi r17,lo8(-(1))
 3995               	.LM402:
 3996 1510 FE01      		movw r30,r28
 3997 1512 E10F      		add r30,r17
 3998 1514 F11D      		adc r31,__zero_reg__
 3999 1516 8091 0000 		lds r24,mac_tx_current_frame+170
 4000 151a 8083      		st Z,r24
 4001 151c 1F5F      		subi r17,lo8(-(1))
 4003               	.LM403:
 4004 151e FE01      		movw r30,r28
 4005 1520 E10F      		add r30,r17
 4006 1522 F11D      		adc r31,__zero_reg__
 4007 1524 8091 0000 		lds r24,mac_tx_current_frame+171
 4008 1528 35C0      		rjmp .L237
 4009               	.L217:
 4011               	.LM404:
 4012 152a FE01      		movw r30,r28
 4013 152c E10F      		add r30,r17
 4014 152e F11D      		adc r31,__zero_reg__
 4015 1530 8091 0000 		lds r24,mac_tx_current_frame+172
 4016 1534 2FC0      		rjmp .L237
 4017               	.L222:
 4019               	.LM405:
 4020 1536 FE01      		movw r30,r28
 4021 1538 E10F      		add r30,r17
 4022 153a F11D      		adc r31,__zero_reg__
 4023 153c 8091 0000 		lds r24,mac_tx_current_frame+173
 4024 1540 8083      		st Z,r24
 4025 1542 1F5F      		subi r17,lo8(-(1))
 4027               	.LM406:
 4028 1544 FE01      		movw r30,r28
 4029 1546 E10F      		add r30,r17
 4030 1548 F11D      		adc r31,__zero_reg__
 4031 154a 8091 0000 		lds r24,mac_tx_current_frame+174
 4032 154e 8083      		st Z,r24
 4033 1550 1F5F      		subi r17,lo8(-(1))
 4035               	.LM407:
 4036 1552 FE01      		movw r30,r28
 4037 1554 E10F      		add r30,r17
 4038 1556 F11D      		adc r31,__zero_reg__
 4039 1558 8091 0000 		lds r24,mac_tx_current_frame+175
 4040 155c 8083      		st Z,r24
 4041 155e 1F5F      		subi r17,lo8(-(1))
 4043               	.LM408:
 4044 1560 FE01      		movw r30,r28
 4045 1562 E10F      		add r30,r17
 4046 1564 F11D      		adc r31,__zero_reg__
 4047 1566 8091 0000 		lds r24,mac_tx_current_frame+176
 4048 156a 8083      		st Z,r24
 4049 156c 1F5F      		subi r17,lo8(-(1))
 4051               	.LM409:
 4052 156e FE01      		movw r30,r28
 4053 1570 E10F      		add r30,r17
 4054 1572 F11D      		adc r31,__zero_reg__
 4055 1574 8091 0000 		lds r24,mac_tx_current_frame+177
 4056 1578 8083      		st Z,r24
 4057 157a 1F5F      		subi r17,lo8(-(1))
 4059               	.LM410:
 4060 157c FE01      		movw r30,r28
 4061 157e E10F      		add r30,r17
 4062 1580 F11D      		adc r31,__zero_reg__
 4063 1582 8091 0000 		lds r24,mac_tx_current_frame+178
 4064 1586 8083      		st Z,r24
 4065 1588 1F5F      		subi r17,lo8(-(1))
 4067               	.LM411:
 4068 158a FE01      		movw r30,r28
 4069 158c E10F      		add r30,r17
 4070 158e F11D      		adc r31,__zero_reg__
 4071 1590 8091 0000 		lds r24,mac_tx_current_frame+179
 4072               	.L237:
 4073 1594 8083      		st Z,r24
 4074 1596 1F5F      		subi r17,lo8(-(1))
 4075               	.L193:
 4077               	.LM412:
 4078 1598 E02E      		mov r14,r16
 4079 159a 0D2D      		mov r16,r13
 4080 159c 2F2D      		mov r18,r15
 4081 159e 4C2D      		mov r20,r12
 4082 15a0 BE01      		movw r22,r28
 4083 15a2 812F      		mov r24,r17
 4084 15a4 0E94 0000 		call add_tx_queue
 4085 15a8 8C01      		movw r16,r24
 4087               	.LM413:
 4088 15aa 9093 0000 		sts (head_of_tx_buffer)+1,r25
 4089 15ae 8093 0000 		sts head_of_tx_buffer,r24
 4091               	.LM414:
 4092 15b2 8091 0000 		lds r24,Parameter_list+10
 4093 15b6 282F      		mov r18,r24
 4094 15b8 3327      		clr r19
 4095 15ba 8091 0000 		lds r24,Parameter_list+11
 4096 15be E82F      		mov r30,r24
 4097 15c0 FF27      		clr r31
 4098 15c2 EF01      		movw r28,r30
 4099 15c4 2196      		adiw r28,1
 4100 15c6 CE01      		movw r24,r28
 4101 15c8 65E0      		ldi r22,lo8(5)
 4102 15ca 70E0      		ldi r23,hi8(5)
 4103 15cc 0E94 0000 		call __divmodhi4
 4104 15d0 2817      		cp r18,r24
 4105 15d2 3907      		cpc r19,r25
 4106 15d4 29F4      		brne .L226
 4108               	.LM415:
 4109 15d6 80E0      		ldi r24,lo8(.LC14)
 4110 15d8 90E0      		ldi r25,hi8(.LC14)
 4111 15da 0E94 0000 		call error
 4112 15de 11C0      		rjmp .L180
 4113               	.L226:
 4115               	.LM416:
 4116 15e0 EE0F      		add r30,r30
 4117 15e2 FF1F      		adc r31,r31
 4118 15e4 E050      		subi r30,lo8(-(Parameter_list))
 4119 15e6 F040      		sbci r31,hi8(-(Parameter_list))
 4120 15e8 0083      		st Z,r16
 4121 15ea 1183      		std Z+1,r17
 4123               	.LM417:
 4124 15ec CE01      		movw r24,r28
 4125 15ee 65E0      		ldi r22,lo8(5)
 4126 15f0 70E0      		ldi r23,hi8(5)
 4127 15f2 0E94 0000 		call __divmodhi4
 4128 15f6 8093 0000 		sts Parameter_list+11,r24
 4130               	.LM418:
 4131 15fa 80E0      		ldi r24,lo8(pm(transmit_with_csmaca))
 4132 15fc 90E0      		ldi r25,hi8(pm(transmit_with_csmaca))
 4133               	.L238:
 4134 15fe 0E94 0000 		call OS_post
 4135               	.L180:
 4136               	/* epilogue: frame size=0 */
 4137 1602 DF91      		pop r29
 4138 1604 CF91      		pop r28
 4139 1606 1F91      		pop r17
 4140 1608 0F91      		pop r16
 4141 160a FF90      		pop r15
 4142 160c EF90      		pop r14
 4143 160e DF90      		pop r13
 4144 1610 CF90      		pop r12
 4145 1612 0895      		ret
 4146               	/* epilogue end (size=9) */
 4147               	/* function mac_frame_send size 608 (591) */
 4158               	.Lscope35:
 4161               	.global	beacon_frame_send
 4163               	beacon_frame_send:
 4165               	.LM419:
 4166               	/* prologue: frame size=0 */
 4167 1614 CF93      		push r28
 4168 1616 DF93      		push r29
 4169               	/* prologue end (size=2) */
 4171               	.LM420:
 4172 1618 1092 0000 		sts mac_tx_current_frame+26,__zero_reg__
 4174               	.LM421:
 4175 161c 9091 0000 		lds r25,mac_pib_data+13
 4176 1620 292F      		mov r18,r25
 4177 1622 9F5F      		subi r25,lo8(-(1))
 4178 1624 9093 0000 		sts mac_pib_data+13,r25
 4179 1628 2093 0000 		sts mac_tx_current_frame+28,r18
 4181               	.LM422:
 4182 162c 1092 0000 		sts mac_tx_current_frame,__zero_reg__
 4184               	.LM423:
 4185 1630 2091 0000 		lds r18,mac_pib_data+28
 4186 1634 3091 0000 		lds r19,(mac_pib_data+28)+1
 4187 1638 3093 0000 		sts (mac_tx_current_frame+24)+1,r19
 4188 163c 2093 0000 		sts mac_tx_current_frame+24,r18
 4190               	.LM424:
 4191 1640 8823      		tst r24
 4192 1642 61F0      		breq .L240
 4194               	.LM425:
 4195 1644 82E0      		ldi r24,lo8(2)
 4196 1646 8093 0000 		sts mac_tx_current_frame+13,r24
 4198               	.LM426:
 4199 164a 8091 0000 		lds r24,mac_pib_data+32
 4200 164e 9091 0000 		lds r25,(mac_pib_data+32)+1
 4201 1652 9093 0000 		sts (mac_tx_current_frame+22)+1,r25
 4202 1656 8093 0000 		sts mac_tx_current_frame+22,r24
 4203 165a 0CC0      		rjmp .L241
 4204               	.L240:
 4206               	.LM427:
 4207 165c 83E0      		ldi r24,lo8(3)
 4208 165e 8093 0000 		sts mac_tx_current_frame+13,r24
 4210               	.LM428:
 4211 1662 88E0      		ldi r24,lo8(8)
 4212 1664 A0E0      		ldi r26,lo8(mac_pib_data+34)
 4213 1666 B0E0      		ldi r27,hi8(mac_pib_data+34)
 4214 1668 E0E0      		ldi r30,lo8(mac_tx_current_frame+14)
 4215 166a F0E0      		ldi r31,hi8(mac_tx_current_frame+14)
 4216 166c 0D90      		ld __tmp_reg__,X+
 4217 166e 0192      		st Z+,__tmp_reg__
 4218 1670 8A95      		dec r24
 4219 1672 E1F7      		brne .-8
 4220               	.L241:
 4222               	.LM429:
 4223 1674 8091 0000 		lds r24,mac_tx_beacon
 4224 1678 9091 0000 		lds r25,(mac_tx_beacon)+1
 4225 167c 9093 0000 		sts (mac_tx_current_frame+144)+1,r25
 4226 1680 8093 0000 		sts mac_tx_current_frame+144,r24
 4228               	.LM430:
 4229 1684 8091 0000 		lds r24,mac_tx_beacon+2
 4230 1688 8093 0000 		sts mac_tx_current_frame+146,r24
 4232               	.LM431:
 4233 168c 8091 0000 		lds r24,mac_tx_beacon+3
 4234 1690 8093 0000 		sts mac_tx_current_frame+147,r24
 4236               	.LM432:
 4237 1694 8823      		tst r24
 4238 1696 59F0      		breq .L255
 4239 1698 282F      		mov r18,r24
 4240 169a A0E0      		ldi r26,lo8(mac_tx_current_frame+149)
 4241 169c B0E0      		ldi r27,hi8(mac_tx_current_frame+149)
 4242 169e E0E0      		ldi r30,lo8(mac_tx_beacon+5)
 4243 16a0 F0E0      		ldi r31,hi8(mac_tx_beacon+5)
 4244               	.L245:
 4246               	.LM433:
 4247 16a2 8191      		ld r24,Z+
 4248 16a4 9191      		ld r25,Z+
 4249 16a6 8D93      		st X+,r24
 4250 16a8 9D93      		st X+,r25
 4252               	.LM434:
 4253 16aa 2150      		subi r18,lo8(-(-1))
 4254 16ac D1F7      		brne .L245
 4255               	.L255:
 4257               	.LM435:
 4258 16ae 8091 0000 		lds r24,mac_tx_beacon+4
 4259 16b2 8093 0000 		sts mac_tx_current_frame+148,r24
 4261               	.LM436:
 4262 16b6 8823      		tst r24
 4263 16b8 91F0      		breq .L257
 4264 16ba 98E0      		ldi r25,lo8(8)
 4265 16bc A0E0      		ldi r26,lo8(mac_tx_current_frame+153)
 4266 16be B0E0      		ldi r27,hi8(mac_tx_current_frame+153)
 4267 16c0 40E0      		ldi r20,lo8(mac_tx_beacon+9)
 4268 16c2 50E0      		ldi r21,hi8(mac_tx_beacon+9)
 4269 16c4 282F      		mov r18,r24
 4270               	.L249:
 4272               	.LM437:
 4273 16c6 ED01      		movw r28,r26
 4274 16c8 FA01      		movw r30,r20
 4275 16ca 892F      		mov r24,r25
 4276 16cc 0190      		ld __tmp_reg__,Z+
 4277 16ce 0992      		st Y+,__tmp_reg__
 4278 16d0 8A95      		dec r24
 4279 16d2 E1F7      		brne .-8
 4280 16d4 485F      		subi r20,lo8(-(8))
 4281 16d6 5F4F      		sbci r21,hi8(-(8))
 4282 16d8 1896      		adiw r26,8
 4284               	.LM438:
 4285 16da 2150      		subi r18,lo8(-(-1))
 4286 16dc A1F7      		brne .L249
 4287               	.L257:
 4289               	.LM439:
 4290 16de 8091 0000 		lds r24,mac_tx_beacon+25
 4291 16e2 8093 0000 		sts mac_tx_current_frame+40,r24
 4293               	.LM440:
 4294 16e6 8823      		tst r24
 4295 16e8 49F0      		breq .L259
 4296 16ea A0E0      		ldi r26,lo8(mac_tx_current_frame+41)
 4297 16ec B0E0      		ldi r27,hi8(mac_tx_current_frame+41)
 4298 16ee E0E0      		ldi r30,lo8(mac_tx_beacon+26)
 4299 16f0 F0E0      		ldi r31,hi8(mac_tx_beacon+26)
 4300 16f2 282F      		mov r18,r24
 4301               	.L253:
 4303               	.LM441:
 4304 16f4 8191      		ld r24,Z+
 4305 16f6 8D93      		st X+,r24
 4307               	.LM442:
 4308 16f8 2150      		subi r18,lo8(-(-1))
 4309 16fa E1F7      		brne .L253
 4310               	.L259:
 4312               	.LM443:
 4313 16fc 1092 0000 		sts mac_tx_current_frame+36,__zero_reg__
 4315               	.LM444:
 4316 1700 8091 0000 		lds r24,mac_tx_current_frame+13
 4317 1704 8295      		swap r24
 4318 1706 880F      		lsl r24
 4319 1708 880F      		lsl r24
 4320 170a 807C      		andi r24,0xc0
 4321 170c 8093 0000 		sts mac_tx_current_frame+37,r24
 4323               	.LM445:
 4324 1710 80E0      		ldi r24,lo8(pm(pending_frame_handle))
 4325 1712 90E0      		ldi r25,hi8(pm(pending_frame_handle))
 4326 1714 0E94 0000 		call OS_post
 4328               	.LM446:
 4329 1718 0E94 0000 		call mac_frame_send
 4330               	/* epilogue: frame size=0 */
 4331 171c DF91      		pop r29
 4332 171e CF91      		pop r28
 4333 1720 0895      		ret
 4334               	/* epilogue end (size=3) */
 4335               	/* function beacon_frame_send size 138 (133) */
 4340               	.Lscope36:
 4346               	.global	associate_response_frame_send
 4348               	associate_response_frame_send:
 4350               	.LM447:
 4351               	/* prologue: frame size=8 */
 4352 1722 CF92      		push r12
 4353 1724 DF92      		push r13
 4354 1726 EF92      		push r14
 4355 1728 FF92      		push r15
 4356 172a 0F93      		push r16
 4357 172c 1F93      		push r17
 4358 172e CF93      		push r28
 4359 1730 DF93      		push r29
 4360 1732 CDB7      		in r28,__SP_L__
 4361 1734 DEB7      		in r29,__SP_H__
 4362 1736 2897      		sbiw r28,8
 4363 1738 0FB6      		in __tmp_reg__,__SREG__
 4364 173a F894      		cli
 4365 173c DEBF      		out __SP_H__,r29
 4366 173e 0FBE      		out __SREG__,__tmp_reg__
 4367 1740 CDBF      		out __SP_L__,r28
 4368               	/* prologue end (size=16) */
 4369 1742 E982      		std Y+1,r14
 4370 1744 FA82      		std Y+2,r15
 4371 1746 0B83      		std Y+3,r16
 4372 1748 1C83      		std Y+4,r17
 4373 174a 2D83      		std Y+5,r18
 4374 174c 3E83      		std Y+6,r19
 4375 174e 4F83      		std Y+7,r20
 4376 1750 5887      		std Y+8,r21
 4378               	.LM448:
 4379 1752 82E0      		ldi r24,lo8(2)
 4380 1754 8093 0000 		sts mac_tx_current_frame+27,r24
 4382               	.LM449:
 4383 1758 93E0      		ldi r25,lo8(3)
 4384 175a 9093 0000 		sts mac_tx_current_frame+26,r25
 4386               	.LM450:
 4387 175e 8091 0000 		lds r24,mac_pib_data+24
 4388 1762 282F      		mov r18,r24
 4389 1764 8F5F      		subi r24,lo8(-(1))
 4390 1766 8093 0000 		sts mac_pib_data+24,r24
 4391 176a 2093 0000 		sts mac_tx_current_frame+28,r18
 4393               	.LM451:
 4394 176e 9093 0000 		sts mac_tx_current_frame+13,r25
 4396               	.LM452:
 4397 1772 9093 0000 		sts mac_tx_current_frame,r25
 4399               	.LM453:
 4400 1776 8091 0000 		lds r24,mac_pib_data+28
 4401 177a 9091 0000 		lds r25,(mac_pib_data+28)+1
 4402 177e 9093 0000 		sts (mac_tx_current_frame+24)+1,r25
 4403 1782 8093 0000 		sts mac_tx_current_frame+24,r24
 4405               	.LM454:
 4406 1786 9093 0000 		sts (mac_tx_current_frame+11)+1,r25
 4407 178a 8093 0000 		sts mac_tx_current_frame+11,r24
 4409               	.LM455:
 4410 178e 00E0      		ldi r16,lo8(mac_tx_current_frame+14)
 4411 1790 10E0      		ldi r17,hi8(mac_tx_current_frame+14)
 4412 1792 88E0      		ldi r24,lo8(8)
 4413 1794 20E0      		ldi r18,lo8(mac_pib_data+34)
 4414 1796 30E0      		ldi r19,hi8(mac_pib_data+34)
 4415 1798 D801      		movw r26,r16
 4416 179a F901      		movw r30,r18
 4417 179c 982F      		mov r25,r24
 4418 179e 0190      		ld __tmp_reg__,Z+
 4419 17a0 0D92      		st X+,__tmp_reg__
 4420 17a2 9A95      		dec r25
 4421 17a4 E1F7      		brne .-8
 4423               	.LM456:
 4424 17a6 F801      		movw r30,r16
 4425 17a8 3D97      		sbiw r30,13
 4426 17aa DE01      		movw r26,r28
 4427 17ac 1196      		adiw r26,1
 4428 17ae 0D90      		ld __tmp_reg__,X+
 4429 17b0 0192      		st Z+,__tmp_reg__
 4430 17b2 8A95      		dec r24
 4431 17b4 E1F7      		brne .-8
 4433               	.LM457:
 4434 17b6 D092 0000 		sts (mac_tx_current_frame+169)+1,r13
 4435 17ba C092 0000 		sts mac_tx_current_frame+169,r12
 4437               	.LM458:
 4438 17be 6093 0000 		sts mac_tx_current_frame+171,r22
 4440               	.LM459:
 4441 17c2 83E2      		ldi r24,lo8(35)
 4442 17c4 8093 0000 		sts mac_tx_current_frame+36,r24
 4444               	.LM460:
 4445 17c8 8CEC      		ldi r24,lo8(-52)
 4446 17ca 8093 0000 		sts mac_tx_current_frame+37,r24
 4448               	.LM461:
 4449 17ce 0E94 0000 		call mac_frame_send
 4450               	/* epilogue: frame size=8 */
 4451 17d2 2896      		adiw r28,8
 4452 17d4 0FB6      		in __tmp_reg__,__SREG__
 4453 17d6 F894      		cli
 4454 17d8 DEBF      		out __SP_H__,r29
 4455 17da 0FBE      		out __SREG__,__tmp_reg__
 4456 17dc CDBF      		out __SP_L__,r28
 4457 17de DF91      		pop r29
 4458 17e0 CF91      		pop r28
 4459 17e2 1F91      		pop r17
 4460 17e4 0F91      		pop r16
 4461 17e6 FF90      		pop r15
 4462 17e8 EF90      		pop r14
 4463 17ea DF90      		pop r13
 4464 17ec CF90      		pop r12
 4465 17ee 0895      		ret
 4466               	/* epilogue end (size=15) */
 4467               	/* function associate_response_frame_send size 103 (72) */
 4469               	.Lscope37:
 4474               	.global	coordinator_realignment_frame_send
 4476               	coordinator_realignment_frame_send:
 4478               	.LM462:
 4479               	/* prologue: frame size=13 */
 4480 17f0 8F92      		push r8
 4481 17f2 9F92      		push r9
 4482 17f4 AF92      		push r10
 4483 17f6 BF92      		push r11
 4484 17f8 CF92      		push r12
 4485 17fa DF92      		push r13
 4486 17fc EF92      		push r14
 4487 17fe FF92      		push r15
 4488 1800 0F93      		push r16
 4489 1802 1F93      		push r17
 4490 1804 CF93      		push r28
 4491 1806 DF93      		push r29
 4492 1808 CDB7      		in r28,__SP_L__
 4493 180a DEB7      		in r29,__SP_H__
 4494 180c 2D97      		sbiw r28,13
 4495 180e 0FB6      		in __tmp_reg__,__SREG__
 4496 1810 F894      		cli
 4497 1812 DEBF      		out __SP_H__,r29
 4498 1814 0FBE      		out __SREG__,__tmp_reg__
 4499 1816 CDBF      		out __SP_L__,r28
 4500               	/* prologue end (size=20) */
 4501 1818 A982      		std Y+1,r10
 4502 181a BA82      		std Y+2,r11
 4503 181c CB82      		std Y+3,r12
 4504 181e DC82      		std Y+4,r13
 4505 1820 ED82      		std Y+5,r14
 4506 1822 FE82      		std Y+6,r15
 4507 1824 0F83      		std Y+7,r16
 4508 1826 1887      		std Y+8,r17
 4509 1828 2987      		std Y+9,r18
 4510 182a 3A87      		std Y+10,r19
 4511 182c 4B87      		std Y+11,r20
 4512 182e 5C87      		std Y+12,r21
 4513 1830 6D87      		std Y+13,r22
 4515               	.LM463:
 4516 1832 78E0      		ldi r23,lo8(8)
 4517 1834 7093 0000 		sts mac_tx_current_frame+27,r23
 4519               	.LM464:
 4520 1838 63E0      		ldi r22,lo8(3)
 4521 183a 6093 0000 		sts mac_tx_current_frame+26,r22
 4523               	.LM465:
 4524 183e 9091 0000 		lds r25,mac_pib_data+24
 4525 1842 292F      		mov r18,r25
 4526 1844 9F5F      		subi r25,lo8(-(1))
 4527 1846 9093 0000 		sts mac_pib_data+24,r25
 4528 184a 2093 0000 		sts mac_tx_current_frame+28,r18
 4530               	.LM466:
 4531 184e 6093 0000 		sts mac_tx_current_frame+13,r22
 4533               	.LM467:
 4534 1852 00E0      		ldi r16,lo8(mac_tx_current_frame+14)
 4535 1854 10E0      		ldi r17,hi8(mac_tx_current_frame+14)
 4536 1856 20E0      		ldi r18,lo8(mac_pib_data+34)
 4537 1858 30E0      		ldi r19,hi8(mac_pib_data+34)
 4538 185a D801      		movw r26,r16
 4539 185c F901      		movw r30,r18
 4540 185e 972F      		mov r25,r23
 4541 1860 0190      		ld __tmp_reg__,Z+
 4542 1862 0D92      		st X+,__tmp_reg__
 4543 1864 9A95      		dec r25
 4544 1866 E1F7      		brne .-8
 4546               	.LM468:
 4547 1868 4091 0000 		lds r20,mac_pib_data+28
 4548 186c 5091 0000 		lds r21,(mac_pib_data+28)+1
 4549 1870 5093 0000 		sts (mac_tx_current_frame+24)+1,r21
 4550 1874 4093 0000 		sts mac_tx_current_frame+24,r20
 4552               	.LM469:
 4553 1878 2091 0000 		lds r18,default_short_addr
 4554 187c 3091 0000 		lds r19,(default_short_addr)+1
 4555 1880 3093 0000 		sts (mac_tx_current_frame+11)+1,r19
 4556 1884 2093 0000 		sts mac_tx_current_frame+11,r18
 4558               	.LM470:
 4559 1888 8823      		tst r24
 4560 188a 99F0      		breq .L262
 4562               	.LM471:
 4563 188c 6093 0000 		sts mac_tx_current_frame,r22
 4565               	.LM472:
 4566 1890 F801      		movw r30,r16
 4567 1892 3D97      		sbiw r30,13
 4568 1894 DE01      		movw r26,r28
 4569 1896 1296      		adiw r26,2
 4570 1898 0D90      		ld __tmp_reg__,X+
 4571 189a 0192      		st Z+,__tmp_reg__
 4572 189c 7A95      		dec r23
 4573 189e E1F7      		brne .-8
 4575               	.LM473:
 4576 18a0 9092 0000 		sts (mac_tx_current_frame+178)+1,r9
 4577 18a4 8092 0000 		sts mac_tx_current_frame+178,r8
 4579               	.LM474:
 4580 18a8 83E2      		ldi r24,lo8(35)
 4581 18aa 8093 0000 		sts mac_tx_current_frame+36,r24
 4583               	.LM475:
 4584 18ae 8CEC      		ldi r24,lo8(-52)
 4585 18b0 0EC0      		rjmp .L264
 4586               	.L262:
 4588               	.LM476:
 4589 18b2 82E0      		ldi r24,lo8(2)
 4590 18b4 8093 0000 		sts mac_tx_current_frame,r24
 4592               	.LM477:
 4593 18b8 3093 0000 		sts (mac_tx_current_frame+9)+1,r19
 4594 18bc 2093 0000 		sts mac_tx_current_frame+9,r18
 4596               	.LM478:
 4597 18c0 3093 0000 		sts (mac_tx_current_frame+178)+1,r19
 4598 18c4 2093 0000 		sts mac_tx_current_frame+178,r18
 4600               	.LM479:
 4601 18c8 6093 0000 		sts mac_tx_current_frame+36,r22
 4603               	.LM480:
 4604 18cc 88EC      		ldi r24,lo8(-56)
 4605               	.L264:
 4606 18ce 8093 0000 		sts mac_tx_current_frame+37,r24
 4608               	.LM481:
 4609 18d2 5093 0000 		sts (mac_tx_current_frame+173)+1,r21
 4610 18d6 4093 0000 		sts mac_tx_current_frame+173,r20
 4612               	.LM482:
 4613 18da 8091 0000 		lds r24,mac_pib_data+32
 4614 18de 9091 0000 		lds r25,(mac_pib_data+32)+1
 4615 18e2 9093 0000 		sts (mac_tx_current_frame+175)+1,r25
 4616 18e6 8093 0000 		sts mac_tx_current_frame+175,r24
 4618               	.LM483:
 4619 18ea 8091 0000 		lds r24,ppib
 4620 18ee 8093 0000 		sts mac_tx_current_frame+177,r24
 4622               	.LM484:
 4623 18f2 0E94 0000 		call mac_frame_send
 4624               	/* epilogue: frame size=13 */
 4625 18f6 2D96      		adiw r28,13
 4626 18f8 0FB6      		in __tmp_reg__,__SREG__
 4627 18fa F894      		cli
 4628 18fc DEBF      		out __SP_H__,r29
 4629 18fe 0FBE      		out __SREG__,__tmp_reg__
 4630 1900 CDBF      		out __SP_L__,r28
 4631 1902 DF91      		pop r29
 4632 1904 CF91      		pop r28
 4633 1906 1F91      		pop r17
 4634 1908 0F91      		pop r16
 4635 190a FF90      		pop r15
 4636 190c EF90      		pop r14
 4637 190e DF90      		pop r13
 4638 1910 CF90      		pop r12
 4639 1912 BF90      		pop r11
 4640 1914 AF90      		pop r10
 4641 1916 9F90      		pop r9
 4642 1918 8F90      		pop r8
 4643 191a 0895      		ret
 4644               	/* epilogue end (size=19) */
 4645               	/* function coordinator_realignment_frame_send size 150 (111) */
 4647               	.Lscope38:
 4650               	.global	mlmeSyncLossIndication
 4652               	mlmeSyncLossIndication:
 4654               	.LM485:
 4655               	/* prologue: frame size=13 */
 4656 191c 8F92      		push r8
 4657 191e 9F92      		push r9
 4658 1920 AF92      		push r10
 4659 1922 BF92      		push r11
 4660 1924 CF92      		push r12
 4661 1926 DF92      		push r13
 4662 1928 EF92      		push r14
 4663 192a FF92      		push r15
 4664 192c 0F93      		push r16
 4665 192e 1F93      		push r17
 4666 1930 CF93      		push r28
 4667 1932 DF93      		push r29
 4668 1934 CDB7      		in r28,__SP_L__
 4669 1936 DEB7      		in r29,__SP_H__
 4670 1938 2D97      		sbiw r28,13
 4671 193a 0FB6      		in __tmp_reg__,__SREG__
 4672 193c F894      		cli
 4673 193e DEBF      		out __SP_H__,r29
 4674 1940 0FBE      		out __SREG__,__tmp_reg__
 4675 1942 CDBF      		out __SP_L__,r28
 4676               	/* prologue end (size=20) */
 4678               	.LM486:
 4679 1944 8090 0000 		lds r8,default_short_addr
 4680 1948 9090 0000 		lds r9,(default_short_addr)+1
 4681 194c A980      		ldd r10,Y+1
 4682 194e BA80      		ldd r11,Y+2
 4683 1950 CB80      		ldd r12,Y+3
 4684 1952 DC80      		ldd r13,Y+4
 4685 1954 ED80      		ldd r14,Y+5
 4686 1956 FE80      		ldd r15,Y+6
 4687 1958 0F81      		ldd r16,Y+7
 4688 195a 1885      		ldd r17,Y+8
 4689 195c 2985      		ldd r18,Y+9
 4690 195e 3A85      		ldd r19,Y+10
 4691 1960 4B85      		ldd r20,Y+11
 4692 1962 5C85      		ldd r21,Y+12
 4693 1964 6D85      		ldd r22,Y+13
 4694 1966 80E0      		ldi r24,lo8(0)
 4695 1968 0E94 0000 		call coordinator_realignment_frame_send
 4697               	.LM487:
 4698 196c 80E1      		ldi r24,lo8(16)
 4699 196e 8093 0000 		sts mac_current_state,r24
 4700               	/* epilogue: frame size=13 */
 4701 1972 2D96      		adiw r28,13
 4702 1974 0FB6      		in __tmp_reg__,__SREG__
 4703 1976 F894      		cli
 4704 1978 DEBF      		out __SP_H__,r29
 4705 197a 0FBE      		out __SREG__,__tmp_reg__
 4706 197c CDBF      		out __SP_L__,r28
 4707 197e DF91      		pop r29
 4708 1980 CF91      		pop r28
 4709 1982 1F91      		pop r17
 4710 1984 0F91      		pop r16
 4711 1986 FF90      		pop r15
 4712 1988 EF90      		pop r14
 4713 198a DF90      		pop r13
 4714 198c CF90      		pop r12
 4715 198e BF90      		pop r11
 4716 1990 AF90      		pop r10
 4717 1992 9F90      		pop r9
 4718 1994 8F90      		pop r8
 4719 1996 0895      		ret
 4720               	/* epilogue end (size=19) */
 4721               	/* function mlmeSyncLossIndication size 62 (23) */
 4726               	.Lscope39:
 4732               	.global	mlmeOrphanResponse
 4734               	mlmeOrphanResponse:
 4736               	.LM488:
 4737               	/* prologue: frame size=21 */
 4738 1998 8F92      		push r8
 4739 199a 9F92      		push r9
 4740 199c AF92      		push r10
 4741 199e BF92      		push r11
 4742 19a0 CF92      		push r12
 4743 19a2 DF92      		push r13
 4744 19a4 EF92      		push r14
 4745 19a6 FF92      		push r15
 4746 19a8 0F93      		push r16
 4747 19aa 1F93      		push r17
 4748 19ac CF93      		push r28
 4749 19ae DF93      		push r29
 4750 19b0 CDB7      		in r28,__SP_L__
 4751 19b2 DEB7      		in r29,__SP_H__
 4752 19b4 6597      		sbiw r28,21
 4753 19b6 0FB6      		in __tmp_reg__,__SREG__
 4754 19b8 F894      		cli
 4755 19ba DEBF      		out __SP_H__,r29
 4756 19bc 0FBE      		out __SREG__,__tmp_reg__
 4757 19be CDBF      		out __SP_L__,r28
 4758               	/* prologue end (size=20) */
 4759 19c0 2983      		std Y+1,r18
 4760 19c2 3A83      		std Y+2,r19
 4761 19c4 4B83      		std Y+3,r20
 4762 19c6 5C83      		std Y+4,r21
 4763 19c8 6D83      		std Y+5,r22
 4764 19ca 7E83      		std Y+6,r23
 4765 19cc 8F83      		std Y+7,r24
 4766 19ce 9887      		std Y+8,r25
 4767 19d0 4801      		movw r8,r16
 4769               	.LM489:
 4770 19d2 93E0      		ldi r25,lo8(3)
 4771 19d4 9987      		std Y+9,r25
 4773               	.LM490:
 4774 19d6 022F      		mov r16,r18
 4775 19d8 132F      		mov r17,r19
 4776 19da 242F      		mov r18,r20
 4777 19dc 352F      		mov r19,r21
 4778 19de 462F      		mov r20,r22
 4779 19e0 572F      		mov r21,r23
 4780 19e2 6F81      		ldd r22,Y+7
 4781 19e4 7885      		ldd r23,Y+8
 4782 19e6 0A87      		std Y+10,r16
 4783 19e8 1B87      		std Y+11,r17
 4784 19ea 2C87      		std Y+12,r18
 4785 19ec 3D87      		std Y+13,r19
 4786 19ee 4E87      		std Y+14,r20
 4787 19f0 5F87      		std Y+15,r21
 4788 19f2 688B      		std Y+16,r22
 4789 19f4 798B      		std Y+17,r23
 4791               	.LM491:
 4792 19f6 EE20      		tst r14
 4793 19f8 A1F0      		breq .L268
 4795               	.LM492:
 4796 19fa 8091 0000 		lds r24,mac_current_state
 4797 19fe 8031      		cpi r24,lo8(16)
 4798 1a00 81F4      		brne .L268
 4800               	.LM493:
 4801 1a02 A92E      		mov r10,r25
 4802 1a04 B02E      		mov r11,r16
 4803 1a06 C12E      		mov r12,r17
 4804 1a08 D22E      		mov r13,r18
 4805 1a0a E32E      		mov r14,r19
 4806 1a0c F42E      		mov r15,r20
 4807 1a0e 052F      		mov r16,r21
 4808 1a10 162F      		mov r17,r22
 4809 1a12 272F      		mov r18,r23
 4810 1a14 3A89      		ldd r19,Y+18
 4811 1a16 4B89      		ldd r20,Y+19
 4812 1a18 5C89      		ldd r21,Y+20
 4813 1a1a 6D89      		ldd r22,Y+21
 4814 1a1c 81E0      		ldi r24,lo8(1)
 4815 1a1e 0E94 0000 		call coordinator_realignment_frame_send
 4816               	.L268:
 4817               	/* epilogue: frame size=21 */
 4818 1a22 6596      		adiw r28,21
 4819 1a24 0FB6      		in __tmp_reg__,__SREG__
 4820 1a26 F894      		cli
 4821 1a28 DEBF      		out __SP_H__,r29
 4822 1a2a 0FBE      		out __SREG__,__tmp_reg__
 4823 1a2c CDBF      		out __SP_L__,r28
 4824 1a2e DF91      		pop r29
 4825 1a30 CF91      		pop r28
 4826 1a32 1F91      		pop r17
 4827 1a34 0F91      		pop r16
 4828 1a36 FF90      		pop r15
 4829 1a38 EF90      		pop r14
 4830 1a3a DF90      		pop r13
 4831 1a3c CF90      		pop r12
 4832 1a3e BF90      		pop r11
 4833 1a40 AF90      		pop r10
 4834 1a42 9F90      		pop r9
 4835 1a44 8F90      		pop r8
 4836 1a46 0895      		ret
 4837               	/* epilogue end (size=19) */
 4838               	/* function mlmeOrphanResponse size 88 (49) */
 4843               	.Lscope40:
 4844               		.data
 4845               	.LC15:
 4846 028c 0A73 7563 		.string	"\nsuccess received a orphan notification frame"
 4846      6365 7373 
 4846      2072 6563 
 4846      6569 7665 
 4846      6420 6120 
 4847               		.text
 4852               	.global	mlmeOrphanIndication
 4854               	mlmeOrphanIndication:
 4856               	.LM494:
 4857               	/* prologue: frame size=8 */
 4858 1a48 CF92      		push r12
 4859 1a4a EF92      		push r14
 4860 1a4c 0F93      		push r16
 4861 1a4e 1F93      		push r17
 4862 1a50 CF93      		push r28
 4863 1a52 DF93      		push r29
 4864 1a54 CDB7      		in r28,__SP_L__
 4865 1a56 DEB7      		in r29,__SP_H__
 4866 1a58 2897      		sbiw r28,8
 4867 1a5a 0FB6      		in __tmp_reg__,__SREG__
 4868 1a5c F894      		cli
 4869 1a5e DEBF      		out __SP_H__,r29
 4870 1a60 0FBE      		out __SREG__,__tmp_reg__
 4871 1a62 CDBF      		out __SP_L__,r28
 4872               	/* prologue end (size=14) */
 4873 1a64 2983      		std Y+1,r18
 4874 1a66 3A83      		std Y+2,r19
 4875 1a68 4B83      		std Y+3,r20
 4876 1a6a 5C83      		std Y+4,r21
 4877 1a6c 6D83      		std Y+5,r22
 4878 1a6e 7E83      		std Y+6,r23
 4879 1a70 8F83      		std Y+7,r24
 4880 1a72 9887      		std Y+8,r25
 4882               	.LM495:
 4883 1a74 80E0      		ldi r24,lo8(.LC15)
 4884 1a76 90E0      		ldi r25,hi8(.LC15)
 4885 1a78 0E94 0000 		call puts
 4887               	.LM496:
 4888 1a7c 2981      		ldd r18,Y+1
 4889 1a7e 3A81      		ldd r19,Y+2
 4890 1a80 4B81      		ldd r20,Y+3
 4891 1a82 5C81      		ldd r21,Y+4
 4892 1a84 6D81      		ldd r22,Y+5
 4893 1a86 7E81      		ldd r23,Y+6
 4894 1a88 8F81      		ldd r24,Y+7
 4895 1a8a 9885      		ldd r25,Y+8
 4896 1a8c 0E94 0000 		call short_address_allocate_req
 4898               	.LM497:
 4899 1a90 CC24      		clr r12
 4900 1a92 21E0      		ldi r18,lo8(1)
 4901 1a94 E22E      		mov r14,r18
 4902 1a96 8C01      		movw r16,r24
 4903 1a98 2981      		ldd r18,Y+1
 4904 1a9a 3A81      		ldd r19,Y+2
 4905 1a9c 4B81      		ldd r20,Y+3
 4906 1a9e 5C81      		ldd r21,Y+4
 4907 1aa0 6D81      		ldd r22,Y+5
 4908 1aa2 7E81      		ldd r23,Y+6
 4909 1aa4 8F81      		ldd r24,Y+7
 4910 1aa6 9885      		ldd r25,Y+8
 4911 1aa8 0E94 0000 		call mlmeOrphanResponse
 4912               	/* epilogue: frame size=8 */
 4913 1aac 2896      		adiw r28,8
 4914 1aae 0FB6      		in __tmp_reg__,__SREG__
 4915 1ab0 F894      		cli
 4916 1ab2 DEBF      		out __SP_H__,r29
 4917 1ab4 0FBE      		out __SREG__,__tmp_reg__
 4918 1ab6 CDBF      		out __SP_L__,r28
 4919 1ab8 DF91      		pop r29
 4920 1aba CF91      		pop r28
 4921 1abc 1F91      		pop r17
 4922 1abe 0F91      		pop r16
 4923 1ac0 EF90      		pop r14
 4924 1ac2 CF90      		pop r12
 4925 1ac4 0895      		ret
 4926               	/* epilogue end (size=13) */
 4927               	/* function mlmeOrphanIndication size 63 (36) */
 4932               	.Lscope41:
 4943               	.global	mlmeStartRequest
 4945               	mlmeStartRequest:
 4947               	.LM498:
 4948               	/* prologue: frame size=0 */
 4949 1ac6 8F92      		push r8
 4950 1ac8 9F92      		push r9
 4951 1aca AF92      		push r10
 4952 1acc BF92      		push r11
 4953 1ace CF92      		push r12
 4954 1ad0 DF92      		push r13
 4955 1ad2 EF92      		push r14
 4956 1ad4 FF92      		push r15
 4957 1ad6 0F93      		push r16
 4958 1ad8 1F93      		push r17
 4959 1ada CF93      		push r28
 4960 1adc DF93      		push r29
 4961 1ade CDB7      		in r28,__SP_L__
 4962 1ae0 DEB7      		in r29,__SP_H__
 4963               	/* prologue end (size=14) */
 4964 1ae2 DC01      		movw r26,r24
 4965 1ae4 522F      		mov r21,r18
 4967               	.LM499:
 4968 1ae6 1092 0000 		sts mac_tx_beacon+25,__zero_reg__
 4970               	.LM500:
 4971 1aea 1092 0000 		sts mac_tx_beacon+4,__zero_reg__
 4973               	.LM501:
 4974 1aee 1092 0000 		sts mac_tx_beacon+3,__zero_reg__
 4976               	.LM502:
 4977 1af2 E22F      		mov r30,r18
 4978 1af4 FF27      		clr r31
 4979 1af6 9F01      		movw r18,r30
 4980 1af8 74E0      		ldi r23,4
 4981 1afa 220F      	1:	lsl r18
 4982 1afc 331F      		rol r19
 4983 1afe 7A95      		dec r23
 4984 1b00 E1F7      		brne 1b
 4985 1b02 942F      		mov r25,r20
 4986 1b04 922B      		or r25,r18
 4987 1b06 9093 0000 		sts mac_tx_beacon,r25
 4989               	.LM503:
 4990 1b0a 0023      		tst r16
 4991 1b0c 11F0      		breq .L272
 4993               	.LM504:
 4994 1b0e 8FEC      		ldi r24,lo8(-49)
 4995 1b10 01C0      		rjmp .L276
 4996               	.L272:
 4998               	.LM505:
 4999 1b12 8FE8      		ldi r24,lo8(-113)
 5000               	.L276:
 5001 1b14 8093 0000 		sts mac_tx_beacon+1,r24
 5003               	.LM506:
 5004 1b18 B093 0000 		sts (mac_pib_data+28)+1,r27
 5005 1b1c A093 0000 		sts mac_pib_data+28,r26
 5007               	.LM507:
 5008 1b20 4093 0000 		sts mac_pib_data+8,r20
 5010               	.LM508:
 5011 1b24 5093 0000 		sts mac_pib_data+42,r21
 5013               	.LM509:
 5014 1b28 6093 0000 		sts ppib,r22
 5016               	.LM510:
 5017 1b2c 80EA      		ldi r24,lo8(160)
 5018 1b2e 90E0      		ldi r25,hi8(160)
 5019 1b30 A0E0      		ldi r26,hlo8(160)
 5020 1b32 B0E0      		ldi r27,hhi8(160)
 5021 1b34 7C01      		movw r14,r24
 5022 1b36 8D01      		movw r16,r26
 5023 1b38 04C0      		rjmp 2f
 5024 1b3a EE0C      	1:	lsl r14
 5025 1b3c FF1C      		rol r15
 5026 1b3e 001F      		rol r16
 5027 1b40 111F      		rol r17
 5028 1b42 4A95      	2:	dec r20
 5029 1b44 D2F7      		brpl 1b
 5030 1b46 E092 0000 		sts MAC_SUPERFRAME_PERIOD,r14
 5031 1b4a F092 0000 		sts (MAC_SUPERFRAME_PERIOD)+1,r15
 5032 1b4e 0093 0000 		sts (MAC_SUPERFRAME_PERIOD)+2,r16
 5033 1b52 1093 0000 		sts (MAC_SUPERFRAME_PERIOD)+3,r17
 5035               	.LM511:
 5036 1b56 04C0      		rjmp 2f
 5037 1b58 880F      	1:	lsl r24
 5038 1b5a 991F      		rol r25
 5039 1b5c AA1F      		rol r26
 5040 1b5e BB1F      		rol r27
 5041 1b60 EA95      	2:	dec r30
 5042 1b62 D2F7      		brpl 1b
 5043 1b64 8093 0000 		sts MAC_CAP_PERIOD,r24
 5044 1b68 9093 0000 		sts (MAC_CAP_PERIOD)+1,r25
 5045 1b6c A093 0000 		sts (MAC_CAP_PERIOD)+2,r26
 5046 1b70 B093 0000 		sts (MAC_CAP_PERIOD)+3,r27
 5048               	.LM512:
 5049 1b74 80E0      		ldi r24,lo8(0)
 5050 1b76 0E94 0000 		call PLME_SET_request
 5052               	.LM513:
 5053 1b7a CC20      		tst r12
 5054 1b7c 21F4      		brne .L274
 5056               	.LM514:
 5057 1b7e 81E0      		ldi r24,lo8(1)
 5058 1b80 0E94 0000 		call beacon_frame_send
 5059 1b84 21C0      		rjmp .L271
 5060               	.L274:
 5062               	.LM515:
 5063 1b86 8090 0000 		lds r8,default_short_addr
 5064 1b8a 9090 0000 		lds r9,(default_short_addr)+1
 5065 1b8e A090 0000 		lds r10,default_node
 5066 1b92 B090 0000 		lds r11,default_node+1
 5067 1b96 C090 0000 		lds r12,default_node+2
 5068 1b9a D090 0000 		lds r13,default_node+3
 5069 1b9e E090 0000 		lds r14,default_node+4
 5070 1ba2 F090 0000 		lds r15,default_node+5
 5071 1ba6 0091 0000 		lds r16,default_node+6
 5072 1baa 1091 0000 		lds r17,default_node+7
 5073 1bae 2091 0000 		lds r18,default_node+8
 5074 1bb2 3091 0000 		lds r19,default_node+9
 5075 1bb6 4091 0000 		lds r20,default_node+10
 5076 1bba 5091 0000 		lds r21,default_node+11
 5077 1bbe 6091 0000 		lds r22,default_node+12
 5078 1bc2 80E0      		ldi r24,lo8(0)
 5079 1bc4 0E94 0000 		call coordinator_realignment_frame_send
 5080               	.L271:
 5081               	/* epilogue: frame size=0 */
 5082 1bc8 DF91      		pop r29
 5083 1bca CF91      		pop r28
 5084 1bcc 1F91      		pop r17
 5085 1bce 0F91      		pop r16
 5086 1bd0 FF90      		pop r15
 5087 1bd2 EF90      		pop r14
 5088 1bd4 DF90      		pop r13
 5089 1bd6 CF90      		pop r12
 5090 1bd8 BF90      		pop r11
 5091 1bda AF90      		pop r10
 5092 1bdc 9F90      		pop r9
 5093 1bde 8F90      		pop r8
 5094 1be0 0895      		ret
 5095               	/* epilogue end (size=13) */
 5096               	/* function mlmeStartRequest size 144 (117) */
 5098               	.Lscope42:
 5100               	.global	orphan_notification_frame_send
 5102               	orphan_notification_frame_send:
 5104               	.LM516:
 5105               	/* prologue: frame size=0 */
 5106 1be2 0F93      		push r16
 5107 1be4 1F93      		push r17
 5108               	/* prologue end (size=2) */
 5110               	.LM517:
 5111 1be6 86E0      		ldi r24,lo8(6)
 5112 1be8 8093 0000 		sts mac_tx_current_frame+27,r24
 5114               	.LM518:
 5115 1bec 33E0      		ldi r19,lo8(3)
 5116 1bee 3093 0000 		sts mac_tx_current_frame+26,r19
 5118               	.LM519:
 5119 1bf2 8091 0000 		lds r24,mac_pib_data+24
 5120 1bf6 982F      		mov r25,r24
 5121 1bf8 8F5F      		subi r24,lo8(-(1))
 5122 1bfa 8093 0000 		sts mac_pib_data+24,r24
 5123 1bfe 9093 0000 		sts mac_tx_current_frame+28,r25
 5125               	.LM520:
 5126 1c02 3093 0000 		sts mac_tx_current_frame+13,r19
 5128               	.LM521:
 5129 1c06 82E0      		ldi r24,lo8(2)
 5130 1c08 8093 0000 		sts mac_tx_current_frame,r24
 5132               	.LM522:
 5133 1c0c 8091 0000 		lds r24,default_short_addr
 5134 1c10 9091 0000 		lds r25,(default_short_addr)+1
 5135 1c14 9093 0000 		sts (mac_tx_current_frame+24)+1,r25
 5136 1c18 8093 0000 		sts mac_tx_current_frame+24,r24
 5138               	.LM523:
 5139 1c1c 28E0      		ldi r18,lo8(8)
 5140 1c1e A0E0      		ldi r26,lo8(mac_pib_data+34)
 5141 1c20 B0E0      		ldi r27,hi8(mac_pib_data+34)
 5142 1c22 E0E0      		ldi r30,lo8(mac_tx_current_frame+14)
 5143 1c24 F0E0      		ldi r31,hi8(mac_tx_current_frame+14)
 5144 1c26 0D90      		ld __tmp_reg__,X+
 5145 1c28 0192      		st Z+,__tmp_reg__
 5146 1c2a 2A95      		dec r18
 5147 1c2c E1F7      		brne .-8
 5149               	.LM524:
 5150 1c2e 9093 0000 		sts (mac_tx_current_frame+11)+1,r25
 5151 1c32 8093 0000 		sts mac_tx_current_frame+11,r24
 5153               	.LM525:
 5154 1c36 9093 0000 		sts (mac_tx_current_frame+9)+1,r25
 5155 1c3a 8093 0000 		sts mac_tx_current_frame+9,r24
 5157               	.LM526:
 5158 1c3e 3093 0000 		sts mac_tx_current_frame+36,r19
 5160               	.LM527:
 5161 1c42 88EC      		ldi r24,lo8(-56)
 5162 1c44 8093 0000 		sts mac_tx_current_frame+37,r24
 5164               	.LM528:
 5165 1c48 0E94 0000 		call mac_frame_send
 5167               	.LM529:
 5168 1c4c 00E4      		ldi r16,lo8(1600)
 5169 1c4e 16E0      		ldi r17,hi8(1600)
 5170 1c50 21E0      		ldi r18,lo8(1)
 5171 1c52 4091 0000 		lds r20,mac_tx_current_frame+28
 5172 1c56 622F      		mov r22,r18
 5173 1c58 8091 0000 		lds r24,head_of_timer_queue
 5174 1c5c 9091 0000 		lds r25,(head_of_timer_queue)+1
 5175 1c60 0E94 0000 		call timer3queue_start
 5176 1c64 9093 0000 		sts (head_of_timer_queue)+1,r25
 5177 1c68 8093 0000 		sts head_of_timer_queue,r24
 5178               	/* epilogue: frame size=0 */
 5179 1c6c 1F91      		pop r17
 5180 1c6e 0F91      		pop r16
 5181 1c70 0895      		ret
 5182               	/* epilogue end (size=3) */
 5183               	/* function orphan_notification_frame_send size 72 (67) */
 5185               	.Lscope43:
 5186               		.data
 5187               	.LC16:
 5188 02ba 0A73 6574 		.string	"\nset the %d channel & waitting for beacon\n"
 5188      2074 6865 
 5188      2025 6420 
 5188      6368 616E 
 5188      6E65 6C20 
 5189               		.text
 5191               	.global	mac_timer_task
 5193               	mac_timer_task:
 5195               	.LM530:
 5196               	/* prologue: frame size=0 */
 5197 1c72 EF92      		push r14
 5198 1c74 FF92      		push r15
 5199 1c76 0F93      		push r16
 5200 1c78 1F93      		push r17
 5201 1c7a CF93      		push r28
 5202 1c7c DF93      		push r29
 5203               	/* prologue end (size=6) */
 5205               	.LM531:
 5206 1c7e E091 0000 		lds r30,current_timer_elem
 5207 1c82 F091 0000 		lds r31,(current_timer_elem)+1
 5208 1c86 8281      		ldd r24,Z+2
 5209 1c88 9927      		clr r25
 5210 1c8a 8230      		cpi r24,2
 5211 1c8c 9105      		cpc r25,__zero_reg__
 5212 1c8e 09F4      		brne .+2
 5213 1c90 E6C0      		rjmp .L307
 5215               	.LM532:
 5216 1c92 8330      		cpi r24,3
 5217 1c94 9105      		cpc r25,__zero_reg__
 5218 1c96 34F4      		brge .L310
 5219 1c98 0097      		sbiw r24,0
 5220 1c9a 61F0      		breq .L280
 5221 1c9c 0197      		sbiw r24,1
 5222 1c9e 09F4      		brne .+2
 5223 1ca0 66C0      		rjmp .L296
 5224 1ca2 11C1      		rjmp .L279
 5225               	.L310:
 5226 1ca4 8330      		cpi r24,3
 5227 1ca6 9105      		cpc r25,__zero_reg__
 5228 1ca8 09F4      		brne .+2
 5229 1caa 6FC0      		rjmp .L301
 5230 1cac 0497      		sbiw r24,4
 5231 1cae 09F4      		brne .+2
 5232 1cb0 03C1      		rjmp .L308
 5233 1cb2 09C1      		rjmp .L279
 5234               	.L280:
 5236               	.LM533:
 5237 1cb4 8181      		ldd r24,Z+1
 5238 1cb6 0E94 0000 		call get_frame_pointer
 5239 1cba EC01      		movw r28,r24
 5241               	.LM534:
 5242 1cbc 892B      		or r24,r25
 5243 1cbe 09F4      		brne .+2
 5244 1cc0 02C1      		rjmp .L279
 5246               	.LM535:
 5247 1cc2 8C81      		ldd r24,Y+4
 5248 1cc4 8823      		tst r24
 5249 1cc6 69F1      		breq .L282
 5251               	.LM536:
 5252 1cc8 8091 0000 		lds r24,Parameter_list+10
 5253 1ccc 282F      		mov r18,r24
 5254 1cce 3327      		clr r19
 5255 1cd0 8091 0000 		lds r24,Parameter_list+11
 5256 1cd4 E82F      		mov r30,r24
 5257 1cd6 FF27      		clr r31
 5258 1cd8 8F01      		movw r16,r30
 5259 1cda 0F5F      		subi r16,lo8(-(1))
 5260 1cdc 1F4F      		sbci r17,hi8(-(1))
 5261 1cde C801      		movw r24,r16
 5262 1ce0 65E0      		ldi r22,lo8(5)
 5263 1ce2 70E0      		ldi r23,hi8(5)
 5264 1ce4 0E94 0000 		call __divmodhi4
 5265 1ce8 2817      		cp r18,r24
 5266 1cea 3907      		cpc r19,r25
 5267 1cec 29F4      		brne .L283
 5269               	.LM537:
 5270 1cee 80E0      		ldi r24,lo8(.LC14)
 5271 1cf0 90E0      		ldi r25,hi8(.LC14)
 5272 1cf2 0E94 0000 		call error
 5273 1cf6 11C0      		rjmp .L284
 5274               	.L283:
 5276               	.LM538:
 5277 1cf8 EE0F      		add r30,r30
 5278 1cfa FF1F      		adc r31,r31
 5279 1cfc E050      		subi r30,lo8(-(Parameter_list))
 5280 1cfe F040      		sbci r31,hi8(-(Parameter_list))
 5281 1d00 C083      		st Z,r28
 5282 1d02 D183      		std Z+1,r29
 5284               	.LM539:
 5285 1d04 C801      		movw r24,r16
 5286 1d06 65E0      		ldi r22,lo8(5)
 5287 1d08 70E0      		ldi r23,hi8(5)
 5288 1d0a 0E94 0000 		call __divmodhi4
 5289 1d0e 8093 0000 		sts Parameter_list+11,r24
 5291               	.LM540:
 5292 1d12 80E0      		ldi r24,lo8(pm(transmit_with_csmaca))
 5293 1d14 90E0      		ldi r25,hi8(pm(transmit_with_csmaca))
 5294 1d16 0E94 0000 		call OS_post
 5295               	.L284:
 5297               	.LM541:
 5298 1d1a 8C81      		ldd r24,Y+4
 5299 1d1c 8150      		subi r24,lo8(-(-1))
 5300 1d1e 8C83      		std Y+4,r24
 5301 1d20 D2C0      		rjmp .L279
 5302               	.L282:
 5304               	.LM542:
 5305 1d22 8E81      		ldd r24,Y+6
 5306 1d24 9927      		clr r25
 5307 1d26 8130      		cpi r24,1
 5308 1d28 9105      		cpc r25,__zero_reg__
 5309 1d2a 49F0      		breq .L288
 5310 1d2c 8230      		cpi r24,2
 5311 1d2e 9105      		cpc r25,__zero_reg__
 5312 1d30 1CF4      		brge .L295
 5313 1d32 892B      		or r24,r25
 5314 1d34 81F0      		breq .L290
 5315 1d36 17C0      		rjmp .L286
 5316               	.L295:
 5317 1d38 0397      		sbiw r24,3
 5318 1d3a 91F0      		breq .L291
 5319 1d3c 14C0      		rjmp .L286
 5320               	.L288:
 5322               	.LM543:
 5323 1d3e 8091 0000 		lds r24,mac_current_state
 5324 1d42 8330      		cpi r24,lo8(3)
 5325 1d44 81F4      		brne .L286
 5327               	.LM544:
 5328 1d46 69EE      		ldi r22,lo8(-23)
 5329 1d48 8091 0000 		lds r24,default_short_addr
 5330 1d4c 9091 0000 		lds r25,(default_short_addr)+1
 5331 1d50 0E94 0000 		call mlmeAssociateConfirm
 5333               	.LM545:
 5334 1d54 08C0      		rjmp .L286
 5335               	.L290:
 5337               	.LM546:
 5338 1d56 6981      		ldd r22,Y+1
 5339 1d58 89EE      		ldi r24,lo8(-23)
 5340 1d5a 0E94 0000 		call mcpsDataConfirm
 5342               	.LM547:
 5343 1d5e 03C0      		rjmp .L286
 5344               	.L291:
 5346               	.LM548:
 5347 1d60 89EE      		ldi r24,lo8(-23)
 5348 1d62 0E94 0000 		call mlmeDisassociateConfirm
 5349               	.L286:
 5351               	.LM549:
 5352 1d66 8B81      		ldd r24,Y+3
 5353 1d68 0E94 0000 		call remove_tx_queue
 5355               	.LM550:
 5356 1d6c ACC0      		rjmp .L279
 5357               	.L296:
 5359               	.LM551:
 5360 1d6e 8091 0000 		lds r24,mac_current_state
 5361 1d72 8330      		cpi r24,lo8(3)
 5362 1d74 09F4      		brne .+2
 5363 1d76 73C0      		rjmp .L307
 5364 1d78 8131      		cpi r24,lo8(17)
 5365 1d7a 09F4      		brne .+2
 5366 1d7c 70C0      		rjmp .L307
 5368               	.LM552:
 5369 1d7e 8830      		cpi r24,lo8(8)
 5370 1d80 09F0      		breq .+2
 5371 1d82 A1C0      		rjmp .L279
 5373               	.LM553:
 5374 1d84 0E94 0000 		call orphan_notification_frame_send
 5376               	.LM554:
 5377 1d88 9EC0      		rjmp .L279
 5378               	.L301:
 5380               	.LM555:
 5381 1d8a 8091 0000 		lds r24,mac_current_state
 5382 1d8e 8730      		cpi r24,lo8(7)
 5383 1d90 09F0      		breq .+2
 5384 1d92 99C0      		rjmp .L279
 5386               	.LM556:
 5387 1d94 C091 0000 		lds r28,scan_channel
 5388 1d98 D091 0000 		lds r29,(scan_channel)+1
 5389 1d9c E091 0000 		lds r30,(scan_channel)+2
 5390 1da0 F091 0000 		lds r31,(scan_channel)+3
 5391 1da4 CE01      		movw r24,r28
 5392 1da6 DF01      		movw r26,r30
 5393 1da8 0090 0000 		lds r0,scan_channel_index
 5394 1dac 04C0      		rjmp 2f
 5395 1dae B695      	1:	lsr r27
 5396 1db0 A795      		ror r26
 5397 1db2 9795      		ror r25
 5398 1db4 8795      		ror r24
 5399 1db6 0A94      	2:	dec r0
 5400 1db8 D2F7      		brpl 1b
 5401 1dba 21E0      		ldi r18,lo8(1)
 5402 1dbc 30E0      		ldi r19,hi8(1)
 5403 1dbe 40E0      		ldi r20,hlo8(1)
 5404 1dc0 50E0      		ldi r21,hhi8(1)
 5405               	.L314:
 5406 1dc2 8227      		eor r24,r18
 5407 1dc4 9327      		eor r25,r19
 5408 1dc6 A427      		eor r26,r20
 5409 1dc8 B527      		eor r27,r21
 5410 1dca 8170      		andi r24,lo8(1)
 5411 1dcc 9070      		andi r25,hi8(1)
 5412 1dce 892B      		or r24,r25
 5413 1dd0 A1F0      		breq .L312
 5415               	.LM557:
 5416 1dd2 8091 0000 		lds r24,scan_channel_index
 5417 1dd6 8F5F      		subi r24,lo8(-(1))
 5418 1dd8 8093 0000 		sts scan_channel_index,r24
 5420               	.LM558:
 5421 1ddc 8031      		cpi r24,lo8(16)
 5422 1dde 08F0      		brlo .+2
 5423 1de0 46C0      		rjmp .L313
 5425               	.LM559:
 5426 1de2 7E01      		movw r14,r28
 5427 1de4 8F01      		movw r16,r30
 5428 1de6 04C0      		rjmp 2f
 5429 1de8 1695      	1:	lsr r17
 5430 1dea 0795      		ror r16
 5431 1dec F794      		ror r15
 5432 1dee E794      		ror r14
 5433 1df0 8A95      	2:	dec r24
 5434 1df2 D2F7      		brpl 1b
 5435 1df4 D801      		movw r26,r16
 5436 1df6 C701      		movw r24,r14
 5437 1df8 E4CF      		rjmp .L314
 5438               	.L312:
 5440               	.LM560:
 5441 1dfa 8091 0000 		lds r24,scan_channel_index
 5442 1dfe 982F      		mov r25,r24
 5443 1e00 8F5F      		subi r24,lo8(-(1))
 5444 1e02 8093 0000 		sts scan_channel_index,r24
 5445 1e06 692F      		mov r22,r25
 5446 1e08 80E0      		ldi r24,lo8(0)
 5447 1e0a 0E94 0000 		call PLME_SET_request
 5449               	.LM561:
 5450 1e0e 86E0      		ldi r24,lo8(6)
 5451 1e10 0E94 0000 		call PLME_SET_TRX_STATE_request
 5453               	.LM562:
 5454 1e14 84E0      		ldi r24,lo8(4)
 5455 1e16 8093 0000 		sts phy_channel_state,r24
 5457               	.LM563:
 5458 1e1a 0091 0000 		lds r16,scan_time_period
 5459 1e1e 1091 0000 		lds r17,(scan_time_period)+1
 5460 1e22 23E0      		ldi r18,lo8(3)
 5461 1e24 40E0      		ldi r20,lo8(0)
 5462 1e26 61E0      		ldi r22,lo8(1)
 5463 1e28 8091 0000 		lds r24,head_of_timer_queue
 5464 1e2c 9091 0000 		lds r25,(head_of_timer_queue)+1
 5465 1e30 0E94 0000 		call timer3queue_start
 5466 1e34 9093 0000 		sts (head_of_timer_queue)+1,r25
 5467 1e38 8093 0000 		sts head_of_timer_queue,r24
 5469               	.LM564:
 5470 1e3c 8091 0000 		lds r24,scan_channel_index
 5471 1e40 9927      		clr r25
 5472 1e42 0197      		sbiw r24,1
 5473 1e44 9F93      		push r25
 5474 1e46 8F93      		push r24
 5475 1e48 80E0      		ldi r24,lo8(.LC16)
 5476 1e4a 90E0      		ldi r25,hi8(.LC16)
 5477 1e4c 9F93      		push r25
 5478 1e4e 8F93      		push r24
 5479 1e50 0E94 0000 		call printf
 5480 1e54 0F90      		pop __tmp_reg__
 5481 1e56 0F90      		pop __tmp_reg__
 5482 1e58 0F90      		pop __tmp_reg__
 5483 1e5a 0F90      		pop __tmp_reg__
 5485               	.LM565:
 5486 1e5c 34C0      		rjmp .L279
 5487               	.L307:
 5489               	.LM566:
 5490 1e5e 6BEE      		ldi r22,lo8(-21)
 5491 1e60 8091 0000 		lds r24,default_short_addr
 5492 1e64 9091 0000 		lds r25,(default_short_addr)+1
 5493 1e68 0E94 0000 		call mlmeAssociateConfirm
 5495               	.LM567:
 5496 1e6c 2CC0      		rjmp .L279
 5497               	.L313:
 5499               	.LM568:
 5500 1e6e 85E0      		ldi r24,lo8(5)
 5501 1e70 8093 0000 		sts phy_channel_state,r24
 5503               	.LM569:
 5504 1e74 88E0      		ldi r24,lo8(8)
 5505 1e76 0E94 0000 		call PLME_SET_TRX_STATE_request
 5507               	.LM570:
 5508 1e7a 0DB7      		in r16,__SP_L__
 5509 1e7c 1EB7      		in r17,__SP_H__
 5510 1e7e 0458      		subi r16,lo8(-(-132))
 5511 1e80 1040      		sbci r17,hi8(-(-132))
 5512 1e82 0FB6      		in __tmp_reg__,__SREG__
 5513 1e84 F894      		cli
 5514 1e86 1EBF      		out __SP_H__,r17
 5515 1e88 0FBE      		out __SREG__,__tmp_reg__
 5516 1e8a 0DBF      		out __SP_L__,r16
 5517 1e8c ADB7      		in r26,__SP_L__
 5518 1e8e BEB7      		in r27,__SP_H__
 5519 1e90 1196      		adiw r26,1
 5520 1e92 84E8      		ldi r24,lo8(-124)
 5521 1e94 E0E0      		ldi r30,lo8(scan_result_info)
 5522 1e96 F0E0      		ldi r31,hi8(scan_result_info)
 5523 1e98 0190      		ld __tmp_reg__,Z+
 5524 1e9a 0D92      		st X+,__tmp_reg__
 5525 1e9c 8A95      		dec r24
 5526 1e9e E1F7      		brne .-8
 5527 1ea0 0E94 0000 		call mlmeScanConfirm
 5529               	.LM571:
 5530 1ea4 8DB7      		in r24,__SP_L__
 5531 1ea6 9EB7      		in r25,__SP_H__
 5532 1ea8 8C57      		subi r24,lo8(-(132))
 5533 1eaa 9F4F      		sbci r25,hi8(-(132))
 5534 1eac 0FB6      		in __tmp_reg__,__SREG__
 5535 1eae F894      		cli
 5536 1eb0 9EBF      		out __SP_H__,r25
 5537 1eb2 0FBE      		out __SREG__,__tmp_reg__
 5538 1eb4 8DBF      		out __SP_L__,r24
 5539 1eb6 0DC0      		rjmp .L278
 5540               	.L308:
 5542               	.LM572:
 5543 1eb8 8091 0000 		lds r24,IS_MAC_SYNING
 5544 1ebc 8823      		tst r24
 5545 1ebe 19F0      		breq .L279
 5547               	.LM573:
 5548 1ec0 80EE      		ldi r24,lo8(-32)
 5549 1ec2 0E94 0000 		call mlmeSyncLossIndication
 5550               	.L279:
 5552               	.LM574:
 5553 1ec6 8091 0000 		lds r24,current_timer_elem
 5554 1eca 9091 0000 		lds r25,(current_timer_elem)+1
 5555 1ece 0E94 0000 		call free
 5556               	.L278:
 5557               	/* epilogue: frame size=0 */
 5558 1ed2 DF91      		pop r29
 5559 1ed4 CF91      		pop r28
 5560 1ed6 1F91      		pop r17
 5561 1ed8 0F91      		pop r16
 5562 1eda FF90      		pop r15
 5563 1edc EF90      		pop r14
 5564 1ede 0895      		ret
 5565               	/* epilogue end (size=7) */
 5566               	/* function mac_timer_task size 315 (302) */
 5571               	.Lscope44:
 5576               	.global	mlmeScanRequest
 5578               	mlmeScanRequest:
 5580               	.LM575:
 5581               	/* prologue: frame size=0 */
 5582 1ee0 4F92      		push r4
 5583 1ee2 5F92      		push r5
 5584 1ee4 6F92      		push r6
 5585 1ee6 7F92      		push r7
 5586 1ee8 8F92      		push r8
 5587 1eea 9F92      		push r9
 5588 1eec AF92      		push r10
 5589 1eee BF92      		push r11
 5590 1ef0 CF92      		push r12
 5591 1ef2 DF92      		push r13
 5592 1ef4 EF92      		push r14
 5593 1ef6 FF92      		push r15
 5594 1ef8 0F93      		push r16
 5595 1efa 1F93      		push r17
 5596 1efc CF93      		push r28
 5597 1efe DF93      		push r29
 5598               	/* prologue end (size=16) */
 5599 1f00 4A01      		movw r8,r20
 5600 1f02 5B01      		movw r10,r22
 5602               	.LM576:
 5603 1f04 C0EA      		ldi r28,lo8(160)
 5604 1f06 D0E0      		ldi r29,hi8(160)
 5605 1f08 02C0      		rjmp 2f
 5606 1f0a CC0F      	1:	lsl r28
 5607 1f0c DD1F      		rol r29
 5608 1f0e 2A95      	2:	dec r18
 5609 1f10 E2F7      		brpl 1b
 5610 1f12 C056      		subi r28,lo8(-(160))
 5611 1f14 DF4F      		sbci r29,hi8(-(160))
 5613               	.LM577:
 5614 1f16 1092 0000 		sts scan_result_info+6,__zero_reg__
 5616               	.LM578:
 5617 1f1a 282F      		mov r18,r24
 5618 1f1c 3327      		clr r19
 5619 1f1e 2130      		cpi r18,1
 5620 1f20 3105      		cpc r19,__zero_reg__
 5621 1f22 09F4      		brne .+2
 5622 1f24 72C0      		rjmp .L329
 5624               	.LM579:
 5625 1f26 2230      		cpi r18,2
 5626 1f28 3105      		cpc r19,__zero_reg__
 5627 1f2a 24F4      		brge .L335
 5628 1f2c 2115      		cp r18,__zero_reg__
 5629 1f2e 3105      		cpc r19,__zero_reg__
 5630 1f30 31F0      		breq .L317
 5631 1f32 DBC0      		rjmp .L316
 5632               	.L335:
 5633 1f34 2330      		cpi r18,3
 5634 1f36 3105      		cpc r19,__zero_reg__
 5635 1f38 09F4      		brne .+2
 5636 1f3a D2C0      		rjmp .L334
 5637 1f3c D6C0      		rjmp .L316
 5638               	.L317:
 5640               	.LM580:
 5641 1f3e 85E0      		ldi r24,lo8(5)
 5642 1f40 8093 0000 		sts mac_current_state,r24
 5644               	.LM581:
 5645 1f44 8093 0000 		sts phy_channel_state,r24
 5647               	.LM582:
 5648 1f48 7090 0000 		lds r7,scan_result_info+6
 5649 1f4c 2901      		movw r4,r18
 5650               	.L328:
 5652               	.LM583:
 5653 1f4e 81E0      		ldi r24,lo8(1)
 5654 1f50 90E0      		ldi r25,hi8(1)
 5655 1f52 042C      		mov r0,r4
 5656 1f54 02C0      		rjmp 2f
 5657 1f56 880F      	1:	lsl r24
 5658 1f58 991F      		rol r25
 5659 1f5a 0A94      	2:	dec r0
 5660 1f5c E2F7      		brpl 1b
 5661 1f5e AA27      		clr r26
 5662 1f60 97FD      		sbrc r25,7
 5663 1f62 A095      		com r26
 5664 1f64 BA2F      		mov r27,r26
 5665 1f66 8821      		and r24,r8
 5666 1f68 9921      		and r25,r9
 5667 1f6a AA21      		and r26,r10
 5668 1f6c BB21      		and r27,r11
 5669 1f6e 0097      		sbiw r24,0
 5670 1f70 A105      		cpc r26,__zero_reg__
 5671 1f72 B105      		cpc r27,__zero_reg__
 5672 1f74 A1F1      		breq .L321
 5674               	.LM584:
 5675 1f76 0E94 0000 		call systime32
 5676 1f7a 6B01      		movw r12,r22
 5677 1f7c 7C01      		movw r14,r24
 5678 1f7e CE01      		movw r24,r28
 5679 1f80 AA27      		clr r26
 5680 1f82 BB27      		clr r27
 5681 1f84 880F      		lsl r24
 5682 1f86 991F      		rol r25
 5683 1f88 AA1F      		rol r26
 5684 1f8a BB1F      		rol r27
 5685 1f8c C80E      		add r12,r24
 5686 1f8e D91E      		adc r13,r25
 5687 1f90 EA1E      		adc r14,r26
 5688 1f92 FB1E      		adc r15,r27
 5690               	.LM585:
 5691 1f94 E0E8      		ldi r30,lo8(-128)
 5692 1f96 6E2E      		mov r6,r30
 5694               	.LM586:
 5695 1f98 672D      		mov r22,r7
 5696 1f9a 80E0      		ldi r24,lo8(0)
 5697 1f9c 0E94 0000 		call PLME_SET_request
 5698 1fa0 8C01      		movw r16,r24
 5700               	.LM587:
 5701 1fa2 86E0      		ldi r24,lo8(6)
 5702 1fa4 0E94 0000 		call PLME_SET_TRX_STATE_request
 5704               	.LM588:
 5705 1fa8 0730      		cpi r16,lo8(7)
 5706 1faa C9F4      		brne .L321
 5708               	.LM589:
 5709 1fac 05C0      		rjmp .L344
 5710               	.L326:
 5712               	.LM590:
 5713 1fae 0E94 0000 		call PLME_ED_request
 5715               	.LM591:
 5716 1fb2 9615      		cp r25,r6
 5717 1fb4 0CF0      		brlt .L344
 5719               	.LM592:
 5720 1fb6 692E      		mov r6,r25
 5721               	.L344:
 5722 1fb8 0E94 0000 		call systime32
 5723 1fbc DC01      		movw r26,r24
 5724 1fbe CB01      		movw r24,r22
 5725 1fc0 8C15      		cp r24,r12
 5726 1fc2 9D05      		cpc r25,r13
 5727 1fc4 AE05      		cpc r26,r14
 5728 1fc6 BF05      		cpc r27,r15
 5729 1fc8 91F7      		brne .L326
 5731               	.LM593:
 5732 1fca 8091 0000 		lds r24,scan_result_info+6
 5733 1fce E82F      		mov r30,r24
 5734 1fd0 FF27      		clr r31
 5735 1fd2 E050      		subi r30,lo8(-(scan_result_info))
 5736 1fd4 F040      		sbci r31,hi8(-(scan_result_info))
 5737 1fd6 6782      		std Z+7,r6
 5738 1fd8 8F5F      		subi r24,lo8(-(1))
 5739 1fda 8093 0000 		sts scan_result_info+6,r24
 5740               	.L321:
 5742               	.LM594:
 5743 1fde 8091 0000 		lds r24,scan_result_info+6
 5744 1fe2 8031      		cpi r24,lo8(16)
 5745 1fe4 40F4      		brsh .L319
 5747               	.LM595:
 5748 1fe6 7394      		inc r7
 5749 1fe8 0894      		sec
 5750 1fea 411C      		adc r4,__zero_reg__
 5751 1fec 511C      		adc r5,__zero_reg__
 5752 1fee 8FE0      		ldi r24,lo8(15)
 5753 1ff0 8715      		cp r24,r7
 5754 1ff2 08F0      		brlo .+2
 5755 1ff4 ACCF      		rjmp .L328
 5756               	.L319:
 5758               	.LM596:
 5759 1ff6 86E0      		ldi r24,lo8(6)
 5760 1ff8 8093 0000 		sts mac_current_state,r24
 5762               	.LM597:
 5763 1ffc 85E0      		ldi r24,lo8(5)
 5764 1ffe 8093 0000 		sts phy_channel_state,r24
 5766               	.LM598:
 5767 2002 88E0      		ldi r24,lo8(8)
 5768 2004 0E94 0000 		call PLME_SET_TRX_STATE_request
 5770               	.LM599:
 5771 2008 70C0      		rjmp .L316
 5772               	.L329:
 5774               	.LM600:
 5775 200a 1092 0000 		sts scan_channel_index,__zero_reg__
 5777               	.LM601:
 5778 200e 4093 0000 		sts scan_channel,r20
 5779 2012 5093 0000 		sts (scan_channel)+1,r21
 5780 2016 6093 0000 		sts (scan_channel)+2,r22
 5781 201a 7093 0000 		sts (scan_channel)+3,r23
 5783               	.LM602:
 5784 201e D093 0000 		sts (scan_time_period)+1,r29
 5785 2022 C093 0000 		sts scan_time_period,r28
 5787               	.LM603:
 5788 2026 0E94 0000 		call cc2420_bcn_accept
 5790               	.LM604:
 5791 202a 8091 0000 		lds r24,default_short_addr
 5792 202e 9091 0000 		lds r25,(default_short_addr)+1
 5793 2032 0E94 0000 		call cc2420_setshortaddress
 5795               	.LM605:
 5796 2036 8091 0000 		lds r24,default_short_addr
 5797 203a 9091 0000 		lds r25,(default_short_addr)+1
 5798 203e 0E94 0000 		call cc2420_setpanid
 5800               	.LM606:
 5801 2042 87E0      		ldi r24,lo8(7)
 5802 2044 8093 0000 		sts mac_current_state,r24
 5804               	.LM607:
 5805 2048 D501      		movw r26,r10
 5806 204a C401      		movw r24,r8
 5807 204c 0090 0000 		lds r0,scan_channel_index
 5808 2050 04C0      		rjmp 2f
 5809 2052 B695      	1:	lsr r27
 5810 2054 A795      		ror r26
 5811 2056 9795      		ror r25
 5812 2058 8795      		ror r24
 5813 205a 0A94      	2:	dec r0
 5814 205c D2F7      		brpl 1b
 5815 205e 21E0      		ldi r18,lo8(1)
 5816 2060 30E0      		ldi r19,hi8(1)
 5817 2062 40E0      		ldi r20,hlo8(1)
 5818 2064 50E0      		ldi r21,hhi8(1)
 5819               	.L343:
 5820 2066 8227      		eor r24,r18
 5821 2068 9327      		eor r25,r19
 5822 206a A427      		eor r26,r20
 5823 206c B527      		eor r27,r21
 5824 206e 8170      		andi r24,lo8(1)
 5825 2070 9070      		andi r25,hi8(1)
 5826 2072 892B      		or r24,r25
 5827 2074 99F0      		breq .L338
 5829               	.LM608:
 5830 2076 8091 0000 		lds r24,scan_channel_index
 5831 207a 8F5F      		subi r24,lo8(-(1))
 5832 207c 8093 0000 		sts scan_channel_index,r24
 5834               	.LM609:
 5835 2080 8031      		cpi r24,lo8(16)
 5836 2082 99F1      		breq .L316
 5838               	.LM610:
 5839 2084 F501      		movw r30,r10
 5840 2086 E401      		movw r28,r8
 5841 2088 04C0      		rjmp 2f
 5842 208a F695      	1:	lsr r31
 5843 208c E795      		ror r30
 5844 208e D795      		ror r29
 5845 2090 C795      		ror r28
 5846 2092 8A95      	2:	dec r24
 5847 2094 D2F7      		brpl 1b
 5848 2096 CE01      		movw r24,r28
 5849 2098 DF01      		movw r26,r30
 5850 209a E5CF      		rjmp .L343
 5851               	.L338:
 5853               	.LM611:
 5854 209c 8091 0000 		lds r24,scan_channel_index
 5855 20a0 982F      		mov r25,r24
 5856 20a2 8F5F      		subi r24,lo8(-(1))
 5857 20a4 8093 0000 		sts scan_channel_index,r24
 5858 20a8 692F      		mov r22,r25
 5859 20aa 80E0      		ldi r24,lo8(0)
 5860 20ac 0E94 0000 		call PLME_SET_request
 5862               	.LM612:
 5863 20b0 0091 0000 		lds r16,scan_time_period
 5864 20b4 1091 0000 		lds r17,(scan_time_period)+1
 5865 20b8 23E0      		ldi r18,lo8(3)
 5866 20ba 40E0      		ldi r20,lo8(0)
 5867 20bc 61E0      		ldi r22,lo8(1)
 5868 20be 8091 0000 		lds r24,head_of_timer_queue
 5869 20c2 9091 0000 		lds r25,(head_of_timer_queue)+1
 5870 20c6 0E94 0000 		call timer3queue_start
 5871 20ca 9093 0000 		sts (head_of_timer_queue)+1,r25
 5872 20ce 8093 0000 		sts head_of_timer_queue,r24
 5874               	.LM613:
 5875 20d2 86E0      		ldi r24,lo8(6)
 5876 20d4 0E94 0000 		call PLME_SET_TRX_STATE_request
 5878               	.LM614:
 5879 20d8 84E0      		ldi r24,lo8(4)
 5880 20da 8093 0000 		sts phy_channel_state,r24
 5882               	.LM615:
 5883 20de 05C0      		rjmp .L316
 5884               	.L334:
 5886               	.LM616:
 5887 20e0 88E0      		ldi r24,lo8(8)
 5888 20e2 8093 0000 		sts mac_current_state,r24
 5890               	.LM617:
 5891 20e6 0E94 0000 		call orphan_notification_frame_send
 5892               	.L316:
 5893               	/* epilogue: frame size=0 */
 5894 20ea DF91      		pop r29
 5895 20ec CF91      		pop r28
 5896 20ee 1F91      		pop r17
 5897 20f0 0F91      		pop r16
 5898 20f2 FF90      		pop r15
 5899 20f4 EF90      		pop r14
 5900 20f6 DF90      		pop r13
 5901 20f8 CF90      		pop r12
 5902 20fa BF90      		pop r11
 5903 20fc AF90      		pop r10
 5904 20fe 9F90      		pop r9
 5905 2100 8F90      		pop r8
 5906 2102 7F90      		pop r7
 5907 2104 6F90      		pop r6
 5908 2106 5F90      		pop r5
 5909 2108 4F90      		pop r4
 5910 210a 0895      		ret
 5911               	/* epilogue end (size=17) */
 5912               	/* function mlmeScanRequest size 280 (247) */
 5922               	.Lscope45:
 5924               	.global	scan_task
 5926               	scan_task:
 5928               	.LM618:
 5929               	/* prologue: frame size=0 */
 5930               	/* prologue end (size=0) */
 5932               	.LM619:
 5933 210c 26E0      		ldi r18,lo8(6)
 5934 210e 48E0      		ldi r20,lo8(8)
 5935 2110 50E0      		ldi r21,hi8(8)
 5936 2112 60E0      		ldi r22,hlo8(8)
 5937 2114 70E0      		ldi r23,hhi8(8)
 5938 2116 81E0      		ldi r24,lo8(1)
 5939 2118 0E94 0000 		call mlmeScanRequest
 5940               	/* epilogue: frame size=0 */
 5941 211c 0895      		ret
 5942               	/* epilogue end (size=1) */
 5943               	/* function scan_task size 9 (8) */
 5945               	.Lscope46:
 5947               	.global	panid_confilct_frame_send
 5949               	panid_confilct_frame_send:
 5951               	.LM620:
 5952               	/* prologue: frame size=0 */
 5953               	/* prologue end (size=0) */
 5955               	.LM621:
 5956 211e 85E0      		ldi r24,lo8(5)
 5957 2120 8093 0000 		sts mac_tx_current_frame+27,r24
 5959               	.LM622:
 5960 2124 23E0      		ldi r18,lo8(3)
 5961 2126 2093 0000 		sts mac_tx_current_frame+26,r18
 5963               	.LM623:
 5964 212a 8091 0000 		lds r24,mac_pib_data+24
 5965 212e 982F      		mov r25,r24
 5966 2130 8F5F      		subi r24,lo8(-(1))
 5967 2132 8093 0000 		sts mac_pib_data+24,r24
 5968 2136 9093 0000 		sts mac_tx_current_frame+28,r25
 5970               	.LM624:
 5971 213a 2093 0000 		sts mac_tx_current_frame+13,r18
 5973               	.LM625:
 5974 213e 82E0      		ldi r24,lo8(2)
 5975 2140 8093 0000 		sts mac_tx_current_frame,r24
 5977               	.LM626:
 5978 2144 8091 0000 		lds r24,mac_pib_data+28
 5979 2148 9091 0000 		lds r25,(mac_pib_data+28)+1
 5980 214c 9093 0000 		sts (mac_tx_current_frame+24)+1,r25
 5981 2150 8093 0000 		sts mac_tx_current_frame+24,r24
 5983               	.LM627:
 5984 2154 9093 0000 		sts (mac_tx_current_frame+11)+1,r25
 5985 2158 8093 0000 		sts mac_tx_current_frame+11,r24
 5987               	.LM628:
 5988 215c 88E0      		ldi r24,lo8(8)
 5989 215e A0E0      		ldi r26,lo8(mac_pib_data+34)
 5990 2160 B0E0      		ldi r27,hi8(mac_pib_data+34)
 5991 2162 E0E0      		ldi r30,lo8(mac_tx_current_frame+14)
 5992 2164 F0E0      		ldi r31,hi8(mac_tx_current_frame+14)
 5993 2166 0D90      		ld __tmp_reg__,X+
 5994 2168 0192      		st Z+,__tmp_reg__
 5995 216a 8A95      		dec r24
 5996 216c E1F7      		brne .-8
 5998               	.LM629:
 5999 216e 8091 0000 		lds r24,mac_pib_data+22
 6000 2172 9091 0000 		lds r25,(mac_pib_data+22)+1
 6001 2176 9093 0000 		sts (mac_tx_current_frame+9)+1,r25
 6002 217a 8093 0000 		sts mac_tx_current_frame+9,r24
 6004               	.LM630:
 6005 217e 83E2      		ldi r24,lo8(35)
 6006 2180 8093 0000 		sts mac_tx_current_frame+36,r24
 6008               	.LM631:
 6009 2184 88EC      		ldi r24,lo8(-56)
 6010 2186 8093 0000 		sts mac_tx_current_frame+37,r24
 6012               	.LM632:
 6013 218a 0E94 0000 		call mac_frame_send
 6014               	/* epilogue: frame size=0 */
 6015 218e 0895      		ret
 6016               	/* epilogue end (size=1) */
 6017               	/* function panid_confilct_frame_send size 57 (56) */
 6019               	.Lscope47:
 6023               	.global	disassociate_notification_frame_send
 6025               	disassociate_notification_frame_send:
 6027               	.LM633:
 6028               	/* prologue: frame size=8 */
 6029 2190 0F93      		push r16
 6030 2192 1F93      		push r17
 6031 2194 CF93      		push r28
 6032 2196 DF93      		push r29
 6033 2198 CDB7      		in r28,__SP_L__
 6034 219a DEB7      		in r29,__SP_H__
 6035 219c 2897      		sbiw r28,8
 6036 219e 0FB6      		in __tmp_reg__,__SREG__
 6037 21a0 F894      		cli
 6038 21a2 DEBF      		out __SP_H__,r29
 6039 21a4 0FBE      		out __SREG__,__tmp_reg__
 6040 21a6 CDBF      		out __SP_L__,r28
 6041               	/* prologue end (size=12) */
 6042 21a8 0983      		std Y+1,r16
 6043 21aa 1A83      		std Y+2,r17
 6044 21ac 2B83      		std Y+3,r18
 6045 21ae 3C83      		std Y+4,r19
 6046 21b0 4D83      		std Y+5,r20
 6047 21b2 5E83      		std Y+6,r21
 6048 21b4 6F83      		std Y+7,r22
 6049 21b6 7887      		std Y+8,r23
 6050 21b8 23E0      		ldi r18,lo8(3)
 6051 21ba 2093 0000 		sts mac_tx_current_frame+27,r18
 6053               	.LM634:
 6054 21be 2093 0000 		sts mac_tx_current_frame+26,r18
 6056               	.LM635:
 6057 21c2 9091 0000 		lds r25,mac_pib_data+24
 6058 21c6 392F      		mov r19,r25
 6059 21c8 9F5F      		subi r25,lo8(-(1))
 6060 21ca 9093 0000 		sts mac_pib_data+24,r25
 6061 21ce 3093 0000 		sts mac_tx_current_frame+28,r19
 6063               	.LM636:
 6064 21d2 2093 0000 		sts mac_tx_current_frame+13,r18
 6066               	.LM637:
 6067 21d6 2093 0000 		sts mac_tx_current_frame,r18
 6069               	.LM638:
 6070 21da 2091 0000 		lds r18,mac_pib_data+28
 6071 21de 3091 0000 		lds r19,(mac_pib_data+28)+1
 6072 21e2 3093 0000 		sts (mac_tx_current_frame+24)+1,r19
 6073 21e6 2093 0000 		sts mac_tx_current_frame+24,r18
 6075               	.LM639:
 6076 21ea 3093 0000 		sts (mac_tx_current_frame+11)+1,r19
 6077 21ee 2093 0000 		sts mac_tx_current_frame+11,r18
 6079               	.LM640:
 6080 21f2 60E0      		ldi r22,lo8(mac_tx_current_frame+14)
 6081 21f4 70E0      		ldi r23,hi8(mac_tx_current_frame+14)
 6082 21f6 98E0      		ldi r25,lo8(8)
 6083 21f8 40E0      		ldi r20,lo8(mac_pib_data+34)
 6084 21fa 50E0      		ldi r21,hi8(mac_pib_data+34)
 6085 21fc DB01      		movw r26,r22
 6086 21fe FA01      		movw r30,r20
 6087 2200 292F      		mov r18,r25
 6088 2202 0190      		ld __tmp_reg__,Z+
 6089 2204 0D92      		st X+,__tmp_reg__
 6090 2206 2A95      		dec r18
 6091 2208 E1F7      		brne .-8
 6093               	.LM641:
 6094 220a FB01      		movw r30,r22
 6095 220c 3D97      		sbiw r30,13
 6096 220e DE01      		movw r26,r28
 6097 2210 1196      		adiw r26,1
 6098 2212 0D90      		ld __tmp_reg__,X+
 6099 2214 0192      		st Z+,__tmp_reg__
 6100 2216 9A95      		dec r25
 6101 2218 E1F7      		brne .-8
 6103               	.LM642:
 6104 221a 8093 0000 		sts mac_tx_current_frame+172,r24
 6106               	.LM643:
 6107 221e 83E2      		ldi r24,lo8(35)
 6108 2220 8093 0000 		sts mac_tx_current_frame+36,r24
 6110               	.LM644:
 6111 2224 8CEC      		ldi r24,lo8(-52)
 6112 2226 8093 0000 		sts mac_tx_current_frame+37,r24
 6114               	.LM645:
 6115 222a 0E94 0000 		call mac_frame_send
 6116               	/* epilogue: frame size=8 */
 6117 222e 2896      		adiw r28,8
 6118 2230 0FB6      		in __tmp_reg__,__SREG__
 6119 2232 F894      		cli
 6120 2234 DEBF      		out __SP_H__,r29
 6121 2236 0FBE      		out __SREG__,__tmp_reg__
 6122 2238 CDBF      		out __SP_L__,r28
 6123 223a DF91      		pop r29
 6124 223c CF91      		pop r28
 6125 223e 1F91      		pop r17
 6126 2240 0F91      		pop r16
 6127 2242 0895      		ret
 6128               	/* epilogue end (size=11) */
 6129               	/* function disassociate_notification_frame_send size 90 (67) */
 6131               	.Lscope48:
 6136               	.global	mlmeDisassociateRequest
 6138               	mlmeDisassociateRequest:
 6140               	.LM646:
 6141               	/* prologue: frame size=37 */
 6142 2244 FF92      		push r15
 6143 2246 0F93      		push r16
 6144 2248 1F93      		push r17
 6145 224a CF93      		push r28
 6146 224c DF93      		push r29
 6147 224e CDB7      		in r28,__SP_L__
 6148 2250 DEB7      		in r29,__SP_H__
 6149 2252 A597      		sbiw r28,37
 6150 2254 0FB6      		in __tmp_reg__,__SREG__
 6151 2256 F894      		cli
 6152 2258 DEBF      		out __SP_H__,r29
 6153 225a 0FBE      		out __SREG__,__tmp_reg__
 6154 225c CDBF      		out __SP_L__,r28
 6155               	/* prologue end (size=13) */
 6156 225e 2983      		std Y+1,r18
 6157 2260 3A83      		std Y+2,r19
 6158 2262 4B83      		std Y+3,r20
 6159 2264 5C83      		std Y+4,r21
 6160 2266 6D83      		std Y+5,r22
 6161 2268 7E83      		std Y+6,r23
 6162 226a 8F83      		std Y+7,r24
 6163 226c 9887      		std Y+8,r25
 6164 226e F02E      		mov r15,r16
 6166               	.LM647:
 6167 2270 83E0      		ldi r24,lo8(3)
 6168 2272 8C87      		std Y+12,r24
 6170               	.LM648:
 6171 2274 898F      		std Y+25,r24
 6173               	.LM649:
 6174 2276 8091 0000 		lds r24,mac_pib_data+28
 6175 227a 9091 0000 		lds r25,(mac_pib_data+28)+1
 6176 227e 8F8B      		std Y+23,r24
 6177 2280 988F      		std Y+24,r25
 6179               	.LM650:
 6180 2282 8CA3      		std Y+36,r24
 6181 2284 9DA3      		std Y+37,r25
 6183               	.LM651:
 6184 2286 60E0      		ldi r22,lo8(mac_pib_data+34)
 6185 2288 70E0      		ldi r23,hi8(mac_pib_data+34)
 6186 228a 48E0      		ldi r20,lo8(8)
 6187 228c FE01      		movw r30,r28
 6188 228e 7A96      		adiw r30,26
 6189 2290 DB01      		movw r26,r22
 6190 2292 242F      		mov r18,r20
 6191 2294 0D90      		ld __tmp_reg__,X+
 6192 2296 0192      		st Z+,__tmp_reg__
 6193 2298 2A95      		dec r18
 6194 229a E1F7      		brne .-8
 6196               	.LM652:
 6197 229c 83E2      		ldi r24,lo8(35)
 6198 229e 8987      		std Y+9,r24
 6200               	.LM653:
 6201 22a0 8CEC      		ldi r24,lo8(-52)
 6202 22a2 8A87      		std Y+10,r24
 6204               	.LM654:
 6205 22a4 8091 0000 		lds r24,mac_current_state
 6206 22a8 8031      		cpi r24,lo8(16)
 6207 22aa 09F0      		breq .+2
 6208 22ac 78C0      		rjmp .L354
 6210               	.LM655:
 6211 22ae 8091 0000 		lds r24,current_pending_num
 6212 22b2 9E01      		movw r18,r28
 6213 22b4 235F      		subi r18,lo8(-(13))
 6214 22b6 3F4F      		sbci r19,hi8(-(13))
 6215 22b8 8330      		cpi r24,lo8(3)
 6216 22ba 08F0      		brlo .+2
 6217 22bc 56C0      		rjmp .L358
 6219               	.LM656:
 6220 22be BE01      		movw r22,r28
 6221 22c0 6F5F      		subi r22,lo8(-(1))
 6222 22c2 7F4F      		sbci r23,hi8(-(1))
 6223 22c4 D901      		movw r26,r18
 6224 22c6 FB01      		movw r30,r22
 6225 22c8 842F      		mov r24,r20
 6226 22ca 0190      		ld __tmp_reg__,Z+
 6227 22cc 0D92      		st X+,__tmp_reg__
 6228 22ce 8A95      		dec r24
 6229 22d0 E1F7      		brne .-8
 6231               	.LM657:
 6232 22d2 8091 0000 		lds r24,default_short_addr
 6233 22d6 9091 0000 		lds r25,(default_short_addr)+1
 6234 22da 9F93      		push r25
 6235 22dc 8F93      		push r24
 6236 22de ADB7      		in r26,__SP_L__
 6237 22e0 BEB7      		in r27,__SP_H__
 6238 22e2 1897      		sbiw r26,8
 6239 22e4 0FB6      		in __tmp_reg__,__SREG__
 6240 22e6 F894      		cli
 6241 22e8 BEBF      		out __SP_H__,r27
 6242 22ea 0FBE      		out __SREG__,__tmp_reg__
 6243 22ec ADBF      		out __SP_L__,r26
 6244 22ee EDB7      		in r30,__SP_L__
 6245 22f0 FEB7      		in r31,__SP_H__
 6246 22f2 3196      		adiw r30,1
 6247 22f4 DB01      		movw r26,r22
 6248 22f6 0D90      		ld __tmp_reg__,X+
 6249 22f8 0192      		st Z+,__tmp_reg__
 6250 22fa 4A95      		dec r20
 6251 22fc E1F7      		brne .-8
 6252 22fe 1F92      		push __zero_reg__
 6253 2300 0F93      		push r16
 6254 2302 1F92      		push __zero_reg__
 6255 2304 1F92      		push __zero_reg__
 6256 2306 1F92      		push __zero_reg__
 6257 2308 EDB7      		in r30,__SP_L__
 6258 230a FEB7      		in r31,__SP_H__
 6259 230c 3D97      		sbiw r30,13
 6260 230e 0FB6      		in __tmp_reg__,__SREG__
 6261 2310 F894      		cli
 6262 2312 FEBF      		out __SP_H__,r31
 6263 2314 0FBE      		out __SREG__,__tmp_reg__
 6264 2316 EDBF      		out __SP_L__,r30
 6265 2318 ADB7      		in r26,__SP_L__
 6266 231a BEB7      		in r27,__SP_H__
 6267 231c 1196      		adiw r26,1
 6268 231e 8DE0      		ldi r24,lo8(13)
 6269 2320 FE01      		movw r30,r28
 6270 2322 7996      		adiw r30,25
 6271 2324 282F      		mov r18,r24
 6272 2326 0190      		ld __tmp_reg__,Z+
 6273 2328 0D92      		st X+,__tmp_reg__
 6274 232a 2A95      		dec r18
 6275 232c E1F7      		brne .-8
 6276 232e ADB7      		in r26,__SP_L__
 6277 2330 BEB7      		in r27,__SP_H__
 6278 2332 1D97      		sbiw r26,13
 6279 2334 0FB6      		in __tmp_reg__,__SREG__
 6280 2336 F894      		cli
 6281 2338 BEBF      		out __SP_H__,r27
 6282 233a 0FBE      		out __SREG__,__tmp_reg__
 6283 233c ADBF      		out __SP_L__,r26
 6284 233e 1196      		adiw r26,1
 6285 2340 FE01      		movw r30,r28
 6286 2342 3C96      		adiw r30,12
 6287 2344 0190      		ld __tmp_reg__,Z+
 6288 2346 0D92      		st X+,__tmp_reg__
 6289 2348 8A95      		dec r24
 6290 234a E1F7      		brne .-8
 6291 234c 4985      		ldd r20,Y+9
 6292 234e 5A85      		ldd r21,Y+10
 6293 2350 6B85      		ldd r22,Y+11
 6294 2352 80E0      		ldi r24,lo8(0)
 6295 2354 0E94 0000 		call add_pending_queue
 6296 2358 EDB7      		in r30,__SP_L__
 6297 235a FEB7      		in r31,__SP_H__
 6298 235c B996      		adiw r30,41
 6299 235e 0FB6      		in __tmp_reg__,__SREG__
 6300 2360 F894      		cli
 6301 2362 FEBF      		out __SP_H__,r31
 6302 2364 0FBE      		out __SREG__,__tmp_reg__
 6303 2366 EDBF      		out __SP_L__,r30
 6304 2368 1AC0      		rjmp .L354
 6305               	.L358:
 6307               	.LM658:
 6308 236a FB01      		movw r30,r22
 6309 236c 7497      		sbiw r30,20
 6310 236e D901      		movw r26,r18
 6311 2370 0190      		ld __tmp_reg__,Z+
 6312 2372 0D92      		st X+,__tmp_reg__
 6313 2374 4A95      		dec r20
 6314 2376 E1F7      		brne .-8
 6316               	.LM659:
 6317 2378 0091 0000 		lds r16,mac_pib_data+14
 6318 237c 1091 0000 		lds r17,mac_pib_data+15
 6319 2380 2091 0000 		lds r18,mac_pib_data+16
 6320 2384 3091 0000 		lds r19,mac_pib_data+17
 6321 2388 4091 0000 		lds r20,mac_pib_data+18
 6322 238c 5091 0000 		lds r21,mac_pib_data+19
 6323 2390 6091 0000 		lds r22,mac_pib_data+20
 6324 2394 7091 0000 		lds r23,mac_pib_data+21
 6325 2398 8F2D      		mov r24,r15
 6326 239a 0E94 0000 		call disassociate_notification_frame_send
 6327               	.L354:
 6328               	/* epilogue: frame size=37 */
 6329 239e A596      		adiw r28,37
 6330 23a0 0FB6      		in __tmp_reg__,__SREG__
 6331 23a2 F894      		cli
 6332 23a4 DEBF      		out __SP_H__,r29
 6333 23a6 0FBE      		out __SREG__,__tmp_reg__
 6334 23a8 CDBF      		out __SP_L__,r28
 6335 23aa DF91      		pop r29
 6336 23ac CF91      		pop r28
 6337 23ae 1F91      		pop r17
 6338 23b0 0F91      		pop r16
 6339 23b2 FF90      		pop r15
 6340 23b4 0895      		ret
 6341               	/* epilogue end (size=12) */
 6342               	/* function mlmeDisassociateRequest size 185 (160) */
 6349               	.Lscope49:
 6354               	.global	associate_request_frame_send
 6356               	associate_request_frame_send:
 6358               	.LM660:
 6359               	/* prologue: frame size=13 */
 6360 23b6 8F92      		push r8
 6361 23b8 AF92      		push r10
 6362 23ba BF92      		push r11
 6363 23bc CF92      		push r12
 6364 23be DF92      		push r13
 6365 23c0 EF92      		push r14
 6366 23c2 FF92      		push r15
 6367 23c4 0F93      		push r16
 6368 23c6 1F93      		push r17
 6369 23c8 CF93      		push r28
 6370 23ca DF93      		push r29
 6371 23cc CDB7      		in r28,__SP_L__
 6372 23ce DEB7      		in r29,__SP_H__
 6373 23d0 2D97      		sbiw r28,13
 6374 23d2 0FB6      		in __tmp_reg__,__SREG__
 6375 23d4 F894      		cli
 6376 23d6 DEBF      		out __SP_H__,r29
 6377 23d8 0FBE      		out __SREG__,__tmp_reg__
 6378 23da CDBF      		out __SP_L__,r28
 6379               	/* prologue end (size=19) */
 6380 23dc A982      		std Y+1,r10
 6381 23de BA82      		std Y+2,r11
 6382 23e0 CB82      		std Y+3,r12
 6383 23e2 DC82      		std Y+4,r13
 6384 23e4 ED82      		std Y+5,r14
 6385 23e6 FE82      		std Y+6,r15
 6386 23e8 0F83      		std Y+7,r16
 6387 23ea 1887      		std Y+8,r17
 6388 23ec 2987      		std Y+9,r18
 6389 23ee 3A87      		std Y+10,r19
 6390 23f0 4B87      		std Y+11,r20
 6391 23f2 5C87      		std Y+12,r21
 6392 23f4 6D87      		std Y+13,r22
 6394               	.LM661:
 6395 23f6 81E0      		ldi r24,lo8(1)
 6396 23f8 8093 0000 		sts mac_tx_current_frame+27,r24
 6398               	.LM662:
 6399 23fc 23E0      		ldi r18,lo8(3)
 6400 23fe 2093 0000 		sts mac_tx_current_frame+26,r18
 6402               	.LM663:
 6403 2402 8091 0000 		lds r24,mac_pib_data+24
 6404 2406 982F      		mov r25,r24
 6405 2408 8F5F      		subi r24,lo8(-(1))
 6406 240a 8093 0000 		sts mac_pib_data+24,r24
 6407 240e 9093 0000 		sts mac_tx_current_frame+28,r25
 6409               	.LM664:
 6410 2412 2093 0000 		sts mac_tx_current_frame+13,r18
 6412               	.LM665:
 6413 2416 60E0      		ldi r22,lo8(mac_tx_current_frame)
 6414 2418 70E0      		ldi r23,hi8(mac_tx_current_frame)
 6415 241a 8DE0      		ldi r24,lo8(13)
 6416 241c AE01      		movw r20,r28
 6417 241e 4F5F      		subi r20,lo8(-(1))
 6418 2420 5F4F      		sbci r21,hi8(-(1))
 6419 2422 DB01      		movw r26,r22
 6420 2424 FA01      		movw r30,r20
 6421 2426 0190      		ld __tmp_reg__,Z+
 6422 2428 0D92      		st X+,__tmp_reg__
 6423 242a 8A95      		dec r24
 6424 242c E1F7      		brne .-8
 6426               	.LM666:
 6427 242e 8091 0000 		lds r24,default_short_addr
 6428 2432 9091 0000 		lds r25,(default_short_addr)+1
 6429 2436 9093 0000 		sts (mac_tx_current_frame+24)+1,r25
 6430 243a 8093 0000 		sts mac_tx_current_frame+24,r24
 6432               	.LM667:
 6433 243e FB01      		movw r30,r22
 6434 2440 3E96      		adiw r30,14
 6435 2442 88E0      		ldi r24,lo8(8)
 6436 2444 A0E0      		ldi r26,lo8(mac_pib_data+34)
 6437 2446 B0E0      		ldi r27,hi8(mac_pib_data+34)
 6438 2448 0D90      		ld __tmp_reg__,X+
 6439 244a 0192      		st Z+,__tmp_reg__
 6440 244c 8A95      		dec r24
 6441 244e E1F7      		brne .-8
 6443               	.LM668:
 6444 2450 8092 0000 		sts mac_tx_current_frame+143,r8
 6446               	.LM669:
 6447 2454 83E2      		ldi r24,lo8(35)
 6448 2456 8093 0000 		sts mac_tx_current_frame+36,r24
 6450               	.LM670:
 6451 245a 8091 0000 		lds r24,mac_tx_current_frame
 6452 245e 282F      		mov r18,r24
 6453 2460 3327      		clr r19
 6454 2462 220F      		lsl r18
 6455 2464 331F      		rol r19
 6456 2466 220F      		lsl r18
 6457 2468 331F      		rol r19
 6458 246a 8091 0000 		lds r24,mac_tx_current_frame+13
 6459 246e 9927      		clr r25
 6460 2470 A6E0      		ldi r26,6
 6461 2472 880F      	1:	lsl r24
 6462 2474 991F      		rol r25
 6463 2476 AA95      		dec r26
 6464 2478 E1F7      		brne 1b
 6465 247a 822B      		or r24,r18
 6466 247c 8093 0000 		sts mac_tx_current_frame+37,r24
 6468               	.LM671:
 6469 2480 0E94 0000 		call mac_frame_send
 6470               	/* epilogue: frame size=13 */
 6471 2484 2D96      		adiw r28,13
 6472 2486 0FB6      		in __tmp_reg__,__SREG__
 6473 2488 F894      		cli
 6474 248a DEBF      		out __SP_H__,r29
 6475 248c 0FBE      		out __SREG__,__tmp_reg__
 6476 248e CDBF      		out __SP_L__,r28
 6477 2490 DF91      		pop r29
 6478 2492 CF91      		pop r28
 6479 2494 1F91      		pop r17
 6480 2496 0F91      		pop r16
 6481 2498 FF90      		pop r15
 6482 249a EF90      		pop r14
 6483 249c DF90      		pop r13
 6484 249e CF90      		pop r12
 6485 24a0 BF90      		pop r11
 6486 24a2 AF90      		pop r10
 6487 24a4 8F90      		pop r8
 6488 24a6 0895      		ret
 6489               	/* epilogue end (size=18) */
 6490               	/* function associate_request_frame_send size 121 (84) */
 6492               	.Lscope50:
 6500               	.global	mlmeAssociateRequest
 6502               	mlmeAssociateRequest:
 6504               	.LM672:
 6505               	/* prologue: frame size=21 */
 6506 24a8 CF92      		push r12
 6507 24aa DF92      		push r13
 6508 24ac EF92      		push r14
 6509 24ae FF92      		push r15
 6510 24b0 0F93      		push r16
 6511 24b2 1F93      		push r17
 6512 24b4 CF93      		push r28
 6513 24b6 DF93      		push r29
 6514 24b8 CDB7      		in r28,__SP_L__
 6515 24ba DEB7      		in r29,__SP_H__
 6516 24bc 6597      		sbiw r28,21
 6517 24be 0FB6      		in __tmp_reg__,__SREG__
 6518 24c0 F894      		cli
 6519 24c2 DEBF      		out __SP_H__,r29
 6520 24c4 0FBE      		out __SREG__,__tmp_reg__
 6521 24c6 CDBF      		out __SP_L__,r28
 6522               	/* prologue end (size=16) */
 6523 24c8 C982      		std Y+1,r12
 6524 24ca DA82      		std Y+2,r13
 6525 24cc EB82      		std Y+3,r14
 6526 24ce FC82      		std Y+4,r15
 6527 24d0 0D83      		std Y+5,r16
 6528 24d2 1E83      		std Y+6,r17
 6529 24d4 2F83      		std Y+7,r18
 6530 24d6 3887      		std Y+8,r19
 6532               	.LM673:
 6533 24d8 6987      		std Y+9,r22
 6535               	.LM674:
 6536 24da 4C8B      		std Y+20,r20
 6537 24dc 5D8B      		std Y+21,r21
 6539               	.LM675:
 6540 24de 6330      		cpi r22,lo8(3)
 6541 24e0 51F4      		brne .L362
 6543               	.LM676:
 6544 24e2 88E0      		ldi r24,lo8(8)
 6545 24e4 DE01      		movw r26,r28
 6546 24e6 1196      		adiw r26,1
 6547 24e8 FE01      		movw r30,r28
 6548 24ea 3A96      		adiw r30,10
 6549 24ec 0D90      		ld __tmp_reg__,X+
 6550 24ee 0192      		st Z+,__tmp_reg__
 6551 24f0 8A95      		dec r24
 6552 24f2 E1F7      		brne .-8
 6553 24f4 06C0      		rjmp .L361
 6554               	.L362:
 6556               	.LM677:
 6557 24f6 6230      		cpi r22,lo8(2)
 6558 24f8 21F4      		brne .L361
 6560               	.LM678:
 6561 24fa 8981      		ldd r24,Y+1
 6562 24fc 9A81      		ldd r25,Y+2
 6563 24fe 8A8B      		std Y+18,r24
 6564 2500 9B8B      		std Y+19,r25
 6565               	.L361:
 6566               	/* epilogue: frame size=21 */
 6567 2502 6596      		adiw r28,21
 6568 2504 0FB6      		in __tmp_reg__,__SREG__
 6569 2506 F894      		cli
 6570 2508 DEBF      		out __SP_H__,r29
 6571 250a 0FBE      		out __SREG__,__tmp_reg__
 6572 250c CDBF      		out __SP_L__,r28
 6573 250e DF91      		pop r29
 6574 2510 CF91      		pop r28
 6575 2512 1F91      		pop r17
 6576 2514 0F91      		pop r16
 6577 2516 FF90      		pop r15
 6578 2518 EF90      		pop r14
 6579 251a DF90      		pop r13
 6580 251c CF90      		pop r12
 6581 251e 0895      		ret
 6582               	/* epilogue end (size=15) */
 6583               	/* function mlmeAssociateRequest size 60 (29) */
 6588               	.Lscope51:
 6595               	.global	data_frame_send
 6597               	data_frame_send:
 6599               	.LM679:
 6600               	/* prologue: frame size=13 */
 6601 2520 6F92      		push r6
 6602 2522 7F92      		push r7
 6603 2524 8F92      		push r8
 6604 2526 9F92      		push r9
 6605 2528 AF92      		push r10
 6606 252a BF92      		push r11
 6607 252c CF92      		push r12
 6608 252e DF92      		push r13
 6609 2530 EF92      		push r14
 6610 2532 FF92      		push r15
 6611 2534 0F93      		push r16
 6612 2536 1F93      		push r17
 6613 2538 CF93      		push r28
 6614 253a DF93      		push r29
 6615 253c CDB7      		in r28,__SP_L__
 6616 253e DEB7      		in r29,__SP_H__
 6617 2540 2D97      		sbiw r28,13
 6618 2542 0FB6      		in __tmp_reg__,__SREG__
 6619 2544 F894      		cli
 6620 2546 DEBF      		out __SP_H__,r29
 6621 2548 0FBE      		out __SREG__,__tmp_reg__
 6622 254a CDBF      		out __SP_L__,r28
 6623               	/* prologue end (size=22) */
 6624 254c 3C01      		movw r6,r24
 6625 254e 562F      		mov r21,r22
 6626 2550 8982      		std Y+1,r8
 6627 2552 9A82      		std Y+2,r9
 6628 2554 AB82      		std Y+3,r10
 6629 2556 BC82      		std Y+4,r11
 6630 2558 CD82      		std Y+5,r12
 6631 255a DE82      		std Y+6,r13
 6632 255c EF82      		std Y+7,r14
 6633 255e F886      		std Y+8,r15
 6634 2560 0987      		std Y+9,r16
 6635 2562 1A87      		std Y+10,r17
 6636 2564 2B87      		std Y+11,r18
 6637 2566 3C87      		std Y+12,r19
 6638 2568 4D87      		std Y+13,r20
 6639 256a 2BA5      		ldd r18,Y+43
 6641               	.LM680:
 6642 256c 1092 0000 		sts mac_tx_current_frame+27,__zero_reg__
 6644               	.LM681:
 6645 2570 81E0      		ldi r24,lo8(1)
 6646 2572 8093 0000 		sts mac_tx_current_frame+26,r24
 6648               	.LM682:
 6649 2576 8091 0000 		lds r24,mac_pib_data+24
 6650 257a 982F      		mov r25,r24
 6651 257c 8F5F      		subi r24,lo8(-(1))
 6652 257e 8093 0000 		sts mac_pib_data+24,r24
 6653 2582 9093 0000 		sts mac_tx_current_frame+28,r25
 6655               	.LM683:
 6656 2586 8DE0      		ldi r24,lo8(13)
 6657 2588 60E0      		ldi r22,lo8(mac_tx_current_frame)
 6658 258a 70E0      		ldi r23,hi8(mac_tx_current_frame)
 6659 258c 8E01      		movw r16,r28
 6660 258e 0F5F      		subi r16,lo8(-(1))
 6661 2590 1F4F      		sbci r17,hi8(-(1))
 6662 2592 DB01      		movw r26,r22
 6663 2594 F801      		movw r30,r16
 6664 2596 982F      		mov r25,r24
 6665 2598 0190      		ld __tmp_reg__,Z+
 6666 259a 0D92      		st X+,__tmp_reg__
 6667 259c 9A95      		dec r25
 6668 259e E1F7      		brne .-8
 6670               	.LM684:
 6671 25a0 FB01      		movw r30,r22
 6672 25a2 3D96      		adiw r30,13
 6673 25a4 AEE1      		ldi r26,lo8(30)
 6674 25a6 B0E0      		ldi r27,hi8(30)
 6675 25a8 AC0F      		add r26,r28
 6676 25aa BD1F      		adc r27,r29
 6677 25ac 0D90      		ld __tmp_reg__,X+
 6678 25ae 0192      		st Z+,__tmp_reg__
 6679 25b0 8A95      		dec r24
 6680 25b2 E1F7      		brne .-8
 6682               	.LM685:
 6683 25b4 5093 0000 		sts mac_tx_current_frame+39,r21
 6685               	.LM686:
 6686 25b8 2093 0000 		sts mac_tx_current_frame+30,r18
 6688               	.LM687:
 6689 25bc 852F      		mov r24,r21
 6690 25be 9927      		clr r25
 6691 25c0 0097      		sbiw r24,0
 6692 25c2 51F0      		breq .L374
 6693 25c4 FB01      		movw r30,r22
 6694 25c6 B996      		adiw r30,41
 6695 25c8 9C01      		movw r18,r24
 6696               	.L370:
 6698               	.LM688:
 6699 25ca D301      		movw r26,r6
 6700 25cc 8D91      		ld r24,X+
 6701 25ce 3D01      		movw r6,r26
 6702 25d0 8193      		st Z+,r24
 6704               	.LM689:
 6705 25d2 2150      		subi r18,lo8(-(-1))
 6706 25d4 3040      		sbci r19,hi8(-(-1))
 6707 25d6 C9F7      		brne .L370
 6708               	.L374:
 6710               	.LM690:
 6711 25d8 C980      		ldd r12,Y+1
 6712 25da DA80      		ldd r13,Y+2
 6713 25dc EB80      		ldd r14,Y+3
 6714 25de FC80      		ldd r15,Y+4
 6715 25e0 0D81      		ldd r16,Y+5
 6716 25e2 1E81      		ldd r17,Y+6
 6717 25e4 2F81      		ldd r18,Y+7
 6718 25e6 3885      		ldd r19,Y+8
 6719 25e8 4985      		ldd r20,Y+9
 6720 25ea 5A85      		ldd r21,Y+10
 6721 25ec 6B85      		ldd r22,Y+11
 6722 25ee 7C85      		ldd r23,Y+12
 6723 25f0 8D85      		ldd r24,Y+13
 6724 25f2 0E94 0000 		call Is_data_pending
 6725 25f6 8823      		tst r24
 6726 25f8 11F0      		breq .L371
 6728               	.LM691:
 6729 25fa 81E3      		ldi r24,lo8(49)
 6730 25fc 01C0      		rjmp .L375
 6731               	.L371:
 6733               	.LM692:
 6734 25fe 81E2      		ldi r24,lo8(33)
 6735               	.L375:
 6736 2600 8093 0000 		sts mac_tx_current_frame+36,r24
 6738               	.LM693:
 6739 2604 8091 0000 		lds r24,mac_tx_current_frame
 6740 2608 282F      		mov r18,r24
 6741 260a 3327      		clr r19
 6742 260c 220F      		lsl r18
 6743 260e 331F      		rol r19
 6744 2610 220F      		lsl r18
 6745 2612 331F      		rol r19
 6746 2614 8091 0000 		lds r24,mac_tx_current_frame+13
 6747 2618 9927      		clr r25
 6748 261a 16E0      		ldi r17,6
 6749 261c 880F      	1:	lsl r24
 6750 261e 991F      		rol r25
 6751 2620 1A95      		dec r17
 6752 2622 E1F7      		brne 1b
 6753 2624 822B      		or r24,r18
 6754 2626 8093 0000 		sts mac_tx_current_frame+37,r24
 6756               	.LM694:
 6757 262a 0E94 0000 		call mac_frame_send
 6758               	/* epilogue: frame size=13 */
 6759 262e 2D96      		adiw r28,13
 6760 2630 0FB6      		in __tmp_reg__,__SREG__
 6761 2632 F894      		cli
 6762 2634 DEBF      		out __SP_H__,r29
 6763 2636 0FBE      		out __SREG__,__tmp_reg__
 6764 2638 CDBF      		out __SP_L__,r28
 6765 263a DF91      		pop r29
 6766 263c CF91      		pop r28
 6767 263e 1F91      		pop r17
 6768 2640 0F91      		pop r16
 6769 2642 FF90      		pop r15
 6770 2644 EF90      		pop r14
 6771 2646 DF90      		pop r13
 6772 2648 CF90      		pop r12
 6773 264a BF90      		pop r11
 6774 264c AF90      		pop r10
 6775 264e 9F90      		pop r9
 6776 2650 8F90      		pop r8
 6777 2652 7F90      		pop r7
 6778 2654 6F90      		pop r6
 6779 2656 0895      		ret
 6780               	/* epilogue end (size=21) */
 6781               	/* function data_frame_send size 158 (115) */
 6787               	.Lscope52:
 6790               	.global	pending_data_send
 6792               	pending_data_send:
 6794               	.LM695:
 6795               	/* prologue: frame size=13 */
 6796 2658 6F92      		push r6
 6797 265a 7F92      		push r7
 6798 265c 8F92      		push r8
 6799 265e 9F92      		push r9
 6800 2660 AF92      		push r10
 6801 2662 BF92      		push r11
 6802 2664 CF92      		push r12
 6803 2666 DF92      		push r13
 6804 2668 EF92      		push r14
 6805 266a FF92      		push r15
 6806 266c 0F93      		push r16
 6807 266e 1F93      		push r17
 6808 2670 CF93      		push r28
 6809 2672 DF93      		push r29
 6810 2674 CDB7      		in r28,__SP_L__
 6811 2676 DEB7      		in r29,__SP_H__
 6812 2678 2D97      		sbiw r28,13
 6813 267a 0FB6      		in __tmp_reg__,__SREG__
 6814 267c F894      		cli
 6815 267e DEBF      		out __SP_H__,r29
 6816 2680 0FBE      		out __SREG__,__tmp_reg__
 6817 2682 CDBF      		out __SP_L__,r28
 6818               	/* prologue end (size=22) */
 6819 2684 C982      		std Y+1,r12
 6820 2686 DA82      		std Y+2,r13
 6821 2688 EB82      		std Y+3,r14
 6822 268a FC82      		std Y+4,r15
 6823 268c 0D83      		std Y+5,r16
 6824 268e 1E83      		std Y+6,r17
 6825 2690 2F83      		std Y+7,r18
 6826 2692 3887      		std Y+8,r19
 6827 2694 4987      		std Y+9,r20
 6828 2696 5A87      		std Y+10,r21
 6829 2698 6B87      		std Y+11,r22
 6830 269a 7C87      		std Y+12,r23
 6831 269c 8D87      		std Y+13,r24
 6833               	.LM696:
 6834 269e 0E94 0000 		call get_pending_frame
 6835 26a2 3C01      		movw r6,r24
 6837               	.LM697:
 6838 26a4 C980      		ldd r12,Y+1
 6839 26a6 DA80      		ldd r13,Y+2
 6840 26a8 EB80      		ldd r14,Y+3
 6841 26aa FC80      		ldd r15,Y+4
 6842 26ac 0D81      		ldd r16,Y+5
 6843 26ae 1E81      		ldd r17,Y+6
 6844 26b0 2F81      		ldd r18,Y+7
 6845 26b2 3885      		ldd r19,Y+8
 6846 26b4 4985      		ldd r20,Y+9
 6847 26b6 5A85      		ldd r21,Y+10
 6848 26b8 6B85      		ldd r22,Y+11
 6849 26ba 7C85      		ldd r23,Y+12
 6850 26bc 8D85      		ldd r24,Y+13
 6851 26be 0E94 0000 		call Is_data_pending
 6852 26c2 8823      		tst r24
 6853 26c4 09F4      		brne .+2
 6854 26c6 9AC0      		rjmp .L376
 6856               	.LM698:
 6857 26c8 6114      		cp r6,__zero_reg__
 6858 26ca 7104      		cpc r7,__zero_reg__
 6859 26cc A1F1      		breq .L379
 6860 26ce F301      		movw r30,r6
 6861 26d0 668D      		ldd r22,Z+30
 6862 26d2 778D      		ldd r23,Z+31
 6863 26d4 4C85      		ldd r20,Y+12
 6864 26d6 5D85      		ldd r21,Y+13
 6865 26d8 EA80      		ldd r14,Y+2
 6866 26da FB80      		ldd r15,Y+3
 6867 26dc 0C81      		ldd r16,Y+4
 6868 26de 1D81      		ldd r17,Y+5
 6869 26e0 BE81      		ldd r27,Y+6
 6870 26e2 AF81      		ldd r26,Y+7
 6871 26e4 D884      		ldd r13,Y+8
 6872 26e6 C984      		ldd r12,Y+9
 6873 26e8 2A85      		ldd r18,Y+10
 6874 26ea 3B85      		ldd r19,Y+11
 6875               	.L383:
 6877               	.LM699:
 6878 26ec 6417      		cp r22,r20
 6879 26ee 7507      		cpc r23,r21
 6880 26f0 F9F4      		brne .L378
 6881 26f2 F301      		movw r30,r6
 6882 26f4 8489      		ldd r24,Z+20
 6883 26f6 8E15      		cp r24,r14
 6884 26f8 A9F4      		brne .L382
 6885 26fa 8589      		ldd r24,Z+21
 6886 26fc 8F15      		cp r24,r15
 6887 26fe 91F4      		brne .L382
 6888 2700 8689      		ldd r24,Z+22
 6889 2702 8017      		cp r24,r16
 6890 2704 79F4      		brne .L382
 6891 2706 8789      		ldd r24,Z+23
 6892 2708 8117      		cp r24,r17
 6893 270a 61F4      		brne .L382
 6894 270c 808D      		ldd r24,Z+24
 6895 270e 8B17      		cp r24,r27
 6896 2710 49F4      		brne .L382
 6897 2712 818D      		ldd r24,Z+25
 6898 2714 8A17      		cp r24,r26
 6899 2716 31F4      		brne .L382
 6900 2718 828D      		ldd r24,Z+26
 6901 271a 8D15      		cp r24,r13
 6902 271c 19F4      		brne .L382
 6903 271e 838D      		ldd r24,Z+27
 6904 2720 8C15      		cp r24,r12
 6905 2722 49F0      		breq .L379
 6906               	.L382:
 6907 2724 F301      		movw r30,r6
 6908 2726 848D      		ldd r24,Z+28
 6909 2728 958D      		ldd r25,Z+29
 6910 272a 8217      		cp r24,r18
 6911 272c 9307      		cpc r25,r19
 6912 272e 19F0      		breq .L379
 6913               	.L378:
 6915               	.LM700:
 6916 2730 6114      		cp r6,__zero_reg__
 6917 2732 7104      		cpc r7,__zero_reg__
 6918 2734 D9F6      		brne .L383
 6919               	.L379:
 6921               	.LM701:
 6922 2736 F301      		movw r30,r6
 6923 2738 8481      		ldd r24,Z+4
 6924 273a 9927      		clr r25
 6925 273c 8770      		andi r24,lo8(7)
 6926 273e 9070      		andi r25,hi8(7)
 6927 2740 0197      		sbiw r24,1
 6928 2742 B9F5      		brne .L384
 6930               	.LM702:
 6931 2744 8381      		ldd r24,Z+3
 6932 2746 8F93      		push r24
 6933 2748 8DB7      		in r24,__SP_L__
 6934 274a 9EB7      		in r25,__SP_H__
 6935 274c 0D97      		sbiw r24,13
 6936 274e 0FB6      		in __tmp_reg__,__SREG__
 6937 2750 F894      		cli
 6938 2752 9EBF      		out __SP_H__,r25
 6939 2754 0FBE      		out __SREG__,__tmp_reg__
 6940 2756 8DBF      		out __SP_L__,r24
 6941 2758 EDB7      		in r30,__SP_L__
 6942 275a FEB7      		in r31,__SP_H__
 6943 275c 3196      		adiw r30,1
 6944 275e A0E2      		ldi r26,lo8(32)
 6945 2760 B0E0      		ldi r27,hi8(32)
 6946 2762 6A0E      		add r6,r26
 6947 2764 7B1E      		adc r7,r27
 6948 2766 8DE0      		ldi r24,lo8(13)
 6949 2768 D301      		movw r26,r6
 6950 276a 0D90      		ld __tmp_reg__,X+
 6951 276c 0192      		st Z+,__tmp_reg__
 6952 276e 8A95      		dec r24
 6953 2770 E1F7      		brne .-8
 6954 2772 E0EE      		ldi r30,lo8(-32)
 6955 2774 FFEF      		ldi r31,hi8(-32)
 6956 2776 6E0E      		add r6,r30
 6957 2778 7F1E      		adc r7,r31
 6958 277a F301      		movw r30,r6
 6959 277c 8388      		ldd r8,Z+19
 6960 277e 9488      		ldd r9,Z+20
 6961 2780 A588      		ldd r10,Z+21
 6962 2782 B688      		ldd r11,Z+22
 6963 2784 C788      		ldd r12,Z+23
 6964 2786 D08C      		ldd r13,Z+24
 6965 2788 E18C      		ldd r14,Z+25
 6966 278a F28C      		ldd r15,Z+26
 6967 278c 038D      		ldd r16,Z+27
 6968 278e 148D      		ldd r17,Z+28
 6969 2790 258D      		ldd r18,Z+29
 6970 2792 368D      		ldd r19,Z+30
 6971 2794 478D      		ldd r20,Z+31
 6972 2796 65A5      		ldd r22,Z+45
 6973 2798 86A5      		ldd r24,Z+46
 6974 279a 97A5      		ldd r25,Z+47
 6975 279c 0E94 0000 		call data_frame_send
 6976 27a0 8DB7      		in r24,__SP_L__
 6977 27a2 9EB7      		in r25,__SP_H__
 6978 27a4 0E96      		adiw r24,14
 6979 27a6 0FB6      		in __tmp_reg__,__SREG__
 6980 27a8 F894      		cli
 6981 27aa 9EBF      		out __SP_H__,r25
 6982 27ac 0FBE      		out __SREG__,__tmp_reg__
 6983 27ae 8DBF      		out __SP_L__,r24
 6984 27b0 22C0      		rjmp .L385
 6985               	.L384:
 6987               	.LM703:
 6988 27b2 F301      		movw r30,r6
 6989 27b4 8781      		ldd r24,Z+7
 6990 27b6 8823      		tst r24
 6991 27b8 91F0      		breq .L386
 6993               	.LM704:
 6994 27ba C084      		ldd r12,Z+8
 6995 27bc D184      		ldd r13,Z+9
 6996 27be E384      		ldd r14,Z+11
 6997 27c0 F484      		ldd r15,Z+12
 6998 27c2 0585      		ldd r16,Z+13
 6999 27c4 1685      		ldd r17,Z+14
 7000 27c6 2785      		ldd r18,Z+15
 7001 27c8 3089      		ldd r19,Z+16
 7002 27ca 4189      		ldd r20,Z+17
 7003 27cc 5289      		ldd r21,Z+18
 7004 27ce 6285      		ldd r22,Z+10
 7005 27d0 8091 0000 		lds r24,mac_pib_data+22
 7006 27d4 9091 0000 		lds r25,(mac_pib_data+22)+1
 7007 27d8 0E94 0000 		call associate_response_frame_send
 7008 27dc 0CC0      		rjmp .L385
 7009               	.L386:
 7011               	.LM705:
 7012 27de F301      		movw r30,r6
 7013 27e0 0385      		ldd r16,Z+11
 7014 27e2 1485      		ldd r17,Z+12
 7015 27e4 2585      		ldd r18,Z+13
 7016 27e6 3685      		ldd r19,Z+14
 7017 27e8 4785      		ldd r20,Z+15
 7018 27ea 5089      		ldd r21,Z+16
 7019 27ec 6189      		ldd r22,Z+17
 7020 27ee 7289      		ldd r23,Z+18
 7021 27f0 8285      		ldd r24,Z+10
 7022 27f2 0E94 0000 		call disassociate_notification_frame_send
 7023               	.L385:
 7025               	.LM706:
 7026 27f6 C301      		movw r24,r6
 7027 27f8 0E94 0000 		call remove_pending_queue
 7028               	.L376:
 7029               	/* epilogue: frame size=13 */
 7030 27fc 2D96      		adiw r28,13
 7031 27fe 0FB6      		in __tmp_reg__,__SREG__
 7032 2800 F894      		cli
 7033 2802 DEBF      		out __SP_H__,r29
 7034 2804 0FBE      		out __SREG__,__tmp_reg__
 7035 2806 CDBF      		out __SP_L__,r28
 7036 2808 DF91      		pop r29
 7037 280a CF91      		pop r28
 7038 280c 1F91      		pop r17
 7039 280e 0F91      		pop r16
 7040 2810 FF90      		pop r15
 7041 2812 EF90      		pop r14
 7042 2814 DF90      		pop r13
 7043 2816 CF90      		pop r12
 7044 2818 BF90      		pop r11
 7045 281a AF90      		pop r10
 7046 281c 9F90      		pop r9
 7047 281e 8F90      		pop r8
 7048 2820 7F90      		pop r7
 7049 2822 6F90      		pop r6
 7050 2824 0895      		ret
 7051               	/* epilogue end (size=21) */
 7052               	/* function pending_data_send size 232 (189) */
 7057               	.Lscope53:
 7065               	.global	mcpsDataRequest
 7067               	mcpsDataRequest:
 7069               	.LM707:
 7070               	/* prologue: frame size=16 */
 7071 2826 6F92      		push r6
 7072 2828 7F92      		push r7
 7073 282a 8F92      		push r8
 7074 282c 9F92      		push r9
 7075 282e AF92      		push r10
 7076 2830 BF92      		push r11
 7077 2832 CF92      		push r12
 7078 2834 DF92      		push r13
 7079 2836 EF92      		push r14
 7080 2838 FF92      		push r15
 7081 283a 0F93      		push r16
 7082 283c 1F93      		push r17
 7083 283e CF93      		push r28
 7084 2840 DF93      		push r29
 7085 2842 CDB7      		in r28,__SP_L__
 7086 2844 DEB7      		in r29,__SP_H__
 7087 2846 6097      		sbiw r28,16
 7088 2848 0FB6      		in __tmp_reg__,__SREG__
 7089 284a F894      		cli
 7090 284c DEBF      		out __SP_H__,r29
 7091 284e 0FBE      		out __SREG__,__tmp_reg__
 7092 2850 CDBF      		out __SP_L__,r28
 7093               	/* prologue end (size=22) */
 7094 2852 C982      		std Y+1,r12
 7095 2854 DA82      		std Y+2,r13
 7096 2856 EB82      		std Y+3,r14
 7097 2858 FC82      		std Y+4,r15
 7098 285a 0D83      		std Y+5,r16
 7099 285c 1E83      		std Y+6,r17
 7100 285e 2F83      		std Y+7,r18
 7101 2860 3887      		std Y+8,r19
 7102 2862 4987      		std Y+9,r20
 7103 2864 5A87      		std Y+10,r21
 7104 2866 6B87      		std Y+11,r22
 7105 2868 7C87      		std Y+12,r23
 7106 286a 8D87      		std Y+13,r24
 7107 286c 6EA5      		ldd r22,Y+46
 7108 286e 6FA4      		ldd r6,Y+47
 7109 2870 78A8      		ldd r7,Y+48
 7110 2872 79A9      		ldd r23,Y+49
 7111 2874 8AA9      		ldd r24,Y+50
 7113               	.LM708:
 7114 2876 282F      		mov r18,r24
 7115 2878 3327      		clr r19
 7116 287a C901      		movw r24,r18
 7117 287c 9695      		lsr r25
 7118 287e 8795      		ror r24
 7119 2880 9695      		lsr r25
 7120 2882 8795      		ror r24
 7121 2884 41E0      		ldi r20,lo8(1)
 7122 2886 50E0      		ldi r21,hi8(1)
 7123 2888 8423      		and r24,r20
 7124 288a 9523      		and r25,r21
 7125 288c 8417      		cp r24,r20
 7126 288e 9507      		cpc r25,r21
 7127 2890 79F1      		breq .L391
 7129               	.LM709:
 7130 2892 7F93      		push r23
 7131 2894 2DB7      		in r18,__SP_L__
 7132 2896 3EB7      		in r19,__SP_H__
 7133 2898 2D50      		subi r18,lo8(-(-13))
 7134 289a 3040      		sbci r19,hi8(-(-13))
 7135 289c 0FB6      		in __tmp_reg__,__SREG__
 7136 289e F894      		cli
 7137 28a0 3EBF      		out __SP_H__,r19
 7138 28a2 0FBE      		out __SREG__,__tmp_reg__
 7139 28a4 2DBF      		out __SP_L__,r18
 7140 28a6 EDB7      		in r30,__SP_L__
 7141 28a8 FEB7      		in r31,__SP_H__
 7142 28aa E40F      		add r30,r20
 7143 28ac F51F      		adc r31,r21
 7144 28ae 8DE0      		ldi r24,lo8(13)
 7145 28b0 A1E2      		ldi r26,lo8(33)
 7146 28b2 B0E0      		ldi r27,hi8(33)
 7147 28b4 AC0F      		add r26,r28
 7148 28b6 BD1F      		adc r27,r29
 7149 28b8 0D90      		ld __tmp_reg__,X+
 7150 28ba 0192      		st Z+,__tmp_reg__
 7151 28bc 8A95      		dec r24
 7152 28be E1F7      		brne .-8
 7153 28c0 8980      		ldd r8,Y+1
 7154 28c2 9A80      		ldd r9,Y+2
 7155 28c4 AB80      		ldd r10,Y+3
 7156 28c6 BC80      		ldd r11,Y+4
 7157 28c8 CD80      		ldd r12,Y+5
 7158 28ca DE80      		ldd r13,Y+6
 7159 28cc EF80      		ldd r14,Y+7
 7160 28ce F884      		ldd r15,Y+8
 7161 28d0 0985      		ldd r16,Y+9
 7162 28d2 1A85      		ldd r17,Y+10
 7163 28d4 2B85      		ldd r18,Y+11
 7164 28d6 3C85      		ldd r19,Y+12
 7165 28d8 4D85      		ldd r20,Y+13
 7166 28da C301      		movw r24,r6
 7167 28dc 0E94 0000 		call data_frame_send
 7169               	.LM710:
 7170 28e0 80E1      		ldi r24,lo8(16)
 7171 28e2 8093 0000 		sts mac_current_state,r24
 7172 28e6 2DB7      		in r18,__SP_L__
 7173 28e8 3EB7      		in r19,__SP_H__
 7174 28ea 225F      		subi r18,lo8(-(14))
 7175 28ec 3F4F      		sbci r19,hi8(-(14))
 7176 28ee 6AC0      		rjmp .L401
 7177               	.L391:
 7179               	.LM711:
 7180 28f0 9981      		ldd r25,Y+1
 7181 28f2 9230      		cpi r25,lo8(2)
 7182 28f4 08F4      		brsh .+2
 7183 28f6 6FC0      		rjmp .L393
 7185               	.LM712:
 7186 28f8 2170      		andi r18,lo8(1)
 7187 28fa 3070      		andi r19,hi8(1)
 7188 28fc 2417      		cp r18,r20
 7189 28fe 3507      		cpc r19,r21
 7190 2900 11F0      		breq .L394
 7192               	.LM713:
 7193 2902 81E0      		ldi r24,lo8(1)
 7194 2904 01C0      		rjmp .L399
 7195               	.L394:
 7197               	.LM714:
 7198 2906 81E2      		ldi r24,lo8(33)
 7199               	.L399:
 7200 2908 8E87      		std Y+14,r24
 7202               	.LM715:
 7203 290a 892F      		mov r24,r25
 7204 290c 9927      		clr r25
 7205 290e 880F      		lsl r24
 7206 2910 991F      		rol r25
 7207 2912 880F      		lsl r24
 7208 2914 991F      		rol r25
 7209 2916 29A1      		ldd r18,Y+33
 7210 2918 2295      		swap r18
 7211 291a 220F      		lsl r18
 7212 291c 220F      		lsl r18
 7213 291e 207C      		andi r18,0xc0
 7214 2920 2823      		and r18,r24
 7215 2922 2F87      		std Y+15,r18
 7217               	.LM716:
 7218 2924 8091 0000 		lds r24,current_pending_num
 7219 2928 8330      		cpi r24,lo8(3)
 7220 292a 08F0      		brlo .+2
 7221 292c 51C0      		rjmp .L396
 7223               	.LM717:
 7224 292e 8091 0000 		lds r24,default_short_addr
 7225 2932 9091 0000 		lds r25,(default_short_addr)+1
 7226 2936 9F93      		push r25
 7227 2938 8F93      		push r24
 7228 293a 8DB7      		in r24,__SP_L__
 7229 293c 9EB7      		in r25,__SP_H__
 7230 293e 0897      		sbiw r24,8
 7231 2940 0FB6      		in __tmp_reg__,__SREG__
 7232 2942 F894      		cli
 7233 2944 9EBF      		out __SP_H__,r25
 7234 2946 0FBE      		out __SREG__,__tmp_reg__
 7235 2948 8DBF      		out __SP_L__,r24
 7236 294a ADB7      		in r26,__SP_L__
 7237 294c BEB7      		in r27,__SP_H__
 7238 294e 1196      		adiw r26,1
 7239 2950 88E0      		ldi r24,lo8(8)
 7240 2952 E0E0      		ldi r30,lo8(default_long_addr)
 7241 2954 F0E0      		ldi r31,hi8(default_long_addr)
 7242 2956 0190      		ld __tmp_reg__,Z+
 7243 2958 0D92      		st X+,__tmp_reg__
 7244 295a 8A95      		dec r24
 7245 295c E1F7      		brne .-8
 7246 295e 1F92      		push __zero_reg__
 7247 2960 1F92      		push __zero_reg__
 7248 2962 7F92      		push r7
 7249 2964 6F92      		push r6
 7250 2966 6F93      		push r22
 7251 2968 ADB7      		in r26,__SP_L__
 7252 296a BEB7      		in r27,__SP_H__
 7253 296c 1D97      		sbiw r26,13
 7254 296e 0FB6      		in __tmp_reg__,__SREG__
 7255 2970 F894      		cli
 7256 2972 BEBF      		out __SP_H__,r27
 7257 2974 0FBE      		out __SREG__,__tmp_reg__
 7258 2976 ADBF      		out __SP_L__,r26
 7259 2978 EDB7      		in r30,__SP_L__
 7260 297a FEB7      		in r31,__SP_H__
 7261 297c 3196      		adiw r30,1
 7262 297e 8DE0      		ldi r24,lo8(13)
 7263 2980 A1E2      		ldi r26,lo8(33)
 7264 2982 B0E0      		ldi r27,hi8(33)
 7265 2984 AC0F      		add r26,r28
 7266 2986 BD1F      		adc r27,r29
 7267 2988 282F      		mov r18,r24
 7268 298a 0D90      		ld __tmp_reg__,X+
 7269 298c 0192      		st Z+,__tmp_reg__
 7270 298e 2A95      		dec r18
 7271 2990 E1F7      		brne .-8
 7272 2992 ADB7      		in r26,__SP_L__
 7273 2994 BEB7      		in r27,__SP_H__
 7274 2996 1D97      		sbiw r26,13
 7275 2998 0FB6      		in __tmp_reg__,__SREG__
 7276 299a F894      		cli
 7277 299c BEBF      		out __SP_H__,r27
 7278 299e 0FBE      		out __SREG__,__tmp_reg__
 7279 29a0 ADBF      		out __SP_L__,r26
 7280 29a2 1196      		adiw r26,1
 7281 29a4 FE01      		movw r30,r28
 7282 29a6 3196      		adiw r30,1
 7283 29a8 0190      		ld __tmp_reg__,Z+
 7284 29aa 0D92      		st X+,__tmp_reg__
 7285 29ac 8A95      		dec r24
 7286 29ae E1F7      		brne .-8
 7287 29b0 4E85      		ldd r20,Y+14
 7288 29b2 5F85      		ldd r21,Y+15
 7289 29b4 6889      		ldd r22,Y+16
 7290 29b6 872F      		mov r24,r23
 7291 29b8 0E94 0000 		call add_pending_queue
 7292 29bc 2DB7      		in r18,__SP_L__
 7293 29be 3EB7      		in r19,__SP_H__
 7294 29c0 275D      		subi r18,lo8(-(41))
 7295 29c2 3F4F      		sbci r19,hi8(-(41))
 7296               	.L401:
 7297 29c4 0FB6      		in __tmp_reg__,__SREG__
 7298 29c6 F894      		cli
 7299 29c8 3EBF      		out __SP_H__,r19
 7300 29ca 0FBE      		out __SREG__,__tmp_reg__
 7301 29cc 2DBF      		out __SP_L__,r18
 7302 29ce 07C0      		rjmp .L390
 7303               	.L396:
 7305               	.LM718:
 7306 29d0 672F      		mov r22,r23
 7307 29d2 81EF      		ldi r24,lo8(-15)
 7308 29d4 02C0      		rjmp .L400
 7309               	.L393:
 7311               	.LM719:
 7312 29d6 672F      		mov r22,r23
 7313 29d8 88EE      		ldi r24,lo8(-24)
 7314               	.L400:
 7315 29da 0E94 0000 		call mcpsDataConfirm
 7316               	.L390:
 7317               	/* epilogue: frame size=16 */
 7318 29de 6096      		adiw r28,16
 7319 29e0 0FB6      		in __tmp_reg__,__SREG__
 7320 29e2 F894      		cli
 7321 29e4 DEBF      		out __SP_H__,r29
 7322 29e6 0FBE      		out __SREG__,__tmp_reg__
 7323 29e8 CDBF      		out __SP_L__,r28
 7324 29ea DF91      		pop r29
 7325 29ec CF91      		pop r28
 7326 29ee 1F91      		pop r17
 7327 29f0 0F91      		pop r16
 7328 29f2 FF90      		pop r15
 7329 29f4 EF90      		pop r14
 7330 29f6 DF90      		pop r13
 7331 29f8 CF90      		pop r12
 7332 29fa BF90      		pop r11
 7333 29fc AF90      		pop r10
 7334 29fe 9F90      		pop r9
 7335 2a00 8F90      		pop r8
 7336 2a02 7F90      		pop r7
 7337 2a04 6F90      		pop r6
 7338 2a06 0895      		ret
 7339               	/* epilogue end (size=21) */
 7340               	/* function mcpsDataRequest size 241 (198) */
 7349               	.Lscope54:
 7351               	.global	data_request_frame_send
 7353               	data_request_frame_send:
 7355               	.LM720:
 7356               	/* prologue: frame size=0 */
 7357               	/* prologue end (size=0) */
 7359               	.LM721:
 7360 2a08 84E0      		ldi r24,lo8(4)
 7361 2a0a 8093 0000 		sts mac_tx_current_frame+27,r24
 7363               	.LM722:
 7364 2a0e 83E0      		ldi r24,lo8(3)
 7365 2a10 8093 0000 		sts mac_tx_current_frame+26,r24
 7367               	.LM723:
 7368 2a14 8091 0000 		lds r24,mac_pib_data+24
 7369 2a18 982F      		mov r25,r24
 7370 2a1a 8F5F      		subi r24,lo8(-(1))
 7371 2a1c 8093 0000 		sts mac_pib_data+24,r24
 7372 2a20 9093 0000 		sts mac_tx_current_frame+28,r25
 7374               	.LM724:
 7375 2a24 2091 0000 		lds r18,mac_pib_data+28
 7376 2a28 3091 0000 		lds r19,(mac_pib_data+28)+1
 7377 2a2c 3093 0000 		sts (mac_tx_current_frame+24)+1,r19
 7378 2a30 2093 0000 		sts mac_tx_current_frame+24,r18
 7380               	.LM725:
 7381 2a34 8091 0000 		lds r24,mac_current_state
 7382 2a38 8330      		cpi r24,lo8(3)
 7383 2a3a 19F4      		brne .L403
 7385               	.LM726:
 7386 2a3c 1092 0000 		sts mac_tx_current_frame,__zero_reg__
 7387 2a40 0FC0      		rjmp .L404
 7388               	.L403:
 7390               	.LM727:
 7391 2a42 82E0      		ldi r24,lo8(2)
 7392 2a44 8093 0000 		sts mac_tx_current_frame,r24
 7394               	.LM728:
 7395 2a48 8091 0000 		lds r24,mac_pib_data+22
 7396 2a4c 9091 0000 		lds r25,(mac_pib_data+22)+1
 7397 2a50 9093 0000 		sts (mac_tx_current_frame+9)+1,r25
 7398 2a54 8093 0000 		sts mac_tx_current_frame+9,r24
 7400               	.LM729:
 7401 2a58 3093 0000 		sts (mac_tx_current_frame+11)+1,r19
 7402 2a5c 2093 0000 		sts mac_tx_current_frame+11,r18
 7403               	.L404:
 7405               	.LM730:
 7406 2a60 2091 0000 		lds r18,mac_pib_data+32
 7407 2a64 3091 0000 		lds r19,(mac_pib_data+32)+1
 7408 2a68 8091 0000 		lds r24,default_short_addr
 7409 2a6c 9091 0000 		lds r25,(default_short_addr)+1
 7410 2a70 2817      		cp r18,r24
 7411 2a72 3907      		cpc r19,r25
 7412 2a74 39F0      		breq .L406
 7413 2a76 8091 0000 		lds r24,no_short_addr
 7414 2a7a 9091 0000 		lds r25,(no_short_addr)+1
 7415 2a7e 2817      		cp r18,r24
 7416 2a80 3907      		cpc r19,r25
 7417 2a82 69F4      		brne .L405
 7418               	.L406:
 7420               	.LM731:
 7421 2a84 83E0      		ldi r24,lo8(3)
 7422 2a86 8093 0000 		sts mac_tx_current_frame+13,r24
 7424               	.LM732:
 7425 2a8a 88E0      		ldi r24,lo8(8)
 7426 2a8c A0E0      		ldi r26,lo8(mac_pib_data+34)
 7427 2a8e B0E0      		ldi r27,hi8(mac_pib_data+34)
 7428 2a90 E0E0      		ldi r30,lo8(mac_tx_current_frame+14)
 7429 2a92 F0E0      		ldi r31,hi8(mac_tx_current_frame+14)
 7430 2a94 0D90      		ld __tmp_reg__,X+
 7431 2a96 0192      		st Z+,__tmp_reg__
 7432 2a98 8A95      		dec r24
 7433 2a9a E1F7      		brne .-8
 7434 2a9c 07C0      		rjmp .L407
 7435               	.L405:
 7437               	.LM733:
 7438 2a9e 82E0      		ldi r24,lo8(2)
 7439 2aa0 8093 0000 		sts mac_tx_current_frame+13,r24
 7441               	.LM734:
 7442 2aa4 3093 0000 		sts (mac_tx_current_frame+22)+1,r19
 7443 2aa8 2093 0000 		sts mac_tx_current_frame+22,r18
 7444               	.L407:
 7446               	.LM735:
 7447 2aac 83E2      		ldi r24,lo8(35)
 7448 2aae 8093 0000 		sts mac_tx_current_frame+36,r24
 7450               	.LM736:
 7451 2ab2 8091 0000 		lds r24,mac_tx_current_frame
 7452 2ab6 282F      		mov r18,r24
 7453 2ab8 3327      		clr r19
 7454 2aba 220F      		lsl r18
 7455 2abc 331F      		rol r19
 7456 2abe 220F      		lsl r18
 7457 2ac0 331F      		rol r19
 7458 2ac2 8091 0000 		lds r24,mac_tx_current_frame+13
 7459 2ac6 9927      		clr r25
 7460 2ac8 56E0      		ldi r21,6
 7461 2aca 880F      	1:	lsl r24
 7462 2acc 991F      		rol r25
 7463 2ace 5A95      		dec r21
 7464 2ad0 E1F7      		brne 1b
 7465 2ad2 822B      		or r24,r18
 7466 2ad4 8093 0000 		sts mac_tx_current_frame+37,r24
 7468               	.LM737:
 7469 2ad8 0E94 0000 		call mac_frame_send
 7470               	/* epilogue: frame size=0 */
 7471 2adc 0895      		ret
 7472               	/* epilogue end (size=1) */
 7473               	/* function data_request_frame_send size 107 (106) */
 7475               	.Lscope55:
 7478               	.global	mlmeBeaconNotifyIndication
 7480               	mlmeBeaconNotifyIndication:
 7482               	.LM738:
 7483               	/* prologue: frame size=0 */
 7484 2ade 1F93      		push r17
 7485 2ae0 CF93      		push r28
 7486 2ae2 DF93      		push r29
 7487 2ae4 CDB7      		in r28,__SP_L__
 7488 2ae6 DEB7      		in r29,__SP_H__
 7489               	/* prologue end (size=5) */
 7491               	.LM739:
 7492 2ae8 60E0      		ldi r22,lo8(0)
 7494               	.LM740:
 7495 2aea 8091 0000 		lds r24,mac_current_state
 7496 2aee 8730      		cpi r24,lo8(7)
 7497 2af0 09F0      		breq .+2
 7498 2af2 55C0      		rjmp .L409
 7500               	.LM741:
 7501 2af4 81E0      		ldi r24,lo8(1)
 7502 2af6 8093 0000 		sts scan_result_info+1,r24
 7504               	.LM742:
 7505 2afa 6093 0000 		sts scan_result_info,r22
 7507               	.LM743:
 7508 2afe 2091 0000 		lds r18,scan_result_info+6
 7509 2b02 2630      		cpi r18,lo8(6)
 7510 2b04 98F1      		brlo .L410
 7512               	.LM744:
 7513 2b06 43E0      		ldi r20,lo8(3)
 7514 2b08 8091 0000 		lds r24,head_of_timer_queue
 7515 2b0c 9091 0000 		lds r25,(head_of_timer_queue)+1
 7516 2b10 0E94 0000 		call timer3quere_cancel
 7517 2b14 9093 0000 		sts (head_of_timer_queue)+1,r25
 7518 2b18 8093 0000 		sts head_of_timer_queue,r24
 7520               	.LM745:
 7521 2b1c 8DB7      		in r24,__SP_L__
 7522 2b1e 9EB7      		in r25,__SP_H__
 7523 2b20 8458      		subi r24,lo8(-(-132))
 7524 2b22 9040      		sbci r25,hi8(-(-132))
 7525 2b24 0FB6      		in __tmp_reg__,__SREG__
 7526 2b26 F894      		cli
 7527 2b28 9EBF      		out __SP_H__,r25
 7528 2b2a 0FBE      		out __SREG__,__tmp_reg__
 7529 2b2c 8DBF      		out __SP_L__,r24
 7530 2b2e ADB7      		in r26,__SP_L__
 7531 2b30 BEB7      		in r27,__SP_H__
 7532 2b32 1196      		adiw r26,1
 7533 2b34 84E8      		ldi r24,lo8(-124)
 7534 2b36 E0E0      		ldi r30,lo8(scan_result_info)
 7535 2b38 F0E0      		ldi r31,hi8(scan_result_info)
 7536 2b3a 0190      		ld __tmp_reg__,Z+
 7537 2b3c 0D92      		st X+,__tmp_reg__
 7538 2b3e 8A95      		dec r24
 7539 2b40 E1F7      		brne .-8
 7540 2b42 0E94 0000 		call mlmeScanConfirm
 7542               	.LM746:
 7543 2b46 8AE0      		ldi r24,lo8(10)
 7544 2b48 8093 0000 		sts mac_current_state,r24
 7546               	.LM747:
 7547 2b4c 8DB7      		in r24,__SP_L__
 7548 2b4e 9EB7      		in r25,__SP_H__
 7549 2b50 8C57      		subi r24,lo8(-(132))
 7550 2b52 9F4F      		sbci r25,hi8(-(132))
 7551 2b54 0FB6      		in __tmp_reg__,__SREG__
 7552 2b56 F894      		cli
 7553 2b58 9EBF      		out __SP_H__,r25
 7554 2b5a 0FBE      		out __SREG__,__tmp_reg__
 7555 2b5c 8DBF      		out __SP_L__,r24
 7556 2b5e 88E0      		ldi r24,lo8(8)
 7557 2b60 0E94 0000 		call PLME_SET_TRX_STATE_request
 7559               	.LM748:
 7560 2b64 85E0      		ldi r24,lo8(5)
 7561 2b66 8093 0000 		sts phy_channel_state,r24
 7562 2b6a 64C0      		rjmp .L408
 7563               	.L410:
 7565               	.LM749:
 7566 2b6c 3327      		clr r19
 7567 2b6e 89E1      		ldi r24,lo8(25)
 7568 2b70 90E0      		ldi r25,hi8(25)
 7569 2b72 289F      		mul r18,r24
 7570 2b74 F001      		movw r30,r0
 7571 2b76 299F      		mul r18,r25
 7572 2b78 F00D      		add r31,r0
 7573 2b7a 389F      		mul r19,r24
 7574 2b7c F00D      		add r31,r0
 7575 2b7e 1124      		clr r1
 7576 2b80 E050      		subi r30,lo8(-(scan_result_info+7))
 7577 2b82 F040      		sbci r31,hi8(-(scan_result_info+7))
 7578 2b84 89E1      		ldi r24,lo8(25)
 7579 2b86 DE01      		movw r26,r28
 7580 2b88 1796      		adiw r26,7
 7581 2b8a 0D90      		ld __tmp_reg__,X+
 7582 2b8c 0192      		st Z+,__tmp_reg__
 7583 2b8e 8A95      		dec r24
 7584 2b90 E1F7      		brne .-8
 7586               	.LM750:
 7587 2b92 8091 0000 		lds r24,scan_result_info+6
 7588 2b96 8F5F      		subi r24,lo8(-(1))
 7589 2b98 8093 0000 		sts scan_result_info+6,r24
 7590 2b9c 4BC0      		rjmp .L408
 7591               	.L409:
 7593               	.LM751:
 7594 2b9e 89A1      		ldd r24,Y+33
 7595 2ba0 6817      		cp r22,r24
 7596 2ba2 78F4      		brsh .L425
 7597 2ba4 4091 0000 		lds r20,mac_pib_data+32
 7598 2ba8 5091 0000 		lds r21,(mac_pib_data+32)+1
 7599 2bac 282F      		mov r18,r24
 7600 2bae FE01      		movw r30,r28
 7601 2bb0 B396      		adiw r30,35
 7602               	.L417:
 7604               	.LM752:
 7605 2bb2 8191      		ld r24,Z+
 7606 2bb4 9191      		ld r25,Z+
 7607 2bb6 8417      		cp r24,r20
 7608 2bb8 9507      		cpc r25,r21
 7609 2bba 09F4      		brne .L415
 7611               	.LM753:
 7612 2bbc 61E0      		ldi r22,lo8(1)
 7613               	.L415:
 7615               	.LM754:
 7616 2bbe 2150      		subi r18,lo8(-(-1))
 7617 2bc0 C1F7      		brne .L417
 7618               	.L425:
 7620               	.LM755:
 7621 2bc2 8AA1      		ldd r24,Y+34
 7622 2bc4 8823      		tst r24
 7623 2bc6 91F1      		breq .L427
 7624 2bc8 1091 0000 		lds r17,mac_pib_data+34
 7625 2bcc B091 0000 		lds r27,mac_pib_data+35
 7626 2bd0 A091 0000 		lds r26,mac_pib_data+36
 7627 2bd4 7091 0000 		lds r23,mac_pib_data+37
 7628 2bd8 5091 0000 		lds r21,mac_pib_data+38
 7629 2bdc 4091 0000 		lds r20,mac_pib_data+39
 7630 2be0 3091 0000 		lds r19,mac_pib_data+40
 7631 2be4 9091 0000 		lds r25,mac_pib_data+41
 7632 2be8 E6E0      		ldi r30,lo8(6)
 7633 2bea F0E0      		ldi r31,hi8(6)
 7634 2bec EC0F      		add r30,r28
 7635 2bee FD1F      		adc r31,r29
 7636 2bf0 282F      		mov r18,r24
 7637               	.L422:
 7639               	.LM756:
 7640 2bf2 81A1      		ldd r24,Z+33
 7641 2bf4 8117      		cp r24,r17
 7642 2bf6 B1F4      		brne .L420
 7643 2bf8 82A1      		ldd r24,Z+34
 7644 2bfa 8B17      		cp r24,r27
 7645 2bfc 99F4      		brne .L420
 7646 2bfe 83A1      		ldd r24,Z+35
 7647 2c00 8A17      		cp r24,r26
 7648 2c02 81F4      		brne .L420
 7649 2c04 84A1      		ldd r24,Z+36
 7650 2c06 8717      		cp r24,r23
 7651 2c08 69F4      		brne .L420
 7652 2c0a 85A1      		ldd r24,Z+37
 7653 2c0c 8517      		cp r24,r21
 7654 2c0e 51F4      		brne .L420
 7655 2c10 86A1      		ldd r24,Z+38
 7656 2c12 8417      		cp r24,r20
 7657 2c14 39F4      		brne .L420
 7658 2c16 87A1      		ldd r24,Z+39
 7659 2c18 8317      		cp r24,r19
 7660 2c1a 21F4      		brne .L420
 7661 2c1c 80A5      		ldd r24,Z+40
 7662 2c1e 8917      		cp r24,r25
 7663 2c20 09F4      		brne .L420
 7665               	.LM757:
 7666 2c22 61E0      		ldi r22,lo8(1)
 7667               	.L420:
 7669               	.LM758:
 7670 2c24 2150      		subi r18,lo8(-(-1))
 7671 2c26 3896      		adiw r30,8
 7672 2c28 2223      		tst r18
 7673 2c2a 19F7      		brne .L422
 7674               	.L427:
 7676               	.LM759:
 7677 2c2c 6623      		tst r22
 7678 2c2e 11F0      		breq .L408
 7680               	.LM760:
 7681 2c30 0E94 0000 		call data_request_frame_send
 7682               	.L408:
 7683               	/* epilogue: frame size=0 */
 7684 2c34 DF91      		pop r29
 7685 2c36 CF91      		pop r28
 7686 2c38 1F91      		pop r17
 7687 2c3a 0895      		ret
 7688               	/* epilogue end (size=4) */
 7689               	/* function mlmeBeaconNotifyIndication size 176 (167) */
 7695               	.Lscope56:
 7696               		.data
 7697               	.LC17:
 7698 02e5 0A73 7563 		.string	"\nsuccess receive a association req ack frame"
 7698      6365 7373 
 7698      2072 6563 
 7698      6569 7665 
 7698      2061 2061 
 7699               	.LC18:
 7700 0312 0A73 7563 		.string	"\nsuccess received the data request ack"
 7700      6365 7373 
 7700      2072 6563 
 7700      6569 7665 
 7700      6420 7468 
 7701               		.text
 7703               	.global	mac_frame_rcvd
 7705               	mac_frame_rcvd:
 7707               	.LM761:
 7708               	/* prologue: frame size=0 */
 7709 2c3c CF92      		push r12
 7710 2c3e DF92      		push r13
 7711 2c40 EF92      		push r14
 7712 2c42 FF92      		push r15
 7713 2c44 0F93      		push r16
 7714 2c46 1F93      		push r17
 7715 2c48 CF93      		push r28
 7716 2c4a DF93      		push r29
 7717               	/* prologue end (size=8) */
 7719               	.LM762:
 7720 2c4c 8091 0000 		lds r24,mac_rx_current_frame+26
 7721 2c50 9927      		clr r25
 7722 2c52 8130      		cpi r24,1
 7723 2c54 9105      		cpc r25,__zero_reg__
 7724 2c56 09F4      		brne .+2
 7725 2c58 5CC0      		rjmp .L460
 7727               	.LM763:
 7728 2c5a 8230      		cpi r24,2
 7729 2c5c 9105      		cpc r25,__zero_reg__
 7730 2c5e 24F4      		brge .L484
 7731 2c60 892B      		or r24,r25
 7732 2c62 09F4      		brne .+2
 7733 2c64 1AC1      		rjmp .L477
 7734 2c66 35C1      		rjmp .L428
 7735               	.L484:
 7736 2c68 8230      		cpi r24,2
 7737 2c6a 9105      		cpc r25,__zero_reg__
 7738 2c6c 21F0      		breq .L430
 7739 2c6e 0397      		sbiw r24,3
 7740 2c70 09F4      		brne .+2
 7741 2c72 98C0      		rjmp .L466
 7742 2c74 2EC1      		rjmp .L428
 7743               	.L430:
 7745               	.LM764:
 7746 2c76 8091 0000 		lds r24,mac_rx_current_frame+28
 7747 2c7a 0E94 0000 		call get_frame_pointer
 7748 2c7e FC01      		movw r30,r24
 7750               	.LM765:
 7751 2c80 892B      		or r24,r25
 7752 2c82 09F4      		brne .+2
 7753 2c84 26C1      		rjmp .L428
 7755               	.LM766:
 7756 2c86 8681      		ldd r24,Z+6
 7757 2c88 9927      		clr r25
 7758 2c8a 8130      		cpi r24,1
 7759 2c8c 9105      		cpc r25,__zero_reg__
 7760 2c8e 61F0      		breq .L433
 7761 2c90 8230      		cpi r24,2
 7762 2c92 9105      		cpc r25,__zero_reg__
 7763 2c94 1CF4      		brge .L441
 7764 2c96 892B      		or r24,r25
 7765 2c98 79F1      		breq .L436
 7766 2c9a 36C0      		rjmp .L432
 7767               	.L441:
 7768 2c9c 8330      		cpi r24,3
 7769 2c9e 9105      		cpc r25,__zero_reg__
 7770 2ca0 81F1      		breq .L438
 7771 2ca2 0497      		sbiw r24,4
 7772 2ca4 69F0      		breq .L435
 7773 2ca6 30C0      		rjmp .L432
 7774               	.L433:
 7776               	.LM767:
 7777 2ca8 80E0      		ldi r24,lo8(.LC17)
 7778 2caa 90E0      		ldi r25,hi8(.LC17)
 7779 2cac 0E94 0000 		call puts
 7781               	.LM768:
 7782 2cb0 8091 0000 		lds r24,mac_current_state
 7783 2cb4 8230      		cpi r24,lo8(2)
 7784 2cb6 41F5      		brne .L432
 7786               	.LM769:
 7787 2cb8 83E0      		ldi r24,lo8(3)
 7788 2cba 8093 0000 		sts mac_current_state,r24
 7790               	.LM770:
 7791 2cbe 24C0      		rjmp .L432
 7792               	.L435:
 7794               	.LM771:
 7795 2cc0 80E0      		ldi r24,lo8(.LC18)
 7796 2cc2 90E0      		ldi r25,hi8(.LC18)
 7797 2cc4 0E94 0000 		call puts
 7799               	.LM772:
 7800 2cc8 04EC      		ldi r16,lo8(1220)
 7801 2cca 14E0      		ldi r17,hi8(1220)
 7802 2ccc 22E0      		ldi r18,lo8(2)
 7803 2cce 40E0      		ldi r20,lo8(0)
 7804 2cd0 61E0      		ldi r22,lo8(1)
 7805 2cd2 8091 0000 		lds r24,head_of_timer_queue
 7806 2cd6 9091 0000 		lds r25,(head_of_timer_queue)+1
 7807 2cda 0E94 0000 		call timer3queue_start
 7808 2cde 9093 0000 		sts (head_of_timer_queue)+1,r25
 7809 2ce2 8093 0000 		sts head_of_timer_queue,r24
 7811               	.LM773:
 7812 2ce6 1092 0000 		sts phy_channel_state,__zero_reg__
 7814               	.LM774:
 7815 2cea 83E0      		ldi r24,lo8(3)
 7816 2cec 8093 0000 		sts mac_current_state,r24
 7818               	.LM775:
 7819 2cf0 86E0      		ldi r24,lo8(6)
 7820 2cf2 0E94 0000 		call PLME_SET_TRX_STATE_request
 7822               	.LM776:
 7823 2cf6 08C0      		rjmp .L432
 7824               	.L436:
 7826               	.LM777:
 7827 2cf8 6181      		ldd r22,Z+1
 7828 2cfa 80E0      		ldi r24,lo8(0)
 7829 2cfc 0E94 0000 		call mcpsDataConfirm
 7831               	.LM778:
 7832 2d00 03C0      		rjmp .L432
 7833               	.L438:
 7835               	.LM779:
 7836 2d02 80E0      		ldi r24,lo8(0)
 7837 2d04 0E94 0000 		call mlmeDisassociateConfirm
 7838               	.L432:
 7840               	.LM780:
 7841 2d08 8091 0000 		lds r24,mac_rx_current_frame+28
 7842 2d0c 0E94 0000 		call remove_tx_queue
 7844               	.LM781:
 7845 2d10 E0C0      		rjmp .L428
 7846               	.L460:
 7848               	.LM782:
 7849 2d12 8091 0000 		lds r24,mac_current_state
 7850 2d16 8031      		cpi r24,lo8(16)
 7851 2d18 09F0      		breq .+2
 7852 2d1a DBC0      		rjmp .L428
 7854               	.LM783:
 7855 2d1c 20E0      		ldi r18,lo8(mac_rx_current_frame+13)
 7856 2d1e 30E0      		ldi r19,hi8(mac_rx_current_frame+13)
 7857 2d20 8DE0      		ldi r24,lo8(13)
 7858 2d22 A0E0      		ldi r26,lo8(mcps_data_indication_info)
 7859 2d24 B0E0      		ldi r27,hi8(mcps_data_indication_info)
 7860 2d26 ED01      		movw r28,r26
 7861 2d28 F901      		movw r30,r18
 7862 2d2a 982F      		mov r25,r24
 7863 2d2c 0190      		ld __tmp_reg__,Z+
 7864 2d2e 0992      		st Y+,__tmp_reg__
 7865 2d30 9A95      		dec r25
 7866 2d32 E1F7      		brne .-8
 7868               	.LM784:
 7869 2d34 1D96      		adiw r26,13
 7870 2d36 F901      		movw r30,r18
 7871 2d38 3D97      		sbiw r30,13
 7872 2d3a ED01      		movw r28,r26
 7873 2d3c 0190      		ld __tmp_reg__,Z+
 7874 2d3e 0992      		st Y+,__tmp_reg__
 7875 2d40 8A95      		dec r24
 7876 2d42 E1F7      		brne .-8
 7877 2d44 1D97      		sbiw r26,13
 7879               	.LM785:
 7880 2d46 8091 0000 		lds r24,mac_rx_current_frame+31
 7881 2d4a 8093 0000 		sts mcps_data_indication_info+26,r24
 7883               	.LM786:
 7884 2d4e 8091 0000 		lds r24,mac_rx_current_frame+39
 7885 2d52 8093 0000 		sts mcps_data_indication_info+29,r24
 7887               	.LM787:
 7888 2d56 8823      		tst r24
 7889 2d58 41F0      		breq .L486
 7890 2d5a 5E96      		adiw r26,30
 7891 2d5c F901      		movw r30,r18
 7892 2d5e 7C96      		adiw r30,28
 7893 2d60 982F      		mov r25,r24
 7894               	.L465:
 7896               	.LM788:
 7897 2d62 8191      		ld r24,Z+
 7898 2d64 8D93      		st X+,r24
 7900               	.LM789:
 7901 2d66 9150      		subi r25,lo8(-(-1))
 7902 2d68 E1F7      		brne .L465
 7903               	.L486:
 7905               	.LM790:
 7906 2d6a EDB7      		in r30,__SP_L__
 7907 2d6c FEB7      		in r31,__SP_H__
 7908 2d6e E458      		subi r30,lo8(-(-132))
 7909 2d70 F040      		sbci r31,hi8(-(-132))
 7910 2d72 0FB6      		in __tmp_reg__,__SREG__
 7911 2d74 F894      		cli
 7912 2d76 FEBF      		out __SP_H__,r31
 7913 2d78 0FBE      		out __SREG__,__tmp_reg__
 7914 2d7a EDBF      		out __SP_L__,r30
 7915 2d7c 3196      		adiw r30,1
 7916 2d7e 84E8      		ldi r24,lo8(-124)
 7917 2d80 A0E0      		ldi r26,lo8(mcps_data_indication_info)
 7918 2d82 B0E0      		ldi r27,hi8(mcps_data_indication_info)
 7919 2d84 0D90      		ld __tmp_reg__,X+
 7920 2d86 0192      		st Z+,__tmp_reg__
 7921 2d88 8A95      		dec r24
 7922 2d8a E1F7      		brne .-8
 7923 2d8c 0E94 0000 		call mcpsDataIndication
 7924 2d90 8DB7      		in r24,__SP_L__
 7925 2d92 9EB7      		in r25,__SP_H__
 7926 2d94 8C57      		subi r24,lo8(-(132))
 7927 2d96 9F4F      		sbci r25,hi8(-(132))
 7928 2d98 0FB6      		in __tmp_reg__,__SREG__
 7929 2d9a F894      		cli
 7930 2d9c 9EBF      		out __SP_H__,r25
 7931 2d9e 0FBE      		out __SREG__,__tmp_reg__
 7932 2da0 8DBF      		out __SP_L__,r24
 7934               	.LM791:
 7935 2da2 97C0      		rjmp .L428
 7936               	.L466:
 7938               	.LM792:
 7939 2da4 8091 0000 		lds r24,mac_rx_current_frame+27
 7940 2da8 9927      		clr r25
 7941 2daa 8430      		cpi r24,4
 7942 2dac 9105      		cpc r25,__zero_reg__
 7943 2dae 09F4      		brne .+2
 7944 2db0 57C0      		rjmp .L475
 7945 2db2 8530      		cpi r24,5
 7946 2db4 9105      		cpc r25,__zero_reg__
 7947 2db6 54F4      		brge .L483
 7948 2db8 8230      		cpi r24,2
 7949 2dba 9105      		cpc r25,__zero_reg__
 7950 2dbc 09F4      		brne .+2
 7951 2dbe 89C0      		rjmp .L428
 7952 2dc0 8330      		cpi r24,3
 7953 2dc2 9105      		cpc r25,__zero_reg__
 7954 2dc4 B4F5      		brge .L472
 7955 2dc6 0197      		sbiw r24,1
 7956 2dc8 49F0      		breq .L468
 7957 2dca 83C0      		rjmp .L428
 7958               	.L483:
 7959 2dcc 8630      		cpi r24,6
 7960 2dce 9105      		cpc r25,__zero_reg__
 7961 2dd0 09F4      		brne .+2
 7962 2dd2 67C0      		rjmp .L478
 7963 2dd4 0697      		sbiw r24,6
 7964 2dd6 0CF4      		brge .+2
 7965 2dd8 60C0      		rjmp .L477
 7966 2dda 7BC0      		rjmp .L428
 7967               	.L468:
 7969               	.LM793:
 7970 2ddc 8091 0000 		lds r24,mac_current_state
 7971 2de0 8031      		cpi r24,lo8(16)
 7972 2de2 09F0      		breq .+2
 7973 2de4 76C0      		rjmp .L428
 7975               	.LM794:
 7976 2de6 8091 0000 		lds r24,mac_rx_current_frame+143
 7977 2dea 8093 0000 		sts mlme_associate_indication_info+8,r24
 7979               	.LM795:
 7980 2dee 88E0      		ldi r24,lo8(8)
 7981 2df0 A0E0      		ldi r26,lo8(mac_rx_current_frame+14)
 7982 2df2 B0E0      		ldi r27,hi8(mac_rx_current_frame+14)
 7983 2df4 E0E0      		ldi r30,lo8(mlme_associate_indication_info)
 7984 2df6 F0E0      		ldi r31,hi8(mlme_associate_indication_info)
 7985 2df8 0D90      		ld __tmp_reg__,X+
 7986 2dfa 0192      		st Z+,__tmp_reg__
 7987 2dfc 8A95      		dec r24
 7988 2dfe E1F7      		brne .-8
 7990               	.LM796:
 7991 2e00 E090 0000 		lds r14,mlme_associate_indication_info
 7992 2e04 F090 0000 		lds r15,mlme_associate_indication_info+1
 7993 2e08 0091 0000 		lds r16,mlme_associate_indication_info+2
 7994 2e0c 1091 0000 		lds r17,mlme_associate_indication_info+3
 7995 2e10 2091 0000 		lds r18,mlme_associate_indication_info+4
 7996 2e14 3091 0000 		lds r19,mlme_associate_indication_info+5
 7997 2e18 4091 0000 		lds r20,mlme_associate_indication_info+6
 7998 2e1c 5091 0000 		lds r21,mlme_associate_indication_info+7
 7999 2e20 6091 0000 		lds r22,mlme_associate_indication_info+8
 8000 2e24 7091 0000 		lds r23,mlme_associate_indication_info+9
 8001 2e28 8091 0000 		lds r24,mlme_associate_indication_info+10
 8002 2e2c 0E94 0000 		call mlmeAssociateIndication
 8004               	.LM797:
 8005 2e30 50C0      		rjmp .L428
 8006               	.L472:
 8008               	.LM798:
 8009 2e32 CC24      		clr r12
 8010 2e34 EC2C      		mov r14,r12
 8011 2e36 0091 0000 		lds r16,mac_rx_current_frame+172
 8012 2e3a 2091 0000 		lds r18,mac_rx_current_frame+14
 8013 2e3e 3091 0000 		lds r19,mac_rx_current_frame+15
 8014 2e42 4091 0000 		lds r20,mac_rx_current_frame+16
 8015 2e46 5091 0000 		lds r21,mac_rx_current_frame+17
 8016 2e4a 6091 0000 		lds r22,mac_rx_current_frame+18
 8017 2e4e 7091 0000 		lds r23,mac_rx_current_frame+19
 8018 2e52 8091 0000 		lds r24,mac_rx_current_frame+20
 8019 2e56 9091 0000 		lds r25,mac_rx_current_frame+21
 8020 2e5a 0E94 0000 		call mlmeDisassociateIndication
 8022               	.LM799:
 8023 2e5e 39C0      		rjmp .L428
 8024               	.L475:
 8026               	.LM800:
 8027 2e60 C090 0000 		lds r12,mac_rx_current_frame+13
 8028 2e64 D090 0000 		lds r13,mac_rx_current_frame+14
 8029 2e68 E090 0000 		lds r14,mac_rx_current_frame+15
 8030 2e6c F090 0000 		lds r15,mac_rx_current_frame+16
 8031 2e70 0091 0000 		lds r16,mac_rx_current_frame+17
 8032 2e74 1091 0000 		lds r17,mac_rx_current_frame+18
 8033 2e78 2091 0000 		lds r18,mac_rx_current_frame+19
 8034 2e7c 3091 0000 		lds r19,mac_rx_current_frame+20
 8035 2e80 4091 0000 		lds r20,mac_rx_current_frame+21
 8036 2e84 5091 0000 		lds r21,mac_rx_current_frame+22
 8037 2e88 6091 0000 		lds r22,mac_rx_current_frame+23
 8038 2e8c 7091 0000 		lds r23,mac_rx_current_frame+24
 8039 2e90 8091 0000 		lds r24,mac_rx_current_frame+25
 8040 2e94 0E94 0000 		call pending_data_send
 8042               	.LM801:
 8043 2e98 1CC0      		rjmp .L428
 8044               	.L477:
 8046               	.LM802:
 8047 2e9a 8EEE      		ldi r24,lo8(-18)
 8048 2e9c 0E94 0000 		call mlmeSyncLossIndication
 8050               	.LM803:
 8051 2ea0 18C0      		rjmp .L428
 8052               	.L478:
 8054               	.LM804:
 8055 2ea2 8091 0000 		lds r24,mac_current_state
 8056 2ea6 8031      		cpi r24,lo8(16)
 8057 2ea8 A1F4      		brne .L428
 8059               	.LM805:
 8060 2eaa EE24      		clr r14
 8061 2eac 0E2D      		mov r16,r14
 8062 2eae 2091 0000 		lds r18,mac_rx_current_frame+14
 8063 2eb2 3091 0000 		lds r19,mac_rx_current_frame+15
 8064 2eb6 4091 0000 		lds r20,mac_rx_current_frame+16
 8065 2eba 5091 0000 		lds r21,mac_rx_current_frame+17
 8066 2ebe 6091 0000 		lds r22,mac_rx_current_frame+18
 8067 2ec2 7091 0000 		lds r23,mac_rx_current_frame+19
 8068 2ec6 8091 0000 		lds r24,mac_rx_current_frame+20
 8069 2eca 9091 0000 		lds r25,mac_rx_current_frame+21
 8070 2ece 0E94 0000 		call mlmeOrphanIndication
 8071               	.L428:
 8072               	/* epilogue: frame size=0 */
 8073 2ed2 DF91      		pop r29
 8074 2ed4 CF91      		pop r28
 8075 2ed6 1F91      		pop r17
 8076 2ed8 0F91      		pop r16
 8077 2eda FF90      		pop r15
 8078 2edc EF90      		pop r14
 8079 2ede DF90      		pop r13
 8080 2ee0 CF90      		pop r12
 8081 2ee2 0895      		ret
 8082               	/* epilogue end (size=9) */
 8083               	/* function mac_frame_rcvd size 345 (328) */
 8089               	.Lscope57:
 8090               		.data
 8091               	.LC19:
 8092 0339 0A74 6865 		.string	"\nthe received frame length  is %d\n"
 8092      2072 6563 
 8092      6569 7665 
 8092      6420 6672 
 8092      616D 6520 
 8093               	.LC20:
 8094 035c 0A21 2121 		.string	"\n!!!received frame length error\n"
 8094      7265 6365 
 8094      6976 6564 
 8094      2066 7261 
 8094      6D65 206C 
 8095               		.text
 8097               	.global	mac_get_received_frame
 8099               	mac_get_received_frame:
 8101               	.LM806:
 8102               	/* prologue: frame size=0 */
 8103 2ee4 1F93      		push r17
 8104 2ee6 CF93      		push r28
 8105 2ee8 DF93      		push r29
 8106               	/* prologue end (size=3) */
 8108               	.LM807:
 8109 2eea C091 0000 		lds r28,head_of_rx_buffer
 8110 2eee D091 0000 		lds r29,(head_of_rx_buffer)+1
 8112               	.LM808:
 8113 2ef2 8091 0000 		lds r24,tail_of_rx_buffer
 8114 2ef6 9091 0000 		lds r25,(tail_of_rx_buffer)+1
 8115 2efa 8C17      		cp r24,r28
 8116 2efc 9D07      		cpc r25,r29
 8117 2efe 31F4      		brne .L488
 8119               	.LM809:
 8120 2f00 8885      		ldd r24,Y+8
 8121 2f02 9985      		ldd r25,Y+9
 8122 2f04 9093 0000 		sts (tail_of_rx_buffer)+1,r25
 8123 2f08 8093 0000 		sts tail_of_rx_buffer,r24
 8124               	.L488:
 8126               	.LM810:
 8127 2f0c 8885      		ldd r24,Y+8
 8128 2f0e 9985      		ldd r25,Y+9
 8129 2f10 9093 0000 		sts (head_of_rx_buffer)+1,r25
 8130 2f14 8093 0000 		sts head_of_rx_buffer,r24
 8132               	.LM811:
 8133 2f18 2881      		ld r18,Y
 8134 2f1a 2250      		subi r18,lo8(-(-2))
 8135 2f1c 2093 0000 		sts mac_rx_current_frame+29,r18
 8137               	.LM812:
 8138 2f20 8B81      		ldd r24,Y+3
 8139 2f22 8093 0000 		sts mac_rx_current_frame+31,r24
 8141               	.LM813:
 8142 2f26 8C81      		ldd r24,Y+4
 8143 2f28 9D81      		ldd r25,Y+5
 8144 2f2a AE81      		ldd r26,Y+6
 8145 2f2c BF81      		ldd r27,Y+7
 8146 2f2e 8093 0000 		sts mac_rx_current_frame+32,r24
 8147 2f32 9093 0000 		sts (mac_rx_current_frame+32)+1,r25
 8148 2f36 A093 0000 		sts (mac_rx_current_frame+32)+2,r26
 8149 2f3a B093 0000 		sts (mac_rx_current_frame+32)+3,r27
 8151               	.LM814:
 8152 2f3e 822F      		mov r24,r18
 8153 2f40 9927      		clr r25
 8154 2f42 9F93      		push r25
 8155 2f44 8F93      		push r24
 8156 2f46 80E0      		ldi r24,lo8(.LC19)
 8157 2f48 90E0      		ldi r25,hi8(.LC19)
 8158 2f4a 9F93      		push r25
 8159 2f4c 8F93      		push r24
 8160 2f4e 0E94 0000 		call printf
 8162               	.LM815:
 8163 2f52 E981      		ldd r30,Y+1
 8164 2f54 FA81      		ldd r31,Y+2
 8165 2f56 8181      		ldd r24,Z+1
 8166 2f58 8093 0000 		sts mac_rx_current_frame+36,r24
 8168               	.LM816:
 8169 2f5c E981      		ldd r30,Y+1
 8170 2f5e FA81      		ldd r31,Y+2
 8171 2f60 9281      		ldd r25,Z+2
 8172 2f62 9093 0000 		sts mac_rx_current_frame+37,r25
 8174               	.LM817:
 8175 2f66 E981      		ldd r30,Y+1
 8176 2f68 FA81      		ldd r31,Y+2
 8177 2f6a 14E0      		ldi r17,lo8(4)
 8178 2f6c 8381      		ldd r24,Z+3
 8179 2f6e 8093 0000 		sts mac_rx_current_frame+28,r24
 8181               	.LM818:
 8182 2f72 8091 0000 		lds r24,ppib
 8183 2f76 8093 0000 		sts mac_rx_current_frame+177,r24
 8185               	.LM819:
 8186 2f7a 0F90      		pop __tmp_reg__
 8187 2f7c 0F90      		pop __tmp_reg__
 8188 2f7e 0F90      		pop __tmp_reg__
 8189 2f80 0F90      		pop __tmp_reg__
 8190 2f82 292F      		mov r18,r25
 8191 2f84 3327      		clr r19
 8192 2f86 2C70      		andi r18,lo8(12)
 8193 2f88 3070      		andi r19,hi8(12)
 8194 2f8a 2430      		cpi r18,4
 8195 2f8c 3105      		cpc r19,__zero_reg__
 8196 2f8e 09F4      		brne .+2
 8197 2f90 63C0      		rjmp .L493
 8198 2f92 2530      		cpi r18,5
 8199 2f94 3105      		cpc r19,__zero_reg__
 8200 2f96 24F4      		brge .L494
 8201 2f98 232B      		or r18,r19
 8202 2f9a 09F4      		brne .+2
 8203 2f9c 5AC0      		rjmp .L492
 8204 2f9e 60C0      		rjmp .L489
 8205               	.L494:
 8206 2fa0 2830      		cpi r18,8
 8207 2fa2 3105      		cpc r19,__zero_reg__
 8208 2fa4 E9F1      		breq .L491
 8209 2fa6 2C30      		cpi r18,12
 8210 2fa8 3105      		cpc r19,__zero_reg__
 8211 2faa 09F0      		breq .+2
 8212 2fac 59C0      		rjmp .L489
 8214               	.LM820:
 8215 2fae 83E0      		ldi r24,lo8(3)
 8216 2fb0 8093 0000 		sts mac_rx_current_frame,r24
 8218               	.LM821:
 8219 2fb4 E981      		ldd r30,Y+1
 8220 2fb6 FA81      		ldd r31,Y+2
 8221 2fb8 8481      		ldd r24,Z+4
 8222 2fba 8093 0000 		sts mac_rx_current_frame+11,r24
 8224               	.LM822:
 8225 2fbe E981      		ldd r30,Y+1
 8226 2fc0 FA81      		ldd r31,Y+2
 8227 2fc2 8581      		ldd r24,Z+5
 8228 2fc4 8093 0000 		sts mac_rx_current_frame+12,r24
 8230               	.LM823:
 8231 2fc8 E981      		ldd r30,Y+1
 8232 2fca FA81      		ldd r31,Y+2
 8233 2fcc 8681      		ldd r24,Z+6
 8234 2fce 8093 0000 		sts mac_rx_current_frame+1,r24
 8236               	.LM824:
 8237 2fd2 E981      		ldd r30,Y+1
 8238 2fd4 FA81      		ldd r31,Y+2
 8239 2fd6 8781      		ldd r24,Z+7
 8240 2fd8 8093 0000 		sts mac_rx_current_frame+2,r24
 8242               	.LM825:
 8243 2fdc E981      		ldd r30,Y+1
 8244 2fde FA81      		ldd r31,Y+2
 8245 2fe0 8085      		ldd r24,Z+8
 8246 2fe2 8093 0000 		sts mac_rx_current_frame+3,r24
 8248               	.LM826:
 8249 2fe6 E981      		ldd r30,Y+1
 8250 2fe8 FA81      		ldd r31,Y+2
 8251 2fea 8185      		ldd r24,Z+9
 8252 2fec 8093 0000 		sts mac_rx_current_frame+4,r24
 8254               	.LM827:
 8255 2ff0 E981      		ldd r30,Y+1
 8256 2ff2 FA81      		ldd r31,Y+2
 8257 2ff4 8285      		ldd r24,Z+10
 8258 2ff6 8093 0000 		sts mac_rx_current_frame+5,r24
 8260               	.LM828:
 8261 2ffa E981      		ldd r30,Y+1
 8262 2ffc FA81      		ldd r31,Y+2
 8263 2ffe 8385      		ldd r24,Z+11
 8264 3000 8093 0000 		sts mac_rx_current_frame+6,r24
 8266               	.LM829:
 8267 3004 E981      		ldd r30,Y+1
 8268 3006 FA81      		ldd r31,Y+2
 8269 3008 E20F      		add r30,r18
 8270 300a F31F      		adc r31,r19
 8271 300c 8081      		ld r24,Z
 8272 300e 8093 0000 		sts mac_rx_current_frame+7,r24
 8274               	.LM830:
 8275 3012 E981      		ldd r30,Y+1
 8276 3014 FA81      		ldd r31,Y+2
 8277 3016 1EE0      		ldi r17,lo8(14)
 8278 3018 8585      		ldd r24,Z+13
 8279 301a 8093 0000 		sts mac_rx_current_frame+8,r24
 8281               	.LM831:
 8282 301e 20C0      		rjmp .L489
 8283               	.L491:
 8285               	.LM832:
 8286 3020 82E0      		ldi r24,lo8(2)
 8287 3022 8093 0000 		sts mac_rx_current_frame,r24
 8289               	.LM833:
 8290 3026 E981      		ldd r30,Y+1
 8291 3028 FA81      		ldd r31,Y+2
 8292 302a 8481      		ldd r24,Z+4
 8293 302c 8093 0000 		sts mac_rx_current_frame+11,r24
 8295               	.LM834:
 8296 3030 E981      		ldd r30,Y+1
 8297 3032 FA81      		ldd r31,Y+2
 8298 3034 8581      		ldd r24,Z+5
 8299 3036 8093 0000 		sts mac_rx_current_frame+12,r24
 8301               	.LM835:
 8302 303a E981      		ldd r30,Y+1
 8303 303c FA81      		ldd r31,Y+2
 8304 303e 8681      		ldd r24,Z+6
 8305 3040 8093 0000 		sts mac_rx_current_frame+9,r24
 8307               	.LM836:
 8308 3044 E981      		ldd r30,Y+1
 8309 3046 FA81      		ldd r31,Y+2
 8310 3048 18E0      		ldi r17,lo8(8)
 8311 304a 8781      		ldd r24,Z+7
 8312 304c 8093 0000 		sts mac_rx_current_frame+10,r24
 8314               	.LM837:
 8315 3050 07C0      		rjmp .L489
 8316               	.L492:
 8318               	.LM838:
 8319 3052 1092 0000 		sts mac_rx_current_frame,__zero_reg__
 8321               	.LM839:
 8322 3056 04C0      		rjmp .L489
 8323               	.L493:
 8325               	.LM840:
 8326 3058 80E0      		ldi r24,lo8(.LC12)
 8327 305a 90E0      		ldi r25,hi8(.LC12)
 8328 305c 0E94 0000 		call error
 8329               	.L489:
 8331               	.LM841:
 8332 3060 8091 0000 		lds r24,mac_rx_current_frame+37
 8333 3064 9927      		clr r25
 8334 3066 807C      		andi r24,lo8(192)
 8335 3068 9070      		andi r25,hi8(192)
 8336 306a 8034      		cpi r24,64
 8337 306c 9105      		cpc r25,__zero_reg__
 8338 306e 09F4      		brne .+2
 8339 3070 8AC0      		rjmp .L499
 8340 3072 8134      		cpi r24,65
 8341 3074 9105      		cpc r25,__zero_reg__
 8342 3076 24F4      		brge .L500
 8343 3078 892B      		or r24,r25
 8344 307a 09F4      		brne .+2
 8345 307c 81C0      		rjmp .L498
 8346 307e 87C0      		rjmp .L495
 8347               	.L500:
 8348 3080 8038      		cpi r24,128
 8349 3082 9105      		cpc r25,__zero_reg__
 8350 3084 09F4      		brne .+2
 8351 3086 58C0      		rjmp .L497
 8352 3088 803C      		cpi r24,192
 8353 308a 9105      		cpc r25,__zero_reg__
 8354 308c 09F0      		breq .+2
 8355 308e 7FC0      		rjmp .L495
 8357               	.LM842:
 8358 3090 83E0      		ldi r24,lo8(3)
 8359 3092 8093 0000 		sts mac_rx_current_frame+13,r24
 8361               	.LM843:
 8362 3096 E981      		ldd r30,Y+1
 8363 3098 FA81      		ldd r31,Y+2
 8364 309a E10F      		add r30,r17
 8365 309c F11D      		adc r31,__zero_reg__
 8366 309e 1F5F      		subi r17,lo8(-(1))
 8367 30a0 8081      		ld r24,Z
 8368 30a2 8093 0000 		sts mac_rx_current_frame+24,r24
 8370               	.LM844:
 8371 30a6 E981      		ldd r30,Y+1
 8372 30a8 FA81      		ldd r31,Y+2
 8373 30aa E10F      		add r30,r17
 8374 30ac F11D      		adc r31,__zero_reg__
 8375 30ae 1F5F      		subi r17,lo8(-(1))
 8376 30b0 8081      		ld r24,Z
 8377 30b2 8093 0000 		sts mac_rx_current_frame+25,r24
 8379               	.LM845:
 8380 30b6 E981      		ldd r30,Y+1
 8381 30b8 FA81      		ldd r31,Y+2
 8382 30ba E10F      		add r30,r17
 8383 30bc F11D      		adc r31,__zero_reg__
 8384 30be 1F5F      		subi r17,lo8(-(1))
 8385 30c0 8081      		ld r24,Z
 8386 30c2 8093 0000 		sts mac_rx_current_frame+14,r24
 8388               	.LM846:
 8389 30c6 E981      		ldd r30,Y+1
 8390 30c8 FA81      		ldd r31,Y+2
 8391 30ca E10F      		add r30,r17
 8392 30cc F11D      		adc r31,__zero_reg__
 8393 30ce 1F5F      		subi r17,lo8(-(1))
 8394 30d0 8081      		ld r24,Z
 8395 30d2 8093 0000 		sts mac_rx_current_frame+15,r24
 8397               	.LM847:
 8398 30d6 E981      		ldd r30,Y+1
 8399 30d8 FA81      		ldd r31,Y+2
 8400 30da E10F      		add r30,r17
 8401 30dc F11D      		adc r31,__zero_reg__
 8402 30de 1F5F      		subi r17,lo8(-(1))
 8403 30e0 8081      		ld r24,Z
 8404 30e2 8093 0000 		sts mac_rx_current_frame+16,r24
 8406               	.LM848:
 8407 30e6 E981      		ldd r30,Y+1
 8408 30e8 FA81      		ldd r31,Y+2
 8409 30ea E10F      		add r30,r17
 8410 30ec F11D      		adc r31,__zero_reg__
 8411 30ee 1F5F      		subi r17,lo8(-(1))
 8412 30f0 8081      		ld r24,Z
 8413 30f2 8093 0000 		sts mac_rx_current_frame+17,r24
 8415               	.LM849:
 8416 30f6 E981      		ldd r30,Y+1
 8417 30f8 FA81      		ldd r31,Y+2
 8418 30fa E10F      		add r30,r17
 8419 30fc F11D      		adc r31,__zero_reg__
 8420 30fe 1F5F      		subi r17,lo8(-(1))
 8421 3100 8081      		ld r24,Z
 8422 3102 8093 0000 		sts mac_rx_current_frame+18,r24
 8424               	.LM850:
 8425 3106 E981      		ldd r30,Y+1
 8426 3108 FA81      		ldd r31,Y+2
 8427 310a E10F      		add r30,r17
 8428 310c F11D      		adc r31,__zero_reg__
 8429 310e 1F5F      		subi r17,lo8(-(1))
 8430 3110 8081      		ld r24,Z
 8431 3112 8093 0000 		sts mac_rx_current_frame+19,r24
 8433               	.LM851:
 8434 3116 E981      		ldd r30,Y+1
 8435 3118 FA81      		ldd r31,Y+2
 8436 311a E10F      		add r30,r17
 8437 311c F11D      		adc r31,__zero_reg__
 8438 311e 1F5F      		subi r17,lo8(-(1))
 8439 3120 8081      		ld r24,Z
 8440 3122 8093 0000 		sts mac_rx_current_frame+20,r24
 8442               	.LM852:
 8443 3126 E981      		ldd r30,Y+1
 8444 3128 FA81      		ldd r31,Y+2
 8445 312a E10F      		add r30,r17
 8446 312c F11D      		adc r31,__zero_reg__
 8447 312e 1F5F      		subi r17,lo8(-(1))
 8448 3130 8081      		ld r24,Z
 8449 3132 8093 0000 		sts mac_rx_current_frame+21,r24
 8451               	.LM853:
 8452 3136 2BC0      		rjmp .L495
 8453               	.L497:
 8455               	.LM854:
 8456 3138 82E0      		ldi r24,lo8(2)
 8457 313a 8093 0000 		sts mac_rx_current_frame+13,r24
 8459               	.LM855:
 8460 313e E981      		ldd r30,Y+1
 8461 3140 FA81      		ldd r31,Y+2
 8462 3142 E10F      		add r30,r17
 8463 3144 F11D      		adc r31,__zero_reg__
 8464 3146 1F5F      		subi r17,lo8(-(1))
 8465 3148 8081      		ld r24,Z
 8466 314a 8093 0000 		sts mac_rx_current_frame+24,r24
 8468               	.LM856:
 8469 314e E981      		ldd r30,Y+1
 8470 3150 FA81      		ldd r31,Y+2
 8471 3152 E10F      		add r30,r17
 8472 3154 F11D      		adc r31,__zero_reg__
 8473 3156 1F5F      		subi r17,lo8(-(1))
 8474 3158 8081      		ld r24,Z
 8475 315a 8093 0000 		sts mac_rx_current_frame+25,r24
 8477               	.LM857:
 8478 315e E981      		ldd r30,Y+1
 8479 3160 FA81      		ldd r31,Y+2
 8480 3162 E10F      		add r30,r17
 8481 3164 F11D      		adc r31,__zero_reg__
 8482 3166 1F5F      		subi r17,lo8(-(1))
 8483 3168 8081      		ld r24,Z
 8484 316a 8093 0000 		sts mac_rx_current_frame+22,r24
 8486               	.LM858:
 8487 316e E981      		ldd r30,Y+1
 8488 3170 FA81      		ldd r31,Y+2
 8489 3172 E10F      		add r30,r17
 8490 3174 F11D      		adc r31,__zero_reg__
 8491 3176 1F5F      		subi r17,lo8(-(1))
 8492 3178 8081      		ld r24,Z
 8493 317a 8093 0000 		sts mac_rx_current_frame+23,r24
 8495               	.LM859:
 8496 317e 07C0      		rjmp .L495
 8497               	.L498:
 8499               	.LM860:
 8500 3180 1092 0000 		sts mac_rx_current_frame+13,__zero_reg__
 8502               	.LM861:
 8503 3184 04C0      		rjmp .L495
 8504               	.L499:
 8506               	.LM862:
 8507 3186 80E0      		ldi r24,lo8(.LC12)
 8508 3188 90E0      		ldi r25,hi8(.LC12)
 8509 318a 0E94 0000 		call error
 8510               	.L495:
 8512               	.LM863:
 8513 318e 8091 0000 		lds r24,mac_rx_current_frame+36
 8514 3192 8770      		andi r24,lo8(7)
 8515 3194 8093 0000 		sts mac_rx_current_frame+26,r24
 8517               	.LM864:
 8518 3198 9927      		clr r25
 8519 319a 8130      		cpi r24,1
 8520 319c 9105      		cpc r25,__zero_reg__
 8521 319e 09F4      		brne .+2
 8522 31a0 BCC0      		rjmp .L515
 8523 31a2 8230      		cpi r24,2
 8524 31a4 9105      		cpc r25,__zero_reg__
 8525 31a6 1CF4      		brge .L533
 8526 31a8 892B      		or r24,r25
 8527 31aa 29F0      		breq .L502
 8528 31ac 4CC1      		rjmp .L501
 8529               	.L533:
 8530 31ae 0397      		sbiw r24,3
 8531 31b0 09F4      		brne .+2
 8532 31b2 CDC0      		rjmp .L521
 8533 31b4 48C1      		rjmp .L501
 8534               	.L502:
 8536               	.LM865:
 8537 31b6 E981      		ldd r30,Y+1
 8538 31b8 FA81      		ldd r31,Y+2
 8539 31ba E10F      		add r30,r17
 8540 31bc F11D      		adc r31,__zero_reg__
 8541 31be 1F5F      		subi r17,lo8(-(1))
 8542 31c0 8081      		ld r24,Z
 8543 31c2 8093 0000 		sts mac_rx_current_frame+144,r24
 8545               	.LM866:
 8546 31c6 E981      		ldd r30,Y+1
 8547 31c8 FA81      		ldd r31,Y+2
 8548 31ca E10F      		add r30,r17
 8549 31cc F11D      		adc r31,__zero_reg__
 8550 31ce 1F5F      		subi r17,lo8(-(1))
 8551 31d0 8081      		ld r24,Z
 8552 31d2 8093 0000 		sts mac_rx_current_frame+145,r24
 8554               	.LM867:
 8555 31d6 E981      		ldd r30,Y+1
 8556 31d8 FA81      		ldd r31,Y+2
 8557 31da E10F      		add r30,r17
 8558 31dc F11D      		adc r31,__zero_reg__
 8559 31de 1F5F      		subi r17,lo8(-(1))
 8560 31e0 8081      		ld r24,Z
 8561 31e2 8093 0000 		sts mac_rx_current_frame+180,r24
 8563               	.LM868:
 8564 31e6 E981      		ldd r30,Y+1
 8565 31e8 FA81      		ldd r31,Y+2
 8566 31ea E10F      		add r30,r17
 8567 31ec F11D      		adc r31,__zero_reg__
 8568 31ee 1F5F      		subi r17,lo8(-(1))
 8569 31f0 8081      		ld r24,Z
 8570 31f2 8093 0000 		sts mac_rx_current_frame+146,r24
 8572               	.LM869:
 8573 31f6 282F      		mov r18,r24
 8574 31f8 2770      		andi r18,lo8(7)
 8575 31fa 2093 0000 		sts mac_rx_current_frame+147,r18
 8577               	.LM870:
 8578 31fe 9927      		clr r25
 8579 3200 8077      		andi r24,lo8(112)
 8580 3202 9070      		andi r25,hi8(112)
 8581 3204 E4E0      		ldi r30,4
 8582 3206 9595      	1:	asr r25
 8583 3208 8795      		ror r24
 8584 320a EA95      		dec r30
 8585 320c E1F7      		brne 1b
 8586 320e 8093 0000 		sts mac_rx_current_frame+148,r24
 8588               	.LM871:
 8589 3212 90E0      		ldi r25,lo8(0)
 8590 3214 9217      		cp r25,r18
 8591 3216 E0F4      		brsh .L536
 8592               	.L506:
 8594               	.LM872:
 8595 3218 E92F      		mov r30,r25
 8596 321a FF27      		clr r31
 8597 321c EE0F      		add r30,r30
 8598 321e FF1F      		adc r31,r31
 8599 3220 E050      		subi r30,lo8(-(mac_rx_current_frame))
 8600 3222 F040      		sbci r31,hi8(-(mac_rx_current_frame))
 8601 3224 EB56      		subi r30,lo8(-(149))
 8602 3226 FF4F      		sbci r31,hi8(-(149))
 8603 3228 A981      		ldd r26,Y+1
 8604 322a BA81      		ldd r27,Y+2
 8605 322c A10F      		add r26,r17
 8606 322e B11D      		adc r27,__zero_reg__
 8607 3230 1F5F      		subi r17,lo8(-(1))
 8608 3232 8C91      		ld r24,X
 8609 3234 8193      		st Z+,r24
 8611               	.LM873:
 8612 3236 DF01      		movw r26,r30
 8613 3238 E981      		ldd r30,Y+1
 8614 323a FA81      		ldd r31,Y+2
 8615 323c E10F      		add r30,r17
 8616 323e F11D      		adc r31,__zero_reg__
 8617 3240 1F5F      		subi r17,lo8(-(1))
 8618 3242 8081      		ld r24,Z
 8619 3244 8C93      		st X,r24
 8621               	.LM874:
 8622 3246 9F5F      		subi r25,lo8(-(1))
 8623 3248 8091 0000 		lds r24,mac_rx_current_frame+147
 8624 324c 9817      		cp r25,r24
 8625 324e 20F3      		brlo .L506
 8626               	.L536:
 8628               	.LM875:
 8629 3250 90E0      		ldi r25,lo8(0)
 8630               	.L543:
 8631 3252 8091 0000 		lds r24,mac_rx_current_frame+148
 8632 3256 9817      		cp r25,r24
 8633 3258 08F0      		brlo .+2
 8634 325a 45C0      		rjmp .L538
 8636               	.LM876:
 8637 325c A92F      		mov r26,r25
 8638 325e BB27      		clr r27
 8639 3260 73E0      		ldi r23,3
 8640 3262 AA0F      	1:	lsl r26
 8641 3264 BB1F      		rol r27
 8642 3266 7A95      		dec r23
 8643 3268 E1F7      		brne 1b
 8644 326a A050      		subi r26,lo8(-(mac_rx_current_frame))
 8645 326c B040      		sbci r27,hi8(-(mac_rx_current_frame))
 8646 326e A756      		subi r26,lo8(-(153))
 8647 3270 BF4F      		sbci r27,hi8(-(153))
 8648 3272 E981      		ldd r30,Y+1
 8649 3274 FA81      		ldd r31,Y+2
 8650 3276 E10F      		add r30,r17
 8651 3278 F11D      		adc r31,__zero_reg__
 8652 327a 1F5F      		subi r17,lo8(-(1))
 8653 327c 8081      		ld r24,Z
 8654 327e 8D93      		st X+,r24
 8656               	.LM877:
 8657 3280 E981      		ldd r30,Y+1
 8658 3282 FA81      		ldd r31,Y+2
 8659 3284 E10F      		add r30,r17
 8660 3286 F11D      		adc r31,__zero_reg__
 8661 3288 1F5F      		subi r17,lo8(-(1))
 8662 328a 8081      		ld r24,Z
 8663 328c 8D93      		st X+,r24
 8665               	.LM878:
 8666 328e E981      		ldd r30,Y+1
 8667 3290 FA81      		ldd r31,Y+2
 8668 3292 E10F      		add r30,r17
 8669 3294 F11D      		adc r31,__zero_reg__
 8670 3296 1F5F      		subi r17,lo8(-(1))
 8671 3298 8081      		ld r24,Z
 8672 329a 8D93      		st X+,r24
 8674               	.LM879:
 8675 329c E981      		ldd r30,Y+1
 8676 329e FA81      		ldd r31,Y+2
 8677 32a0 E10F      		add r30,r17
 8678 32a2 F11D      		adc r31,__zero_reg__
 8679 32a4 1F5F      		subi r17,lo8(-(1))
 8680 32a6 8081      		ld r24,Z
 8681 32a8 8D93      		st X+,r24
 8683               	.LM880:
 8684 32aa E981      		ldd r30,Y+1
 8685 32ac FA81      		ldd r31,Y+2
 8686 32ae E10F      		add r30,r17
 8687 32b0 F11D      		adc r31,__zero_reg__
 8688 32b2 1F5F      		subi r17,lo8(-(1))
 8689 32b4 8081      		ld r24,Z
 8690 32b6 8D93      		st X+,r24
 8692               	.LM881:
 8693 32b8 E981      		ldd r30,Y+1
 8694 32ba FA81      		ldd r31,Y+2
 8695 32bc E10F      		add r30,r17
 8696 32be F11D      		adc r31,__zero_reg__
 8697 32c0 1F5F      		subi r17,lo8(-(1))
 8698 32c2 8081      		ld r24,Z
 8699 32c4 8D93      		st X+,r24
 8701               	.LM882:
 8702 32c6 E981      		ldd r30,Y+1
 8703 32c8 FA81      		ldd r31,Y+2
 8704 32ca E10F      		add r30,r17
 8705 32cc F11D      		adc r31,__zero_reg__
 8706 32ce 1F5F      		subi r17,lo8(-(1))
 8707 32d0 8081      		ld r24,Z
 8708 32d2 8D93      		st X+,r24
 8710               	.LM883:
 8711 32d4 E981      		ldd r30,Y+1
 8712 32d6 FA81      		ldd r31,Y+2
 8713 32d8 E10F      		add r30,r17
 8714 32da F11D      		adc r31,__zero_reg__
 8715 32dc 1F5F      		subi r17,lo8(-(1))
 8716 32de 8081      		ld r24,Z
 8717 32e0 8C93      		st X,r24
 8719               	.LM884:
 8720 32e2 9F5F      		subi r25,lo8(-(1))
 8721 32e4 B6CF      		rjmp .L543
 8722               	.L538:
 8724               	.LM885:
 8725 32e6 E981      		ldd r30,Y+1
 8726 32e8 FA81      		ldd r31,Y+2
 8727 32ea E10F      		add r30,r17
 8728 32ec F11D      		adc r31,__zero_reg__
 8729 32ee 1F5F      		subi r17,lo8(-(1))
 8730 32f0 A081      		ld r26,Z
 8731 32f2 A093 0000 		sts mac_rx_current_frame+40,r26
 8733               	.LM886:
 8734 32f6 AA23      		tst r26
 8735 32f8 09F4      		brne .+2
 8736 32fa A5C0      		rjmp .L501
 8737 32fc 20E0      		ldi r18,lo8(mac_rx_current_frame+41)
 8738 32fe 30E0      		ldi r19,hi8(mac_rx_current_frame+41)
 8739 3300 9A2F      		mov r25,r26
 8740               	.L514:
 8742               	.LM887:
 8743 3302 E981      		ldd r30,Y+1
 8744 3304 FA81      		ldd r31,Y+2
 8745 3306 E10F      		add r30,r17
 8746 3308 F11D      		adc r31,__zero_reg__
 8747 330a 1F5F      		subi r17,lo8(-(1))
 8748 330c 8081      		ld r24,Z
 8749 330e F901      		movw r30,r18
 8750 3310 8193      		st Z+,r24
 8751 3312 9F01      		movw r18,r30
 8753               	.LM888:
 8754 3314 9150      		subi r25,lo8(-(-1))
 8755 3316 A9F7      		brne .L514
 8757               	.LM889:
 8758 3318 96C0      		rjmp .L501
 8759               	.L515:
 8761               	.LM890:
 8762 331a E981      		ldd r30,Y+1
 8763 331c FA81      		ldd r31,Y+2
 8764 331e E10F      		add r30,r17
 8765 3320 F11D      		adc r31,__zero_reg__
 8766 3322 1F5F      		subi r17,lo8(-(1))
 8767 3324 A081      		ld r26,Z
 8768 3326 A093 0000 		sts mac_rx_current_frame+39,r26
 8770               	.LM891:
 8771 332a AA23      		tst r26
 8772 332c 09F4      		brne .+2
 8773 332e 8BC0      		rjmp .L501
 8774 3330 20E0      		ldi r18,lo8(mac_rx_current_frame+41)
 8775 3332 30E0      		ldi r19,hi8(mac_rx_current_frame+41)
 8776 3334 9A2F      		mov r25,r26
 8777               	.L519:
 8779               	.LM892:
 8780 3336 E981      		ldd r30,Y+1
 8781 3338 FA81      		ldd r31,Y+2
 8782 333a E10F      		add r30,r17
 8783 333c F11D      		adc r31,__zero_reg__
 8784 333e 1F5F      		subi r17,lo8(-(1))
 8785 3340 8081      		ld r24,Z
 8786 3342 F901      		movw r30,r18
 8787 3344 8193      		st Z+,r24
 8788 3346 9F01      		movw r18,r30
 8790               	.LM893:
 8791 3348 9150      		subi r25,lo8(-(-1))
 8792 334a A9F7      		brne .L519
 8794               	.LM894:
 8795 334c 7CC0      		rjmp .L501
 8796               	.L521:
 8798               	.LM895:
 8799 334e E981      		ldd r30,Y+1
 8800 3350 FA81      		ldd r31,Y+2
 8801 3352 E10F      		add r30,r17
 8802 3354 F11D      		adc r31,__zero_reg__
 8803 3356 1F5F      		subi r17,lo8(-(1))
 8804 3358 8081      		ld r24,Z
 8805 335a 8093 0000 		sts mac_rx_current_frame+27,r24
 8807               	.LM896:
 8808 335e 9927      		clr r25
 8809 3360 8230      		cpi r24,2
 8810 3362 9105      		cpc r25,__zero_reg__
 8811 3364 B1F0      		breq .L524
 8812 3366 8330      		cpi r24,3
 8813 3368 9105      		cpc r25,__zero_reg__
 8814 336a 1CF4      		brge .L532
 8815 336c 0197      		sbiw r24,1
 8816 336e 41F0      		breq .L523
 8817 3370 6AC0      		rjmp .L501
 8818               	.L532:
 8819 3372 8330      		cpi r24,3
 8820 3374 9105      		cpc r25,__zero_reg__
 8821 3376 09F4      		brne .+2
 8822 3378 5EC0      		rjmp .L528
 8823 337a 0897      		sbiw r24,8
 8824 337c 19F1      		breq .L526
 8825 337e 63C0      		rjmp .L501
 8826               	.L523:
 8828               	.LM897:
 8829 3380 E981      		ldd r30,Y+1
 8830 3382 FA81      		ldd r31,Y+2
 8831 3384 E10F      		add r30,r17
 8832 3386 F11D      		adc r31,__zero_reg__
 8833 3388 1F5F      		subi r17,lo8(-(1))
 8834 338a 8081      		ld r24,Z
 8835 338c 8093 0000 		sts mac_rx_current_frame+143,r24
 8837               	.LM898:
 8838 3390 5AC0      		rjmp .L501
 8839               	.L524:
 8841               	.LM899:
 8842 3392 E981      		ldd r30,Y+1
 8843 3394 FA81      		ldd r31,Y+2
 8844 3396 E10F      		add r30,r17
 8845 3398 F11D      		adc r31,__zero_reg__
 8846 339a 1F5F      		subi r17,lo8(-(1))
 8847 339c 8081      		ld r24,Z
 8848 339e 8093 0000 		sts mac_rx_current_frame+169,r24
 8850               	.LM900:
 8851 33a2 E981      		ldd r30,Y+1
 8852 33a4 FA81      		ldd r31,Y+2
 8853 33a6 E10F      		add r30,r17
 8854 33a8 F11D      		adc r31,__zero_reg__
 8855 33aa 1F5F      		subi r17,lo8(-(1))
 8856 33ac 8081      		ld r24,Z
 8857 33ae 8093 0000 		sts mac_rx_current_frame+170,r24
 8859               	.LM901:
 8860 33b2 E981      		ldd r30,Y+1
 8861 33b4 FA81      		ldd r31,Y+2
 8862 33b6 E10F      		add r30,r17
 8863 33b8 F11D      		adc r31,__zero_reg__
 8864 33ba 1F5F      		subi r17,lo8(-(1))
 8865 33bc 8081      		ld r24,Z
 8866 33be 8093 0000 		sts mac_rx_current_frame+171,r24
 8868               	.LM902:
 8869 33c2 41C0      		rjmp .L501
 8870               	.L526:
 8872               	.LM903:
 8873 33c4 E981      		ldd r30,Y+1
 8874 33c6 FA81      		ldd r31,Y+2
 8875 33c8 E10F      		add r30,r17
 8876 33ca F11D      		adc r31,__zero_reg__
 8877 33cc 1F5F      		subi r17,lo8(-(1))
 8878 33ce 8081      		ld r24,Z
 8879 33d0 8093 0000 		sts mac_rx_current_frame+173,r24
 8881               	.LM904:
 8882 33d4 E981      		ldd r30,Y+1
 8883 33d6 FA81      		ldd r31,Y+2
 8884 33d8 E10F      		add r30,r17
 8885 33da F11D      		adc r31,__zero_reg__
 8886 33dc 1F5F      		subi r17,lo8(-(1))
 8887 33de 8081      		ld r24,Z
 8888 33e0 8093 0000 		sts mac_rx_current_frame+174,r24
 8890               	.LM905:
 8891 33e4 E981      		ldd r30,Y+1
 8892 33e6 FA81      		ldd r31,Y+2
 8893 33e8 E10F      		add r30,r17
 8894 33ea F11D      		adc r31,__zero_reg__
 8895 33ec 1F5F      		subi r17,lo8(-(1))
 8896 33ee 8081      		ld r24,Z
 8897 33f0 8093 0000 		sts mac_rx_current_frame+175,r24
 8899               	.LM906:
 8900 33f4 E981      		ldd r30,Y+1
 8901 33f6 FA81      		ldd r31,Y+2
 8902 33f8 E10F      		add r30,r17
 8903 33fa F11D      		adc r31,__zero_reg__
 8904 33fc 1F5F      		subi r17,lo8(-(1))
 8905 33fe 8081      		ld r24,Z
 8906 3400 8093 0000 		sts mac_rx_current_frame+176,r24
 8908               	.LM907:
 8909 3404 E981      		ldd r30,Y+1
 8910 3406 FA81      		ldd r31,Y+2
 8911 3408 E10F      		add r30,r17
 8912 340a F11D      		adc r31,__zero_reg__
 8913 340c 1F5F      		subi r17,lo8(-(1))
 8914 340e 8081      		ld r24,Z
 8915 3410 8093 0000 		sts mac_rx_current_frame+177,r24
 8917               	.LM908:
 8918 3414 E981      		ldd r30,Y+1
 8919 3416 FA81      		ldd r31,Y+2
 8920 3418 E10F      		add r30,r17
 8921 341a F11D      		adc r31,__zero_reg__
 8922 341c 1F5F      		subi r17,lo8(-(1))
 8923 341e 8081      		ld r24,Z
 8924 3420 8093 0000 		sts mac_rx_current_frame+178,r24
 8926               	.LM909:
 8927 3424 E981      		ldd r30,Y+1
 8928 3426 FA81      		ldd r31,Y+2
 8929 3428 E10F      		add r30,r17
 8930 342a F11D      		adc r31,__zero_reg__
 8931 342c 1F5F      		subi r17,lo8(-(1))
 8932 342e 8081      		ld r24,Z
 8933 3430 8093 0000 		sts mac_rx_current_frame+179,r24
 8935               	.LM910:
 8936 3434 08C0      		rjmp .L501
 8937               	.L528:
 8939               	.LM911:
 8940 3436 E981      		ldd r30,Y+1
 8941 3438 FA81      		ldd r31,Y+2
 8942 343a E10F      		add r30,r17
 8943 343c F11D      		adc r31,__zero_reg__
 8944 343e 1F5F      		subi r17,lo8(-(1))
 8945 3440 8081      		ld r24,Z
 8946 3442 8093 0000 		sts mac_rx_current_frame+172,r24
 8947               	.L501:
 8949               	.LM912:
 8950 3446 812F      		mov r24,r17
 8951 3448 9927      		clr r25
 8952 344a 0197      		sbiw r24,1
 8953 344c 2091 0000 		lds r18,mac_rx_current_frame+29
 8954 3450 3327      		clr r19
 8955 3452 8217      		cp r24,r18
 8956 3454 9307      		cpc r25,r19
 8957 3456 29F0      		breq .L534
 8959               	.LM913:
 8960 3458 80E0      		ldi r24,lo8(.LC20)
 8961 345a 90E0      		ldi r25,hi8(.LC20)
 8962 345c 0E94 0000 		call error
 8964               	.LM914:
 8965 3460 05C0      		rjmp .L487
 8966               	.L534:
 8968               	.LM915:
 8969 3462 CE01      		movw r24,r28
 8970 3464 0E94 0000 		call remove_from_rx_buffer
 8972               	.LM916:
 8973 3468 0E94 0000 		call mac_frame_rcvd
 8974               	.L487:
 8975               	/* epilogue: frame size=0 */
 8976 346c DF91      		pop r29
 8977 346e CF91      		pop r28
 8978 3470 1F91      		pop r17
 8979 3472 0895      		ret
 8980               	/* epilogue end (size=4) */
 8981               	/* function mac_get_received_frame size 717 (710) */
 8988               	.Lscope58:
 8990               	.global	initial_pending_queue
 8992               	initial_pending_queue:
 8994               	.LM917:
 8995               	/* prologue: frame size=0 */
 8996               	/* prologue end (size=0) */
 8997               	/* epilogue: frame size=0 */
 8998 3474 0895      		ret
 8999               	/* epilogue end (size=1) */
 9000               	/* function initial_pending_queue size 1 (0) */
 9002               	.Lscope59:
 9004               	.global	random_generate
 9006               	random_generate:
2340:mac.c         **** 
2341:mac.c         **** 
2342:mac.c         **** 
2343:mac.c         **** uint8_t   csma_state;
2344:mac.c         **** #define  csma_state_initial   0
2345:mac.c         **** #define   csma_state_delaying   1
2346:mac.c         **** 
2347:mac.c         **** 
2348:mac.c         **** TX_BUFFER   * temp_csma_ca_frame;
2349:mac.c         **** uint8_t BE;
2350:mac.c         **** uint8_t NB;
2351:mac.c         **** uint8_t CW;   
2352:mac.c         **** 
2353:mac.c         **** 
2354:mac.c         **** uint8_t  random_generate(void)
2355:mac.c         **** {
 9008               	.LM918:
 9009               	/* prologue: frame size=0 */
 9010               	/* prologue end (size=0) */
2356:mac.c         ****      return 0;
2357:mac.c         **** }
 9012               	.LM919:
 9013 3476 80E0      		ldi r24,lo8(0)
 9014 3478 90E0      		ldi r25,hi8(0)
 9015               	/* epilogue: frame size=0 */
 9016 347a 0895      		ret
 9017               	/* epilogue end (size=1) */
 9018               	/* function random_generate size 3 (2) */
 9020               	.Lscope60:
 9022               	.global	do_backoff
 9024               	do_backoff:
2358:mac.c         **** /*
2359:mac.c         **** uint8_t  wait_for_backoff_boundary(void)
2360:mac.c         **** {
2361:mac.c         **** 
2362:mac.c         **** 
2363:mac.c         ****        uint32_t  delta; 
2364:mac.c         **** 	   
2365:mac.c         ****     	do{
2366:mac.c         **** 	    MAC_CURRENT_TICKS=systime32();
2367:mac.c         **** 	    delta=(MAC_CURRENT_TICKS>MAC_OBJECT_CAP_START_TICKS)?(MAC_CURRENT_TICKS-MAC_OBJECT_CAP_START_T
2368:mac.c         **** 	    if(phy_channel_state!=DOINGCSMA_CA)
2369:mac.c         ****                  return 0;
2370:mac.c         **** 	}while(!(delta%(2*aUnitBackoffPeriod)));
2371:mac.c         **** 	return 1;	
2372:mac.c         **** 	
2373:mac.c         **** }
2374:mac.c         **** */
2375:mac.c         **** uint8_t  do_backoff(void)
2376:mac.c         **** {
 9026               	.LM920:
 9027               	/* prologue: frame size=0 */
 9028               	/* prologue end (size=0) */
2377:mac.c         ****       uint8_t  random_backoff;
2378:mac.c         ****       uint32_t   timing_symbol_value;	  
2379:mac.c         ****       random_backoff=random_generate();
 9030               	.LM921:
 9031 347c 0E94 0000 		call random_generate
 9032 3480 282F      		mov r18,r24
2380:mac.c         ****       if(random_backoff==0)
 9034               	.LM922:
 9035 3482 8823      		tst r24
 9036 3484 29F4      		brne .L547
2381:mac.c         ****             OS_post(CSMA_CA_DOING);
 9038               	.LM923:
 9039 3486 80E0      		ldi r24,lo8(pm(CSMA_CA_DOING))
 9040 3488 90E0      		ldi r25,hi8(pm(CSMA_CA_DOING))
 9041 348a 0E94 0000 		call OS_post
 9042 348e 0895      		ret
 9043               	.L547:
2382:mac.c         ****       else
2383:mac.c         ****       	{
2384:mac.c         ****             random_backoff=(random_backoff<<BE)-random_backoff;	  
 9045               	.LM924:
 9046 3490 9927      		clr r25
 9047 3492 0090 0000 		lds r0,BE
 9048 3496 02C0      		rjmp 2f
 9049 3498 880F      	1:	lsl r24
 9050 349a 991F      		rol r25
 9051 349c 0A94      	2:	dec r0
 9052 349e E2F7      		brpl 1b
 9053 34a0 821B      		sub r24,r18
 9054 34a2 282F      		mov r18,r24
2385:mac.c         ****             timing_symbol_value=random_backoff*aUnitBackoffPeriod; 	
 9056               	.LM925:
 9057 34a4 85E0      		ldi r24,lo8(5)
 9058 34a6 289F      		mul r18,r24
 9059 34a8 C001      		movw r24,r0
 9060 34aa 1124      		clr r1
 9061 34ac AA27      		clr r26
 9062 34ae 97FD      		sbrc r25,7
 9063 34b0 A095      		com r26
 9064 34b2 BA2F      		mov r27,r26
2386:mac.c         ****             head_of_systimer_queue=systimer_start_task(head_of_systimer_queue, CSMA_TIMING, timing_
 9066               	.LM926:
 9067 34b4 9C01      		movw r18,r24
 9068 34b6 AD01      		movw r20,r26
 9069 34b8 63E0      		ldi r22,lo8(3)
 9070 34ba 8091 0000 		lds r24,head_of_systimer_queue
 9071 34be 9091 0000 		lds r25,(head_of_systimer_queue)+1
 9072 34c2 0E94 0000 		call systimer_start_task
 9073 34c6 9093 0000 		sts (head_of_systimer_queue)+1,r25
 9074 34ca 8093 0000 		sts head_of_systimer_queue,r24
2387:mac.c         ****       	}		
2388:mac.c         **** }
 9076               	.LM927:
 9077 34ce 0895      		ret
 9078               	/* epilogue: frame size=0 */
 9079 34d0 0895      		ret
 9080               	/* epilogue end (size=1) */
 9081               	/* function do_backoff size 43 (42) */
 9087               	.Lscope61:
 9089               	.global	csma_initial
 9091               	csma_initial:
2389:mac.c         **** 
2390:mac.c         **** 
2391:mac.c         **** uint8_t  csma_initial(void)
2392:mac.c         **** {
 9093               	.LM928:
 9094               	/* prologue: frame size=0 */
 9095 34d2 EF92      		push r14
 9096 34d4 FF92      		push r15
 9097 34d6 0F93      		push r16
 9098 34d8 1F93      		push r17
 9099 34da CF93      		push r28
 9100 34dc DF93      		push r29
 9101               	/* prologue end (size=6) */
2393:mac.c         **** 
2394:mac.c         ****        uint32_t  wait_for_boundary_time;
2395:mac.c         **** 	uint32_t  delta_time;   
2396:mac.c         **** 	uint8_t    random_backoff;   
2397:mac.c         **** 	uint32_t   timing_symbol_value;
2398:mac.c         ****        
2399:mac.c         **** 	
2400:mac.c         **** 	//±äÁ¿µÄ³õÊ¼»¯
2401:mac.c         ****        NB=0;
 9103               	.LM929:
 9104 34de 1092 0000 		sts NB,__zero_reg__
2402:mac.c         **** 	CW=1;
 9106               	.LM930:
 9107 34e2 81E0      		ldi r24,lo8(1)
 9108 34e4 8093 0000 		sts CW,r24
2403:mac.c         **** 	if(mac_pib_data.macBattLifeExt==FALSE)
 9110               	.LM931:
 9111 34e8 8091 0000 		lds r24,mac_pib_data+3
 9112 34ec 9091 0000 		lds r25,mac_pib_data+27
 9113 34f0 8823      		tst r24
 9114 34f2 19F4      		brne .L550
2404:mac.c         **** 		BE=mac_pib_data.macMinBE;
 9116               	.LM932:
 9117 34f4 9093 0000 		sts BE,r25
 9118 34f8 06C0      		rjmp .L551
 9119               	.L550:
2405:mac.c         **** 	else
2406:mac.c         **** 		BE=(mac_pib_data.macMinBE>2)? 2:mac_pib_data.macMinBE;
 9121               	.LM933:
 9122 34fa 892F      		mov r24,r25
 9123 34fc 9330      		cpi r25,lo8(3)
 9124 34fe 08F0      		brlo .L552
 9125 3500 82E0      		ldi r24,lo8(2)
 9126               	.L552:
 9127 3502 8093 0000 		sts BE,r24
 9128               	.L551:
2407:mac.c         ****        phy_channel_state=DOINGCSMA_CA;
 9130               	.LM934:
 9131 3506 81E0      		ldi r24,lo8(1)
 9132 3508 8093 0000 		sts phy_channel_state,r24
2408:mac.c         **** 	//¼ÆËã¶¨Ê±Æ÷µÄ¶¨Ê±Öµ,²¢Æô¶¯¶¨Ê±
2409:mac.c         **** 	MAC_CURRENT_TICKS=systime32();
 9134               	.LM935:
 9135 350c 0E94 0000 		call systime32
 9136 3510 DC01      		movw r26,r24
 9137 3512 CB01      		movw r24,r22
 9138 3514 8093 0000 		sts MAC_CURRENT_TICKS,r24
 9139 3518 9093 0000 		sts (MAC_CURRENT_TICKS)+1,r25
 9140 351c A093 0000 		sts (MAC_CURRENT_TICKS)+2,r26
 9141 3520 B093 0000 		sts (MAC_CURRENT_TICKS)+3,r27
2410:mac.c         **** 
2411:mac.c         **** 	//¶¨Î»µ½backoffµÄ±ß½ç
2412:mac.c         ****        delta_time=(MAC_CURRENT_TICKS>MAC_OBJECT_CAP_START_TICKS)?(MAC_CURRENT_TICKS-MAC_OBJECT_CAP_
 9143               	.LM936:
 9144 3524 2091 0000 		lds r18,MAC_OBJECT_CAP_START_TICKS
 9145 3528 3091 0000 		lds r19,(MAC_OBJECT_CAP_START_TICKS)+1
 9146 352c 4091 0000 		lds r20,(MAC_OBJECT_CAP_START_TICKS)+2
 9147 3530 5091 0000 		lds r21,(MAC_OBJECT_CAP_START_TICKS)+3
 9148 3534 FD01      		movw r30,r26
 9149 3536 EC01      		movw r28,r24
 9150 3538 C21B      		sub r28,r18
 9151 353a D30B      		sbc r29,r19
 9152 353c E40B      		sbc r30,r20
 9153 353e F50B      		sbc r31,r21
 9154 3540 2817      		cp r18,r24
 9155 3542 3907      		cpc r19,r25
 9156 3544 4A07      		cpc r20,r26
 9157 3546 5B07      		cpc r21,r27
 9158 3548 20F0      		brlo .L553
 9159 354a C050      		subi r28,lo8(-(1073741824))
 9160 354c D040      		sbci r29,hi8(-(1073741824))
 9161 354e E040      		sbci r30,hlo8(-(1073741824))
 9162 3550 F04C      		sbci r31,hhi8(-(1073741824))
 9163               	.L553:
2413:mac.c         **** 
2414:mac.c         **** 	//×ª»¯³ÉÊµ¼ÊµÄ·ûºÅÊýÄ¿  
2415:mac.c         **** 	delta_time=delta_time>>1;
 9165               	.LM937:
 9166 3552 F695      		lsr r31
 9167 3554 E795      		ror r30
 9168 3556 D795      		ror r29
 9169 3558 C795      		ror r28
2416:mac.c         **** 	wait_for_boundary_time=aUnitBackoffPeriod-(delta_time%aUnitBackoffPeriod);
 9171               	.LM938:
 9172 355a A5E0      		ldi r26,lo8(5)
 9173 355c EA2E      		mov r14,r26
 9174 355e F12C      		mov r15,__zero_reg__
 9175 3560 012D      		mov r16,__zero_reg__
 9176 3562 112D      		mov r17,__zero_reg__
 9177 3564 BE01      		movw r22,r28
 9178 3566 CF01      		movw r24,r30
 9179 3568 A801      		movw r20,r16
 9180 356a 9701      		movw r18,r14
 9181 356c 0E94 0000 		call __udivmodsi4
 9182 3570 DC01      		movw r26,r24
 9183 3572 CB01      		movw r24,r22
 9184 3574 E81A      		sub r14,r24
 9185 3576 F90A      		sbc r15,r25
 9186 3578 0A0B      		sbc r16,r26
 9187 357a 1B0B      		sbc r17,r27
2417:mac.c         **** 	random_backoff=random_generate();
 9189               	.LM939:
 9190 357c 0E94 0000 		call random_generate
 9191 3580 282F      		mov r18,r24
2418:mac.c         **** 	random_backoff=(random_backoff<<BE)-random_backoff;
 9193               	.LM940:
 9194 3582 9927      		clr r25
 9195 3584 0090 0000 		lds r0,BE
 9196 3588 02C0      		rjmp 2f
 9197 358a 880F      	1:	lsl r24
 9198 358c 991F      		rol r25
 9199 358e 0A94      	2:	dec r0
 9200 3590 E2F7      		brpl 1b
 9201 3592 982F      		mov r25,r24
 9202 3594 921B      		sub r25,r18
2419:mac.c         **** 	timing_symbol_value=wait_for_boundary_time+random_backoff*aUnitBackoffPeriod;
 9204               	.LM941:
 9205 3596 85E0      		ldi r24,lo8(5)
 9206 3598 989F      		mul r25,r24
 9207 359a C001      		movw r24,r0
 9208 359c 1124      		clr r1
 9209 359e AA27      		clr r26
 9210 35a0 97FD      		sbrc r25,7
 9211 35a2 A095      		com r26
 9212 35a4 BA2F      		mov r27,r26
 9213 35a6 E80E      		add r14,r24
 9214 35a8 F91E      		adc r15,r25
 9215 35aa 0A1F      		adc r16,r26
 9216 35ac 1B1F      		adc r17,r27
2420:mac.c         **** 	head_of_systimer_queue=systimer_start_task(head_of_systimer_queue, CSMA_TIMING, timing_symbol_valu
 9218               	.LM942:
 9219 35ae A801      		movw r20,r16
 9220 35b0 9701      		movw r18,r14
 9221 35b2 63E0      		ldi r22,lo8(3)
 9222 35b4 8091 0000 		lds r24,head_of_systimer_queue
 9223 35b8 9091 0000 		lds r25,(head_of_systimer_queue)+1
 9224 35bc 0E94 0000 		call systimer_start_task
 9225 35c0 9093 0000 		sts (head_of_systimer_queue)+1,r25
 9226 35c4 8093 0000 		sts head_of_systimer_queue,r24
 9227               	/* epilogue: frame size=0 */
 9228 35c8 DF91      		pop r29
 9229 35ca CF91      		pop r28
 9230 35cc 1F91      		pop r17
 9231 35ce 0F91      		pop r16
 9232 35d0 FF90      		pop r15
 9233 35d2 EF90      		pop r14
 9234 35d4 0895      		ret
 9235               	/* epilogue end (size=7) */
 9236               	/* function csma_initial size 130 (117) */
 9243               	.Lscope62:
 9245               	.global	failure_to_tx_with_csma
 9247               	failure_to_tx_with_csma:
2421:mac.c         ****        
2422:mac.c         **** 	//printf("\n----csma timing  start--time is %08lx---\n",systime32());
2423:mac.c         **** }
2424:mac.c         **** //bool  a;
2425:mac.c         **** void CSMA_CA_DOING(void)
2426:mac.c         **** {
2427:mac.c         ****         uint8_t  return_status;
2428:mac.c         **** 	 uint8_t  cca_result;
2429:mac.c         **** 	 uint32_t random_backoff;
2430:mac.c         **** 	 uint32_t  csma_ca_send_timestamp;
2431:mac.c         **** 	 uint32_t   now_time_ticks;
2432:mac.c         **** 	 uint16_t   timinglength;  
2433:mac.c         ****         switch(csma_state)
2434:mac.c         ****         	{
2435:mac.c         **** 		    case  csma_state_initial:
2436:mac.c         **** 				return_status=csma_initial();
2437:mac.c         **** 				//printf("\ncsma is init\n");
2438:mac.c         **** 				csma_state=csma_state_delaying;
2439:mac.c         **** 				break;
2440:mac.c         **** 		    case  csma_state_delaying:
2441:mac.c         **** 				cca_result=PLME_CCA_request();
2442:mac.c         **** 				Leds_redToggle();
2443:mac.c         **** 				if((phy_channel_state!=DOINGCSMA_CA))
2444:mac.c         **** 					{
2445:mac.c         **** 					   //free(temp_csma_ca_frame);
2446:mac.c         **** 					   failure_to_tx_with_csma();
2447:mac.c         **** 					   return;
2448:mac.c         **** 					}  
2449:mac.c         **** 				if((cca_result==IDLE)&&(CW!=0))
2450:mac.c         **** 					{
2451:mac.c         **** 					    csma_state=csma_state_delaying;
2452:mac.c         **** 					    head_of_systimer_queue=systimer_start_task(head_of_systimer_queue, CSMA_TIMING, aUnitBacko
2453:mac.c         **** 					    CW--;	
2454:mac.c         **** 					}
2455:mac.c         **** 				else if((cca_result==IDLE)&&(CW==0))
2456:mac.c         **** 					{
2457:mac.c         **** 					    //³É¹¦·¢ËÍ
2458:mac.c         **** 					    //printf("\nthe frame length is %d\n",temp_csma_ca_frame->frameLength);
2459:mac.c         **** 					    csma_ca_send_timestamp=PD_DATA_request(temp_csma_ca_frame->frameLength, temp_csma_ca_frame
2460:mac.c         **** 					    phy_channel_state=PHY_IDLE;
2461:mac.c         **** 					    Leds_redToggle();
2462:mac.c         **** 				           if(temp_csma_ca_frame->IsNeedAcked)	
2463:mac.c         **** 				           	{
2464:mac.c         **** 				           	      phy_channel_state=WAITING_FOR_ACK;
2465:mac.c         **** 						      PLME_SET_TRX_STATE_request(RX_ON);
2466:mac.c         **** 						      //wait_for_ack_timing 	  
2467:mac.c         **** 						      //printf("\nthe frame is need ack\n");
2468:mac.c         **** 						      now_time_ticks=systime32();
2469:mac.c         **** 						      timinglength=(uint16_t)((now_time_ticks>=csma_ca_send_timestamp)?(now_time_ticks-csma_c
2470:mac.c         **** 							  
2471:mac.c         **** 						      head_of_timer_queue=timer3queue_start(head_of_timer_queue, TIMER_ONE_SHOT, temp_csma_ca
2472:mac.c         ****                                                 //printf("\n---send at  %08lx---send time is %d---\
2473:mac.c         **** 						      //printf("\ntimer header ->framedsn is %d---\n",head_of_timer_queue->framedsn);
2474:mac.c         **** 						      //printf("\nthe csma tx frame's dsn is %d\n",temp_csma_ca_frame->FrameSeq);
2475:mac.c         **** 						     //printf("\nthis frame need acked, the phychannel is %d\n",phy_channel_state);
2476:mac.c         **** 				           	}
2477:mac.c         **** 						   //printf("\nthe csma transimitted frame is payload length is: %d",temp_csma_ca_frame->fram
2478:mac.c         ****                                        //for(uint8_t i=0;i<temp_csma_ca_frame->frameLength;i++)
2479:mac.c         ****                                        //	{
2480:mac.c         **** 					    //	 //printf("\nthe csma transimitted frame is payload[%d]: %02x",i,temp_csma_ca_frame->pa
2481:mac.c         ****                                        //	}			   
2482:mac.c         **** 					    //remove_tx_queue(temp_csma_ca_frame->FrameSeq);
2483:mac.c         **** 						//if()	
2484:mac.c         **** 						 //printf("\ncsma transmitted success\n");	
2485:mac.c         **** 					}
2486:mac.c         **** 				else
2487:mac.c         **** 					{
2488:mac.c         **** 					    CW=1;
2489:mac.c         **** 					    NB++;
2490:mac.c         **** 					    BE++;	
2491:mac.c         **** 					    BE=(BE>aMaxBE)? aMaxBE:BE;
2492:mac.c         **** 					    if(NB>(mac_pib_data.macMaxCsmaBackoffs))
2493:mac.c         **** 					    	{
2494:mac.c         **** 					    	      //·¢ËÍÊ§°Ü,Ïò¸ß²ãÍ¨Öª
2495:mac.c         **** 					    	      failure_to_tx_with_csma();
2496:mac.c         **** 					    	}
2497:mac.c         **** 					    else
2498:mac.c         **** 					    	{
2499:mac.c         **** 					    	      csma_state=csma_state_delaying;
2500:mac.c         **** 					    	      do_backoff();
2501:mac.c         **** 					    	}
2502:mac.c         **** 					}
2503:mac.c         **** 				break;
2504:mac.c         **** 		    default :
2505:mac.c         **** 				break;
2506:mac.c         ****         	}
2507:mac.c         **** }
2508:mac.c         **** 
2509:mac.c         **** void  failure_to_tx_with_csma(void)
2510:mac.c         **** {
 9249               	.LM943:
 9250               	/* prologue: frame size=0 */
 9251               	/* prologue end (size=0) */
2511:mac.c         **** 
2512:mac.c         ****       //¸ù¾ÝÖ¡ÀàÐÍÏò¸ß²ãÍ¨Öª
2513:mac.c         ****       //------------------------------
2514:mac.c         ****       //------------------------------
2515:mac.c         ****       //-----´úÂëÌí¼Ó------------
2516:mac.c         ****       remove_tx_queue(temp_csma_ca_frame->FrameSeq);
 9253               	.LM944:
 9254 35d6 E091 0000 		lds r30,temp_csma_ca_frame
 9255 35da F091 0000 		lds r31,(temp_csma_ca_frame)+1
 9256 35de 8381      		ldd r24,Z+3
 9257 35e0 0E94 0000 		call remove_tx_queue
 9258               	/* epilogue: frame size=0 */
 9259 35e4 0895      		ret
 9260               	/* epilogue end (size=1) */
 9261               	/* function failure_to_tx_with_csma size 8 (7) */
 9263               	.Lscope63:
 9265               	.global	CSMA_CA_DOING
 9267               	CSMA_CA_DOING:
 9269               	.LM945:
 9270               	/* prologue: frame size=0 */
 9271 35e6 DF92      		push r13
 9272 35e8 EF92      		push r14
 9273 35ea FF92      		push r15
 9274 35ec 0F93      		push r16
 9275 35ee 1F93      		push r17
 9276 35f0 CF93      		push r28
 9277               	/* prologue end (size=6) */
 9279               	.LM946:
 9280 35f2 8091 0000 		lds r24,csma_state
 9281 35f6 9927      		clr r25
 9282 35f8 0097      		sbiw r24,0
 9283 35fa 19F0      		breq .L557
 9285               	.LM947:
 9286 35fc 0197      		sbiw r24,1
 9287 35fe 39F0      		breq .L558
 9288 3600 88C0      		rjmp .L555
 9289               	.L557:
 9291               	.LM948:
 9292 3602 0E94 0000 		call csma_initial
 9294               	.LM949:
 9295 3606 81E0      		ldi r24,lo8(1)
 9296 3608 8093 0000 		sts csma_state,r24
 9298               	.LM950:
 9299 360c 82C0      		rjmp .L555
 9300               	.L558:
 9302               	.LM951:
 9303 360e 0E94 0000 		call PLME_CCA_request
 9304 3612 182F      		mov r17,r24
 9306               	.LM952:
 9307 3614 0E94 0000 		call Leds_redToggle
 9309               	.LM953:
 9310 3618 D090 0000 		lds r13,phy_channel_state
 9311 361c 81E0      		ldi r24,lo8(1)
 9312 361e D816      		cp r13,r24
 9313 3620 09F0      		breq .+2
 9314 3622 70C0      		rjmp .L571
 9316               	.LM954:
 9317 3624 1430      		cpi r17,lo8(4)
 9318 3626 09F0      		breq .+2
 9319 3628 57C0      		rjmp .L562
 9320 362a C091 0000 		lds r28,CW
 9321 362e CC23      		tst r28
 9322 3630 B9F0      		breq .L570
 9324               	.LM955:
 9325 3632 D092 0000 		sts csma_state,r13
 9327               	.LM956:
 9328 3636 25E0      		ldi r18,lo8(5)
 9329 3638 30E0      		ldi r19,hi8(5)
 9330 363a 40E0      		ldi r20,hlo8(5)
 9331 363c 50E0      		ldi r21,hhi8(5)
 9332 363e 63E0      		ldi r22,lo8(3)
 9333 3640 8091 0000 		lds r24,head_of_systimer_queue
 9334 3644 9091 0000 		lds r25,(head_of_systimer_queue)+1
 9335 3648 0E94 0000 		call systimer_start_task
 9336 364c 9093 0000 		sts (head_of_systimer_queue)+1,r25
 9337 3650 8093 0000 		sts head_of_systimer_queue,r24
 9339               	.LM957:
 9340 3654 8091 0000 		lds r24,CW
 9341 3658 8150      		subi r24,lo8(-(-1))
 9342 365a 8093 0000 		sts CW,r24
 9343 365e 59C0      		rjmp .L555
 9344               	.L570:
 9346               	.LM958:
 9347 3660 E091 0000 		lds r30,temp_csma_ca_frame
 9348 3664 F091 0000 		lds r31,(temp_csma_ca_frame)+1
 9349 3668 6781      		ldd r22,Z+7
 9350 366a 7085      		ldd r23,Z+8
 9351 366c 8581      		ldd r24,Z+5
 9352 366e 0E94 0000 		call PD_DATA_request
 9353 3672 7B01      		movw r14,r22
 9354 3674 8C01      		movw r16,r24
 9356               	.LM959:
 9357 3676 C093 0000 		sts phy_channel_state,r28
 9359               	.LM960:
 9360 367a 0E94 0000 		call Leds_redToggle
 9362               	.LM961:
 9363 367e E091 0000 		lds r30,temp_csma_ca_frame
 9364 3682 F091 0000 		lds r31,(temp_csma_ca_frame)+1
 9365 3686 8081      		ld r24,Z
 9366 3688 8823      		tst r24
 9367 368a 09F4      		brne .+2
 9368 368c 42C0      		rjmp .L555
 9370               	.LM962:
 9371 368e 83E0      		ldi r24,lo8(3)
 9372 3690 8093 0000 		sts phy_channel_state,r24
 9374               	.LM963:
 9375 3694 86E0      		ldi r24,lo8(6)
 9376 3696 0E94 0000 		call PLME_SET_TRX_STATE_request
 9378               	.LM964:
 9379 369a 0E94 0000 		call systime32
 9380 369e DC01      		movw r26,r24
 9381 36a0 CB01      		movw r24,r22
 9383               	.LM965:
 9384 36a2 9C01      		movw r18,r24
 9385 36a4 2E19      		sub r18,r14
 9386 36a6 3F09      		sbc r19,r15
 9388               	.LM966:
 9389 36a8 8091 0000 		lds r24,mac_pib_data
 9390 36ac 9927      		clr r25
 9391 36ae 821B      		sub r24,r18
 9392 36b0 930B      		sbc r25,r19
 9393 36b2 E091 0000 		lds r30,temp_csma_ca_frame
 9394 36b6 F091 0000 		lds r31,(temp_csma_ca_frame)+1
 9395 36ba 8C01      		movw r16,r24
 9396 36bc 2C2F      		mov r18,r28
 9397 36be 4381      		ldd r20,Z+3
 9398 36c0 6D2D      		mov r22,r13
 9399 36c2 8091 0000 		lds r24,head_of_timer_queue
 9400 36c6 9091 0000 		lds r25,(head_of_timer_queue)+1
 9401 36ca 0E94 0000 		call timer3queue_start
 9402 36ce 9093 0000 		sts (head_of_timer_queue)+1,r25
 9403 36d2 8093 0000 		sts head_of_timer_queue,r24
 9404 36d6 1DC0      		rjmp .L555
 9405               	.L562:
 9407               	.LM967:
 9408 36d8 21E0      		ldi r18,lo8(1)
 9409 36da 2093 0000 		sts CW,r18
 9411               	.LM968:
 9412 36de 9091 0000 		lds r25,NB
 9413 36e2 920F      		add r25,r18
 9414 36e4 9093 0000 		sts NB,r25
 9416               	.LM969:
 9417 36e8 8091 0000 		lds r24,BE
 9418 36ec 820F      		add r24,r18
 9419 36ee 8093 0000 		sts BE,r24
 9421               	.LM970:
 9422 36f2 8630      		cpi r24,lo8(6)
 9423 36f4 08F0      		brlo .L565
 9424 36f6 85E0      		ldi r24,lo8(5)
 9425               	.L565:
 9426 36f8 8093 0000 		sts BE,r24
 9428               	.LM971:
 9429 36fc 8091 0000 		lds r24,mac_pib_data+26
 9430 3700 8917      		cp r24,r25
 9431 3702 18F4      		brsh .L566
 9432               	.L571:
 9434               	.LM972:
 9435 3704 0E94 0000 		call failure_to_tx_with_csma
 9436 3708 04C0      		rjmp .L555
 9437               	.L566:
 9439               	.LM973:
 9440 370a 2093 0000 		sts csma_state,r18
 9442               	.LM974:
 9443 370e 0E94 0000 		call do_backoff
 9444               	.L555:
 9445               	/* epilogue: frame size=0 */
 9446 3712 CF91      		pop r28
 9447 3714 1F91      		pop r17
 9448 3716 0F91      		pop r16
 9449 3718 FF90      		pop r15
 9450 371a EF90      		pop r14
 9451 371c DF90      		pop r13
 9452 371e 0895      		ret
 9453               	/* epilogue end (size=7) */
 9454               	/* function CSMA_CA_DOING size 158 (145) */
 9462               	.Lscope64:
 9463               		.data
 9464               	.LC21:
 9465 037d 0A65 7272 		.string	"\nerror:there is no frame in the tx buffer\n"
 9465      6F72 3A74 
 9465      6865 7265 
 9465      2069 7320 
 9465      6E6F 2066 
 9466               		.text
 9468               	.global	transmit_with_csmaca
 9470               	transmit_with_csmaca:
2517:mac.c         ****     //printf("\n---csma failure----\n");	  
2518:mac.c         ****       //free(temp_csma_ca_frame);
2519:mac.c         **** }
2520:mac.c         **** 
2521:mac.c         **** /*
2522:mac.c         **** //slotted CSMA-CA algorithm
2523:mac.c         **** void CSMA_CA_DOING(void)
2524:mac.c         **** {
2525:mac.c         ****        TX_BUFFER * temp;
2526:mac.c         **** 
2527:mac.c         **** 	uint8_t BE;
2528:mac.c         ****        uint8_t NB;
2529:mac.c         **** 	uint8_t CW;   
2530:mac.c         **** 
2531:mac.c         **** 	uint8_t    random_backoff;   
2532:mac.c         **** 	uint8_t  status; 
2533:mac.c         **** 	uint32_t  object_backoff;
2534:mac.c         **** 	uint8_t    cca_result;
2535:mac.c         **** 	uint32_t  csma_ca_send_timestamp;
2536:mac.c         **** 	//uint32_t   start_backoff_time;
2537:mac.c         ****        //Ê×ÏÈ´Ó·¢ËÍ¶ÔÁÐÖÐÈ¡µÃ´ý·¢ËÍµÄÊý¾Ý
2538:mac.c         ****        temp=Parameter_list.parameter_tx_task[Parameter_list.top];
2539:mac.c         **** 	Parameter_list.top=(Parameter_list.top+1)%MAX_TX_BUFFER_SIZE;
2540:mac.c         **** 	if(temp==NULL)
2541:mac.c         **** 	{
2542:mac.c         **** 	     error("\nerror:there is no frame in the tx buffer\n");
2543:mac.c         **** 	     return;
2544:mac.c         **** 	}
2545:mac.c         **** 	
2546:mac.c         **** 	//±äÁ¿µÄ³õÊ¼»¯
2547:mac.c         ****        NB=0;
2548:mac.c         **** 	CW=2;
2549:mac.c         **** 	if(mac_pib_data.macBattLifeExt==FALSE)
2550:mac.c         **** 		BE=mac_pib_data.macMinBE;
2551:mac.c         **** 	else
2552:mac.c         **** 		BE=(mac_pib_data.macMinBE>2)? 2:mac_pib_data.macMinBE;
2553:mac.c         ****        phy_channel_state=DOINGCSMA_CA;
2554:mac.c         **** 	//mac_current_state=MAC_STATE
2555:mac.c         **** 	//¶¨Î»µ½backoffµÄ±ß½ç
2556:mac.c         ****       	status=wait_for_backoff_boundary();
2557:mac.c         ****        if(status==0)
2558:mac.c         **** 	   	return;
2559:mac.c         ****                 
2560:mac.c         **** 	//µ±Ç°ÒÑ¾­ÊÇunit boundary
2561:mac.c         ****        
2562:mac.c         ****        do{
2563:mac.c         **** 
2564:mac.c         **** 	    random_backoff=random_generate();
2565:mac.c         **** 	    random_backoff=(random_backoff<<BE)-random_backoff;
2566:mac.c         **** 	    MAC_CURRENT_TICKS=systime32();
2567:mac.c         **** 	    object_backoff=(uint32_t)(random_backoff*aUnitBackoffPeriod*2)+MAC_CURRENT_TICKS;
2568:mac.c         **** 	    if(object_backoff>=0x40000000)
2569:mac.c         **** 			object_backoff=object_backoff-0x40000000;
2570:mac.c         **** 	    //×÷»ØÍË			
2571:mac.c         **** 	    while(MAC_CURRENT_TICKS!=object_backoff)
2572:mac.c         **** 			{
2573:mac.c         **** 			     MAC_CURRENT_TICKS=systime32();
2574:mac.c         **** 			     if((phy_channel_state!=DOINGCSMA_CA))
2575:mac.c         ****                               return;	
2576:mac.c         **** 			     //ÓÐ¿ÉÄÜÖÐ¶ÏÊ¹µÃMAC_CURRENT_TICKSÓëobject_backoff´í¹ý±È½ÏÏàµÈµÄÊ±»ú.	 
2577:mac.c         **** 			     //ÐèÒªÌí¼Ó´úÂë
2578:mac.c         **** 			}
2579:mac.c         **** 	    //perform  CCA
2580:mac.c         **** 	    do{
2581:mac.c         **** 	         status=wait_for_backoff_boundary();
2582:mac.c         **** 	         if(status==0)
2583:mac.c         **** 			 	return;
2584:mac.c         **** 	         cca_result=PLME_CCA_request();
2585:mac.c         **** 		  if(cca_result!=IDLE)
2586:mac.c         **** 		  	break;
2587:mac.c         **** 	    }while((CW--));
2588:mac.c         **** 	    //cama³É¹¦,·¢ËÍ	
2589:mac.c         **** 	    if(cca_result==IDLE)
2590:mac.c         **** 	    	{
2591:mac.c         **** 		   csma_ca_send_timestamp=PD_DATA_request(temp->frameLength, temp->payload);
2592:mac.c         **** 		   
2593:mac.c         **** 		   return;
2594:mac.c         **** 	    	}  
2595:mac.c         **** 	    else
2596:mac.c         **** 	    	{
2597:mac.c         **** 	    	   CW=2;
2598:mac.c         **** 		   NB=NB+1;	   
2599:mac.c         **** 	    	}
2600:mac.c         **** 		
2601:mac.c         ****       	}
2602:mac.c         **** 	while(NB<(mac_pib_data.macMaxCsmaBackoffs));
2603:mac.c         ****   
2604:mac.c         **** }
2605:mac.c         **** */
2606:mac.c         **** void transmit_with_csmaca(void)
2607:mac.c         **** {
 9472               	.LM975:
 9473               	/* prologue: frame size=0 */
 9474               	/* prologue end (size=0) */
2608:mac.c         ****        csma_state=csma_state_initial;
 9476               	.LM976:
 9477 3720 1092 0000 		sts csma_state,__zero_reg__
2609:mac.c         **** 
2610:mac.c         **** 	temp_csma_ca_frame=Parameter_list.parameter_tx_task[Parameter_list.top];
 9479               	.LM977:
 9480 3724 8091 0000 		lds r24,Parameter_list+10
 9481 3728 9927      		clr r25
 9482 372a FC01      		movw r30,r24
 9483 372c E80F      		add r30,r24
 9484 372e F91F      		adc r31,r25
 9485 3730 E050      		subi r30,lo8(-(Parameter_list))
 9486 3732 F040      		sbci r31,hi8(-(Parameter_list))
 9487 3734 2081      		ld r18,Z
 9488 3736 3181      		ldd r19,Z+1
 9489 3738 3093 0000 		sts (temp_csma_ca_frame)+1,r19
 9490 373c 2093 0000 		sts temp_csma_ca_frame,r18
2611:mac.c         **** 	Parameter_list.top=(Parameter_list.top+1)%MAX_TX_BUFFER_SIZE;
 9492               	.LM978:
 9493 3740 0196      		adiw r24,1
 9494 3742 65E0      		ldi r22,lo8(5)
 9495 3744 70E0      		ldi r23,hi8(5)
 9496 3746 0E94 0000 		call __divmodhi4
 9497 374a 8093 0000 		sts Parameter_list+10,r24
2612:mac.c         **** 	if(temp_csma_ca_frame==NULL)
 9499               	.LM979:
 9500 374e 232B      		or r18,r19
 9501 3750 29F4      		brne .L573
2613:mac.c         **** 	{
2614:mac.c         **** 	     error("\nerror:there is no frame in the tx buffer\n");
 9503               	.LM980:
 9504 3752 80E0      		ldi r24,lo8(.LC21)
 9505 3754 90E0      		ldi r25,hi8(.LC21)
 9506 3756 0E94 0000 		call error
2615:mac.c         **** 	     return;
 9508               	.LM981:
 9509 375a 0895      		ret
 9510               	.L573:
2616:mac.c         **** 	}   
2617:mac.c         **** 	if(phy_channel_state==PHY_IDLE)
 9512               	.LM982:
 9513 375c 8091 0000 		lds r24,phy_channel_state
 9514 3760 8823      		tst r24
 9515 3762 31F4      		brne .L574
2618:mac.c         **** 		{
2619:mac.c         **** 		   PLME_SET_TRX_STATE_request(RX_ON);
 9517               	.LM983:
 9518 3764 86E0      		ldi r24,lo8(6)
 9519 3766 0E94 0000 		call PLME_SET_TRX_STATE_request
2620:mac.c         **** 		   //printf("\n^^^^^^^^^^\n"); 
2621:mac.c         ****                  CSMA_CA_DOING();
 9521               	.LM984:
 9522 376a 0E94 0000 		call CSMA_CA_DOING
 9523 376e 0895      		ret
 9524               	.L574:
2622:mac.c         ****                  //printf("\n^^^^^^^^^^\n");
2623:mac.c         **** 		}
2624:mac.c         **** 	else
2625:mac.c         **** 		failure_to_tx_with_csma();
 9526               	.LM985:
 9527 3770 0E94 0000 		call failure_to_tx_with_csma
 9528 3774 0895      		ret
 9529               	/* epilogue: frame size=0 */
 9530 3776 0895      		ret
 9531               	/* epilogue end (size=1) */
 9532               	/* function transmit_with_csmaca size 44 (43) */
 9534               	.Lscope65:
 9535               		.comm OS_queue,16,1
 9536               		.comm OS_sched_full,1,1
 9537               		.comm OS_sched_free,1,1
 9538               		.comm currentTime,2,1
 9539               		.comm head_of_systimer_queue,2,1
 9540               		.comm timestamp_H,2,1
 9541               		.comm mState,4,1
 9542               		.comm setIntervalFlag,1,1
 9543               		.comm mScale,1,1
 9544               		.comm mInterval,1,1
 9545               		.comm queue_head,1,1
 9546               		.comm queue_tail,1,1
 9547               		.comm queue_size,1,1
 9548               		.comm queue,3,1
 9549               		.comm mTimerList,33,1
 9550               		.comm backoff_timer_Set,1,1
 9551               		.comm backoff_call,2,1
 9552               		.comm SENSOR_DATA_VALUE,20,1
 9553               		.comm ADC_INTERRUPT_FLAG,1,1
 9554               		.comm cc2420_bramspi,1,1
 9555               		.comm cc2420_rambuf,2,1
 9556               		.comm cc2420_ramlen,1,1
 9557               		.comm cc2420_ramaddr,2,1
 9558               		.comm cc2420fifo_bspi,1,1
 9559               		.comm cc2420fifo_txbuf,2,1
 9560               		.comm cc2420fifo_txlength,1,1
 9561               		.comm cc2420_rxbuf,4,1
 9562               		.comm cc2420_rxlength,1,1
 9563               		.comm cc2420_rxbuf_now,2,1
 9564               		.comm cc2420_rxlength_now,1,1
 9565               		.comm cc2420_rxbufuse,1,1
 9566               		.comm rfpackernum,1,1
 9567               		.comm cc2420_rxflag,1,1
 9568               		.comm cc2420_currentparameters,28,1
 9569               		.comm receive_timestamp,4,1
 9570               		.comm send_timestamp,4,1
 9571               		.comm cc2420_stateRadio,1,1
 9572               		.comm cc2420_LocalAddr,2,1
 9573               		.comm ieee_address,8,1
 9574               		.comm rxbuf_flag,1,1
 9575               		.comm ppib,3,1
 9576               		.comm MAC_OBJECT_CAP_START_TICKS,4,1
 9577               		.comm MAC_OBJECT_CAP_END_TICKS,4,1
 9578               		.comm head_of_timer_queue,2,1
 9579               		.comm GTSDirectionMask,1,1
 9580               		.comm phy_channel_state,1,1
 9581               		.comm mac_pib_data,45,1
 9582               		.comm scan_channel_index,1,1
 9583               		.comm scan_channel,4,1
 9584               		.comm scan_time_period,2,1
 9585               		.comm mac_working_state,1,1
 9586               		.comm mac_tx_current_frame,181,1
 9587               		.comm mac_rx_current_frame,181,1
 9588               		.comm mac_tx_beacon,78,1
 9589               		.comm mac_current_state,1,1
 9590               		.comm mac_current_state_saved,1,1
 9591               		.comm Is_mac_associated_successful,1,1
 9592               		.comm current_timer_elem,2,1
 9593               		.comm head_of_tx_buffer,2,1
 9594               		.comm tail_of_tx_buffer,2,1
 9595               		.comm Parameter_list,12,1
 9596               		.comm head_of_rx_buffer,2,1
 9597               		.comm tail_of_rx_buffer,2,1
 9598               		.comm head_of_indirect_pending_buffer,2,1
 9599               		.comm tail_of_indirect_pending_buffer,2,1
 9600               		.comm current_pending_num,1,1
 9601               		.comm TRACKBEACON,1,1
 9602               		.comm IS_MAC_SYNING,1,1
 9603               		.comm scan_result_info,132,1
 9604               		.comm mcps_data_indication_info,132,1
 9605               		.comm beacon_info,102,1
 9606               		.comm mlme_associate_indication_info,11,1
 9607               		.comm default_short_addr,2,1
 9608               		.comm no_short_addr,2,1
 9609               		.comm default_long_addr,8,1
 9610               		.comm default_node,13,1
 9611               		.comm MAC_SUPERFRAME_PERIOD,4,1
 9612               		.comm last_beacon_tx_timestamp,4,1
 9613               		.comm last_beacon_rx_timestamp,4,1
 9614               		.comm MAC_CAP_PERIOD,4,1
 9615               		.comm MAC_OBJECT_SUPERFRAME_TICKS,4,1
 9616               		.comm MAC_CURRENT_TICKS,4,1
 9617               		.comm Is_received_beacon,1,1
 9618               		.comm loss_sync_number,1,1
 9619               		.comm IS_NETWORK_FORMED,1,1
 9620               		.comm csma_state,1,1
 9621               		.comm temp_csma_ca_frame,2,1
 9622               		.comm BE,1,1
 9623               		.comm NB,1,1
 9624               		.comm CW,1,1
 9715               		.text
 9717               	Letext:
 9718               	/* File "mac.c": code 7134 = 0x1bde (6188), prologues 463, epilogues 483 */
DEFINED SYMBOLS
                            *ABS*:00000000 mac.c
                            *ABS*:0000003f __SREG__
                            *ABS*:0000003e __SP_H__
                            *ABS*:0000003d __SP_L__
                            *ABS*:00000000 __tmp_reg__
                            *ABS*:00000001 __zero_reg__
C:\Users\sunhejie\AppData\Local\Temp/ccOsbaaa.s:221    .text:00000000 MAC_init
                            *COM*:00000002 head_of_timer_queue
                            *COM*:00000001 mac_current_state
                            *COM*:00000001 phy_channel_state
                            *COM*:00000002 head_of_tx_buffer
                            *COM*:00000002 tail_of_tx_buffer
                            *COM*:0000000c Parameter_list
                            *COM*:00000002 head_of_rx_buffer
                            *COM*:00000002 tail_of_rx_buffer
                            *COM*:00000002 head_of_indirect_pending_buffer
                            *COM*:00000002 tail_of_indirect_pending_buffer
                            *COM*:00000001 current_pending_num
                            *COM*:00000001 IS_MAC_SYNING
                            *COM*:00000002 default_short_addr
                            *COM*:00000008 default_long_addr
                            *COM*:00000002 no_short_addr
                            *COM*:0000000d default_node
                            *COM*:00000002 head_of_systimer_queue
                            *COM*:0000002d mac_pib_data
                            *COM*:00000084 scan_result_info
                            *COM*:00000001 loss_sync_number
C:\Users\sunhejie\AppData\Local\Temp/ccOsbaaa.s:342    .text:000000cc mlmeResetRequest
                            *COM*:00000001 IS_NETWORK_FORMED
C:\Users\sunhejie\AppData\Local\Temp/ccOsbaaa.s:565    .text:0000021a mlmeSetRequest
C:\Users\sunhejie\AppData\Local\Temp/ccOsbaaa.s:580    .text:0000021c mlmeScanConfirm
                            *COM*:00000003 ppib
C:\Users\sunhejie\AppData\Local\Temp/ccOsbaaa.s:689    .text:000002ba mlmeStartConfirm
C:\Users\sunhejie\AppData\Local\Temp/ccOsbaaa.s:711    .text:000002bc mlmeAssociateConfirm
C:\Users\sunhejie\AppData\Local\Temp/ccOsbaaa.s:795    .text:00000316 mlmeDisassociateIndication
C:\Users\sunhejie\AppData\Local\Temp/ccOsbaaa.s:845    .text:00000354 mlmeDisassociateConfirm
C:\Users\sunhejie\AppData\Local\Temp/ccOsbaaa.s:876    .text:00000364 mlmeCommStatusIndication
C:\Users\sunhejie\AppData\Local\Temp/ccOsbaaa.s:893    .text:00000366 mlmeRxEnableRequest
C:\Users\sunhejie\AppData\Local\Temp/ccOsbaaa.s:908    .text:00000368 mlmeRxEnableConfirm
C:\Users\sunhejie\AppData\Local\Temp/ccOsbaaa.s:924    .text:0000036a mlmeSyncRequest
                            *COM*:00000004 MAC_SUPERFRAME_PERIOD
                            *COM*:00000004 MAC_CAP_PERIOD
                            *COM*:00000001 Is_received_beacon
C:\Users\sunhejie\AppData\Local\Temp/ccOsbaaa.s:1022   .text:0000041a synrequest_task
C:\Users\sunhejie\AppData\Local\Temp/ccOsbaaa.s:1041   .text:00000426 mlmesyn_finished
                            *COM*:00000004 last_beacon_rx_timestamp
                            *COM*:00000004 MAC_OBJECT_CAP_START_TICKS
                            *COM*:00000004 MAC_OBJECT_CAP_END_TICKS
                            *COM*:00000004 MAC_OBJECT_SUPERFRAME_TICKS
C:\Users\sunhejie\AppData\Local\Temp/ccOsbaaa.s:1218   .text:00000592 mcpsDataConfirm
C:\Users\sunhejie\AppData\Local\Temp/ccOsbaaa.s:1246   .text:000005a2 mcpsDataIndication
C:\Users\sunhejie\AppData\Local\Temp/ccOsbaaa.s:1305   .text:000005f8 get_frame_pointer
C:\Users\sunhejie\AppData\Local\Temp/ccOsbaaa.s:1346   .text:00000614 get_pending_frame
C:\Users\sunhejie\AppData\Local\Temp/ccOsbaaa.s:1484   .text:000006f0 Is_data_pending
C:\Users\sunhejie\AppData\Local\Temp/ccOsbaaa.s:1614   .text:000007b4 beacon_request_frame_send
C:\Users\sunhejie\AppData\Local\Temp/ccOsbaaa.s:1628   .text:000007b6 beacon_frame_tx_timing
                            *COM*:00000004 last_beacon_tx_timestamp
C:\Users\sunhejie\AppData\Local\Temp/ccOsbaaa.s:1799   .text:00000922 timerqueue_adjust
                            *COM*:00000002 current_timer_elem
C:\Users\sunhejie\AppData\Local\Temp/ccOsbaaa.s:1834   .text:00000940 remove_pending_queue
                            *COM*:0000004e mac_tx_beacon
C:\Users\sunhejie\AppData\Local\Temp/ccOsbaaa.s:2232   .text:00000ba4 pending_frame_handle
C:\Users\sunhejie\AppData\Local\Temp/ccOsbaaa.s:2301   .text:00000bec remove_from_rx_buffer
C:\Users\sunhejie\AppData\Local\Temp/ccOsbaaa.s:2335   .text:00000c08 remove_tx_queue
C:\Users\sunhejie\AppData\Local\Temp/ccOsbaaa.s:2431   .text:00000c72 mac_timer3queue_getnextinterval
C:\Users\sunhejie\AppData\Local\Temp/ccOsbaaa.s:2471   .text:00000c90 initial_tx_queue
C:\Users\sunhejie\AppData\Local\Temp/ccOsbaaa.s:2495   .text:00000c92 add_pending_queue
C:\Users\sunhejie\AppData\Local\Temp/ccOsbaaa.s:2775   .text:00000e38 mlmeAssociateResponse
C:\Users\sunhejie\AppData\Local\Temp/ccOsbaaa.s:2969   .text:00000f6a mlmeAssociateIndication
C:\Users\sunhejie\AppData\Local\Temp/ccOsbaaa.s:3075   .text:00001002 add_to_rx_buffer
C:\Users\sunhejie\AppData\Local\Temp/ccOsbaaa.s:3183   .text:00001086 PD_DATA_indication
C:\Users\sunhejie\AppData\Local\Temp/ccOsbaaa.s:8099   .text:00002ee4 mac_get_received_frame
C:\Users\sunhejie\AppData\Local\Temp/ccOsbaaa.s:3223   .text:000010b0 add_tx_queue
C:\Users\sunhejie\AppData\Local\Temp/ccOsbaaa.s:3336   .text:00001132 direct_transmit
C:\Users\sunhejie\AppData\Local\Temp/ccOsbaaa.s:3387   .text:00001160 mac_frame_send
                            *COM*:000000b5 mac_tx_current_frame
                            *COM*:000000b5 mac_rx_current_frame
C:\Users\sunhejie\AppData\Local\Temp/ccOsbaaa.s:9470   .text:00003720 transmit_with_csmaca
C:\Users\sunhejie\AppData\Local\Temp/ccOsbaaa.s:4163   .text:00001614 beacon_frame_send
C:\Users\sunhejie\AppData\Local\Temp/ccOsbaaa.s:4348   .text:00001722 associate_response_frame_send
C:\Users\sunhejie\AppData\Local\Temp/ccOsbaaa.s:4476   .text:000017f0 coordinator_realignment_frame_send
C:\Users\sunhejie\AppData\Local\Temp/ccOsbaaa.s:4652   .text:0000191c mlmeSyncLossIndication
C:\Users\sunhejie\AppData\Local\Temp/ccOsbaaa.s:4734   .text:00001998 mlmeOrphanResponse
C:\Users\sunhejie\AppData\Local\Temp/ccOsbaaa.s:4854   .text:00001a48 mlmeOrphanIndication
C:\Users\sunhejie\AppData\Local\Temp/ccOsbaaa.s:4945   .text:00001ac6 mlmeStartRequest
C:\Users\sunhejie\AppData\Local\Temp/ccOsbaaa.s:5102   .text:00001be2 orphan_notification_frame_send
C:\Users\sunhejie\AppData\Local\Temp/ccOsbaaa.s:5193   .text:00001c72 mac_timer_task
                            *COM*:00000004 scan_channel
                            *COM*:00000001 scan_channel_index
                            *COM*:00000002 scan_time_period
C:\Users\sunhejie\AppData\Local\Temp/ccOsbaaa.s:5578   .text:00001ee0 mlmeScanRequest
C:\Users\sunhejie\AppData\Local\Temp/ccOsbaaa.s:5926   .text:0000210c scan_task
C:\Users\sunhejie\AppData\Local\Temp/ccOsbaaa.s:5949   .text:0000211e panid_confilct_frame_send
C:\Users\sunhejie\AppData\Local\Temp/ccOsbaaa.s:6025   .text:00002190 disassociate_notification_frame_send
C:\Users\sunhejie\AppData\Local\Temp/ccOsbaaa.s:6138   .text:00002244 mlmeDisassociateRequest
C:\Users\sunhejie\AppData\Local\Temp/ccOsbaaa.s:6356   .text:000023b6 associate_request_frame_send
C:\Users\sunhejie\AppData\Local\Temp/ccOsbaaa.s:6502   .text:000024a8 mlmeAssociateRequest
C:\Users\sunhejie\AppData\Local\Temp/ccOsbaaa.s:6597   .text:00002520 data_frame_send
C:\Users\sunhejie\AppData\Local\Temp/ccOsbaaa.s:6792   .text:00002658 pending_data_send
C:\Users\sunhejie\AppData\Local\Temp/ccOsbaaa.s:7067   .text:00002826 mcpsDataRequest
C:\Users\sunhejie\AppData\Local\Temp/ccOsbaaa.s:7353   .text:00002a08 data_request_frame_send
C:\Users\sunhejie\AppData\Local\Temp/ccOsbaaa.s:7480   .text:00002ade mlmeBeaconNotifyIndication
C:\Users\sunhejie\AppData\Local\Temp/ccOsbaaa.s:7705   .text:00002c3c mac_frame_rcvd
                            *COM*:00000084 mcps_data_indication_info
                            *COM*:0000000b mlme_associate_indication_info
C:\Users\sunhejie\AppData\Local\Temp/ccOsbaaa.s:8992   .text:00003474 initial_pending_queue
C:\Users\sunhejie\AppData\Local\Temp/ccOsbaaa.s:9006   .text:00003476 random_generate
C:\Users\sunhejie\AppData\Local\Temp/ccOsbaaa.s:9024   .text:0000347c do_backoff
C:\Users\sunhejie\AppData\Local\Temp/ccOsbaaa.s:9267   .text:000035e6 CSMA_CA_DOING
                            *COM*:00000001 BE
C:\Users\sunhejie\AppData\Local\Temp/ccOsbaaa.s:9091   .text:000034d2 csma_initial
                            *COM*:00000001 NB
                            *COM*:00000001 CW
                            *COM*:00000004 MAC_CURRENT_TICKS
C:\Users\sunhejie\AppData\Local\Temp/ccOsbaaa.s:9247   .text:000035d6 failure_to_tx_with_csma
                            *COM*:00000002 temp_csma_ca_frame
                            *COM*:00000001 csma_state
                            *COM*:00000010 OS_queue
                            *COM*:00000001 OS_sched_full
                            *COM*:00000001 OS_sched_free
                            *COM*:00000002 currentTime
                            *COM*:00000002 timestamp_H
                            *COM*:00000004 mState
                            *COM*:00000001 setIntervalFlag
                            *COM*:00000001 mScale
                            *COM*:00000001 mInterval
                            *COM*:00000001 queue_head
                            *COM*:00000001 queue_tail
                            *COM*:00000001 queue_size
                            *COM*:00000003 queue
                            *COM*:00000021 mTimerList
                            *COM*:00000001 backoff_timer_Set
                            *COM*:00000002 backoff_call
                            *COM*:00000014 SENSOR_DATA_VALUE
                            *COM*:00000001 ADC_INTERRUPT_FLAG
                            *COM*:00000001 cc2420_bramspi
                            *COM*:00000002 cc2420_rambuf
                            *COM*:00000001 cc2420_ramlen
                            *COM*:00000002 cc2420_ramaddr
                            *COM*:00000001 cc2420fifo_bspi
                            *COM*:00000002 cc2420fifo_txbuf
                            *COM*:00000001 cc2420fifo_txlength
                            *COM*:00000004 cc2420_rxbuf
                            *COM*:00000001 cc2420_rxlength
                            *COM*:00000002 cc2420_rxbuf_now
                            *COM*:00000001 cc2420_rxlength_now
                            *COM*:00000001 cc2420_rxbufuse
                            *COM*:00000001 rfpackernum
                            *COM*:00000001 cc2420_rxflag
                            *COM*:0000001c cc2420_currentparameters
                            *COM*:00000004 receive_timestamp
                            *COM*:00000004 send_timestamp
                            *COM*:00000001 cc2420_stateRadio
                            *COM*:00000002 cc2420_LocalAddr
                            *COM*:00000008 ieee_address
                            *COM*:00000001 rxbuf_flag
                            *COM*:00000001 GTSDirectionMask
                            *COM*:00000001 mac_working_state
                            *COM*:00000001 mac_current_state_saved
                            *COM*:00000001 Is_mac_associated_successful
                            *COM*:00000001 TRACKBEACON
                            *COM*:00000066 beacon_info
C:\Users\sunhejie\AppData\Local\Temp/ccOsbaaa.s:9717   .text:00003778 Letext

UNDEFINED SYMBOLS
__do_copy_data
__do_clear_bss
cc2420_set_ieee
cc2420_get_ieee
PLME_SET_TRX_STATE_request
puts
cc2420_setshortaddress
cc2420_setpanid
PLME_SET_request
systimer_start_task
systime32
sensor_data_tx_to_pc
error
free
malloc
short_address_allocate_req
printf
OS_post
PD_DATA_request
__divmodhi4
timer3queue_start
PLME_ED_request
cc2420_bcn_accept
timer3quere_cancel
__udivmodsi4
PLME_CCA_request
Leds_redToggle
